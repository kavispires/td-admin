"use strict";(self.webpackChunktdr=self.webpackChunktdr||[]).push([[187],{8158:(e,t,s)=>{s.d(t,{CQ:()=>h,bN:()=>p,cw:()=>x,hW:()=>g,xL:()=>m});var i=s(1105),a=s(2556),n=s(1310),r=s(6020),l=s(8955),o=s(5458),d=s(1087),c=s(7134),u=s(184);function m(e){let{item:t,width:s,className:i}=e;return(0,u.jsx)(r.ck,{id:t.id,width:s,title:"".concat(t.name.en," | ").concat(t.name.pt),className:i})}function p(e){let{item:t}=e;const s=(0,c._)();return(0,u.jsx)("span",{children:(0,u.jsx)(i.Z,{prefix:t.nsfw?(0,u.jsx)(l.Z,{style:{color:"hotPink"}}):(0,u.jsx)(o.Z,{}),placeholder:"Id",variant:"borderless",size:"small",value:t.id,readOnly:!0,style:{width:"8ch"},onClick:()=>s(t.id)})})}function h(e){let{item:t,language:s}=e;return(0,u.jsx)(i.Z,{prefix:(0,u.jsx)(n.H,{language:s,width:"1em"}),placeholder:"Name in ".concat(s.toUpperCase()),variant:"borderless",size:"small",value:t.name[s],readOnly:!0})}function g(e){let{item:t}=e;return t.nsfw?(0,u.jsx)(l.Z,{style:{color:"hotpink"}}):(0,u.jsx)(u.Fragment,{})}function x(e){let{item:t}=e;const[,s]=(0,d.lr)();return(0,u.jsx)("span",{children:(0,u.jsx)(a.ZP,{size:"small",shape:"round",onClick:()=>{s({itemId:t.id,view:"classifier"})},children:"Go to"})})}},548:(e,t,s)=>{s.d(t,{P:()=>a});var i=s(4766);function a(e){var t,s;let{prefix:a="",defaultCurrent:n=1,defaultPageSize:r=10,pageSizeOptions:l=[10,20,50,100],total:o,showQuickJumper:d}=e;const{queryParams:c,addParam:u}=(0,i.K)();return{current:Number(null!==(t=c.get("".concat(a,"page")))&&void 0!==t?t:String(n)),pageSize:Number(null!==(s=c.get("".concat(a,"pageSize")))&&void 0!==s?s:String(r)),onChange:e=>{u("".concat(a,"page"),e.toString(),String(n))},onShowSizeChange:(e,t)=>{u("".concat(a,"pageSize"),t.toString(),String(r))},defaultCurrent:n,defaultPageSize:r,pageSizeOptions:l,total:o,hideOnSinglePage:!0,showQuickJumper:d}}},1469:(e,t,s)=>{s.r(t),s.d(t,{ItemsGroups:()=>R,default:()=>K});var i=s(3990),a=s(2128),n=s(4520),r=s(4031),l=s(1046),o=s(2556),d=s(2979),c=s(3320),u=s(6106),m=s(914),p=s(2228),h=s(6020),g=s(7134),x=s(4290),j=s(4766),y=s(5529),v=s(763),f=s(2791),I=s(5850),S=s(731),Z=s(7765),k=s(8158),C=s(184);function b(e){let{item:t,itemGroups:s,groupsTypeahead:i,onUpdateItemGroups:a}=e;const n=(0,g._)();return(0,C.jsxs)(S.Z,{title:(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(r.Z.Text,{onClick:()=>n(t.id),children:t.id}),(0,C.jsx)(k.hW,{item:t})]}),style:{maxWidth:250},children:[(0,C.jsx)(k.xL,{item:t,width:75}),(0,C.jsxs)(l.Z,{size:"small",direction:"vertical",className:"my-4",children:[(0,C.jsx)(k.CQ,{item:t,language:"en"}),(0,C.jsx)(k.CQ,{item:t,language:"pt"}),(0,C.jsx)(Z.Z,{mode:"tags",style:{width:"100%"},placeholder:"Select a group",defaultValue:s,options:i,showSearch:!0,size:"small",onChange:e=>a(t.id,e)},String(s))]})]})}var w=s(548),G=s(6173);function N(e){let{data:t,addEntryToUpdate:s}=e;const{is:i,queryParams:a}=(0,j.K)(),n=(0,y.N)("items"),r=(0,f.useMemo)((()=>Object.values(null!==t&&void 0!==t?t:[]).reduce(((e,t)=>(t.itemsIds||console.warn("Group without items",t),t.itemsIds.forEach((s=>{e[s]||(e[s]=[]),e[s].push(t.id)})),e)),{})),[t]),l=(0,f.useMemo)((()=>(0,v.orderBy)(Object.keys(t).map((e=>({label:e,value:e}))),"label")),[t]),o=(e,i)=>{var a;const n=null!==(a=r[e])&&void 0!==a?a:[],l=i.filter((e=>!n.includes(e))),o=n.filter((e=>!i.includes(e)));l.forEach((i=>{var a,n;s(i,{id:i,itemsIds:(0,I.R1)([...null!==(a=null===(n=t[i])||void 0===n?void 0:n.itemsIds)&&void 0!==a?a:[],e])})})),o.forEach((i=>{var a;s(i,{id:i,itemsIds:(0,I.R1)(null===(a=t[i])||void 0===a?void 0:a.itemsIds.filter((t=>t!==e)))})}))};return(0,C.jsxs)(C.Fragment,{children:[(i("display","group")||!a.has("display"))&&(0,C.jsx)(O,{data:t,items:n.data,grousByItem:r,groupsTypeahead:l,onUpdateItemGroups:o}),i("display","item")&&(0,C.jsx)(z,{data:t,items:n.data,grousByItem:r,groupsTypeahead:l,onUpdateItemGroups:o})]})}function O(e){let{data:t,items:s,grousByItem:i,groupsTypeahead:a,onUpdateItemGroups:u}=e;const m=(0,g._)(),[p,x]=(0,f.useState)(null),j=(0,w.P)({showQuickJumper:!0,total:Object.keys(t).length}),y=[{title:"id",dataIndex:"id",key:"id",render:e=>(0,C.jsx)("span",{children:e})},{title:"Items",dataIndex:"itemsIds",key:"itemsIds",render:(e,t)=>(0,C.jsx)(n.Z,{gap:6,wrap:"wrap",children:e.map((e=>(0,C.jsxs)(n.Z,{gap:2,vertical:!0,children:[(0,C.jsx)(G.F6,{onClick:()=>x(e),children:(0,C.jsx)(h.ck,{id:e,width:60})}),(0,C.jsx)(n.Z,{justify:"center",children:(0,C.jsx)(r.Z.Text,{onClick:()=>m(e),children:e})})]},"".concat(t.id,"-").concat(e))))},"items-".concat(t.id))},{title:"Count",dataIndex:"itemsIds",key:"count",render:e=>(0,I.R1)(e).filter(Boolean).length},{title:"Actions",dataIndex:"itemsIds",key:"actions",render:e=>(0,C.jsx)(l.Z,{direction:"vertical",size:"small",children:(0,C.jsx)(o.ZP,{size:"small",onClick:()=>m(JSON.stringify(e)),children:"Copy Ids"})})}],v=p?s[p]:null;return(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(d.Z,{columns:y,dataSource:Object.values(t),className:"my-4",pagination:j}),(0,C.jsx)(c.Z,{title:"Edit Item Group",onClose:()=>x(null),open:!!v,children:v&&(0,C.jsx)(b,{item:v,itemGroups:i[v.id],groupsTypeahead:a,onUpdateItemGroups:u})})]})}function z(e){let{items:t,grousByItem:s,groupsTypeahead:i,onUpdateItemGroups:a}=e;const{is:n}=(0,j.K)(),l=n("emptyOnly"),o=(0,f.useMemo)((()=>l?Object.values(t).filter((e=>!s[e.id])):Object.values(t)),[t,s,l]),{page:d,pagination:c}=(0,x.e)({data:o});return(0,C.jsxs)(C.Fragment,{children:[(0,C.jsxs)(r.Z.Title,{level:2,children:["Groups by Items (",o.length,")"]}),(0,C.jsx)(p.N,{pagination:c,children:(0,C.jsx)(u.Z,{gutter:[16,16],className:"my-4",children:d.map((e=>(0,C.jsx)(m.Z,{xs:24,sm:24,md:12,lg:6,xl:4,children:(0,C.jsx)(b,{item:e,itemGroups:s[e.id],groupsTypeahead:i,onUpdateItemGroups:a})},e.id)))})})]})}var P=s(7128),T=s(7018),U=s(1958),B=s(3660),E=s(9197),D=s(7340);function F(e){var t;let{data:s,save:i,isDirty:a,isSaving:r,entriesToUpdate:l}=e;const{queryParams:o,addParam:d,addParams:c,is:u}=(0,j.K)();return(0,C.jsxs)(U.Pd,{children:[(0,C.jsxs)(n.Z,{vertical:!0,gap:12,children:[(0,C.jsx)(D.k,{isDirty:a,onSave:i,isSaving:r,dirt:JSON.stringify(Q(l))}),(0,C.jsx)(T.o,{data:()=>{return e=s,(0,I.Tj)(Q(e));var e},fileName:"items-groups.json",disabled:a,block:!0})]}),(0,C.jsx)(P.Z,{}),(0,C.jsx)(G.H,{label:"Display",value:null!==(t=o.get("display"))&&void 0!==t?t:"group",onChange:e=>c({display:e,page:1},{page:1}),options:[{title:"By Groups",icon:(0,C.jsx)(B.Z,{}),value:"group"},{title:"By Items",icon:(0,C.jsx)(E.Z,{}),value:"item"}]}),(0,C.jsx)(G.Do,{label:"No Groups Only",value:u("emptyOnly"),onChange:e=>d("emptyOnly",e,!1),disabled:!u("display","item")})]})}function Q(e){return(0,v.omitBy)((0,v.cloneDeep)(e),(e=>(0,v.isEmpty)(e.itemsIds)))}var J=s(4562),L=s(8938);function R(){const e=(0,L.i)({tdrResourceName:"items-groups",firebaseDataCollectionName:"itemsGroups",serialize:!0}),t=(0,y.N)("items");return(0,C.jsx)(U.Xg,{title:"Items",subtitle:"Groups Sets",children:(0,C.jsxs)(i.Z,{hasSider:!0,children:[(0,C.jsx)(J.p,{children:(0,C.jsx)(F,{...e})}),(0,C.jsx)(i.Z.Content,{className:"content",children:(0,C.jsx)(a.T,{isLoading:e.isLoading||t.isLoading,error:e.error||t.error,hasResponseData:!(0,v.isEmpty)(e.data)&&!(0,v.isEmpty)(t.data),children:(0,C.jsx)(N,{...e})})})]})})}const K=R}}]);
//# sourceMappingURL=ItemsGroups.ee2f2544.chunk.js.map