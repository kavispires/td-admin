"use strict";(self.webpackChunktd_admin=self.webpackChunktd_admin||[]).push([[997],{7018:(e,t,s)=>{s.d(t,{o:()=>i});var a=s(2252),n=s(5850),r=s(184);function i(e){let{data:t,fileName:s,loading:i,children:l,...o}=e;return(0,r.jsx)(a.ZP,{onClick:()=>(0,n.ZN)("function"===typeof t?t():t,s),loading:i,...o,children:null!==l&&void 0!==l?l:"Download JSON"})}},7340:(e,t,s)=>{s.d(t,{k:()=>u});var a=s(2252),n=s(2426),r=s.n(n),i=s(2791),l=s(8211),o=s(4483),c=s(4841),d=s(184);function u(e){let{isDirty:t,onSave:s,isSaving:n,dirt:u,interval:h=6e5,...g}=e;const{togglePendingSave:v}=(0,c.b)(),[,m,x]=(0,l.Z)((()=>{t&&s()}),h);return(0,i.useEffect)((()=>{t?(v(!0),console.log("Save Reset",r()(Date.now()).format("MM/DD/YYYY HH:mm:ss")),x()):(v(!1),m())}),[t,x,m,u]),(0,i.useEffect)((()=>{const e=e=>{if(t){const t="You have unsaved changes, are you sure you want to leave?";return e.returnValue=t,t}};return window.addEventListener("beforeunload",e),()=>{window.removeEventListener("beforeunload",e)}}),[t]),(0,d.jsx)(a.ZP,{type:"primary",size:"large",icon:(0,d.jsx)(o.Z,{}),onClick:s,disabled:!t,loading:n,danger:!0,block:!0,...g,children:"Save"})}},145:(e,t,s)=>{s.d(t,{f:()=>l});var a=s(3733),n=s(6340),r=s(2606),i=s(184);const l=e=>{let{id:t,width:s=200,className:l="",preview:o=!0,fileExtension:c="jpg"}=e;const{getUrl:d}=(0,r.n)("images"),u=t.replace(/-/g,"/");return(0,i.jsx)("div",{className:(0,a.Z)("image-card",l),children:(0,i.jsx)(n.Z,{width:s,src:d("".concat(u,".").concat(c)),fallback:d("back/default.jpg"),preview:o})})}},7166:(e,t,s)=>{s.d(t,{P:()=>l,l:()=>o});var a=s(2791),n=s(1127),r=s(184);const i=(0,a.createContext)({}),l=e=>{let{children:t}=e;const s=(0,n.AZ)(),[l,o]=(0,a.useState)(15),[c,d]=(0,a.useState)(5),[u,h]=(0,a.useState)(150),[g,v]=(0,a.useState)(!1),m=(0,n.IN)(s.data,s.setDirty,l,c);return(0,r.jsx)(i.Provider,{value:{sampleSize:l,setSampleSize:o,tagThreshold:c,setTagThreshold:d,cardSize:u,setCardSize:h,showIds:g,setShowIds:v,randomGroups:m,query:s},children:t})},o=()=>(0,a.useContext)(i)},4249:(e,t,s)=>{s.d(t,{c:()=>i});var a=s(1492),n=s(952),r=s(184);function i(e){let{card:t}=e;const s=t.length>10?"red":t.length>5?"blue":t.length>0?"green":void 0;return(0,r.jsx)("div",{children:(0,r.jsxs)(n.Z,{color:s,icon:(0,r.jsx)(a.Z,{}),children:[" ",t.length]})})}},9936:(e,t,s)=>{s.d(t,{A:()=>o});var a=s(8622),n=s(5225),r=s(9367),i=s(7166),l=s(184);function o(){const{query:{stats:e}}=(0,i.l)();return(0,l.jsx)(n.Z.Item,{label:(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(r.C,{icon:(0,l.jsx)(a.Z,{}),shape:"square",size:"small",style:{marginRight:6}}),"Stats"]}),children:(0,l.jsxs)("ul",{className:"statistic__list",children:[(0,l.jsxs)("li",{children:["Completion: ",Math.floor(100*e.total/2520),"%"]}),(0,l.jsxs)("li",{children:["Total Relationships: ",e.total]}),(0,l.jsxs)("li",{children:["Complete: ",e.complete]}),(0,l.jsxs)("li",{children:["Overdone: ",e.overdone]}),(0,l.jsxs)("li",{children:["Single Match: ",e.single]})]})})}},1127:(e,t,s)=>{s.d(t,{AZ:()=>x,gU:()=>m,IN:()=>j});var a=s(4747),n=s(9631),r=s(763),i=s(2791),l=s(2592),o=s(5850),c=s(3713),d=s(2010),u=s(8556);var h=s(4766);const g=()=>(0,r.padStart)(String((0,r.random)(1,252)),2,"0"),v=()=>(0,r.random)(1,12);function m(e,t){var s,a,n;const[r,l]=(0,i.useState)(v()),[c,d]=(0,i.useState)(g()),[u,m]=(0,i.useState)(v()),[x,j]=(0,i.useState)(g()),S="td-d".concat(r,"-").concat(c),f="td-d".concat(u,"-").concat(x),[p,y]=(0,i.useState)(0),{queryParams:C}=(0,h.K)(),Z=Number(null!==(s=C.get("cycle"))&&void 0!==s?s:3),b=null!==(a=null===e||void 0===e?void 0:e[S])&&void 0!==a?a:[],w=null!==(n=null===e||void 0===e?void 0:e[f])&&void 0!==n?n:[],E=()=>{y(0),l(v()),d(g()),m(v()),j(g())};return(0,i.useEffect)((()=>{S===f&&j(g())}),[S,f]),{cardAId:S,cardA:b,cardBId:f,cardB:w,relate:()=>{y(0),b.push(f),e[S]=(0,o.R1)(b),w.push(S),e[f]=(0,o.R1)(w),t(!0),l(u),d(x),m(v()),j(g())},unrelate:()=>{p>=Z?(y(0),E()):(y((e=>e+1)),m(v()),j(g()))},areRelated:b.includes(f),onRandomCards:E}}function x(){const[e,t]=(0,i.useState)(!1),s=["data/imageCardsRelationships"],r=(0,c.NL)(),{notification:o}=a.Z.useApp(),[h,g]=(0,i.useState)({total:0,overdone:0,complete:0,single:0}),{data:v={},isLoading:m,isSuccess:x,isError:j,error:S,isFetched:f,isRefetching:p,refetch:y}=(0,d.a)({queryKey:s,queryFn:async()=>{var e;const t=(0,n.JU)(l.RZ,"data/imageCardsRelationships");return null!==(e=(await(0,n.QT)(t)).data())&&void 0!==e?e:{}}}),{isPending:C,isError:Z,isSuccess:b,mutate:w}=(0,u.D)({mutationKey:s,mutationFn:async()=>{const e=(0,n.JU)(l.RZ,"data/imageCardsRelationships");return await(0,n.pl)(e,v),v},onSuccess:()=>{o.success({message:"Saved",placement:"bottomLeft"}),r.refetchQueries({queryKey:s}),t(!1)}});return(0,i.useEffect)((()=>{if(!p&&f){const e=Object.keys(v).length;let t=0,s=0,a=0;Object.values(v).forEach((e=>{e.length>8&&(t+=1),1===e.length&&(a+=1),e.length>2&&(s+=1)})),g({total:e,overdone:t,complete:s,single:a})}}),[f,p]),{data:v,isLoading:m,isSuccess:x,isError:j,error:S,hasData:x&&Object.keys(v).length>0,refetch:y,isSaving:C,isMutationError:Z,isSaved:b,save:w,setDirty:t,isDirty:e,stats:h}}function j(e,t,s,a){const[n,r]=(0,i.useState)([]),[l,c]=(0,i.useState)([]),[d,u]=(0,i.useState)([]),[h,m]=(0,i.useState)(0),[x,j]=(0,i.useState)(!0),[S,f]=(0,i.useState)([]),p=t=>{c((null!==t&&void 0!==t?t:n).map((t=>{var s;return null!==(s=null===e||void 0===e?void 0:e[t])&&void 0!==s?s:[]})))},y=()=>{const t=[...S];let n=0;const i=d.length<2e3?d:[];let l=0;for(;l<400&&t.length<s;){var o;const s="td-d".concat(v(),"-").concat(g()),r=null!==(o=e[s])&&void 0!==o?o:[],c=!(a>0)||r.length<a,d=!!x&&i.includes(s);t.includes(s)||d||!c||(t.push(s),n+=1),l+=1}r(t),u((e=>[...e,...t])),p(t),m((e=>e+n))};(0,i.useEffect)((()=>{0===n.length&&y()}),[n]);return{cardIds:n,cards:l,selection:S,onSelect:e=>{f((t=>{const s=[...t],a=s.indexOf(e);return a>-1?s.splice(a,1):s.push(e),s}))},relate:()=>{S.forEach((t=>{var s;const a=null!==(s=e[t])&&void 0!==s?s:[];a.push(...S.filter((e=>e!==t))),e[t]=(0,o.R1)(a)})),t(!0),f([]),p(),u([]),m(0)},nextSet:y,deselectAll:()=>{f([])},cycles:h,filters:{useCycles:x,toggleUseCycles:()=>{j((e=>!e))}}}}},4766:(e,t,s)=>{s.d(t,{K:()=>r});var a=s(2791),n=s(1087);function r(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const[t,s]=(0,n.lr)(),r=(e,a,n)=>{void 0===a||""===a||a===n?t.delete(e):t.set(e,String(a)),s(t)},i=function(e){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Object.entries(e).forEach((e=>{let[s,n]=e;a[s]===n?t.delete(s):t.set(s,String(n))})),s(t)},l=e=>{t.delete(e),s(t)},o=function(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"true";return t.get(e)===String(s)};return(0,a.useEffect)((()=>{Object.entries(e).forEach((e=>{let[s,a]=e;t.has(s)||r(s,a)}))}),[]),{addParam:r,addParams:i,removeParam:l,queryParams:t,is:o}}},7131:(e,t,s)=>{s.r(t),s.d(t,{default:()=>I});var a=s(1790),n=s(7166),r=s(2128),i=s(763),l=s(6473),o=s(6340),c=s(952),d=s(2034),u=s(7691),h=s(9720),g=s(398),v=s(4988),m=s(7360),x=s(4057),j=s(145),S=s(4249),f=s(8357),p=s(2791),y=s(7415),C=s(184);function Z(){const{query:{isDirty:e,isSaving:t,save:s,stats:a,...d},randomGroups:{cardIds:h,cards:g,onSelect:v,selection:m,relate:x,nextSet:Z,deselectAll:w,cycles:E},showIds:D,cardSize:N}=(0,n.l)(),R=(0,p.useRef)(null),[k,{width:z}]=(0,y.Z)(),[I,P]=(0,p.useMemo)((()=>{const e=Math.floor(z/N)+1;return[e,Math.floor(z/e)]}),[N,z]);return(0,C.jsx)(r.T,{isLoading:d.isLoading,error:d.error,hasResponseData:!(0,i.isEmpty)(d.data),children:(0,C.jsx)("div",{ref:k,className:"my-6",children:(0,C.jsxs)(l.Z,{title:"Card Relationship Matching",extra:(0,C.jsxs)("span",{children:[(0,C.jsx)(u.Z,{})," ",E]}),className:"image-card-categorizer-card",ref:R,children:[(0,C.jsx)(o.Z.PreviewGroup,{children:(0,C.jsx)("div",{className:"image-cards-group",style:{gridTemplateColumns:"repeat(".concat(Math.max(I,1),", 1fr)")},children:h.map(((e,t)=>{const s=m.includes(e),a=g[t];return(0,C.jsx)("div",{className:"image-card-card__image",children:(0,C.jsxs)(f.F6,{onClick:()=>v(e),active:s,className:"image-cards-group__button",activeClass:"image-cards-group__button--active",children:[(0,C.jsx)(j.f,{id:e,width:P-24,preview:!1}),(0,C.jsxs)("div",{children:[D&&(0,C.jsx)(c.Z,{children:e}),(0,C.jsx)(S.c,{card:a})]})]})},e)}))})}),(0,C.jsx)(b,{isSaving:t,isDirty:e,selection:m,relate:x,deselectAll:w,onNextSet:()=>{var e;Z(),null===(e=R.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})}})]})})})}const b=e=>{let{isSaving:t,isDirty:s,selection:a,relate:n,deselectAll:r,onNextSet:i}=e;if(t)return(0,C.jsx)(C.Fragment,{children:(0,C.jsx)(d.Z,{icon:(0,C.jsx)(h.Z,{})})});return(0,C.jsxs)(C.Fragment,{children:[s&&(0,C.jsx)(d.Z,{icon:(0,C.jsx)(g.Z,{}),type:"primary",style:{right:234}}),(0,C.jsx)(d.Z,{icon:(0,C.jsx)(v.Z,{}),style:{right:164},onClick:r}),(0,C.jsx)(d.Z,{icon:(0,C.jsx)(m.Z,{}),style:{right:94},type:a.length<2?"default":"primary",badge:{count:a.length,size:"small"},onClick:()=>{a.length<2||n()}}),(0,C.jsx)(d.Z,{icon:(0,C.jsx)(x.Z,{}),style:{right:24},onClick:i})]})};var w=s(4520),E=s(7018),D=s(7340),N=s(7965),R=s(6591),k=s(9936);function z(){const{query:{isDirty:e,isSaving:t,save:s,data:a,isLoading:r,isError:l},randomGroups:{filters:o},showIds:c,setShowIds:d,tagThreshold:u,setTagThreshold:h,sampleSize:g,setSampleSize:v,cardSize:m,setCardSize:x}=(0,n.l)();return(0,C.jsxs)(N.p3,{children:[(0,C.jsx)(N.Pd,{children:(0,C.jsxs)(w.Z,{vertical:!0,gap:6,children:[(0,C.jsx)(D.k,{isDirty:e,dirt:JSON.stringify(a),onSave:()=>s({}),isSaving:t}),(0,C.jsx)(E.o,{data:a,fileName:"imageCardsRelationships.json",loading:t,disabled:(0,i.isEmpty)(a),block:!0})]})}),(0,C.jsx)(f.Th,{isLoading:r||t,isDirty:e,isError:l,hasResponseData:!(0,i.isEmpty)(a)}),(0,C.jsxs)(N.Pd,{children:[(0,C.jsx)(f.Do,{label:"Use Cycles",value:o.useCycles,onChange:()=>o.toggleUseCycles()}),(0,C.jsx)(f.Do,{label:"Show Ids",value:c,onChange:e=>d(e)}),(0,C.jsx)(f.zE,{onChange:e=>h(e),value:u,options:R.VC,label:"Tag Count"}),(0,C.jsx)(f.zE,{onChange:e=>v(e),value:g,options:R.ZI,label:"Sample Size"}),(0,C.jsx)(f.zE,{onChange:e=>x(e),value:m,options:R.Hn,label:"Card Size"})]}),(0,C.jsx)(N.Pd,{children:(0,C.jsx)(k.A,{})})]})}const I=function(){return(0,C.jsx)(N.Xg,{title:"Image Cards",subtitle:"Relationships",children:(0,C.jsx)(n.P,{children:(0,C.jsxs)(a.Z,{hasSider:!0,children:[(0,C.jsx)(z,{}),(0,C.jsx)(a.Z.Content,{className:"content",children:(0,C.jsx)(Z,{})})]})})})}}}]);
//# sourceMappingURL=ImageCardsRelationships.7fdc99ce.chunk.js.map