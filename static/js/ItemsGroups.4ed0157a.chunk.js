"use strict";(self.webpackChunktd_admin=self.webpackChunktd_admin||[]).push([[1187],{6095:(e,t,a)=>{a.d(t,{N:()=>d});var s=a(1413),i=a(4925),n=a(2658),r=a(1046),o=a(184);const c=["children","pagination"];function d(e){let{children:t,pagination:a}=e,d=(0,i.Z)(e,c);const l=(0,o.jsx)(n.Z,(0,s.Z)((0,s.Z)({showQuickJumper:!0},a),{},{className:"fixed-pagination"}));return(0,o.jsxs)(r.Z,(0,s.Z)((0,s.Z)({direction:"vertical"},d),{},{children:[l,t,l]}))}},4850:(e,t,a)=>{a.d(t,{A:()=>o});var s=a(1046),i=a(9475),n=a(7134),r=a(184);function o(e){let{ids:t}=e;const a=(0,n._)();return(0,r.jsx)(s.Z,{direction:"vertical",size:"small",children:(0,r.jsx)(i.ZP,{size:"small",onClick:()=>a(JSON.stringify(t)),children:"Copy Ids"})})}},8158:(e,t,a)=>{a.d(t,{CQ:()=>h,bN:()=>p,cw:()=>v,hW:()=>g,xL:()=>m});var s=a(7515),i=a(9475),n=a(1310),r=a(2997),o=a(8955),c=a(5458),d=a(7134),l=a(1087),u=a(184);function m(e){let{item:t,width:a,className:s}=e;return(0,u.jsx)(r.ck,{id:t.id,width:a,title:"".concat(t.name.en," | ").concat(t.name.pt),className:s})}function p(e){let{item:t}=e;const a=(0,d._)();return(0,u.jsx)("span",{children:(0,u.jsx)(s.Z,{prefix:t.nsfw?(0,u.jsx)(o.Z,{style:{color:"hotPink"}}):(0,u.jsx)(c.Z,{}),placeholder:"Id",variant:"borderless",size:"small",value:t.id,readOnly:!0,style:{width:"8ch"},onClick:()=>a(t.id)})})}function h(e){let{item:t,language:a}=e;return(0,u.jsx)(s.Z,{prefix:(0,u.jsx)(n.H,{language:a,width:"1em"}),placeholder:"Name in ".concat(a.toUpperCase()),variant:"borderless",size:"small",value:t.name[a],readOnly:!0})}function g(e){let{item:t}=e;return t.nsfw?(0,u.jsx)(o.Z,{style:{color:"hotpink"}}):(0,u.jsx)(u.Fragment,{})}function v(e){let{item:t}=e;const[,a]=(0,l.lr)();return(0,u.jsx)("span",{children:(0,u.jsx)(i.ZP,{size:"small",shape:"round",onClick:()=>{a({itemId:t.id,view:"classifier"})},children:"Go to"})})}},4290:(e,t,a)=>{a.d(t,{e:()=>r});var s=a(2791),i=a(4421),n=a(4766);function r(e){var t,a;let{prefix:r="",data:o,defaultCurrent:c=1,defaultPageSize:d=64,pageSizeOptions:l=[16,32,64,128],resetter:u}=e;const{queryParams:m,addParam:p}=(0,n.K)(),h=Number(null!==(t=m.get("".concat(r,"page")))&&void 0!==t?t:String(c)),g=Number(null!==(a=m.get("".concat(r,"pageSize")))&&void 0!==a?a:String(d)),v=(0,i.Z)(u),f=(0,s.useMemo)((()=>{const e=(h-1)*g,t=e+g;return o.slice(e,t)}),[h,g,o]),x=e=>{p("".concat(r,"page"),e.toString(),String(c))};return u!==v&&x(c),{page:f,pagination:{current:h,pageSize:g,onChange:x,onShowSizeChange:(e,t)=>{p("".concat(r,"pageSize"),t.toString(),String(d))},defaultCurrent:c,defaultPageSize:d,pageSizeOptions:l,total:o.length,hideOnSinglePage:!0}}}},8938:(e,t,a)=>{a.d(t,{i:()=>m});var s=a(1413),i=a(4747),n=a(763),r=a(2791),o=a(3713),c=a(5850),d=a(8027),l=a(5529),u=a(2233);function m(e){let{tdrResourceName:t,firebaseDataCollectionName:a,serialize:m}=e;const{notification:p}=i.Z.useApp(),h=(0,o.NL)(),g=(0,l.N)(t),v=(0,d.X)("tdr",a,{select:m?c.d_:void 0}),[f,x]=(0,r.useState)({}),j=(0,u.B)("tdr",a,{onSuccess:()=>{p.success({message:"".concat(a," updated")}),h.refetchQueries({queryKey:["firebase","tdr",a]}),x({})},onError:e=>{p.error({message:"".concat(a," update failed"),description:e.message})}}),y=(0,r.useMemo)((()=>{var e,i;return g.isSuccess&&v.isSuccess&&!j.isPending?(console.log("%cMerging ".concat(t,"+").concat(a," data..."),"color: #f0f"),(0,n.cloneDeep)((0,s.Z)((0,s.Z)((0,s.Z)({},null!==(e=g.data)&&void 0!==e?e:{}),null!==(i=v.data)&&void 0!==i?i:{}),f))):{}}),[t,a,g.data,v.data,g.isSuccess,v.isSuccess,j.isPending,f]),Z=!(0,n.isEmpty)(f),S=v.data;return{data:y,isLoading:g.isLoading||v.isLoading,error:g.error||v.error,firebaseData:S,isSaving:j.isPending,save:()=>{j.mutate(m?(0,c.aS)(f):f)},addEntryToUpdate:(e,t)=>{x((a=>(0,s.Z)((0,s.Z)({},a),{},{[e]:t})))},entriesToUpdate:f,isDirty:Z}}},548:(e,t,a)=>{a.d(t,{P:()=>i});var s=a(4766);function i(e){var t,a;let{prefix:i="",defaultCurrent:n=1,defaultPageSize:r=10,pageSizeOptions:o=[10,20,50,100],total:c,showQuickJumper:d}=e;const{queryParams:l,addParam:u}=(0,s.K)();return{current:Number(null!==(t=l.get("".concat(i,"page")))&&void 0!==t?t:String(n)),pageSize:Number(null!==(a=l.get("".concat(i,"pageSize")))&&void 0!==a?a:String(r)),onChange:e=>{u("".concat(i,"page"),e.toString(),String(n))},onShowSizeChange:(e,t)=>{u("".concat(i,"pageSize"),t.toString(),String(r))},defaultCurrent:n,defaultPageSize:r,pageSizeOptions:o,total:c,hideOnSinglePage:!0,showQuickJumper:d}}},8440:(e,t,a)=>{a.r(t),a.d(t,{ItemsGroups:()=>_,default:()=>F});var s=a(1413),i=a(1790),n=a(2128),r=a(4520),o=a(6178),c=a(5625),d=a(3320),l=a(6106),u=a(914),m=a(6095),p=a(2997),h=a(7134),g=a(4290),v=a(4766),f=a(5529),x=a(763),j=a(2791),y=a(5850),Z=a(8357),S=a(548),z=a(4850),I=a(8178),b=a(6473),w=a(1046),C=a(906),N=a(8158),k=a(184);function G(e){let{item:t,itemGroups:a,groupsTypeahead:s,onUpdateItemGroups:i}=e;const n=(0,h._)();return(0,k.jsxs)(b.Z,{title:(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(o.Z.Text,{onClick:()=>n(t.id),children:t.id}),(0,k.jsx)(N.hW,{item:t})]}),style:{maxWidth:250},children:[(0,k.jsx)(N.xL,{item:t,width:75}),(0,k.jsxs)(w.Z,{size:"small",direction:"vertical",className:"my-4",children:[(0,k.jsx)(N.CQ,{item:t,language:"en"}),(0,k.jsx)(N.CQ,{item:t,language:"pt"}),(0,k.jsx)(C.Z,{mode:"tags",style:{width:"100%"},placeholder:"Select a group",defaultValue:a,options:s,showSearch:!0,size:"small",onChange:e=>i(t.id,e)},String(a))]})]})}function P(e){let{data:t,addEntryToUpdate:a}=e;const{is:s,queryParams:i}=(0,v.K)(),n=(0,f.N)("items"),r=(0,j.useMemo)((()=>Object.values(null!==t&&void 0!==t?t:[]).reduce(((e,t)=>(t.itemsIds||console.warn("Group without items",t),t.itemsIds.forEach((a=>{e[a]||(e[a]=[]),e[a].push(t.id)})),e)),{})),[t]),o=(0,j.useMemo)((()=>(0,x.orderBy)(Object.keys(t).map((e=>({label:e,value:e}))),"label")),[t]),c=(e,s)=>{var i;const n=null!==(i=r[e])&&void 0!==i?i:[],o=s.filter((e=>!n.includes(e))),c=n.filter((e=>!s.includes(e)));o.forEach((s=>{var i,n;a(s,{id:s,itemsIds:(0,y.R1)([...null!==(i=null===(n=t[s])||void 0===n?void 0:n.itemsIds)&&void 0!==i?i:[],e])})})),c.forEach((s=>{var i;a(s,{id:s,itemsIds:(0,y.R1)(null===(i=t[s])||void 0===i?void 0:i.itemsIds.filter((t=>t!==e)))})}))},d=(e,t)=>{a(e,{id:e,itemsIds:(0,y.R1)(t)})};return(0,k.jsxs)(k.Fragment,{children:[(s("display","group")||!i.has("display"))&&(0,k.jsx)(O,{data:t,items:n.data,grousByItem:r,groupsTypeahead:o,onUpdateItemGroups:c,onUpdateGroupItems:d}),s("display","item")&&(0,k.jsx)(E,{data:t,items:n.data,grousByItem:r,groupsTypeahead:o,onUpdateItemGroups:c,onUpdateGroupItems:d})]})}function O(e){let{data:t,items:a,grousByItem:s,groupsTypeahead:i,onUpdateItemGroups:n,onUpdateGroupItems:l}=e;const u=(0,h._)(),m=(0,f.N)("items"),[g,v]=(0,j.useState)(null),x=(0,S.P)({showQuickJumper:!0,total:Object.keys(t).length}),I=[{title:"id",dataIndex:"id",key:"id",render:e=>(0,k.jsx)("span",{children:e})},{title:"Items",dataIndex:"itemsIds",key:"itemsIds",render:(e,t)=>(0,k.jsx)(r.Z,{gap:6,wrap:"wrap",children:e.map((e=>(0,k.jsxs)(r.Z,{gap:2,vertical:!0,children:[(0,k.jsx)(Z.F6,{onClick:()=>v(e),children:(0,k.jsx)(p.ck,{id:e,width:60})}),(0,k.jsx)(r.Z,{justify:"center",children:(0,k.jsx)(o.Z.Text,{onClick:()=>u(e),children:e})})]},"".concat(t.id,"-").concat(e))))},"items-".concat(t.id))},c.Z.EXPAND_COLUMN,{title:"Count",dataIndex:"itemsIds",key:"count",render:e=>(0,y.R1)(e).filter(Boolean).length},{title:"Actions",dataIndex:"itemsIds",key:"actions",render:e=>(0,k.jsx)(z.A,{ids:e})}],b=g?a[g]:null;return(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(c.Z,{columns:I,dataSource:Object.values(t),className:"my-4",rowKey:"id",pagination:x,expandable:{expandedRowRender:e=>(0,k.jsx)(H,{group:e,onUpdateGroupItems:l}),rowExpandable:()=>m.isSuccess}}),(0,k.jsx)(d.Z,{title:"Edit Item Group",onClose:()=>v(null),open:!!b,children:b&&(0,k.jsx)(G,{item:b,itemGroups:s[b.id],groupsTypeahead:i,onUpdateItemGroups:n})})]})}function H(e){let{group:t,onUpdateGroupItems:a}=e;return(0,k.jsx)("div",{children:(0,k.jsx)(I.i,{onFinish:e=>{a(t.id,[...t.itemsIds,e])}})})}function E(e){let{items:t,grousByItem:a,groupsTypeahead:s,onUpdateItemGroups:i}=e;const{is:n}=(0,v.K)(),r=n("emptyOnly"),c=(0,j.useMemo)((()=>r?Object.values(t).filter((e=>!a[e.id])):Object.values(t)),[t,a,r]),{page:d,pagination:p}=(0,g.e)({data:c});return(0,k.jsxs)(k.Fragment,{children:[(0,k.jsxs)(o.Z.Title,{level:2,children:["Groups by Items (",c.length,")"]}),(0,k.jsx)(m.N,{pagination:p,children:(0,k.jsx)(l.Z,{gutter:[16,16],className:"my-4",children:d.map((e=>(0,k.jsx)(u.Z,{xs:24,sm:24,md:12,lg:6,xl:4,children:(0,k.jsx)(G,{item:e,itemGroups:a[e.id],groupsTypeahead:s,onUpdateItemGroups:i})},e.id)))})})]})}var V=a(7128),U=a(7018),M=a(7965),T=a(3660),R=a(9197),B=a(7340);function D(e){var t;let{data:a,save:s,isDirty:i,isSaving:n,entriesToUpdate:o}=e;const{queryParams:c,addParam:d,addParams:l,is:u}=(0,v.K)();return(0,k.jsxs)(M.Pd,{children:[(0,k.jsxs)(r.Z,{vertical:!0,gap:12,children:[(0,k.jsx)(B.k,{isDirty:i,onSave:s,isSaving:n,dirt:JSON.stringify(L(o))}),(0,k.jsx)(U.o,{data:()=>{return e=a,Object.keys(e).forEach((t=>{e[t].itemsIds=(0,y.E4)((0,y.R1)(e[t].itemsIds))})),(0,y.Tj)(L(e));var e},fileName:"items-groups.json",disabled:i,block:!0})]}),(0,k.jsx)(V.Z,{}),(0,k.jsx)(Z.H,{label:"Display",value:null!==(t=c.get("display"))&&void 0!==t?t:"group",onChange:e=>l({display:e,page:1},{page:1}),options:[{title:"By Groups",icon:(0,k.jsx)(T.Z,{}),value:"group"},{title:"By Items",icon:(0,k.jsx)(R.Z,{}),value:"item"}]}),u("display","item")&&(0,k.jsx)(Z.Do,{label:"No Groups Only",value:u("emptyOnly"),onChange:e=>d("emptyOnly",e,!1)})]})}function L(e){return(0,x.omitBy)((0,x.cloneDeep)(e),(e=>(0,x.isEmpty)(e.itemsIds)))}var A=a(4562),Q=a(8938);function _(){const e=(0,Q.i)({tdrResourceName:"items-groups",firebaseDataCollectionName:"itemsGroups",serialize:!0}),t=(0,f.N)("items");return(0,k.jsx)(M.Xg,{title:"Items",subtitle:"Groups Sets",children:(0,k.jsxs)(i.Z,{hasSider:!0,children:[(0,k.jsx)(A.p,{children:(0,k.jsx)(D,(0,s.Z)({},e))}),(0,k.jsx)(i.Z.Content,{className:"content",children:(0,k.jsx)(n.T,{isLoading:e.isLoading||t.isLoading,error:e.error||t.error,hasResponseData:!(0,x.isEmpty)(e.data)&&!(0,x.isEmpty)(t.data),children:(0,k.jsx)(P,(0,s.Z)({},e))})})]})})}const F=_},3660:(e,t,a)=>{a.d(t,{Z:()=>c});var s=a(7460),i=a(2791);const n={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M888 680h-54V540H546v-92h238c8.8 0 16-7.2 16-16V168c0-8.8-7.2-16-16-16H240c-8.8 0-16 7.2-16 16v264c0 8.8 7.2 16 16 16h238v92H190v140h-54c-4.4 0-8 3.6-8 8v176c0 4.4 3.6 8 8 8h176c4.4 0 8-3.6 8-8V688c0-4.4-3.6-8-8-8h-54v-72h220v72h-54c-4.4 0-8 3.6-8 8v176c0 4.4 3.6 8 8 8h176c4.4 0 8-3.6 8-8V688c0-4.4-3.6-8-8-8h-54v-72h220v72h-54c-4.4 0-8 3.6-8 8v176c0 4.4 3.6 8 8 8h176c4.4 0 8-3.6 8-8V688c0-4.4-3.6-8-8-8zM256 805.3c0 1.5-1.2 2.7-2.7 2.7h-58.7c-1.5 0-2.7-1.2-2.7-2.7v-58.7c0-1.5 1.2-2.7 2.7-2.7h58.7c1.5 0 2.7 1.2 2.7 2.7v58.7zm288 0c0 1.5-1.2 2.7-2.7 2.7h-58.7c-1.5 0-2.7-1.2-2.7-2.7v-58.7c0-1.5 1.2-2.7 2.7-2.7h58.7c1.5 0 2.7 1.2 2.7 2.7v58.7zM288 384V216h448v168H288zm544 421.3c0 1.5-1.2 2.7-2.7 2.7h-58.7c-1.5 0-2.7-1.2-2.7-2.7v-58.7c0-1.5 1.2-2.7 2.7-2.7h58.7c1.5 0 2.7 1.2 2.7 2.7v58.7zM360 300a40 40 0 1080 0 40 40 0 10-80 0z"}}]},name:"cluster",theme:"outlined"};var r=a(4790),o=function(e,t){return i.createElement(r.Z,(0,s.Z)({},e,{ref:t,icon:n}))};const c=i.forwardRef(o)},8955:(e,t,a)=>{a.d(t,{Z:()=>c});var s=a(7460),i=a(2791);const n={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M834.1 469.2A347.49 347.49 0 00751.2 354l-29.1-26.7a8.09 8.09 0 00-13 3.3l-13 37.3c-8.1 23.4-23 47.3-44.1 70.8-1.4 1.5-3 1.9-4.1 2-1.1.1-2.8-.1-4.3-1.5-1.4-1.2-2.1-3-2-4.8 3.7-60.2-14.3-128.1-53.7-202C555.3 171 510 123.1 453.4 89.7l-41.3-24.3c-5.4-3.2-12.3 1-12 7.3l2.2 48c1.5 32.8-2.3 61.8-11.3 85.9-11 29.5-26.8 56.9-47 81.5a295.64 295.64 0 01-47.5 46.1 352.6 352.6 0 00-100.3 121.5A347.75 347.75 0 00160 610c0 47.2 9.3 92.9 27.7 136a349.4 349.4 0 0075.5 110.9c32.4 32 70 57.2 111.9 74.7C418.5 949.8 464.5 959 512 959s93.5-9.2 136.9-27.3A348.6 348.6 0 00760.8 857c32.4-32 57.8-69.4 75.5-110.9a344.2 344.2 0 0027.7-136c0-48.8-10-96.2-29.9-140.9z"}}]},name:"fire",theme:"filled"};var r=a(4790),o=function(e,t){return i.createElement(r.Z,(0,s.Z)({},e,{ref:t,icon:n}))};const c=i.forwardRef(o)},5458:(e,t,a)=>{a.d(t,{Z:()=>c});var s=a(7460),i=a(2791);const n={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M928 160H96c-17.7 0-32 14.3-32 32v640c0 17.7 14.3 32 32 32h832c17.7 0 32-14.3 32-32V192c0-17.7-14.3-32-32-32zm-40 632H136V232h752v560zM610.3 476h123.4c1.3 0 2.3-3.6 2.3-8v-48c0-4.4-1-8-2.3-8H610.3c-1.3 0-2.3 3.6-2.3 8v48c0 4.4 1 8 2.3 8zm4.8 144h185.7c3.9 0 7.1-3.6 7.1-8v-48c0-4.4-3.2-8-7.1-8H615.1c-3.9 0-7.1 3.6-7.1 8v48c0 4.4 3.2 8 7.1 8zM224 673h43.9c4.2 0 7.6-3.3 7.9-7.5 3.8-50.5 46-90.5 97.2-90.5s93.4 40 97.2 90.5c.3 4.2 3.7 7.5 7.9 7.5H522a8 8 0 008-8.4c-2.8-53.3-32-99.7-74.6-126.1a111.8 111.8 0 0029.1-75.5c0-61.9-49.9-112-111.4-112s-111.4 50.1-111.4 112c0 29.1 11 55.5 29.1 75.5a158.09 158.09 0 00-74.6 126.1c-.4 4.6 3.2 8.4 7.8 8.4zm149-262c28.5 0 51.7 23.3 51.7 52s-23.2 52-51.7 52-51.7-23.3-51.7-52 23.2-52 51.7-52z"}}]},name:"idcard",theme:"outlined"};var r=a(4790),o=function(e,t){return i.createElement(r.Z,(0,s.Z)({},e,{ref:t,icon:n}))};const c=i.forwardRef(o)},9197:(e,t,a)=>{a.d(t,{Z:()=>c});var s=a(7460),i=a(2791);const n={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M928 160H96c-17.7 0-32 14.3-32 32v640c0 17.7 14.3 32 32 32h832c17.7 0 32-14.3 32-32V192c0-17.7-14.3-32-32-32zm-40 208H676V232h212v136zm0 224H676V432h212v160zM412 432h200v160H412V432zm200-64H412V232h200v136zm-476 64h212v160H136V432zm0-200h212v136H136V232zm0 424h212v136H136V656zm276 0h200v136H412V656zm476 136H676V656h212v136z"}}]},name:"table",theme:"outlined"};var r=a(4790),o=function(e,t){return i.createElement(r.Z,(0,s.Z)({},e,{ref:t,icon:n}))};const c=i.forwardRef(o)},914:(e,t,a)=>{a.d(t,{Z:()=>s});const s=a(9752).Z},6106:(e,t,a)=>{a.d(t,{Z:()=>s});const s=a(7545).Z},4421:(e,t,a)=>{a.d(t,{Z:()=>i});var s=a(2791);function i(e){var t=(0,s.useRef)();return(0,s.useEffect)((function(){t.current=e})),t.current}}}]);
//# sourceMappingURL=ItemsGroups.4ed0157a.chunk.js.map