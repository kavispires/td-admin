"use strict";(self.webpackChunktd_admin=self.webpackChunktd_admin||[]).push([[5404],{8158:(e,t,s)=>{s.d(t,{CQ:()=>g,bN:()=>p,cw:()=>x,hW:()=>h,xL:()=>m});var i=s(7515),a=s(9475),r=s(1310),n=s(2997),l=s(8955),o=s(5458),u=s(7134),d=s(1087),c=s(184);function m(e){let{item:t,width:s,className:i}=e;return(0,c.jsx)(n.ck,{id:t.id,width:s,title:"".concat(t.name.en," | ").concat(t.name.pt),className:i})}function p(e){let{item:t}=e;const s=(0,u._)();return(0,c.jsx)("span",{children:(0,c.jsx)(i.Z,{prefix:t.nsfw?(0,c.jsx)(l.Z,{style:{color:"hotPink"}}):(0,c.jsx)(o.Z,{}),placeholder:"Id",variant:"borderless",size:"small",value:t.id,readOnly:!0,style:{width:"8ch"},onClick:()=>s(t.id)})})}function g(e){let{item:t,language:s}=e;return(0,c.jsx)(i.Z,{prefix:(0,c.jsx)(r.H,{language:s,width:"1em"}),placeholder:"Name in ".concat(s.toUpperCase()),variant:"borderless",size:"small",value:t.name[s],readOnly:!0})}function h(e){let{item:t}=e;return t.nsfw?(0,c.jsx)(l.Z,{style:{color:"hotpink"}}):(0,c.jsx)(c.Fragment,{})}function x(e){let{item:t}=e;const[,s]=(0,d.lr)();return(0,c.jsx)("span",{children:(0,c.jsx)(a.ZP,{size:"small",shape:"round",onClick:()=>{s({itemId:t.id,view:"classifier"})},children:"Go to"})})}},3945:(e,t,s)=>{s.r(t),s.d(t,{default:()=>it});var i=s(1790),a=s(2128),r=s(4520),n=s(7128),l=s(8357),o=s(7018),u=s(7340),d=s(7965),c=s(1413),m=s(4747),p=s(763),g=s(2791),h=s(5850),x=s(3713),b=s(8027),j=s(5529),v=s(2233);const y={};var Z=s(184);const f=(0,g.createContext)({getItem:()=>(0,h.VL)(),getItemAttributeValues:()=>(0,h.dK)(),isLoading:!0,error:null,hasResponseData:!1,isDirty:!1,jumpToItem:()=>{},activeItem:(0,h.VL)(),itemAttributeValues:(0,h.dK)(),onAttributeChange:()=>{},isSaving:!1,save:()=>{},attributesList:[],availableItemIds:[],addAttributesToUpdate:()=>{},addMultipleAttributesToUpdate:()=>{},prepareItemsAttributesFileForDownload:()=>({}),attributes:{},attributesToUpdate:{}}),I=e=>{let{children:t}=e;const{getItem:s,getItemAttributeValues:i,availableItemIds:a,isLoading:r,error:n,isSaving:l,save:o,addAttributesToUpdate:u,isDirty:d,attributes:I,addMultipleAttributesToUpdate:N,attributesToUpdate:C}=function(){var e;const{notification:t,message:s}=m.Z.useApp(),i=(0,x.NL)(),a=(0,j.N)("items"),r=(0,j.N)("items-attributes"),n=(0,j.N)("items-attribute-values"),l=(0,b.X)("tdr","itemsAttributeValues",{select:h.d_}),[o,u]=(0,g.useState)({}),d=(0,v.B)("tdr","itemsAttributeValues",{onSuccess:()=>{t.success({message:"itemsAttributeValues updated"}),i.refetchQueries({queryKey:["firebase","tdr","itemsAttributeValues"]}),u({})},onError:e=>{t.error({message:"itemsAttributeValues update failed",description:e.message})}}),Z=(0,g.useMemo)((()=>{var e,t;return(0,c.Z)((0,c.Z)({},null!==(e=n.data)&&void 0!==e?e:{}),null!==(t=l.data)&&void 0!==t?t:{})}),[n.data,l.data]),f=!(0,p.isEmpty)(o),I=l.data;return{availableItemIds:(0,g.useMemo)((()=>{var e;const t=null!==(e=a.data)&&void 0!==e?e:{};return(0,p.orderBy)(Object.keys(t).filter((e=>{var s,i;return(null!==(s=null===(i=t[e])||void 0===i?void 0:i.decks)&&void 0!==s?s:[]).includes("alien")})),(e=>Number(e)),"asc")}),[a.data]),getItem:e=>{var t;return null!==(t=a.data)&&void 0!==t&&t[e]?a.data[e]:(e&&s.info("Item ".concat(e," not found in TDR. Creating a new item...")),(0,h.VL)({id:e}))},getItemAttributeValues:e=>{var t,s,i;const a=null!==(t=null===Z||void 0===Z?void 0:Z[e])&&void 0!==t?t:{},r=null!==(s=o[e])&&void 0!==s?s:{};return(0,p.isEmpty)(a)&&(0,p.isEmpty)(r)?(y[e]=(0,h.dK)({id:e}),y[e]):(0,p.merge)(null!==(i=null===y||void 0===y?void 0:y[e])&&void 0!==i?i:{},a,r)},attributes:null!==(e=r.data)&&void 0!==e?e:{},isLoading:a.isLoading||r.isLoading||n.isLoading||l.isLoading,error:a.error||r.error||n.error||l.error,firebaseData:I,isSaving:d.isPending,save:()=>{d.mutate((0,h.aS)((0,c.Z)((0,c.Z)({},I),o)))},addAttributesToUpdate:(e,t)=>{u((s=>(0,c.Z)((0,c.Z)({},s),{},{[e]:(0,c.Z)((0,c.Z)({},t),{},{updatedAt:Date.now()})})))},addMultipleAttributesToUpdate:e=>{u((t=>(0,c.Z)((0,c.Z)({},t),(0,p.mapKeys)(e.map((e=>(0,c.Z)((0,c.Z)({},e),{},{updatedAt:Date.now()}))),"id"))))},attributesToUpdate:o,isDirty:f}}(),{message:P}=m.Z.useApp(),[w,S]=(0,g.useState)((0,p.random)(0,a.length-1)),T=s(a[w]),E=i(T.id),A=(0,g.useMemo)((()=>(0,p.orderBy)(Object.values(I),"name.en","asc")),[I]);return(0,Z.jsx)(f.Provider,{value:{getItem:s,getItemAttributeValues:i,availableItemIds:a,isLoading:r,error:n,hasResponseData:a.length>0&&!(0,p.isEmpty)(I),isDirty:d,itemAttributeValues:E,jumpToItem:(e,t)=>{if("next"!==e)if("previous"!==e)if("random"!==e)if("first"!==e)if("last"!==e)if("next10"!==e)if("previous10"!==e)if("incomplete"!==e){if("goTo"===e&&void 0!==t){const e=a.indexOf(t);if(-1!==e)return void S(e);P.error("Item ".concat(t," is not available for attribution."))}}else S((e=>{let t=e+1;for(;t<a.length;){const s=i(a[t]);if(Object.keys(s.attributes).length!==A.length)return t;if(t===a.length-1)return P.info("No more incomplete items found."),e;t++}return e}));else S((e=>(e-10+a.length)%a.length));else S((e=>(e+10)%a.length));else S(a.length-1);else S(0);else S((0,p.random)(0,a.length-1));else S((e=>(e-1+a.length)%a.length));else S((e=>(e+1)%a.length))},activeItem:T,onAttributeChange:(e,t)=>{u(T.id,(0,c.Z)((0,c.Z)({},E),{},{attributes:(0,c.Z)((0,c.Z)({},E.attributes),{},{[e]:t})}))},isSaving:l,save:o,attributes:I,attributesList:A,addAttributesToUpdate:u,addMultipleAttributesToUpdate:N,prepareItemsAttributesFileForDownload:()=>(0,h.Tj)(a.reduce(((e,t)=>{const s=i(t);return(0,p.isEmpty)(s.attributes)||(Object.keys(s.attributes).length===A.length?s.complete=!0:delete s.complete,e[s.id]=s),e}),{})),attributesToUpdate:C},children:t})},N=()=>(0,g.useContext)(f);var C=s(1087);function P(){var e;const[t,s]=(0,C.lr)();return{view:null!==(e=t.get("view"))&&void 0!==e?e:"classifier",setView:e=>s({view:e}),addQueryParam:(e,i)=>{t.set(e,"".concat(i)),s(t)},removeQueryParam:e=>{t.delete(e),s(t)},searchParams:t}}var w=s(6591),S=s(4925),T=s(6178),E=s(9475),A=s(952);function k(e){let{label:t,children:s}=e;return(0,Z.jsxs)(T.Z.Text,{children:[t," ",(0,Z.jsx)(A.Z,{children:s})]})}const L=["id","name"];function D(){const{getItemAttributeValues:e,availableItemIds:t,attributesList:s}=N(),{total:i,complete:a,completionPercentage:l,hasDataCount:o,initiatedPercentage:u,progress:d,progressTotal:c,currentProgress:m}=(0,g.useMemo)((()=>{const i=t.length;let a=0,r=0,n=0;t.map((t=>e(t))).forEach((e=>{let{attributes:t}=e;(0,p.isEmpty)(t)||(a+=1),Object.values(t).length===s.length&&(r+=1),n+=Object.values(t).length}));const l=Object.values(s).length*t.length;return{total:i,complete:r,completionPercentage:i>0?(r/i*100).toFixed(1):0,hasDataCount:a,initiatedPercentage:i>0?Math.floor(a/i*100):0,progress:(n/l*100).toFixed(1),currentProgress:n,progressTotal:l}}),[s,t,e]);return(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsxs)(r.Z,{vertical:!0,children:[(0,Z.jsx)(T.Z.Text,{strong:!0,className:"mb-2",children:"Items Stats"}),(0,Z.jsx)(k,{label:"Total",children:i}),(0,Z.jsxs)(k,{label:"Complete",children:[a," (",l,"%)"]}),(0,Z.jsxs)(k,{label:"Initiated",children:[o," (",u,"%)"]}),(0,Z.jsx)(T.Z.Text,{strong:!0,className:"mt-4 mb-2",children:"Attributes Stats"}),(0,Z.jsx)(k,{label:"Total",children:c}),(0,Z.jsx)(k,{label:"Set",children:m}),(0,Z.jsxs)(k,{label:"Progress",children:[d,"%"]})]}),(0,Z.jsx)(n.Z,{})]})}function U(){const{jumpToItem:e}=N(),{searchParams:t,addQueryParam:s}=P();return(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsx)(E.ZP,{block:!0,onClick:()=>e("random"),type:"primary",children:"Random Item"}),(0,Z.jsx)(l.Do,{label:"Unset Only",value:"unset"===t.get("scope"),onChange:e=>s("scope",e?"unset":""),className:"mt-4"})]})}function M(){const{searchParams:e,addQueryParam:t}=P(),{attributesList:s}=N(),i=(0,g.useMemo)((()=>[{label:"Random Attribute",value:"random"},...s.map((e=>{let{id:t,name:s}=e;return{label:s.en,value:t}}))]),[s]);return(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsx)(l.zE,{label:"Sampler Attribute",value:e.get("attribute")||"random",onChange:e=>t("attribute",e),options:i}),(0,Z.jsx)(l.xh,{label:"Sample Size",value:Number(e.get("size")||9),onChange:e=>t("size",String(e)),min:3,max:21,step:3})]})}function z(){const{searchParams:e,addQueryParam:t}=P(),{attributesList:s}=N(),i=(0,g.useMemo)((()=>s.map((e=>{let{id:t,name:s}=e,i=(0,S.Z)(e,L);return{label:"".concat(s.en).concat(i.default?"*":""),value:t}}))),[s]);return(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsx)(l.zE,{label:"Attribute",value:e.get("attribute")||"ali",onChange:e=>t("attribute",e),options:i}),(0,Z.jsx)(l.zE,{label:"Scope",value:e.get("scope")||"unset",onChange:e=>t("scope",e),options:[{value:"unset",label:"Unset"},...w.Ud]}),(0,Z.jsx)(l.zE,{label:"Results per page",value:e.get("pageSize")||12,onChange:e=>t("pageSize",e),options:[12,24,48,96]})]})}function O(){const{searchParams:e,addQueryParam:t}=P();return(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsx)(l.Do,{label:"Only Complete",value:"true"===e.get("showComplete"),onChange:e=>t("showComplete",e?"true":""),className:"full-width m-0"}),(0,Z.jsx)(l.Do,{label:"Show Unrelated",value:"true"===e.get("showUnrelated"),onChange:e=>t("showUnrelated",e?"true":""),className:"full-width m-0"}),(0,Z.jsx)(l.Do,{label:"Show Unclear",value:"true"===e.get("showUnclear"),onChange:e=>t("showUnclear",e?"true":""),className:"full-width m-0"})]})}function F(){const{searchParams:e,addQueryParam:t}=P();return(0,Z.jsx)(Z.Fragment,{children:(0,Z.jsx)(l.Do,{label:"Show Glyphs",value:"true"===e.get("showGlyphs"),onChange:e=>t("showGlyphs",e?"true":""),className:"full-width m-0"})})}function V(){const{isDirty:e,save:t,prepareItemsAttributesFileForDownload:s,attributes:i,isSaving:a,attributesToUpdate:c}=N(),{view:m,setView:p}=P();return(0,Z.jsxs)(d.Pd,{children:[(0,Z.jsxs)(r.Z,{vertical:!0,gap:12,children:[(0,Z.jsx)(u.k,{isDirty:e,onSave:t,isSaving:a,dirt:JSON.stringify(c)}),(0,Z.jsx)(o.o,{data:()=>function(e,t){const s=Object.keys(t).length;return Object.keys(e).forEach((i=>{const a=e[i],r=Object.keys(a.attributes).length;if(r===s){a.complete=!0;let e=0;a.score=Object.values(a.attributes).reduce(((t,s)=>s<=0?(s===w.NL.UNCLEAR&&(e+=1),s===w.NL.OPPOSITE&&(t+=s/2),t):t+s),0),a.reliability=Math.floor((r-e)/s*100),a.key=(0,h.Mg)(a,t,!0).join("")}else a.complete=void 0,a.score=void 0,a.reliability=void 0,a.key=void 0})),(0,h.Tj)((0,h.ET)(e))}(s(),i),fileName:"items-attribute-values.json",disabled:e,block:!0})]}),(0,Z.jsx)(n.Z,{}),(0,Z.jsx)(D,{}),(0,Z.jsx)(l.zE,{label:"View",value:m,onChange:p,options:["classifier","sampler","grouping","comparator","simulator","stats"]}),(0,Z.jsx)(n.Z,{}),"classifier"===m&&(0,Z.jsx)(U,{}),"sampler"===m&&(0,Z.jsx)(M,{}),"grouping"===m&&(0,Z.jsx)(z,{}),"comparator"===m&&(0,Z.jsx)(O,{}),"stats"===m&&(0,Z.jsx)(F,{})]})}var R=s(4664),Q=s(9416),G=s(263);function B(e){const[t,s]=(0,g.useState)(!1),i=()=>{s(window.scrollY>300)};return(0,G.Z)((()=>(window.addEventListener("scroll",i),()=>{window.removeEventListener("scroll",i)}))),(0,Z.jsx)(E.ZP,(0,c.Z)((0,c.Z)({className:"go-to-top-button ".concat(t?"visible":""),onClick:()=>{window.scrollTo({top:0,behavior:"smooth"})},icon:(0,Z.jsx)(Q.Z,{})},e),{},{children:"Go to Top"}))}var _=s(6473),K=s(7305),q=s(1046),$=s(8158),W=s(4424),X=s(7557),J=s(8624),Y=s(1431);function H(e){let{title:t,icon:s}=e;return(0,Z.jsx)(Y.Z,{title:t,children:null!==s&&void 0!==s?s:(0,Z.jsx)(J.Z,{})})}const ee=[{label:"Opposite",value:w.NL.OPPOSITE},{label:"Unrelated",value:w.NL.UNRELATED},{label:"Unclear",value:w.NL.UNCLEAR},{label:"Related",value:w.NL.RELATED},{label:"Deterministic",value:w.NL.DETERMINISTIC}],te=[{label:"Opposite",value:w.NL.OPPOSITE},{label:"Unrelated",value:w.NL.UNRELATED},{label:"Unclear",value:w.NL.UNCLEAR},{label:"Related",value:w.NL.RELATED},{label:"Deterministic",value:w.NL.DETERMINISTIC,disabled:!0}];function se(e){let{attribute:t,value:s,onChange:i,onlyButtons:a,size:r}=e;return t?a?(0,Z.jsx)(W.ZP.Group,{options:t.limited?te:ee,onChange:e=>{let{target:{value:s}}=e;return i(t.id,s)},value:s,optionType:"button",buttonStyle:"solid",size:r}):(0,Z.jsxs)("div",{className:"attribute-button-container__row",children:[(0,Z.jsxs)("span",{className:"attribute-button-container__label",children:[t.name.en," ",(0,Z.jsx)(H,{title:t.description.en})]}),(0,Z.jsx)(W.ZP.Group,{options:t.limited?te:ee,onChange:e=>{let{target:{value:s}}=e;return i(t.id,s)},value:s,optionType:"button",buttonStyle:"solid",size:r}),(0,Z.jsx)("span",{children:(0,Z.jsx)(X.Z,{style:{color:s&&s>7?"green":"transparent"}})})]},t.id):(0,Z.jsx)(Z.Fragment,{})}var ie=s(3733),ae=s(2997);function re(e){let{itemAttributeValues:t,attributes:s}=e;const{searchParams:i,addQueryParam:a}=P(),n="true"===i.get("showUnclear"),o="true"===i.get("showUnrelated"),u=(0,g.useMemo)((()=>(0,h.tt)((0,h.Mg)(t,s),n,o)),[t,s,n,o]),d="true"===i.get("signs")?ne:le;return(0,Z.jsxs)(r.Z,{gap:6,vertical:!0,children:[(0,Z.jsx)(l.Do,{label:"Show Unrelated",value:"true"===i.get("showUnrelated"),onChange:e=>a("showUnrelated",e?"true":""),className:"full-width m-0"}),(0,Z.jsx)(l.Do,{label:"Show Unclear",value:"true"===i.get("showUnclear"),onChange:e=>a("showUnclear",e?"true":""),className:"full-width m-0"}),(0,Z.jsx)(l.Do,{label:"Alien Sings",value:"true"===i.get("signs"),onChange:e=>a("signs",e?"true":""),className:"full-width m-0"}),(0,Z.jsx)(r.Z,{gap:6,wrap:"wrap",className:"item-attribute-value-statement",children:u.map(((e,t,i)=>(0,Z.jsx)(d,{keyVariant:e,attributes:s,firstElement:0===t,lastElement:t===i.length-1},e)))})]})}function ne(e){let{keyVariant:t,attributes:s,withText:i}=e;const{key:a,className:n,text:l}=(0,h.sB)(t);return(0,Z.jsxs)(r.Z,{vertical:!0,align:"center",children:[(0,Z.jsx)(ae.o$,{width:50,id:s[a].spriteId,className:(0,ie.Z)("item-attribute-alien-sign","item-attribute-alien-sign--".concat(n))}),i&&(0,Z.jsxs)(r.Z,{wrap:"wrap",justify:"center",align:"center",style:{maxWidth:50,textAlign:"center",wordBreak:"break-word"},children:[l," ",s[a].name.en.toLowerCase()]})]})}function le(e){let{keyVariant:t,attributes:s,firstElement:i,lastElement:a}=e;const{key:r,text:n}=(0,h.sB)(t),l=i?"It's ":"",o=a?".":", ";return(0,Z.jsxs)(Z.Fragment,{children:[l,n," ",s[r].name.en.toLowerCase(),o]})}var oe=s(1532),ue=s(4587);function de(e){let{attributesList:t,itemAttributeValues:s}=e;const{completion:i,isDeterministic:a,value:n,isOpposing:l,relevancy:o}=(0,g.useMemo)((()=>{const e=t.length,i=Object.keys(s.attributes).length,a=Math.floor(i/e*100);let r=!1,n=!1,l=0;const o=Object.values(s.attributes).reduce(((e,t)=>t<=0?(t===w.NL.UNCLEAR&&(l+=1),t===w.NL.OPPOSITE&&(n=!0,e+=t/2),e):(t===w.NL.DETERMINISTIC&&(r=!0),e+t)),0),u=Math.floor((i-l)/e*100);return{completion:a,isDeterministic:r,value:o,isOpposing:n,relevancy:u}}),[t,s.attributes]);return(0,Z.jsxs)("div",{children:[(0,Z.jsx)(T.Z.Text,{strong:!0,children:"Completion"}),(0,Z.jsx)(ue.Z,{percent:i,size:"small"}),(0,Z.jsx)(T.Z.Text,{strong:!0,children:"Stats"}),(0,Z.jsxs)(r.Z,{vertical:!0,children:[(0,Z.jsx)(k,{label:"Deterministic",children:a?(0,Z.jsx)(X.Z,{style:{color:"green"}}):(0,Z.jsx)(oe.Z,{style:{color:"red"}})}),(0,Z.jsx)(k,{label:"Opposing",children:l?(0,Z.jsx)(X.Z,{style:{color:"CornflowerBlue"}}):(0,Z.jsx)(oe.Z,{style:{color:"grey"}})}),(0,Z.jsx)(k,{label:"Value",children:n}),(0,Z.jsx)(Y.Z,{title:"The percentage of conclusive attributes (not unclear)",children:(0,Z.jsxs)(k,{label:"Reliability",children:[o,"%"]})})]})]})}function ce(){const{activeItem:e,attributesList:t,itemAttributeValues:s,onAttributeChange:i,jumpToItem:a,attributes:l}=N(),{searchParams:o,removeQueryParam:u}=P(),d=o.get("itemId");(0,g.useEffect)((()=>{d&&(u("itemId"),a("goTo",d))}),[d,a,u]);const c="unset"===o.get("scope"),m=(0,g.useMemo)((()=>c?t.filter((e=>!s.attributes[e.id])):t),[c,e.id]);return e?(0,Z.jsx)(_.Z,{children:(0,Z.jsxs)("div",{className:"item-attribution-card",children:[(0,Z.jsx)(K.Z,{offsetTop:120,className:"item-attribution-card__item",children:(0,Z.jsxs)(r.Z,{vertical:!0,gap:6,children:[(0,Z.jsx)($.xL,{item:e,width:150}),(0,Z.jsx)($.bN,{item:e}),(0,Z.jsx)($.CQ,{item:e,language:"en"}),(0,Z.jsx)($.CQ,{item:e,language:"pt"}),(0,Z.jsx)(n.Z,{className:"my-2"}),(0,Z.jsx)(de,{attributesList:t,itemAttributeValues:s}),(0,Z.jsx)(n.Z,{className:"my-2"}),(0,Z.jsx)(T.Z.Text,{type:"secondary",children:(0,Z.jsx)(re,{itemAttributeValues:s,attributes:l})})]})}),(0,Z.jsx)(q.Z,{size:"small",direction:"vertical",className:"my-4 attribute-button-container",wrap:!0,children:m.map((e=>(0,Z.jsx)(se,{attribute:e,value:s.attributes[e.id],onChange:i},e.id)))})]},"".concat(e.id))}):(0,Z.jsx)(_.Z,{children:(0,Z.jsxs)(T.Z.Text,{type:"secondary",children:["No item selected."," ",(0,Z.jsx)(E.ZP,{size:"small",type:"primary",onClick:()=>a("random"),children:"Random Item"})]})})}var me=s(9228),pe=s(9515),ge=s(9617),he=s(6864),xe=s(1938),be=s(5542),je=s(6588),ve=s(8178);function ye(){const{jumpToItem:e}=N();return(0,Z.jsxs)(E.ZP.Group,{className:"my-4",children:[(0,Z.jsx)(E.ZP,{onClick:()=>e("first"),icon:(0,Z.jsx)(pe.Z,{}),children:"First"}),(0,Z.jsx)(E.ZP,{onClick:()=>e("previous10"),icon:(0,Z.jsx)(ge.Z,{}),children:"Previous 10"}),(0,Z.jsx)(E.ZP,{onClick:()=>e("previous"),icon:(0,Z.jsx)(he.Z,{}),children:"Previous"}),(0,Z.jsxs)(E.ZP,{onClick:()=>e("next"),children:["Next ",(0,Z.jsx)(xe.Z,{})]}),(0,Z.jsxs)(E.ZP,{onClick:()=>e("next10"),children:["Next 10 ",(0,Z.jsx)(be.Z,{})]}),(0,Z.jsxs)(E.ZP,{onClick:()=>e("last"),children:["Last ",(0,Z.jsx)(je.Z,{})]}),(0,Z.jsx)(me.Z,{content:(0,Z.jsx)(Ze,{}),title:"Title",children:(0,Z.jsx)(E.ZP,{children:"Go To"})}),(0,Z.jsx)(E.ZP,{onClick:()=>e("incomplete"),children:"Next Incomplete"})]})}function Ze(){const{jumpToItem:e}=N();return(0,Z.jsx)(ve.i,{isPending:!1,onFinish:t=>e("goTo",t)})}var fe=s(2786);function Ie(){const{attributes:e}=N(),{itemMessages:t,grouping:s}=function(){const{attributes:e,getItemAttributeValues:t,availableItemIds:s,getItem:i,isLoading:a}=N(),{searchParams:r}=P(),n="true"===r.get("showComplete"),l="true"===r.get("showUnclear"),o="true"===r.get("showUnrelated"),{itemMessages:u,itemMessagesDict:d,grouping:c}=(0,g.useMemo)((()=>{if(a)return{itemMessages:[],itemMessagesDict:{},grouping:{}};const r=(0,p.orderBy)(s.map((s=>{const a=t(s),r=(0,h.Mg)(a,e);return{item:i(s),itemAttributesValues:a,message:(0,h.tt)(r,l,o),fullMessage:r}})).filter((e=>{let{itemAttributesValues:t}=e;return!n||t.complete})),["message"],["asc"]),u=r.reduce(((e,t)=>{let{message:s,item:{id:i}}=t;const a=s.join(" ");return void 0===e[a]&&(e[a]=[]),e[a].push(i),e}),{}),d=Object.values(u).filter((e=>e.length>1));return d.length>0&&console.log("More than one",d),{itemMessages:r,itemMessagesDict:(0,p.keyBy)(r,"item.id"),grouping:u}}),[e,s,t,i,a,n,l,o]);return{itemMessages:u,itemMessagesDict:d,grouping:c}}(),i=[{title:"Item Id",dataIndex:"item",key:"id",render:e=>(0,Z.jsxs)("div",{children:[(0,Z.jsx)($.bN,{item:e}),(0,Z.jsx)($.cw,{item:e})]}),sorter:(e,t)=>Number(e.item.id)-Number(t.item.id)},{title:"Sprite",dataIndex:"item",key:"sprite",render:e=>(0,Z.jsx)($.xL,{item:e,width:75})},{title:"Name",dataIndex:"item",key:"name",render:e=>(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsx)($.CQ,{item:e,language:"en"}),(0,Z.jsx)($.CQ,{item:e,language:"pt"})]}),sorter:(e,t)=>e.item.name.en.localeCompare(t.item.name.en)},{title:"Address",dataIndex:"message",key:"message",render:(t,s)=>{let{item:i}=s;return(0,Z.jsx)(r.Z,{gap:6,children:t.map(((t,s,a)=>(0,Z.jsx)(ne,{keyVariant:t,attributes:e,firstElement:0===s,lastElement:s===a.length-1,withText:!0},"".concat(t,"-").concat(i.id))))})},sorter:(e,t)=>e.message.join(" ").localeCompare(t.message.join(" "))},{title:"Complete",dataIndex:"itemAttributesValues",key:"complete",render:e=>e.complete?"Yes":"No"},{title:"Identical",dataIndex:"message",key:"identical",render:e=>{var t;const i=null!==(t=s[e.join(" ")])&&void 0!==t?t:[];return(0,Z.jsx)(Z.Fragment,{children:i.length>1?i.length:"0"})},sorter:(e,t)=>{var i,a;const r=null!==(i=s[e.message.join(" ")])&&void 0!==i?i:[];return(null!==(a=s[t.message.join(" ")])&&void 0!==a?a:[]).length-r.length}}];return(0,Z.jsxs)("div",{className:"my-4",children:[(0,Z.jsx)(T.Z.Title,{level:5,children:"Item Comparator"}),(0,Z.jsx)(fe.Z,{dataSource:t,columns:i,pagination:{showQuickJumper:!0}})]})}var Ne=s(2658),Ce=s(906),Pe=s(1082);var we=s(1503),Se=s(3320),Te=s(5922);function Ee(){const{searchParams:e,removeQueryParam:t}=P(),s=e.get("drawer"),[i,a]=(0,g.useState)(!1),{activeItem:l,attributesList:o,itemAttributeValues:u,onAttributeChange:d,jumpToItem:c}=N();(0,g.useEffect)((()=>{s&&c("goTo",s)}),[s,c,t]);const m=(0,g.useMemo)((()=>i?o.filter((e=>!u.attributes[e.id])):o),[i,l.id]);return(0,Z.jsxs)(Se.Z,{open:!!s,title:"Edit: ".concat(l.name.en),onClose:()=>{t("drawer")},width:"640px",children:[(0,Z.jsxs)(r.Z,{gap:6,children:[(0,Z.jsxs)(r.Z,{vertical:!0,gap:6,children:[(0,Z.jsx)($.xL,{item:l,width:50}),(0,Z.jsx)($.bN,{item:l})]}),(0,Z.jsxs)(r.Z,{vertical:!0,gap:6,children:[(0,Z.jsx)($.CQ,{item:l,language:"en"}),(0,Z.jsx)($.CQ,{item:l,language:"pt"})]}),(0,Z.jsx)(r.Z,{vertical:!0,gap:6,children:(0,Z.jsx)(Te.Z,{checked:i,onChange:a,checkedChildren:"Unset",unCheckedChildren:"All"})})]}),(0,Z.jsx)(n.Z,{className:"my-1"}),(0,Z.jsx)(q.Z,{size:"small",direction:"vertical",className:"my-4 attribute-button-container",wrap:!0,children:m.map((e=>(0,Z.jsx)(se,{size:"small",attribute:e,value:u.attributes[e.id],onChange:d},e.id)))})]})}const Ae=(e,t)=>"unset"!==t&&t?"".concat(e.percent,"%  - ").concat(e.group," items"):"".concat(100-e.percent,"% done, ").concat(e.group," left");function ke(){const{getItem:e,getItemAttributeValues:t,attributesList:s}=N(),{attribute:i,pageIds:a,updateAttributeValue:n,updatePageItemsAsUnrelated:l,pagination:o,stats:u,sorting:d}=function(){var e,t,s,i;const{attributesList:a,addAttributesToUpdate:r,getItemAttributeValues:n,availableItemIds:l,addMultipleAttributesToUpdate:o}=N(),{searchParams:u,addQueryParam:d}=P(),m=null!==(e=u.get("attribute"))&&void 0!==e?e:"ali",h=null!==(t=u.get("scope"))&&void 0!==t?t:"unset",x=null!==(s=u.get("page"))&&void 0!==s?s:"1",b=null!==(i=u.get("pageSize"))&&void 0!==i?i:"12",[j,v]=(0,g.useState)("ali"),[y,Z]=(0,g.useState)("unset"),[f,I]=(0,g.useState)(null),[C,S]=(0,g.useState)("desc"),T=(0,g.useMemo)((()=>{const e=l.map((e=>n(e))),t="unset"===h?void 0:w.NL[h.toUpperCase()],s=e.filter((e=>{var s;return(null===(s=e.attributes)||void 0===s?void 0:s[m])===t})).map((e=>e.id)),[i,a]=(null!==f&&void 0!==f?f:"::").split("::");return(0,p.orderBy)(s,[e=>{var t,s;return"attribute"!==i||(null===(t=n(e))||void 0===t||null===(s=t.attributes)||void 0===s?void 0:s[a])},e=>"prop"!==i||Number(e),e=>{var t;return null===(t=n(e))||void 0===t?void 0:t.updatedAt},e=>Number(e)],[C,"asc","desc","asc"])}),[m,h,f,C]),E=(0,g.useMemo)((()=>{if(j!==m||y!==h)return v(m),Z(h),d("page","1"),T.slice(0,Number(b));const e=(Number(x)-1)*Number(b),t=e+Number(b);return T.slice(e,t)}),[x,b,T]),A=a.find((e=>e.id===m));return{group:T,stats:{total:l.length,group:T.length,percent:Math.round(T.length/l.length*100)},pageIds:E,attribute:A,updateAttributeValue:(e,t,s)=>{const i=n(e);r(e,(0,c.Z)((0,c.Z)({},i),{},{attributes:(0,c.Z)((0,c.Z)({},i.attributes),{},{[t]:s})}))},updatePageItemsAsUnrelated:()=>{o(E.map((e=>{const t=n(e);return t.attributes[m]||(t.attributes[m]=w.NL.UNRELATED),t})))},sorting:{sortBy:f,setSortBy:I,sortOrder:C,setSortOrder:S},pagination:{total:T.length,current:Number(x),pageSize:Number(b),onChange:e=>d("page",String(e)),onShowSizeChange:(e,t)=>d("pageSize",String(t)),pageSizeOptions:[12,24,48,96]}}}(),{searchParams:m,addQueryParam:h}=P(),x=(0,we.Z)("(max-width: 1024px)");if((0,p.isEmpty)(i))return(0,Z.jsx)(_.Z,{className:"my-4",children:(0,Z.jsx)(T.Z.Text,{type:"secondary",children:"No group attribute has been selected."})});const b=(0,Z.jsx)(Ne.Z,{onChange:o.onChange,current:o.current,total:o.total,pageSizeOptions:o.pageSizeOptions,pageSize:o.pageSize,onShowSizeChange:o.onShowSizeChange},"pagination"),j=(0,Z.jsxs)(r.Z,{align:"center",children:[(0,Z.jsx)(T.Z.Text,{className:"mr-2",children:"Sort by"}),(0,Z.jsxs)(Ce.Z,{style:{width:120},value:d.sortBy,onChange:e=>d.setSortBy(e),children:[(0,Z.jsx)(Ce.Z.Option,{value:null,children:"Last Updated"}),(0,Z.jsx)(Ce.Z.Option,{value:"prop::id",children:"Id"}),s.map((e=>(0,Z.jsx)(Ce.Z.Option,{value:"attribute::".concat(e.id),children:e.name.en},e.id)))]})]}),v=("unset"===m.get("scope")||!m.get("scope"))&&(0,Z.jsx)(Pe.Z,{title:"Are you sure everything is unrelated to ".concat(i.name.en,"?"),onConfirm:l,children:(0,Z.jsx)(E.ZP,{type:"primary",danger:!0,disabled:0===a.length,children:"Unrelate Unset Items on Page"})},"unrelate-button");return(0,Z.jsxs)(_.Z,{className:"my-4",title:(0,Z.jsxs)(T.Z.Text,{children:[null===i||void 0===i?void 0:i.name.en," (",Ae(u,m.get("scope")),") -"," ",i.description.en]}),extra:(0,Z.jsxs)(r.Z,{align:"center",children:[j,b]}),actions:[v,(0,Z.jsx)(B,{},"go-to-top"),b].filter(Boolean),children:[0===a.length&&(0,Z.jsx)(R.Z,{description:"No items found in this scope for this attribute.",image:R.Z.PRESENTED_IMAGE_SIMPLE}),a.map((s=>{const a=t(s),l=e(s);return(0,Z.jsx)(_.Z.Grid,{style:{width:x?"50%":"25%"},children:(0,Z.jsxs)(r.Z,{gap:6,children:[(0,Z.jsxs)(r.Z,{vertical:!0,gap:6,children:[(0,Z.jsx)($.xL,{item:l,width:75}),(0,Z.jsx)($.bN,{item:l}),(0,Z.jsxs)(E.ZP.Group,{children:[(0,Z.jsx)($.cw,{item:l}),(0,Z.jsx)(E.ZP,{size:"small",shape:"round",onClick:()=>h("drawer",l.id),children:"Drawer"})]}),(0,Z.jsx)($.CQ,{item:l,language:"en"}),(0,Z.jsx)($.CQ,{item:l,language:"pt"})]}),(0,Z.jsx)(se,{attribute:i,value:a.attributes[i.id],onlyButtons:!0,onChange:(e,t)=>n(l.id,e,t)})]})},"".concat(s,"-").concat(a.updatedAt))})),(0,Z.jsx)(Ee,{})]})}var Le=s(324);function De(){const{attributesList:e,availableItemIds:t,addAttributesToUpdate:s,getItemAttributeValues:i}=N(),{searchParams:a}=P(),[r,n]=(0,g.useState)([]),[l,o]=(0,g.useState)(),u=()=>{var s,r,n,l;const o=null!==(s=null!==(r=a.get("attribute"))&&void 0!==r?r:null===(n=(0,p.sample)(e))||void 0===n?void 0:n.id)&&void 0!==s?s:"ali",u=null!==(l=e.find((e=>e.id===o)))&&void 0!==l?l:(0,p.sample)(e),d=Number(a.get("size"))||9,c=[],m=(0,p.shuffle)(t);for(let e=0;e<m.length&&c.length!==d;e++){const t=m[e];i(t).attributes[o]||c.push(t)}return{selectedAttribute:u,selected:c}},d=(0,g.useMemo)((()=>l?t.filter((e=>!i(e).attributes[null===l||void 0===l?void 0:l.id])).length:0),[l,t]);return{sampleIds:r,attribute:l,itemsLeftForAttribute:d,onGetSample:()=>{let e=u(),t=0;for(;0===e.selected.length&&t<30;)e=u(),t++;o(e.selectedAttribute),n(e.selected)},updateAttributeValue:(e,t,a)=>{const r=i(e);s(e,(0,c.Z)((0,c.Z)({},r),{},{attributes:(0,c.Z)((0,c.Z)({},r.attributes),{},{[t]:a})}))}}}var Ue=s(2675);function Me(){const{getItem:e,getItemAttributeValues:t}=N(),{sampleIds:s,attribute:i,onGetSample:a,updateAttributeValue:l,itemsLeftForAttribute:o}=De();if((0,p.isEmpty)(s)&&(0,p.isEmpty)(i))return(0,Z.jsxs)(_.Z,{className:"my-4",children:[(0,Z.jsxs)(T.Z.Text,{type:"secondary",children:["No sample has been generated. Tweak options and"," ",(0,Z.jsx)(E.ZP,{size:"small",type:"primary",onClick:a,children:"Get Sample"})]}),(0,Z.jsx)(n.Z,{}),(0,Z.jsx)(ze,{})]});const u=s.map((s=>({itemAttributes:t(s),item:e(s)}))),d=u.filter((e=>{let{itemAttributes:t}=e;return(null===i||void 0===i?void 0:i.id)&&!t.attributes[i.id]}));return(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsx)(ze,{}),(0,Z.jsx)(_.Z,{className:"my-4",title:(0,Z.jsxs)(T.Z.Text,{children:[null===i||void 0===i?void 0:i.name.en," - ",null===i||void 0===i?void 0:i.description.en," (",o," items left)"]}),actions:[(0,Z.jsx)(E.ZP,{onClick:()=>{d.forEach((e=>{let{item:t}=e;null!==i&&void 0!==i&&i.id&&l(t.id,i.id,-3)}))},danger:!0,disabled:0===d.length,children:"Mark rest as unrelated"},"1"),(0,Z.jsx)(E.ZP,{type:"primary",ghost:!0,onClick:a,children:"Get New Sample"},"2")],extra:(0,Z.jsx)(E.ZP,{type:"primary",size:"small",onClick:a,children:"Get New Sample"}),children:(0,Z.jsxs)(r.Z,{vertical:!0,gap:6,children:[0===u.length&&(0,Z.jsx)(R.Z,{description:"No unset items found for this attribute.",image:R.Z.PRESENTED_IMAGE_SIMPLE}),u.map((e=>{let{item:t,itemAttributes:s}=e;return(0,Z.jsxs)(g.Fragment,{children:[(0,Z.jsxs)(r.Z,{gap:6,children:[(0,Z.jsx)($.xL,{item:t,width:75}),(0,Z.jsxs)(r.Z,{vertical:!0,gap:6,children:[(0,Z.jsxs)(r.Z,{gap:6,children:[(0,Z.jsx)($.bN,{item:t}),(0,Z.jsx)($.cw,{item:t})]}),(0,Z.jsx)($.CQ,{item:t,language:"en"}),(0,Z.jsx)($.CQ,{item:t,language:"pt"})]}),!!i&&(0,Z.jsx)(se,{attribute:i,value:s.attributes[i.id],onChange:(e,s)=>l(t.id,e,s)})]}),(0,Z.jsx)(n.Z,{className:"my-1"})]},"".concat(t.id,"-").concat(s.updatedAt))}))]})})]})}function ze(){const[e,t]=(0,Ue.Z)(!1),{addQueryParam:s,removeQueryParam:i}=P(),{sampleIds:a,attribute:n,onGetSample:l,updateAttributeValue:o}=De(),{getItem:u,getItemAttributeValues:d}=N(),c=()=>{i("size"),t(!1)},m=a[0],p=u(m),g=d(m);return(0,Z.jsxs)(r.Z,{className:"mt-4",children:[(0,Z.jsx)(E.ZP,{type:"primary",onClick:()=>{s("size","1"),t(!0),l()},children:"Single Sampler"}),(0,Z.jsxs)(Le.Z,{title:(0,Z.jsxs)(T.Z,{children:["Single Sampler: ",(0,Z.jsx)("strong",{children:null===n||void 0===n?void 0:n.name.en})]}),open:e,width:"100vw",maskClosable:!1,onOk:c,onClose:c,onCancel:c,cancelButtonProps:{style:{display:"none"}},children:[m&&p&&g&&n&&(0,Z.jsxs)(r.Z,{gap:6,className:"my-10",wrap:"wrap",children:[(0,Z.jsx)($.xL,{item:p,width:150}),(0,Z.jsxs)(r.Z,{vertical:!0,gap:6,children:[(0,Z.jsxs)(r.Z,{gap:6,children:[(0,Z.jsx)($.bN,{item:p}),(0,Z.jsx)($.cw,{item:p})]}),(0,Z.jsx)($.CQ,{item:p,language:"en"}),(0,Z.jsx)($.CQ,{item:p,language:"pt"})]}),!!n&&(0,Z.jsx)(se,{size:"large",attribute:n,value:g.attributes[n.id],onChange:async(e,t)=>{o(p.id,e,t),await(0,h.Dc)(500),l()}})]},m),(0,Z.jsx)(E.ZP,{onClick:l,children:"Another Sample"})]})]})}var Oe=s(7844),Fe=s(7974),Ve=s(3281),Re=s(3949),Qe=s(9793),Ge=s(9263);function Be(){const e=(0,j.N)("items-attributes"),t=(0,j.N)("items-attribute-values"),[s,i]=(0,g.useState)(null);return(0,Z.jsxs)("div",{className:"my-4",children:[(0,Z.jsx)(T.Z.Title,{level:3,children:"Daily Simulator"}),(0,Z.jsx)(T.Z.Paragraph,{children:"Generates a daily game for Alien Communication"}),(0,Z.jsxs)(q.Z,{children:[(0,Z.jsx)(E.ZP,{type:"primary",onClick:()=>{i(_e(e.data,t.data))},children:"Generate"}),(0,Z.jsx)(E.ZP,{onClick:()=>{const s={};let i=0;for(;i<300||15===(0,p.keys)(s).length;){const a=_e(e.data,t.data);if(a.valid&&!s[a.setId]&&(s[a.setId]=a),(0,p.keys)(s).length>=15)break;i+=1}console.log("TRIES",i),console.log(Object.values(s).map(((e,t)=>(0,c.Z)((0,c.Z)({},e),{},{number:e.number-t}))))},children:"Generate List"})]}),(0,Z.jsx)("div",{children:Boolean(s)&&(0,Z.jsxs)(q.Z,{direction:"vertical",children:[(0,Z.jsx)(T.Z.Title,{level:5,children:null===s||void 0===s?void 0:s.setId}),!(null!==s&&void 0!==s&&s.valid)&&(0,Z.jsx)(Ge.Z,{type:"error",message:"Invalid game"}),(0,Z.jsx)(q.Z,{direction:"vertical",children:null===s||void 0===s?void 0:s.attributes.map((e=>(0,Z.jsxs)(r.Z,{gap:8,children:[(0,Z.jsx)(ae.o$,{id:e.spriteId,width:50}),e.itemsIds.map((e=>(0,Z.jsx)(ae.ck,{id:e||"0",width:50},e)))]},e.id)))}),(0,Z.jsx)(n.Z,{className:"my-1"}),(0,Z.jsx)(q.Z,{direction:"horizontal",children:null===s||void 0===s?void 0:s.requests.map((e=>(0,Z.jsxs)(r.Z,{vertical:!0,children:[(0,Z.jsx)(ae.o$,{id:e.spritesIds[2],width:50}),(0,Z.jsx)(ae.o$,{id:e.spritesIds[1],width:50}),(0,Z.jsx)(ae.o$,{id:e.spritesIds[0],width:50})]},e.itemId)))}),(0,Z.jsx)(n.Z,{className:"my-1"}),(0,Z.jsx)(q.Z,{direction:"horizontal",children:null===s||void 0===s?void 0:s.itemsIds.map((e=>(0,Z.jsx)(ae.ck,{id:e||"0",width:50},e)))})]},null===s||void 0===s?void 0:s.setId)})]})}const _e=(e,t)=>{const s=(0,p.values)(e).filter((e=>!e.limited||"sol"===e.id)),i=(0,p.shuffle)((0,p.values)(t).filter((e=>e.complete))),a=(0,p.shuffle)((0,h.R9)(38,0)),r=(0,p.sampleSize)(s,3).map((e=>(0,c.Z)((0,c.Z)({},e),{},{spriteId:"".concat(a.pop())}))),n=[],l=[],o=[],u=[],d=[],m=[],g=[],x=[];i.forEach((e=>{const t=[w.NL.DETERMINISTIC,w.NL.RELATED],s=e.attributes[r[0].id]===w.NL.DETERMINISTIC,i=t.includes(e.attributes[r[0].id]),a=e.attributes[r[0].id]===w.NL.UNRELATED,c=e.attributes[r[1].id]===w.NL.DETERMINISTIC,p=t.includes(e.attributes[r[1].id]),h=e.attributes[r[1].id]===w.NL.UNRELATED,b=e.attributes[r[2].id]===w.NL.DETERMINISTIC,j=t.includes(e.attributes[r[2].id]),v=e.attributes[r[2].id]===w.NL.UNRELATED;if(a&&h&&v)return x.push(e.id);s&&h&&v&&n.push(e.id),a&&c&&v&&l.push(e.id),a&&h&&b&&o.push(e.id),i&&p&&v&&u.push(e.id),i&&h&&j&&d.push(e.id),a&&p&&j&&m.push(e.id),i&&p&&j&&g.push(e.id)}));const b=r.map((e=>({id:e.id,name:e.name.pt,description:e.description.pt,spriteId:e.spriteId,itemsIds:[]})));b[0].itemsIds=(0,p.sampleSize)(n,n.length>3?3:Math.max(n.length-1,1)),b[1].itemsIds=(0,p.sampleSize)(l,l.length>3?3:Math.max(n.length-1,1)),b[2].itemsIds=(0,p.sampleSize)(o,o.length>3?3:Math.max(n.length-1,1));const j=[];b.forEach((e=>{j.push(...e.itemsIds)}));const v=[];var y,Z,f,I;u.length>0&&v.push({spritesIds:[r[0].spriteId,r[1].spriteId],itemId:null!==(y=(0,p.sample)(u))&&void 0!==y?y:""});d.length>0&&v.push({spritesIds:[r[0].spriteId,r[2].spriteId],itemId:null!==(Z=(0,p.sample)(d))&&void 0!==Z?Z:""});m.length>0&&v.push({spritesIds:[r[1].spriteId,r[2].spriteId],itemId:null!==(f=(0,p.sample)(m))&&void 0!==f?f:""});g.length>0&&v.push({spritesIds:r.map((e=>e.spriteId)),itemId:null!==(I=(0,p.sample)(g))&&void 0!==I?I:""});const N=[];n.length>0&&N.push({spritesIds:[r[0].spriteId],itemId:n.filter((e=>!j.includes(e)))[0]}),l.length>0&&N.push({spritesIds:[r[1].spriteId],itemId:l.filter((e=>!j.includes(e)))[0]}),o.length>0&&N.push({spritesIds:[r[2].spriteId],itemId:o.filter((e=>!j.includes(e)))[0]}),console.log({attributeA:n,attributeB:l,attributeC:o,attributeAB:u,attributeAC:d,attributeBC:m,attributeABC:g}),console.log("COMPLEX REQUEST SIZE",v.length),console.log("SIMPLE REQUEST SIZE",N.length);let C=(0,p.sampleSize)(v,4);console.log("REQUEST SIZE",C.length),C.length<3&&C.push(...(0,p.sampleSize)(N,4-C.length)),C.length<4&&console.warn("Not enough requests"),C=(0,p.shuffle)(C);const P=C.map((e=>e.itemId)),S={id:"2024-00-00",setId:b.map((e=>e.id)).sort().join("-"),number:0,type:"comunica\xe7\xe3o-alien\xedgena",attributes:b,requests:C,solution:P.join("-"),itemsIds:(0,p.shuffle)([...P,x[0],x[1],x[2],x[3]]).filter(Boolean),valid:!1};return S.valid=[3===S.attributes.length,4===S.requests.length,S.itemsIds.length>5,S.attributes.every((e=>e.itemsIds.length>0)),S.requests.every((e=>e.itemId))].every(Boolean),console.log(S),S},Ke=["","I","II","III","IV","V"];function qe(){const{attributes:e,availableItemIds:t,getItemAttributeValues:s,getItem:i}=N(),{message:a}=m.Z.useApp(),[n,o]=(0,g.useState)(25),[u,d]=(0,g.useState)(90),[h,x]=(0,g.useState)(!1),[b,j]=(0,g.useState)([]),[v,y]=(0,g.useState)([]),[f,I]=(0,g.useState)(null),[C,P]=(0,g.useState)({id:!0,nameEn:!0,namePt:!0,reliability:!0}),S=e=>{P((t=>(0,c.Z)((0,c.Z)({},t),{},{[e]:!t[e]})))};return(0,Z.jsxs)("div",{className:"my-4",children:[(0,Z.jsx)(T.Z.Title,{level:3,children:"Simulator"}),(0,Z.jsx)(T.Z.Paragraph,{children:"Generates a board with items different enough to get Deterministic values in all selected attributes."}),(0,Z.jsxs)(r.Z,{wrap:!0,gap:12,children:[(0,Z.jsx)(l.zE,{label:"Grid Size",value:n,onChange:e=>o(e),options:[16,25]}),(0,Z.jsx)(l.xh,{label:"Reliability Threshold",value:u,onChange:e=>d(e),step:5,min:10,max:100}),(0,Z.jsx)(l.Do,{label:"NSFW",value:h,onChange:x}),(0,Z.jsx)(E.ZP,{onClick:()=>{const r={},l=(0,p.shuffle)(t);for(;Object.values(r).length<n;){const e=l.pop();if(!e)break;const t=s(e);t&&(!t.complete||!t.reliability||t.reliability<u||!h&&i(e).nsfw||(t.key&&!r[t.key]?r[t.key]=e:console.log("Item has identical key to another item. Skipping.",i(e).name.en)))}const o=Object.values(r);o.length<n&&a.error("Could not generate sample. Got only ".concat(o.length," items")),j((0,p.sortBy)(o,(e=>Number(e))));const d=function(e,t,s){const i={},a={};e.forEach((e=>{e&&Object.keys(e.attributes).forEach((t=>{e.attributes[t]>0&&(i[t]=(i[t]||0)+1),e.attributes[t]===w.NL.DETERMINISTIC&&(a[t]=!0,i[t]=(i[t]||0)+2),e.attributes[t]===w.NL.OPPOSITE&&(i[t]=(i[t]||0)+1)}))}));const r={1:0,2:0,3:0,4:0};function n(e){return e.filter((e=>(r[s[e].level]++,!(r[4]>1)||(console.log("Discarding level 4 attribute",e),!1))))}const l=n(Object.keys(a)),o=n((0,p.keys)(i).filter((e=>!l.includes(e))));if(console.log({levelCount:r}),t===l.length)return console.log("All keys are deterministic"),l;if(console.log(i),0===l.length)return[];const u=l.reduce(((e,t)=>{const s=i[t];return e[s]||(e[s]=[]),e[s].push(t),e}),{}),d=(0,p.keys)(u).sort(((e,t)=>Number(t)-Number(e)));console.log({sortedDeterministicTiedGroupsKeys:d});const c=o.reduce(((e,t)=>{const s=i[t];return e[s]||(e[s]=[]),e[s].push(t),e}),{});console.log(c);const m=(0,p.keys)(c).sort(((e,t)=>Number(t)-Number(e))),g=[];for(const h of d){if(g.length===t)break;g.push(...(0,p.sampleSize)(u[h],t-g.length))}for(const h of m){if(g.length===t)break;g.push(...(0,p.sampleSize)(c[h],t-g.length))}return g}(o.map((e=>s(e))),25,e);if(d.length<25){const t=(0,p.keys)(e).filter((e=>!d.includes(e))),s=(0,p.sortBy)(t,(t=>e[t].priority)).slice(0,25-d.length);console.log("Adding more attributes by priority",s),d.push(...s)}const m=d.reduce(((e,t)=>(o.forEach((i=>{const a=s(i);if(a)switch(a.attributes[t]){case w.NL.RELATED:e.relatedCount[t]=(e.relatedCount[t]||0)+1;break;case w.NL.DETERMINISTIC:e.deterministicCount[t]=(e.deterministicCount[t]||0)+1;break;case w.NL.UNCLEAR:e.unclearCount[t]=(e.unclearCount[t]||0)+1;break;case w.NL.OPPOSITE:e.oppositeCount[t]=(e.oppositeCount[t]||0)+1}})),e)),{relatedCount:{},deterministicCount:{},unclearCount:{},oppositeCount:{}});y(d.sort().map((t=>(0,c.Z)((0,c.Z)({},e[t]),{},{relatedCount:m.relatedCount[t],deterministicCount:m.deterministicCount[t],unclearCount:m.unclearCount[t],oppositeCount:m.oppositeCount[t]}))))},type:"primary",children:"Get Sample Board"})]}),(0,Z.jsxs)(r.Z,{wrap:!0,gap:12,children:[(0,Z.jsx)(l.tj,{label:"Show Id",value:!!C.id,onChange:()=>S("id")}),(0,Z.jsx)(l.tj,{label:"Show Name (EN)",value:!!C.nameEn,onChange:()=>S("nameEn")}),(0,Z.jsx)(l.tj,{label:"Show Name (PT)",value:!!C.namePt,onChange:()=>S("namePt")}),(0,Z.jsx)(l.tj,{label:"Show Reliability",value:!!C.reliability,onChange:()=>S("reliability")})]}),(0,Z.jsx)("div",{className:"simulator-grid",style:{gridTemplateColumns:"repeat(".concat(Math.sqrt(n),", 1fr)")},children:b.map((e=>{const t=i(e),a=s(e);return(0,Z.jsxs)(q.Z,{direction:"vertical",className:(0,ie.Z)("simulator-grid__entry",f&&a.attributes[f]>0&&"simulator-grid__entry--highlighted"),align:"center",children:[(0,Z.jsxs)(q.Z,{children:[(0,Z.jsxs)(r.Z,{vertical:!0,children:[C.id&&(0,Z.jsx)($.bN,{item:t}),C.reliability&&(0,Z.jsx)("span",{children:(0,Z.jsx)(Qe.Z,{prefix:(0,Z.jsx)(Oe.Z,{}),placeholder:"Reliability",variant:"borderless",size:"small",value:a.reliability,readOnly:!0,style:{width:"8ch"},formatter:e=>"".concat(e,"%")})}),C.id&&(0,Z.jsx)($.cw,{item:t})]}),(0,Z.jsx)($.xL,{item:t,width:50})]}),C.nameEn&&(0,Z.jsx)($.CQ,{item:t,language:"en"}),C.namePt&&(0,Z.jsx)($.CQ,{item:t,language:"pt"})]},e)}))}),(0,Z.jsx)("div",{className:"simulator-grid my-4",children:v.map((e=>{var t,s,i,a;return(0,Z.jsxs)(l.F6,{className:(0,ie.Z)("simulator-grid__entry","simulator-grid__button",f===e.id&&"simulator-grid__entry--highlighted"),onClick:()=>I(e.id),children:[e.name.en," ",Ke[e.level],(0,Z.jsxs)(r.Z,{gap:6,justify:"center",className:"my-1",children:[(0,Z.jsxs)("span",{children:[(0,Z.jsx)(Fe.Z,{style:{color:e.deterministicCount?"dodgerblue":void 0}})," ",null!==(t=e.deterministicCount)&&void 0!==t?t:0]}),(0,Z.jsxs)("span",{children:[(0,Z.jsx)(Ve.Z,{style:{color:e.relatedCount?"green":void 0}})," ",null!==(s=e.relatedCount)&&void 0!==s?s:0]}),(0,Z.jsxs)("span",{children:[(0,Z.jsx)(Re.Z,{style:{color:e.oppositeCount?"red":void 0}})," ",null!==(i=e.oppositeCount)&&void 0!==i?i:0]}),(0,Z.jsxs)("span",{children:[(0,Z.jsx)(J.Z,{style:{color:e.unclearCount?"gold":void 0}})," ",null!==(a=e.unclearCount)&&void 0!==a?a:0]})]})]},e.id)}))}),(0,Z.jsx)(Be,{})]})}var $e=s(18),We=s(6978),Xe=s(4766),Je=s(7689);function Ye(){const e=[{key:"1",label:"All Attributes",children:(0,Z.jsx)(He,{type:"all"})},{key:"2",label:"Default Attributes",children:(0,Z.jsx)(He,{type:"default"})},{key:"3",label:"Custom Attributes",children:(0,Z.jsx)(He,{type:"custom"})}];return(0,Z.jsxs)("div",{className:"my-4",children:[(0,Z.jsx)(T.Z.Title,{level:5,children:"Stats"}),(0,Z.jsx)($e.Z,{defaultActiveKey:"1",items:e})]})}function He(e){let{type:t}=e;const{availableItemIds:s,getItemAttributeValues:i,attributesList:a}=N(),n=(0,Je.s0)(),{is:l}=(0,Xe.K)(),o=(0,g.useMemo)((()=>"default"===t?a.filter((e=>e.default)):"custom"===t?a.filter((e=>!e.default)):a),[a,t]),u=(0,g.useMemo)((()=>{const e=s.map((e=>i(e)));return o.map((t=>(0,c.Z)((0,c.Z)({},t),((e,t)=>{let s=0,i=0,a=0,r=0,n=0,l=0,o=0,u=0;t.forEach((t=>{let{attributes:d}=t;if(d[e.id]){s++;const t=d[e.id];10===t?i++:5===t?a++:0!==t&&t?-1===t?n++:-3===t?l++:-10===t&&o++:r++,t>0&&u++}}));const d=t.length,c=i/d*100,m=a/d*100,p=r/d*100,g=n/d*100,h=l/d*100,x=o/d*100,b=u/d*100;return{completionPercentage:(s/d*100).toFixed(1),tensPercentage:c.toFixed(1),fivesPercentage:m.toFixed(1),zerosPercentage:p.toFixed(1),negativeOnesPercentage:g.toFixed(1),negativeThreesPercentage:h.toFixed(1),negativeTensPercentage:x.toFixed(1),positivePercentage:b.toFixed(1)}})(t,e))))}),[o,s,i]),d=[{title:"Attribute",dataIndex:"name",key:"name",render:(e,t)=>(0,Z.jsxs)(r.Z,{align:"center",gap:8,children:[l("showGlyphs")&&(0,Z.jsx)(ae.o$,{id:t.spriteId,width:30}),e.en,t.default?(0,Z.jsx)(A.Z,{className:"ml-1",children:"default"}):"",t.limited?(0,Z.jsx)(A.Z,{className:"ml-1",children:"limited"}):"",(0,Z.jsx)(H,{title:t.description.en})]}),sorter:(e,t)=>e.name.en.localeCompare(t.name.en)},{title:"Priority",dataIndex:"priority",key:"priority",sorter:(e,t)=>e.priority-t.priority},{title:"Positive",dataIndex:"positivePercentage",key:"positivePercentage",render:e=>"".concat(e,"%"),sorter:(e,t)=>Number.parseFloat(e.positivePercentage)-Number.parseFloat(t.positivePercentage)},{title:"10",dataIndex:"tensPercentage",key:"tensPercentage",render:(e,t)=>t.limited?"-":"".concat(e,"%"),sorter:(e,t)=>Number.parseFloat(e.tensPercentage)-Number.parseFloat(t.tensPercentage)},{title:"5",dataIndex:"fivesPercentage",key:"fivesPercentage",render:e=>"".concat(e,"%"),sorter:(e,t)=>Number.parseFloat(e.fivesPercentage)-Number.parseFloat(t.fivesPercentage)},{title:"-1",dataIndex:"negativeOnesPercentage",key:"negativeOnesPercentage",render:e=>"".concat(e,"%"),sorter:(e,t)=>Number.parseFloat(e.negativeOnesPercentage)-Number.parseFloat(t.negativeOnesPercentage)},{title:"-3",dataIndex:"negativeThreesPercentage",key:"negativeThreesPercentage",render:e=>"".concat(e,"%"),sorter:(e,t)=>Number.parseFloat(e.negativeThreesPercentage)-Number.parseFloat(t.negativeThreesPercentage)},{title:"-10",dataIndex:"negativeTensPercentage",key:"negativeTensPercentage",render:e=>"".concat(e,"%"),sorter:(e,t)=>Number.parseFloat(e.negativeTensPercentage)-Number.parseFloat(t.negativeTensPercentage)},{title:"Completion",dataIndex:"completionPercentage",key:"completionPercentage",render:e=>(0,Z.jsx)(ue.Z,{percent:Number.parseFloat(e),size:"small"}),sorter:(e,t)=>Number.parseFloat(e.completionPercentage)-Number.parseFloat(t.completionPercentage)},{title:"Level",dataIndex:"level",key:"level",render:e=>(0,Z.jsx)(We.Z,{count:4,value:e,disabled:!0}),sorter:(e,t)=>e.level-t.level},{title:"Actions",key:"actions",render:e=>(0,Z.jsx)(q.Z,{children:(0,Z.jsxs)(E.ZP.Group,{children:[(0,Z.jsx)(E.ZP,{size:"small",shape:"round",onClick:()=>n("/items/attribution?view=grouping&attribute=".concat(e.id,"&page=1")),children:"Grouping"}),(0,Z.jsx)(E.ZP,{size:"small",shape:"round",onClick:()=>n("/items/attribution?view=sampler&attribute=".concat(e.id,"&size=6")),children:"Sample"})]})})}];return(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsxs)(T.Z.Paragraph,{children:["Total: ",u.length]}),(0,Z.jsx)(fe.Z,{columns:d,dataSource:u,pagination:!1,rowKey:"id",size:"small"})]})}function et(){const{view:e}=P();return"classifier"===e?(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsx)(ye,{}),(0,Z.jsx)(ce,{}),(0,Z.jsx)(r.Z,{justify:"flex-end",className:"my-4",children:(0,Z.jsx)(B,{})})]}):"sampler"===e?(0,Z.jsx)(Me,{}):"grouping"===e?(0,Z.jsx)(ke,{}):"comparator"===e?(0,Z.jsx)(Ie,{}):"simulator"===e?(0,Z.jsx)(qe,{}):"stats"===e?(0,Z.jsx)(Ye,{}):(0,Z.jsx)(R.Z,{className:"my-10",description:"Unknown view has been selected"})}var tt=s(4562);function st(){const{isLoading:e,error:t,hasResponseData:s}=N();return(0,Z.jsx)(d.Xg,{title:"Items",subtitle:"Attribution",children:(0,Z.jsxs)(i.Z,{hasSider:!0,children:[(0,Z.jsx)(tt.p,{children:(0,Z.jsx)(V,{})}),(0,Z.jsx)(i.Z.Content,{className:"content",children:(0,Z.jsx)(a.T,{isLoading:e,error:t,hasResponseData:s,children:(0,Z.jsx)(et,{})})})]})})}const it=function(){return(0,Z.jsx)(I,{children:(0,Z.jsx)(st,{})})}}}]);
//# sourceMappingURL=ItemsAttribution.b75765c0.chunk.js.map