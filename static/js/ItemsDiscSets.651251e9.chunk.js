"use strict";(self.webpackChunktd_admin=self.webpackChunktd_admin||[]).push([[2695],{4341:(e,t,s)=>{s.d(t,{M:()=>n});var a=s(2791);function n(e){let{maxExpandedRows:t,rowExpandable:s,defaultExpandAllRows:n,...i}=e;const[r,l]=(0,a.useState)([]);return{expandedRowKeys:r,rowExpandable:null!==s&&void 0!==s?s:()=>!0,defaultExpandAllRows:null!==n&&void 0!==n&&n,onExpand:(e,s)=>{const a=[...r];if(!e)return l(a.filter((e=>e!==s.id)));if(t){for(;a.length>=t;)a.shift();a.push(s.id),l(a)}},...i}}},9038:(e,t,s)=>{s.r(t),s.d(t,{ItemsDiscSets:()=>ce,default:()=>oe});var a=s(1790),n=s(2128),i=s(2997),r=s(4850),l=s(4766),d=s(4453),c=s(1046),o=s(1082),u=s(2252),p=s(945),m=s(4520),h=s(7134),x=s(548),f=s(5529),j=s(763),v=s(2791),g=s(5850),y=s(8862),Z=s(9929),b=s(8178),I=s(2061),C=s(184);function E(e){let{onUpdateBatch:t}=e;const[s,a]=(0,v.useState)("");return(0,C.jsxs)(p.Z.Paragraph,{children:["Paste IDs",(0,C.jsx)(I.Z.TextArea,{value:s,onChange:e=>a(e.target.value)}),(0,C.jsx)(u.ZP,{size:"small",onClick:()=>{try{const e=s.replace(/^\[|\]$/g,"").split(/\s*,\s*/).map((e=>e.replace(/^"|"$/g,""))).filter(Boolean);t(e),a("")}catch(e){console.error(e)}},children:"Add"})]})}function w(e){let{disc:t,addEntryToUpdate:s}=e;const a=e=>{s(t.id,{...t,itemsIds:(0,g.R1)((0,g.E4)([...t.itemsIds,e]))})};return(0,C.jsxs)(m.Z,{gap:16,children:[(0,C.jsxs)("div",{children:[(0,C.jsx)(p.Z.Paragraph,{children:"Add Item"}),(0,C.jsx)(b.i,{onFinish:a})]}),(0,C.jsx)(S,{onUpdate:a,disc:t}),(0,C.jsx)(E,{onUpdateBatch:e=>{s(t.id,{...t,itemsIds:(0,g.R1)((0,g.E4)([...t.itemsIds,...e]))})}})]})}function S(e){let{onUpdate:t,disc:s}=e;const a=(0,f.N)("items"),[n,r]=(0,v.useState)([...s.itemsIds]),l=e=>{var t;const s=(0,j.difference)(Object.keys(null!==(t=a.data)&&void 0!==t?t:{}),n);return(0,j.sampleSize)(s,e)},[d,c]=(0,v.useState)(l(5)),o=()=>{const e=l(30);c(e),r([...n,...e])};return(0,v.useEffect)((()=>{r([...s.itemsIds])}),[s.id]),(0,v.useEffect)((()=>{0===d.length&&(o(),r([...s.itemsIds]))}),[d]),(0,C.jsxs)("div",{children:[(0,C.jsxs)(p.Z.Paragraph,{children:["Random Sample"," ",(0,C.jsx)(u.ZP,{size:"small",onClick:o,children:"Get"})]}),(0,C.jsx)(m.Z,{gap:16,wrap:"wrap",children:d.map(((e,s)=>(0,C.jsxs)(m.Z,{gap:2,vertical:!0,children:[(0,C.jsx)(i.ck,{id:e,width:60}),(0,C.jsxs)(m.Z,{justify:"center",gap:6,children:[(0,C.jsx)(p.Z.Text,{children:e}),(0,C.jsx)(u.ZP,{size:"small",shape:"circle",onClick:()=>t(e),children:(0,C.jsx)(Z.Z,{})})]})]},"sample-".concat(e,"-").concat(s))))})]})}var k=s(4341);function T(e){let{data:t,addEntryToUpdate:s}=e;const a=(0,f.N)("items"),n=(0,v.useMemo)((()=>{return e=Object.values(t),(0,j.orderBy)(e,[e=>e.title.en]).map((e=>({...e,itemsIds:(0,j.orderBy)(e.itemsIds,(e=>Number(e)))})));var e}),[t]),i=(0,h._)(),r=(0,x.P)({total:n.length,showQuickJumper:!0}),l=[{title:"Id",dataIndex:"id",key:"id",sorter:(e,t)=>e.title.en.localeCompare(t.title.en)},{title:"Title",dataIndex:"title",key:"title",sorter:(e,t)=>e.title.en.localeCompare(t.title.en),render:(e,t)=>(0,C.jsx)(P,{value:e,disc:t,addEntryToUpdate:s})},d.Z.EXPAND_COLUMN,{title:"Items",dataIndex:"itemsIds",key:"itemsIds",render:(e,t)=>(0,C.jsx)(N,{disc:t,itemsIds:(0,g.E4)(e),copyToClipboard:i,addEntryToUpdate:s})},{title:"Count",dataIndex:"itemsIds",key:"count",render:e=>(0,g.R1)(e).filter(Boolean).length}],o=(0,k.M)({maxExpandedRows:1,expandedRowRender:e=>(0,C.jsx)(w,{disc:e,addEntryToUpdate:s}),rowExpandable:()=>a.isSuccess});return(0,C.jsx)(c.Z,{direction:"vertical",children:(0,C.jsx)(d.Z,{columns:l,dataSource:n,pagination:r,rowKey:"id",expandable:o})})}function O(e){let{disc:t,addEntryToUpdate:s,itemId:a}=e;return(0,C.jsx)(o.Z,{title:"Are you sure you want to remove this item?",onConfirm:()=>{s(t.id,{...t,itemsIds:t.itemsIds.filter((e=>e!==a))})},okText:"Yes",cancelText:"No",children:(0,C.jsx)(u.ZP,{icon:(0,C.jsx)(y.Z,{}),size:"small",type:"text"})})}function P(e){let{value:t,disc:s,addEntryToUpdate:a}=e;const n=(e,t)=>{a(s.id,{...s,title:{...s.title,[t]:e}})};return(0,C.jsxs)(c.Z,{direction:"vertical",size:"small",children:[(0,C.jsx)(p.Z.Text,{editable:{onChange:e=>n(e,"pt")},children:String(t.pt)}),(0,C.jsx)(p.Z.Text,{editable:{onChange:e=>n(e,"en")},children:String(t.en)})]})}function N(e){let{disc:t,itemsIds:s,copyToClipboard:a,addEntryToUpdate:n}=e;return(0,C.jsxs)(m.Z,{gap:6,wrap:"wrap",children:[s.map(((e,s)=>(0,C.jsxs)(m.Z,{gap:2,vertical:!0,children:[(0,C.jsx)(i.ck,{id:e,width:60}),(0,C.jsxs)(m.Z,{justify:"center",children:[(0,C.jsx)(p.Z.Text,{onClick:()=>a(e),children:e}),(0,C.jsx)(O,{disc:t,addEntryToUpdate:n,itemId:e})]})]},"".concat(t.title,"-").concat(e,"-").concat(s)))),(0,C.jsx)(r.A,{ids:s})]},"items-".concat(t.title))}var U=s(5922),A=s(3320),z=s(5437),R=s(952),M=s(8357),q=s(2228),B=s(4290);function D(e){var t;let{data:s,addEntryToUpdate:a}=e;const{is:n,addParam:r}=(0,l.K)(),d=(0,f.N)("items"),[o,u]=(0,v.useMemo)((()=>{if(d.data){const e=Object.values(s).reduce(((e,t)=>(t.itemsIds.forEach((s=>{e[s]||(e[s]=[]),e[s].push(t.id)})),e)),{});Object.keys(d.data).reduce(((e,t)=>(void 0===e[t]&&(e[t]=[]),e[t].push(t),e)),{});const t=["black","blue","brown","green","orange","pink","purple","red","white","yellow"],a=Object.keys(d.data).filter((s=>void 0===e[s]||1===e[s].length&&t.includes(e[s][0]))).map((e=>d.data[e]));return[e,a]}return[{},[]]}),[s,d.data]),h=n("onlyOrphans"),{page:x,pagination:j}=(0,B.e)({data:h?u:Object.values(d.data),defaultPageSize:64,resetter:h?"orphans":"all"}),[g,y]=(0,v.useState)(null),[Z,b]=(0,v.useState)(null),I=(0,v.useMemo)((()=>Object.values(s).sort(((e,t)=>e.title.pt.localeCompare(t.title.pt)))),[s]);return(0,C.jsxs)(C.Fragment,{children:[(0,C.jsxs)(p.Z.Title,{level:4,children:["Orphan Items (",u.length,")"]}),(0,C.jsx)(c.Z,{className:"mb-4",children:(0,C.jsx)(U.Z,{checkedChildren:"Only Orphans",unCheckedChildren:"All Items",onChange:e=>r("onlyOrphans",e,!1)})}),(0,C.jsx)(A.Z,{title:"Add Item to Set",open:!!g,onClose:()=>y(null),children:!!g&&(0,C.jsx)(H,{activeItem:g,activeItemSets:null!==(t=null===o||void 0===o?void 0:o[g])&&void 0!==t?t:[],latestSetId:Z,setLatestSetId:b,sortedSets:I,data:s,addEntryToUpdate:a})}),(0,C.jsx)(q.N,{pagination:j,className:"full-width",children:(0,C.jsx)(m.Z,{gap:16,wrap:"wrap",children:x.map((e=>(0,C.jsx)(M.F6,{onClick:()=>y(e.id),children:(0,C.jsx)(i.ck,{id:e.id})},e.id)))})})]})}function H(e){let{activeItem:t,activeItemSets:s,latestSetId:a,setLatestSetId:n,sortedSets:r,data:l,addEntryToUpdate:d}=e;const[c,o]=(0,v.useState)(s);if(!t)return null;const p=r.map((e=>({value:e.id,label:e.title.pt})));return(0,C.jsxs)(m.Z,{vertical:!0,gap:16,children:[(0,C.jsx)(i.ck,{id:t}),(0,C.jsx)(z.Z,{onChange:e=>{o(e)},mode:"tags",value:c,options:p}),(0,C.jsx)(u.ZP,{type:"primary",onClick:()=>{c.forEach((e=>{d(e,{...l[e],itemsIds:[...l[e].itemsIds,t]})})),n(c[c.length-1])},disabled:(0,j.isEqual)(s,c),children:"Save to Sets"}),(0,C.jsx)(m.Z,{wrap:"wrap",gap:8,children:r.map((e=>(0,C.jsx)(R.Z,{onClick:()=>{return t=e.id,void o((e=>e.includes(t)?e.filter((e=>e!==t)):[...e,t]));var t},color:c.includes(e.id)?"gold":void 0,children:e.title.pt})))})]})}function F(e){let{data:t,addEntryToUpdate:s}=e;const{is:a,queryParams:n}=(0,l.K)();return(0,C.jsxs)(C.Fragment,{children:[(a("display","sets")||!n.has("display"))&&(0,C.jsx)(T,{data:t,addEntryToUpdate:s}),(a("display","orphans")||!n.has("display"))&&(0,C.jsx)(D,{data:t,addEntryToUpdate:s})]})}var _=s(7128),K=s(7018),L=s(7340),W=s(7965),$=s(5225),J=s(959),Q=s(1310),X=s(1291),Y=s.n(X);function G(e){let{addEntryToUpdate:t,ids:s}=e;const[a,n]=(0,v.useState)(!1),[i]=$.Z.useForm(),r=$.Z.useWatch("name",i),l=(0,v.useMemo)((()=>{const e={};if(r&&r.length>2){const a=(0,j.camelCase)(r);if(a)try{Y().findBestMatch(a,s).ratings.forEach((t=>{t.rating>.4&&(e[t.target]=t.rating)}))}catch(t){console.error(t)}}return Object.keys(e)}),[r,s]);return(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(u.ZP,{type:"dashed",block:!0,onClick:()=>n(!0),children:"Add New Set"}),(0,C.jsxs)(J.Z,{title:"Add New Set",open:a,onOk:i.submit,onCancel:()=>n(!1),maskClosable:!1,okText:"Add",okButtonProps:{htmlType:"submit"},children:[(0,C.jsxs)($.Z,{form:i,onFinish:e=>{const s=(0,j.camelCase)(e.name);t((0,j.camelCase)(s),{id:s,title:{pt:e.nome,en:e.name},itemsIds:[]})},children:[(0,C.jsx)($.Z.Item,{name:"nome",label:"Nome",rules:[{required:!0}],children:(0,C.jsx)(I.Z,{prefix:(0,C.jsx)(Q.H,{language:"pt",width:"1em"}),placeholder:"Name in pt",size:"small"})}),(0,C.jsx)($.Z.Item,{name:"name",label:"Name",rules:[{required:!0}],children:(0,C.jsx)(I.Z,{prefix:(0,C.jsx)(Q.H,{language:"en",width:"1em"}),placeholder:"Name in en",size:"small"})})]}),(0,C.jsx)(p.Z.Text,{children:"Similar:"}),(0,C.jsx)("ul",{children:l.map((e=>(0,C.jsx)("li",{children:e},e)))})]})]})}var V=s(9197),ee=s(7460);const te={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M288 421a48 48 0 1096 0 48 48 0 10-96 0zm352 0a48 48 0 1096 0 48 48 0 10-96 0zM512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm263 711c-34.2 34.2-74 61-118.3 79.8C611 874.2 562.3 884 512 884c-50.3 0-99-9.8-144.8-29.2A370.4 370.4 0 01248.9 775c-34.2-34.2-61-74-79.8-118.3C149.8 611 140 562.3 140 512s9.8-99 29.2-144.8A370.4 370.4 0 01249 248.9c34.2-34.2 74-61 118.3-79.8C413 149.8 461.7 140 512 140c50.3 0 99 9.8 144.8 29.2A370.4 370.4 0 01775.1 249c34.2 34.2 61 74 79.8 118.3C874.2 413 884 461.7 884 512s-9.8 99-29.2 144.8A368.89 368.89 0 01775 775zM512 533c-85.5 0-155.6 67.3-160 151.6a8 8 0 008 8.4h48.1c4.2 0 7.8-3.2 8.1-7.4C420 636.1 461.5 597 512 597s92.1 39.1 95.8 88.6c.3 4.2 3.9 7.4 8.1 7.4H664a8 8 0 008-8.4C667.6 600.3 597.5 533 512 533z"}}]},name:"frown",theme:"outlined"};var se=s(4508),ae=function(e,t){return v.createElement(se.Z,(0,ee.Z)({},e,{ref:t,icon:te}))};const ne=v.forwardRef(ae);function ie(e){var t;let{data:s,save:a,isDirty:n,isSaving:i,entriesToUpdate:r,addEntryToUpdate:d}=e;const{queryParams:c,addParams:o}=(0,l.K)();return(0,C.jsxs)(W.Pd,{children:[(0,C.jsxs)(m.Z,{vertical:!0,gap:12,children:[(0,C.jsx)(L.k,{isDirty:n,onSave:a,isSaving:i,dirt:JSON.stringify(re(r))}),(0,C.jsx)(K.o,{data:()=>{return e=s,Object.keys(e).forEach((t=>{e[t].itemsIds=(0,g.E4)((0,g.R1)(e[t].itemsIds))})),(0,g.Tj)(re(e));var e},fileName:"daily-disc-sets.json",disabled:n,block:!0})]}),(0,C.jsx)(_.Z,{}),(0,C.jsx)(M.H,{label:"Display",value:null!==(t=c.get("display"))&&void 0!==t?t:"sets",onChange:e=>o({display:e,page:1},{page:1,display:"table"}),options:[{title:"Sets",icon:(0,C.jsx)(V.Z,{}),value:"sets"},{title:"Orphan Items",icon:(0,C.jsx)(ne,{}),value:"orphans"}]}),(0,C.jsx)(G,{addEntryToUpdate:d,ids:Object.keys(s)})]})}function re(e){return(0,j.omitBy)((0,j.cloneDeep)(e),(e=>(0,j.isEmpty)(e.itemsIds)))}var le=s(4562),de=s(8938);function ce(){const e=(0,de.i)({tdrResourceName:"daily-disc-sets",firebaseDataCollectionName:"discSets",serialize:!0});return(0,C.jsx)(W.Xg,{title:"Items",subtitle:"Disc Sets",children:(0,C.jsxs)(a.Z,{hasSider:!0,children:[(0,C.jsx)(le.p,{children:(0,C.jsx)(ie,{...e})}),(0,C.jsx)(a.Z.Content,{className:"content",children:(0,C.jsx)(n.T,{isLoading:e.isLoading||e.isSaving,error:e.error,hasResponseData:!(0,j.isEmpty)(e.data),children:(0,C.jsx)(F,{...e})})})]})})}const oe=ce},7042:(e,t,s)=>{s.d(t,{Z:()=>a});const a={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M482 152h60q8 0 8 8v704q0 8-8 8h-60q-8 0-8-8V160q0-8 8-8z"}},{tag:"path",attrs:{d:"M192 474h672q8 0 8 8v60q0 8-8 8H160q-8 0-8-8v-60q0-8 8-8z"}}]},name:"plus",theme:"outlined"}},8862:(e,t,s)=>{s.d(t,{Z:()=>d});var a=s(7460),n=s(2791);const i={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M864 256H736v-80c0-35.3-28.7-64-64-64H352c-35.3 0-64 28.7-64 64v80H160c-17.7 0-32 14.3-32 32v32c0 4.4 3.6 8 8 8h60.4l24.7 523c1.6 34.1 29.8 61 63.9 61h454c34.2 0 62.3-26.8 63.9-61l24.7-523H888c4.4 0 8-3.6 8-8v-32c0-17.7-14.3-32-32-32zm-200 0H360v-72h304v72z"}}]},name:"delete",theme:"filled"};var r=s(4508),l=function(e,t){return n.createElement(r.Z,(0,a.Z)({},e,{ref:t,icon:i}))};const d=n.forwardRef(l)},9929:(e,t,s)=>{s.d(t,{Z:()=>d});var a=s(7460),n=s(2791),i=s(7042),r=s(4508),l=function(e,t){return n.createElement(r.Z,(0,a.Z)({},e,{ref:t,icon:i.Z}))};const d=n.forwardRef(l)},959:(e,t,s)=>{s.d(t,{Z:()=>Z});var a=s(8887),n=s(6854),i=s(2173),r=s(2791),l=s(9809),d=s.n(l),c=s(3224),o=s(7268),u=s(1929),p=s(7838),m=s(2456),h=s(1458),x=s(3931),f=function(e,t){var s={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(s[a]=e[a]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var n=0;for(a=Object.getOwnPropertySymbols(e);n<a.length;n++)t.indexOf(a[n])<0&&Object.prototype.propertyIsEnumerable.call(e,a[n])&&(s[a[n]]=e[a[n]])}return s};const j=(0,o.i)((e=>{const{prefixCls:t,className:s,closeIcon:a,closable:n,type:i,title:l,children:o,footer:j}=e,v=f(e,["prefixCls","className","closeIcon","closable","type","title","children","footer"]),{getPrefixCls:g}=r.useContext(u.E_),y=g(),Z=t||g("modal"),b=(0,p.Z)(y),[I,C,E]=(0,x.ZP)(Z,b),w="".concat(Z,"-confirm");let S={};return S=i?{closable:null!==n&&void 0!==n&&n,title:"",footer:"",children:r.createElement(m.O,Object.assign({},e,{prefixCls:Z,confirmPrefixCls:w,rootPrefixCls:y,content:o}))}:{closable:null===n||void 0===n||n,title:l,footer:null!==j&&r.createElement(h.$,Object.assign({},e)),children:o},I(r.createElement(c.s,Object.assign({prefixCls:Z,className:d()(C,"".concat(Z,"-pure-panel"),i&&w,i&&"".concat(w,"-").concat(i),s,E,b)},v,{closeIcon:(0,h.b)(Z,a),closable:n},S)))}));var v=s(7562);function g(e){return(0,a.ZP)((0,a.uW)(e))}const y=i.Z;y.useModal=v.Z,y.info=function(e){return(0,a.ZP)((0,a.cw)(e))},y.success=function(e){return(0,a.ZP)((0,a.vq)(e))},y.error=function(e){return(0,a.ZP)((0,a.AQ)(e))},y.warning=g,y.warn=g,y.confirm=function(e){return(0,a.ZP)((0,a.Au)(e))},y.destroyAll=function(){for(;n.Z.length;){const e=n.Z.pop();e&&e()}},y.config=a.ai,y._InternalPanelDoNotUseOrYouWillBeFired=j;const Z=y}}]);
//# sourceMappingURL=ItemsDiscSets.651251e9.chunk.js.map