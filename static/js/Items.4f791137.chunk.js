"use strict";(self.webpackChunktd_admin=self.webpackChunktd_admin||[]).push([[8724],{2228:(e,n,i)=>{i.d(n,{N:()=>l});var t=i(8528),a=i(1046),s=i(184);function l(e){let{children:n,pagination:i,...l}=e;const o=(0,s.jsx)(t.Z,{showQuickJumper:!0,...i,className:"fixed-pagination"});return(0,s.jsxs)(a.Z,{direction:"vertical",...l,children:[o,n,o]})}},8178:(e,n,i)=>{i.d(n,{i:()=>c});var t=i(5),a=i(1105),s=i(5529),l=i(763),o=i(2791),r=i(5675),d=i(184);function c(e){let{items:n,isPending:i,style:c,size:m,placeholder:u,allowClear:h,onFinish:p,...g}=e;const v=(0,s.N)("items",!Boolean(n)&&!i),{namesDict:j,options:x}=(0,o.useMemo)((()=>{var e;console.log("Recomputing item names typeahead...");const i=Object.values(null!==(e=null!==n&&void 0!==n?n:v.data)&&void 0!==e?e:{}).reduce(((e,n)=>{const i="".concat(n.name.en," (").concat(n.id,")"),t="".concat(n.name.pt," (").concat(n.id,")");return e[i]=n.id,e[t]=n.id,n.aliasesEn&&n.aliasesEn.forEach((i=>{e["".concat(i," (").concat(n.id,")*")]=n.id})),n.aliasesPt&&n.aliasesPt.forEach((i=>{e["".concat(i," (").concat(n.id,")*")]=n.id})),e}),{});return{namesDict:i,options:(0,l.orderBy)(Object.keys(i),[e=>e.toLowerCase()]).map((e=>({value:e})))}}),[n,i]),[f,y]=(0,o.useState)([]),[k,S]=(0,o.useState)("");(0,r.Z)((()=>{k&&Z(k)}),500,[k]);const Z=e=>{if(!e)return void y([]);const n=e.trim().toUpperCase(),i=x.filter((e=>{var i;return String(null!==(i=null===e||void 0===e?void 0:e.value)&&void 0!==i?i:"").toUpperCase().includes(n)})),t=(0,l.orderBy)(i,[e=>{var i;const t=String(null!==(i=null===e||void 0===e?void 0:e.value)&&void 0!==i?i:"").toUpperCase();if(t===n)return 0;const a=t.match(/\((.*?)\)/);if(a&&a[1]===n)return 1;const s=t.indexOf(n);return 0===s?2:s>0?3:4}]);y(t)};return(0,d.jsx)(t.Z,{options:f,style:{width:250,...c},allowClear:null===h||void 0===h||h,placeholder:null!==u&&void 0!==u?u:"Search by name or id...",filterOption:(e,n)=>{var i;return-1!==String(null!==(i=null===n||void 0===n?void 0:n.value)&&void 0!==i?i:"").toUpperCase().indexOf(null===e||void 0===e?void 0:e.toUpperCase())},onSearch:S,notFoundContent:k.length>0?"No items found":"Type to search...",onSelect:e=>{void 0!==j[e]&&p(j[e])},...g,children:(0,d.jsx)(a.Z,{onPressEnter:()=>{if(f.length>0){const e=f[0].value;void 0!==j[e]&&p(j[e])}}})})}},4290:(e,n,i)=>{i.d(n,{e:()=>l});var t=i(2791),a=i(4766),s=i(4421);function l(e){var n,i;let{prefix:l="",data:o,defaultCurrent:r=1,defaultPageSize:d=64,pageSizeOptions:c=[16,32,64,128],resetter:m}=e;const{queryParams:u,addParam:h}=(0,a.K)(),p=Number(null!==(n=u.get("".concat(l,"page")))&&void 0!==n?n:String(r)),g=Number(null!==(i=u.get("".concat(l,"pageSize")))&&void 0!==i?i:String(d)),v=(0,s.Z)(m),j=(0,t.useMemo)((()=>{const e=(p-1)*g,n=e+g;return o.slice(e,n)}),[p,g,o]),x=e=>{h("".concat(l,"page"),e.toString(),String(r))};return m!==v&&x(r),{page:j,pagination:{current:p,pageSize:g,onChange:x,onShowSizeChange:(e,n)=>{h("".concat(l,"pageSize"),n.toString(),String(d))},defaultCurrent:r,defaultPageSize:d,pageSizeOptions:c,total:o.length,hideOnSinglePage:!0}}}},5581:(e,n,i)=>{i.r(n),i.d(n,{default:()=>le});var t=i(3990),a=i(1046),s=i(2128),l=i(8252),o=i(4520),r=i(6473),d=i(1105),c=i(5437),m=i(5225),u=i(5922),h=i(9228),p=i(2556),g=i(1310),v=i(2997),j=i(4766),x=i(8938),f=i(763),y=i(2791),k=i(184);const S=(0,y.createContext)({items:{},isLoading:!0,error:null,hasResponseData:!1,decksDict:{},decks:[],listing:[],isDirty:!1,addItemToUpdate:()=>{},itemsToUpdate:{},isSaving:!1,save:()=>{},newId:"-1"}),Z=e=>{var n;let{children:i}=e;const{queryParams:t}=(0,j.K)(),{data:a,isLoading:s,error:l,isSaving:o,save:r,addEntryToUpdate:d,entriesToUpdate:c,isDirty:m}=(0,x.i)({tdrResourceName:"items",firebaseDataCollectionName:"items"}),{decksDict:u,decks:h}=(0,y.useMemo)((()=>{console.log("Recomputing item decks typeahead...");const e={},n={},i={},t=[];Object.values(a).forEach((a=>{var s;const l="".concat(a.name.en," (").concat(a.id,")"),o="".concat(a.name.pt," (").concat(a.id,")");n[a.name.en]?t.push(["".concat(a.name.en," (").concat(n[a.name.en],")"),l]):n[a.name.en]=a.id,i[a.name.pt]?t.push(["".concat(a.name.pt," (").concat(i[a.name.pt],")"),o]):i[a.name.pt]=a.id,null===a||void 0===a||null===(s=a.decks)||void 0===s||s.forEach((n=>{e[n]=n}))}));const s=(0,f.orderBy)(Object.keys(e)).map((e=>({value:e})));return t.length>0&&console.warn("Possible duplicated items",t),{decksDict:e,decks:s}}),[a,o,s]),p=null!==(n=t.get("deck"))&&void 0!==n?n:"all",g=(0,y.useMemo)((()=>{const e=(0,f.orderBy)(Object.values(a),[e=>Number(e.id)],"asc");switch(p){case"all":return e;case"!all":return e.filter((e=>{var n,i;return null===(n=!(null!==e&&void 0!==e&&null!==(i=e.decks)&&void 0!==i&&i.length))||void 0===n||n}));case"nsfw":return e.filter((e=>e.nsfw));case"!nsfw":return e.filter((e=>!e.nsfw));default:return p.startsWith("!")?e.filter((e=>{var n;return!(null!==e&&void 0!==e&&null!==(n=e.decks)&&void 0!==n&&n.includes(p.slice(1)))})):e.filter((e=>{var n;return null===e||void 0===e||null===(n=e.decks)||void 0===n?void 0:n.includes(p)}))}}),[a,p]),v=(0,y.useMemo)((()=>{var e;const n=(0,f.orderBy)(Object.keys(c),[e=>Number(e)],"asc"),i=null===(e=g[g.length-1])||void 0===e?void 0:e.id,t=(0,f.orderBy)([...n,i],[e=>Number(e)],"desc")[0];return String(Number(t)+1)}),[g,c]);return(0,k.jsx)(S.Provider,{value:{items:a,listing:g,isLoading:s,error:l,decksDict:u,decks:h,hasResponseData:g.length>0,isDirty:m,addItemToUpdate:d,isSaving:o,save:r,itemsToUpdate:c,newId:v},children:i})},w=()=>(0,y.useContext)(S);var b=i(7134);var C=i(3834),N=i(4483),O=i(7747),P=i(8955),z=i(6324),D=i(2675);function T(e){let{item:n,editMode:i=!1,simplified:t}=e;const{decks:s}=w(),{isEditing:h,toggleEditMode:p,onEdit:x,isDirty:S,onModify:Z,onReset:z,editableItem:D}=function(e){var n;let i=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const{addItemToUpdate:t,itemsToUpdate:a}=w(),[s,l]=(0,y.useState)(i),[o,r]=(0,y.useState)((0,f.cloneDeep)(e)),d=null!==(n=a[e.id])&&void 0!==n?n:e,c=e=>{const n={...(0,f.cloneDeep)(o),...e};Object.keys(e).includes("nsfw")&&!1===e.nsfw&&delete n.nsfw,r(n)},m=async()=>{t(o.id,o)},u=()=>{r((0,f.cloneDeep)(e)),l(!1)},h=JSON.stringify(d)!==JSON.stringify(o);return{isEditing:s,toggleEditMode:()=>l((e=>!e)),editableItem:o,onEdit:c,isDirty:h,onModify:m,onReset:u}}(n,i),T=(0,b._)(),{is:E}=(0,j.K)();return(0,k.jsxs)(r.Z,{title:(0,k.jsx)(l.Z.Text,{onClick:()=>T(n.id),children:n.id}),extra:(0,k.jsx)(U,{item:n}),style:{maxWidth:250},size:t?"small":"default",actions:t?void 0:S?[(0,k.jsx)(C.Z,{onClick:z},"reset"),(0,k.jsx)(N.Z,{onClick:Z},"save")]:[(0,k.jsx)(O.Z,{onClick:p},"edit")],children:[(0,k.jsx)(v.ck,{id:n.id,width:t?75:125,title:"".concat(n.name.en," | ").concat(n.name.pt)}),(0,k.jsxs)(a.Z,{size:"small",direction:"vertical",className:"my-4",children:[(0,k.jsx)(d.Z,{prefix:(0,k.jsx)(g.H,{language:"en",width:"1em"}),placeholder:"Name in EN",variant:h?"outlined":"borderless",size:"small",defaultValue:n.name.en,readOnly:!h,onChange:e=>x({name:{...D.name,en:e.target.value}})},"en-".concat(n.name.en)),(0,k.jsx)(d.Z,{prefix:(0,k.jsx)(g.H,{language:"pt",width:"1em"}),placeholder:"Name in PT",variant:h?"outlined":"borderless",size:"small",defaultValue:n.name.pt,readOnly:!h,onChange:e=>x({name:{...D.name,pt:e.target.value}})},"pt-".concat(n.name.pt)),!t&&(0,k.jsxs)(k.Fragment,{children:[!E("simplified")&&(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)("div",{children:(0,k.jsx)(c.Z,{mode:"multiple",style:{width:"100%"},placeholder:"Select a deck",defaultValue:n.decks,disabled:!h,options:s,variant:h?"outlined":"borderless",size:"small",onChange:e=>x({decks:e.sort()})},String(n.decks))}),(0,k.jsxs)(o.Z,{gap:6,children:[(0,k.jsx)(g.H,{language:"en",width:"1em"}),(0,k.jsx)(c.Z,{mode:"tags",style:{width:"100%"},placeholder:"Other names EN",defaultValue:n.aliasesEn,options:[],size:"small",onChange:e=>x({aliasesEn:e.sort()})})]}),(0,k.jsxs)(o.Z,{gap:6,children:[(0,k.jsx)(g.H,{language:"pt",width:"1em"}),(0,k.jsx)(c.Z,{mode:"tags",style:{width:"100%"},placeholder:"Other names PT",defaultValue:n.aliasesPt,options:[],size:"small",onChange:e=>x({aliasesPt:e.sort()})})]})]}),E("showVerifyThing")&&(0,k.jsx)("div",{children:(0,k.jsx)(I,{item:n})}),(h||n.nsfw)&&(0,k.jsx)("div",{children:(0,k.jsx)(m.Z.Item,{label:"nsfw",valuePropName:"checked",children:(0,k.jsx)(u.Z,{checked:n.nsfw,onChange:e=>x({nsfw:e}),size:"small",checkedChildren:(0,k.jsx)(P.Z,{style:{color:"hotpink"}}),disabled:!h})})})]})]})]})}const E=(0,f.memoize)((e=>{var n,i;const t=!(null===(n=e.decks)||void 0===n||!n.includes("thing")),a=!(null===(i=e.decks)||void 0===i||!i.includes("manufactured")),s=1===e.name.en.split(" ").length,l=1===e.name.pt.split(" ").length,o={en:t||s&&a,pt:t||l&&a};return o.pt||o.en?(0,k.jsxs)(k.Fragment,{children:[o.en&&(0,k.jsx)(g.H,{language:"en",width:"1em"}),o.pt&&(0,k.jsx)(g.H,{language:"pt",width:"1em"})]}):""})),I=e=>{let{item:n}=e;const i=E(n);return i?(0,k.jsxs)(o.Z,{gap:6,children:["Thing: ",i]}):(0,k.jsx)(k.Fragment,{})};function U(e){let{item:n}=e;const[i,t]=(0,D.Z)(!1),s=(0,b._)();return(0,k.jsx)(h.Z,{content:(0,k.jsxs)(a.Z,{direction:"vertical",children:[(0,k.jsx)(p.ZP,{size:"small",onClick:()=>s(JSON.stringify(n,null,2)),children:"Complete Item"}),(0,k.jsx)(p.ZP,{size:"small",onClick:()=>s(n.name.en),children:"EN Name"}),(0,k.jsx)(p.ZP,{size:"small",onClick:()=>s(n.name.pt),children:"PT Name"}),(0,k.jsx)(p.ZP,{size:"small",onClick:()=>s(JSON.stringify((e=>({id:e.id,type:"item",header:{title:{en:"Item",pt:"Item"},iconId:"2077"},metadata:{level:"basic",keyword:(0,f.snakeCase)(e.name.en).toUpperCase()},content:{itemId:e.id,caption:e.name}}))(n),null,2)),children:"Escape Room Item"})]}),title:"Copy",trigger:"click",open:i,onOpenChange:t,children:(0,k.jsx)(p.ZP,{type:"text",icon:(0,k.jsx)(z.Z,{})})})}var R=i(4290),M=i(2228);function _(){var e;const{queryParams:n}=(0,j.K)(),i=null!==(e=n.get("deck"))&&void 0!==e?e:"all",{listing:t}=w(),{page:a,pagination:s}=(0,R.e)({data:t,resetter:i}),{is:r}=(0,j.K)(),d=r("simplified");return(0,k.jsxs)(k.Fragment,{children:[(0,k.jsxs)(l.Z.Title,{level:2,children:["Listing - ",(0,f.capitalize)(i)," items (",t.length,")"]}),(0,k.jsx)(M.N,{pagination:s,className:"full-width",children:(0,k.jsx)(o.Z,{gap:16,wrap:"wrap",children:a.map((e=>(0,k.jsx)(T,{item:e,simplified:d},e.id)))})})]})}var F=i(7128),B=i(8357),J=i(7018),L=i(7965),V=i(5850),K=i(7340),H=i(2164),q=i(959);const W={id:"",name:{en:"",pt:""},groups:[]};function A(e){let{isModalOpen:n,handleOk:i,handleCancel:t,newId:a}=e;const[s]=(0,y.useState)((0,f.cloneDeep)({...W,id:a}));return(0,k.jsx)(q.Z,{title:"Add new item",open:n,onOk:i,onCancel:t,children:(0,k.jsx)(T,{item:s,editMode:!0})})}function Q(){const[e,n]=(0,y.useState)(!1),{newId:i}=w();return(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(p.ZP,{block:!0,onClick:()=>{n(!0)},children:"Add New Item"}),e&&(0,k.jsx)(A,{isModalOpen:e,handleOk:()=>{n(!1)},handleCancel:()=>{n(!1)},newId:i},i)]})}function G(){var e;const{isDirty:n,save:i,items:t,decks:a,itemsToUpdate:s,isSaving:r}=w(),{queryParams:d,is:c,addParam:m}=(0,j.K)(),u=(0,y.useMemo)((()=>{const e=(0,f.orderBy)(a.map((e=>{let{value:n}=e;return{label:(0,f.capitalize)(n),value:n}})),"label"),n=e.map((e=>{let{label:n,value:i}=e;return{label:"NOT ".concat(n),value:"!".concat(i)}}));return[...e,...n]}),[a]);return(0,k.jsxs)(L.Pd,{children:[(0,k.jsxs)(o.Z,{vertical:!0,gap:6,children:[(0,k.jsx)(K.k,{isDirty:n,dirt:JSON.stringify(s),onSave:i,isSaving:r}),(0,k.jsx)(J.o,{data:()=>function(e){return(0,V.Tj)(Object.values(e).reduce(((e,n)=>{var i;return n.decks=(null!==(i=null===n||void 0===n?void 0:n.decks)&&void 0!==i?i:[]).sort(),0===n.decks.length&&delete n.decks,e[n.id]=n,e}),{}))}(t),fileName:"items.json",disabled:n,block:!0})]}),(0,k.jsx)(F.Z,{className:"my-4"}),(0,k.jsx)(l.Z.Text,{type:"secondary",children:"Tools"}),(0,k.jsx)(B.Do,{label:"Show Search",value:!c("hideSearch"),onChange:e=>m("hideSearch",e?"":"true",""),className:"full-width m-0"}),(0,k.jsx)(B.Do,{label:"Show Randomizer",value:c("showRandomizer"),onChange:e=>m("showRandomizer",e?"true":"",""),className:"full-width m-0"}),(0,k.jsx)(l.Z.Text,{type:"secondary",children:"Display"}),(0,k.jsx)(B.Do,{label:"Simplified UI",value:c("simplified"),onChange:e=>m("simplified",e?"true":""),className:"full-width m-0"}),(0,k.jsx)(B.Do,{label:"Thing Verifier",value:c("showVerifyThing"),onChange:e=>m("showVerifyThing",e?"true":""),className:"full-width m-0",disabled:c("simplified")}),(0,k.jsx)(B.Do,{label:"Other Names",value:c("showOtherNames"),onChange:e=>m("showOtherNames",e?"true":""),className:"full-width m-0",disabled:!0}),(0,k.jsx)(F.Z,{className:"my-4"}),(0,k.jsx)(B.zE,{label:"Deck",value:null!==(e=d.get("deck"))&&void 0!==e?e:"all",onChange:e=>m("deck",e,"all"),options:[{label:"All",value:"all"},{label:"NSFW",value:"nsfw"},{label:"SFW",value:"!nsfw"},...u,{label:"No decks",value:"!all"}]}),(0,k.jsx)(F.Z,{className:"my-4"}),(0,k.jsx)(Q,{}),(0,k.jsx)(F.Z,{className:"my-4"}),(0,k.jsx)(J.o,{data:()=>function(e){return(0,V.Tj)(Object.values((0,f.cloneDeep)(e)).reduce(((e,n)=>{const i={id:n.id,names:{"en-US":n.name.en,"pt-BR":n.name.pt},aliases:{"en-US":n.aliasesEn,"pt-BR":n.aliasesPt}};return e[i.id]=i,e}),{}))}(t),fileName:"items-gpt.json",disabled:n,block:!0,icon:(0,k.jsx)(H.Z,{}),children:"Open AI JSON"})]})}var X=i(4003),Y=i(1583),$=i(5657);function ee(){const{listing:e}=w(),[n,i]=(0,y.useState)([]),t=(0,b._)(),[s,r]=(0,y.useState)(5);return(0,k.jsxs)("div",{children:[(0,k.jsxs)(l.Z.Title,{level:2,children:["Randomized Sample"," ",(0,k.jsx)(p.ZP,{size:"small",icon:(0,k.jsx)($.Z,{}),onClick:()=>{const n=(0,f.chunk)((0,f.sampleSize)(e,15*s),s).map((e=>e.filter((e=>!e.nsfw)))).map((e=>e.map((e=>e.name.en)).join(", "))).map(((e,n)=>"".concat(n+1,") ").concat(e))).join("\n");t(n)},children:"MJ"})]}),(0,k.jsxs)(o.Z,{gap:12,children:[(0,k.jsx)(m.Z.Item,{label:"Quantity"}),(0,k.jsx)("div",{children:(0,k.jsx)(X.Z,{min:3,max:15,value:s,onChange:e=>r(Number(e)),style:{minWidth:"100px"}})}),(0,k.jsx)(p.ZP,{onClick:()=>{i((0,f.sampleSize)(e,s))},type:"primary",children:"Get Sample"}),(0,k.jsx)(Y.Z.Button,{menu:{items:[{label:"Copy IDs",key:"copy_ids"},{label:"Copy Names EN",key:"copy_names_en"},{label:"Copy Names PT",key:"copy_names_pt"}],onClick:e=>{let{key:i}=e;if("copy_ids"!==i)if("copy_names_en"!==i)if("copy_names_pt"!==i);else{const e=n.map((e=>e.name.pt)).join(", ");t(e)}else{const e=n.map((e=>e.name.en)).join(", ");t(e)}else{const e=n.map((e=>e.id));t(JSON.stringify(e))}}},disabled:0===n.length,onClick:()=>t(JSON.stringify(n,null,2)),icon:(0,k.jsx)($.Z,{}),children:"Copy"})]}),(0,k.jsx)(a.Z,{wrap:!0,className:"my-4",children:n.map((e=>(0,k.jsx)(T,{item:e,simplified:!0},e.id)))}),(0,k.jsx)(F.Z,{})]})}var ne=i(8178),ie=i(881);function te(){const{items:e,isLoading:n,isSaving:i}=w(),[t,s]=(0,y.useState)(null),{queryParams:o,addParam:r}=(0,j.K)();return(0,k.jsxs)(y.Fragment,{children:[(0,k.jsx)(l.Z.Title,{level:2,children:"Search for an item"}),(0,k.jsx)("div",{children:(0,k.jsx)(ne.i,{items:e,isPending:n||i,onFinish:n=>s(e[n])})}),Boolean(t)&&(0,k.jsxs)(a.Z,{direction:"vertical",className:"my-4",children:[(0,k.jsx)(T,{item:t}),(0,k.jsx)(p.ZP,{onClick:()=>{if(t){var e;const n=Number(null!==(e=o.get("pageSize"))&&void 0!==e?e:64),i=Number(t.id),a=Math.floor(i/n)+1;r("page",a.toString())}},block:!0,icon:(0,k.jsx)(ie.Z,{}),children:"Find in listing"})]},null===t||void 0===t?void 0:t.id),(0,k.jsx)(F.Z,{})]},"item-search-".concat(n))}var ae=i(4562);function se(){const{isLoading:e,error:n,hasResponseData:i}=w(),{is:l}=(0,j.K)();return(0,k.jsx)(L.Xg,{title:"Items",subtitle:"Listing",children:(0,k.jsxs)(t.Z,{hasSider:!0,children:[(0,k.jsx)(ae.p,{children:(0,k.jsx)(G,{})}),(0,k.jsx)(t.Z.Content,{className:"content",children:(0,k.jsxs)(s.T,{isLoading:e,error:n,hasResponseData:i,children:[!e&&(0,k.jsxs)(a.Z,{size:"large",align:"start",children:[!l("hideSearch")&&(0,k.jsx)(te,{}),l("showRandomizer")&&(0,k.jsx)(ee,{})]}),(0,k.jsx)(_,{})]})})]})})}const le=function(){return(0,k.jsx)(Z,{children:(0,k.jsx)(se,{})})}}}]);
//# sourceMappingURL=Items.4f791137.chunk.js.map