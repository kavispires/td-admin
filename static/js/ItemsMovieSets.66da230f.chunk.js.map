{"version":3,"file":"static/js/ItemsMovieSets.66da230f.chunk.js","mappings":"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","sources":["components/Common/DownloadButton.tsx","components/Items/ItemsTypeahead.tsx","hooks/useCopyToClipboardFunction.ts","components/Items/ItemsMoviesFilters.tsx","../node_modules/@ant-design/icons-svg/es/asn/DeleteFilled.js","../node_modules/@ant-design/icons/es/icons/DeleteFilled.js","components/Items/ItemsMoviesTable.tsx","pages/Items/ItemsMovieSets.tsx","../node_modules/string-similarity/src/index.js","../node_modules/clsx/dist/clsx.mjs"],"sourcesContent":["import { Button, ButtonProps } from 'antd';\nimport { downloadObjectAsFile } from 'utils';\n\ntype DownloadButtonProps = {\n  data: PlainObject | Function;\n  fileName: string;\n} & ButtonProps;\n\n/**\n * Button to download a JSON object as a file\n */\nexport function DownloadButton({ data, fileName, loading, ...props }: DownloadButtonProps) {\n  return (\n    <Button\n      onClick={() => downloadObjectAsFile(typeof data === 'function' ? data() : data, fileName)}\n      loading={loading}\n      {...props}\n    >\n      Download JSON\n    </Button>\n  );\n}\n","import { AutoComplete, AutoCompleteProps, Input } from 'antd';\nimport { useTDResource } from 'hooks/useTDResource';\nimport { orderBy } from 'lodash';\nimport { useMemo, useState } from 'react';\nimport { Item } from 'types';\n\ntype ItemsTypeaheadProps = {\n  items?: Dictionary<Item>;\n  isPending?: boolean;\n  onFinish: (id: string) => void;\n} & Omit<AutoCompleteProps, 'options'>;\n\nexport function ItemsTypeahead({\n  items,\n  isPending,\n  style,\n  size,\n  placeholder,\n  allowClear,\n  onFinish,\n  ...rest\n}: ItemsTypeaheadProps) {\n  const tdrItemsQuery = useTDResource<Item>('items', !Boolean(items) && !isPending);\n\n  const { namesDict, options } = useMemo(() => {\n    console.log('Recomputing item names typeahead...');\n\n    const namesDict = Object.values(items ?? tdrItemsQuery.data ?? {}).reduce(\n      (acc: Dictionary<string>, entry) => {\n        const nameEn = `${entry.name.en} (${entry.id})`;\n        const namePt = `${entry.name.pt} (${entry.id})`;\n        acc[nameEn] = entry.id;\n        acc[namePt] = entry.id;\n        return acc;\n      },\n      {}\n    );\n\n    const options = orderBy(Object.keys(namesDict), [(name) => name.toLowerCase()]).map((name) => ({\n      value: name,\n    }));\n\n    return { namesDict, options };\n  }, [items, isPending]); // eslint-disable-line react-hooks/exhaustive-deps\n\n  const [filteredOptions, setFilteredOptions] = useState<{ value: string }[]>([]);\n\n  const handleSearch = (searchText: string) => {\n    const SEARCH = searchText.trim();\n    const filtered = options.filter((option) =>\n      String(option?.value ?? '')\n        .toUpperCase()\n        .includes(SEARCH)\n    );\n    const sorted = orderBy(filtered, [\n      (option) => {\n        const value = String(option?.value ?? '');\n        if (value.includes(`${SEARCH} `)) return -1;\n        const index = value.toUpperCase().indexOf(SEARCH);\n        return index === 0 ? -1 : index === -1 ? value.length : index;\n      },\n    ]);\n    setFilteredOptions(sorted);\n  };\n\n  const handlePressEnter = () => {\n    if (filteredOptions.length > 0) {\n      const key = filteredOptions[0].value;\n      if (namesDict[key] !== undefined) {\n        onFinish(namesDict[key]);\n      }\n    }\n  };\n\n  const onSelect = (key: any) => {\n    if (namesDict[key] !== undefined) {\n      onFinish(namesDict[key]);\n    }\n  };\n\n  return (\n    <AutoComplete\n      options={options}\n      style={{ width: 250, ...style }}\n      allowClear={allowClear ?? true}\n      placeholder={placeholder ?? 'Search by name or id...'}\n      filterOption={(inputValue, option) =>\n        String(option?.value ?? '')\n          .toUpperCase()\n          .indexOf(inputValue?.toUpperCase()) !== -1\n      }\n      onSearch={handleSearch}\n      notFoundContent=\"No items found\"\n      onSelect={onSelect}\n      {...rest}\n    >\n      <Input onPressEnter={handlePressEnter} />\n    </AutoComplete>\n  );\n}\n","import { App } from 'antd';\nimport { truncate } from 'lodash';\nimport { useEffect } from 'react';\nimport { useCopyToClipboard } from 'react-use';\n\nexport function useCopyToClipboardFunction() {\n  const [state, copyToClipboard] = useCopyToClipboard();\n  const { message } = App.useApp();\n\n  useEffect(() => {\n    if (state.value) {\n      if (state.value.length > 20) {\n        message.info(`Copied to clipboard: ${truncate(state.value, { length: 30, omission: '...' })}`);\n      } else {\n        message.success('Copied');\n      }\n    }\n  }, [state, message]);\n\n  return copyToClipboard;\n}\n","import { Button, Flex } from 'antd';\nimport { DownloadButton } from 'components/Common/DownloadButton';\nimport { SiderContent } from 'components/Layout';\nimport { UseResourceFirebaseDataReturnType } from 'hooks/useResourceFirebaseData';\nimport { DailyMovieSet } from 'types';\nimport { sortJsonKeys } from 'utils';\n\nexport function ItemsMoviesFilters({\n  data,\n  save,\n  isDirty,\n  isSaving,\n}: UseResourceFirebaseDataReturnType<DailyMovieSet>) {\n  return (\n    <SiderContent>\n      <Flex vertical gap={12}>\n        <Button\n          block\n          danger\n          type=\"primary\"\n          loading={isSaving}\n          disabled={!isDirty}\n          onClick={save}\n          size=\"large\"\n        >\n          Save\n        </Button>\n        <DownloadButton\n          data={() => prepareFileForDownload(data)}\n          fileName=\"daily-movie-sets.json\"\n          disabled={isDirty}\n          block\n        />\n      </Flex>\n    </SiderContent>\n  );\n}\nfunction prepareFileForDownload(movies: Dictionary<DailyMovieSet>) {\n  return sortJsonKeys(movies);\n}\n","// This icon file is generated automatically.\nvar DeleteFilled = { \"icon\": { \"tag\": \"svg\", \"attrs\": { \"viewBox\": \"64 64 896 896\", \"focusable\": \"false\" }, \"children\": [{ \"tag\": \"path\", \"attrs\": { \"d\": \"M864 256H736v-80c0-35.3-28.7-64-64-64H352c-35.3 0-64 28.7-64 64v80H160c-17.7 0-32 14.3-32 32v32c0 4.4 3.6 8 8 8h60.4l24.7 523c1.6 34.1 29.8 61 63.9 61h454c34.2 0 62.3-26.8 63.9-61l24.7-523H888c4.4 0 8-3.6 8-8v-32c0-17.7-14.3-32-32-32zm-200 0H360v-72h304v72z\" } }] }, \"name\": \"delete\", \"theme\": \"filled\" };\nexport default DeleteFilled;\n","import _extends from \"@babel/runtime/helpers/esm/extends\";\n// GENERATE BY ./scripts/generate.ts\n// DON NOT EDIT IT MANUALLY\n\nimport * as React from 'react';\nimport DeleteFilledSvg from \"@ant-design/icons-svg/es/asn/DeleteFilled\";\nimport AntdIcon from \"../components/AntdIcon\";\nvar DeleteFilled = function DeleteFilled(props, ref) {\n  return /*#__PURE__*/React.createElement(AntdIcon, _extends({}, props, {\n    ref: ref,\n    icon: DeleteFilledSvg\n  }));\n};\n\n/**![delete](data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNTAiIGhlaWdodD0iNTAiIGZpbGw9IiNjYWNhY2EiIHZpZXdCb3g9IjY0IDY0IDg5NiA4OTYiIGZvY3VzYWJsZT0iZmFsc2UiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PHBhdGggZD0iTTg2NCAyNTZINzM2di04MGMwLTM1LjMtMjguNy02NC02NC02NEgzNTJjLTM1LjMgMC02NCAyOC43LTY0IDY0djgwSDE2MGMtMTcuNyAwLTMyIDE0LjMtMzIgMzJ2MzJjMCA0LjQgMy42IDggOCA4aDYwLjRsMjQuNyA1MjNjMS42IDM0LjEgMjkuOCA2MSA2My45IDYxaDQ1NGMzNC4yIDAgNjIuMy0yNi44IDYzLjktNjFsMjQuNy01MjNIODg4YzQuNCAwIDgtMy42IDgtOHYtMzJjMC0xNy43LTE0LjMtMzItMzItMzJ6bS0yMDAgMEgzNjB2LTcyaDMwNHY3MnoiIC8+PC9zdmc+) */\nvar RefIcon = /*#__PURE__*/React.forwardRef(DeleteFilled);\nif (process.env.NODE_ENV !== 'production') {\n  RefIcon.displayName = 'DeleteFilled';\n}\nexport default RefIcon;","import { Button, Flex, Popconfirm, Space, Table, Typography } from 'antd';\n\nimport { useCopyToClipboardFunction } from 'hooks/useCopyToClipboardFunction';\nimport { UseResourceFirebaseDataReturnType } from 'hooks/useResourceFirebaseData';\nimport { orderBy } from 'lodash';\nimport { DailyMovieSet, type Item as ItemT } from 'types';\nimport { removeDuplicates } from 'utils';\n\nimport type { TableProps } from 'antd';\nimport { ItemsTypeahead } from './ItemsTypeahead';\nimport { DeleteFilled } from '@ant-design/icons';\nimport { useTDResource } from 'hooks/useTDResource';\nimport { Item } from 'components/Sprites';\nfunction orderSets(givenSets: DailyMovieSet[]) {\n  return orderBy(givenSets, [\n    // (s) => removeDuplicates(s.itemsIds).filter(Boolean).length > 0,\n    (s) => s.title,\n  ]).map((s) => ({\n    ...s,\n    itemsIds: orderBy(s.itemsIds, (id) => Number(id)),\n  }));\n}\n\nexport function ItemsMoviesTable({\n  data,\n  addEntryToUpdate,\n}: UseResourceFirebaseDataReturnType<DailyMovieSet>) {\n  const sets = data ? orderSets(Object.values(data)) : [];\n  const copyToClipboard = useCopyToClipboardFunction();\n  const itemsTypeaheadQuery = useTDResource<ItemT>('items');\n\n  const columns: TableProps<DailyMovieSet>['columns'] = [\n    {\n      title: 'Title',\n      dataIndex: 'title',\n      // key: 'title',\n      render: (title) => <span key={title}>{title}</span>,\n    },\n    {\n      title: 'Year',\n      dataIndex: 'year',\n      // key: 'year',\n      render: (year) => <span>{year}</span>,\n    },\n    Table.EXPAND_COLUMN,\n    {\n      title: 'Items',\n      dataIndex: 'itemsIds',\n      key: 'itemsIds',\n      render: (itemsIds: string[], record) => (\n        <Flex gap={6} wrap=\"wrap\" key={`items-${record.title}`}>\n          {itemsIds.map((itemId) => (\n            <Flex key={`${record.title}-${itemId}`} gap={2} vertical>\n              <Item id={itemId} width={60} />\n              <Flex justify=\"center\">\n                <Typography.Text onClick={() => copyToClipboard(itemId)}>{itemId}</Typography.Text>\n                <RemoveItemFlow movie={record} addEntryToUpdate={addEntryToUpdate} itemId={itemId} />\n              </Flex>\n            </Flex>\n          ))}\n        </Flex>\n      ),\n    },\n    {\n      title: 'Count',\n      dataIndex: 'itemsIds',\n      // key: 'count',\n      render: (itemsIds: string[]) => removeDuplicates(itemsIds).filter(Boolean).length,\n    },\n  ];\n\n  return (\n    <Space direction=\"vertical\">\n      <Table\n        columns={columns}\n        rowKey=\"id\"\n        dataSource={sets}\n        expandable={{\n          expandedRowRender: (record) => <AddItemFlow movie={record} addEntryToUpdate={addEntryToUpdate} />,\n          rowExpandable: () => itemsTypeaheadQuery.isSuccess,\n        }}\n      />\n    </Space>\n  );\n}\n\ntype AddItemFlowProps = {\n  movie: DailyMovieSet;\n  addEntryToUpdate: (id: string, item: DailyMovieSet) => void;\n};\n\nfunction AddItemFlow({ movie, addEntryToUpdate }: AddItemFlowProps) {\n  const onUpdate = (itemId: string) => {\n    addEntryToUpdate(movie.id, {\n      ...movie,\n      itemsIds: [...movie.itemsIds, itemId],\n    });\n  };\n\n  return (\n    <div>\n      <ItemsTypeahead onFinish={onUpdate} />\n    </div>\n  );\n}\n\ntype RemoveItemFlowProps = {\n  movie: DailyMovieSet;\n  addEntryToUpdate: (id: string, item: DailyMovieSet) => void;\n  itemId: string;\n};\n\nfunction RemoveItemFlow({ movie, addEntryToUpdate, itemId }: RemoveItemFlowProps) {\n  const onRemove = () => {\n    addEntryToUpdate(movie.id, {\n      ...movie,\n      itemsIds: movie.itemsIds.filter((id) => id !== itemId),\n    });\n  };\n\n  return (\n    <Popconfirm\n      title=\"Are you sure you want to remove this item?\"\n      onConfirm={onRemove}\n      okText=\"Yes\"\n      cancelText=\"No\"\n    >\n      <Button icon={<DeleteFilled />} size=\"small\" type=\"text\" ghost />\n    </Popconfirm>\n  );\n}\n","import { Layout } from 'antd';\nimport { DataLoadingWrapper } from 'components/DataLoadingWrapper';\nimport { ItemsMoviesFilters } from 'components/Items/ItemsMoviesFilters';\nimport { ItemsMoviesTable } from 'components/Items/ItemsMoviesTable';\nimport { PageLayout } from 'components/Layout';\nimport { PageSider } from 'components/Layout/PageSider';\nimport { useResourceFirebaseData } from 'hooks/useResourceFirebaseData';\nimport { isEmpty } from 'lodash';\nimport { DailyMovieSet } from 'types';\n\nexport function ItemsMovieSets() {\n  const moviesData = useResourceFirebaseData<DailyMovieSet>({\n    tdrResourceName: 'daily-movie-sets',\n    firebaseDataCollectionName: 'movieSets',\n  });\n\n  return (\n    <PageLayout title=\"Items\" subtitle=\"Movie Sets\">\n      <Layout hasSider>\n        <PageSider>\n          <ItemsMoviesFilters {...moviesData} />\n        </PageSider>\n\n        <Layout.Content className=\"content\">\n          <DataLoadingWrapper\n            isLoading={moviesData.isLoading}\n            error={moviesData.error}\n            hasResponseData={!isEmpty(moviesData.data)}\n          >\n            <ItemsMoviesTable {...moviesData} />\n          </DataLoadingWrapper>\n        </Layout.Content>\n      </Layout>\n    </PageLayout>\n  );\n}\n\nexport default ItemsMovieSets;\n","module.exports = {\n\tcompareTwoStrings:compareTwoStrings,\n\tfindBestMatch:findBestMatch\n};\n\nfunction compareTwoStrings(first, second) {\n\tfirst = first.replace(/\\s+/g, '')\n\tsecond = second.replace(/\\s+/g, '')\n\n\tif (first === second) return 1; // identical or empty\n\tif (first.length < 2 || second.length < 2) return 0; // if either is a 0-letter or 1-letter string\n\n\tlet firstBigrams = new Map();\n\tfor (let i = 0; i < first.length - 1; i++) {\n\t\tconst bigram = first.substring(i, i + 2);\n\t\tconst count = firstBigrams.has(bigram)\n\t\t\t? firstBigrams.get(bigram) + 1\n\t\t\t: 1;\n\n\t\tfirstBigrams.set(bigram, count);\n\t};\n\n\tlet intersectionSize = 0;\n\tfor (let i = 0; i < second.length - 1; i++) {\n\t\tconst bigram = second.substring(i, i + 2);\n\t\tconst count = firstBigrams.has(bigram)\n\t\t\t? firstBigrams.get(bigram)\n\t\t\t: 0;\n\n\t\tif (count > 0) {\n\t\t\tfirstBigrams.set(bigram, count - 1);\n\t\t\tintersectionSize++;\n\t\t}\n\t}\n\n\treturn (2.0 * intersectionSize) / (first.length + second.length - 2);\n}\n\nfunction findBestMatch(mainString, targetStrings) {\n\tif (!areArgsValid(mainString, targetStrings)) throw new Error('Bad arguments: First argument should be a string, second should be an array of strings');\n\t\n\tconst ratings = [];\n\tlet bestMatchIndex = 0;\n\n\tfor (let i = 0; i < targetStrings.length; i++) {\n\t\tconst currentTargetString = targetStrings[i];\n\t\tconst currentRating = compareTwoStrings(mainString, currentTargetString)\n\t\tratings.push({target: currentTargetString, rating: currentRating})\n\t\tif (currentRating > ratings[bestMatchIndex].rating) {\n\t\t\tbestMatchIndex = i\n\t\t}\n\t}\n\t\n\t\n\tconst bestMatch = ratings[bestMatchIndex]\n\t\n\treturn { ratings: ratings, bestMatch: bestMatch, bestMatchIndex: bestMatchIndex };\n}\n\nfunction areArgsValid(mainString, targetStrings) {\n\tif (typeof mainString !== 'string') return false;\n\tif (!Array.isArray(targetStrings)) return false;\n\tif (!targetStrings.length) return false;\n\tif (targetStrings.find( function (s) { return typeof s !== 'string'})) return false;\n\treturn true;\n}\n","function r(e){var t,f,n=\"\";if(\"string\"==typeof e||\"number\"==typeof e)n+=e;else if(\"object\"==typeof e)if(Array.isArray(e)){var o=e.length;for(t=0;t<o;t++)e[t]&&(f=r(e[t]))&&(n&&(n+=\" \"),n+=f)}else for(f in e)e[f]&&(n&&(n+=\" \"),n+=f);return n}export function clsx(){for(var e,t,f=0,n=\"\",o=arguments.length;f<o;f++)(e=arguments[f])&&(t=r(e))&&(n&&(n+=\" \"),n+=t);return n}export default clsx;"],"names":["DownloadButton","data","fileName","loading","props","onClick","downloadObjectAsFile","ItemsTypeahead","items","isPending","style","size","placeholder","allowClear","onFinish","rest","tdrItemsQuery","useTDResource","Boolean","namesDict","options","useMemo","console","log","Object","values","reduce","acc","entry","nameEn","name","en","id","namePt","pt","orderBy","keys","toLowerCase","map","value","filteredOptions","setFilteredOptions","useState","width","filterOption","inputValue","option","String","toUpperCase","indexOf","onSearch","searchText","SEARCH","trim","filtered","filter","includes","sorted","index","length","notFoundContent","onSelect","key","undefined","onPressEnter","useCopyToClipboardFunction","state","copyToClipboard","useCopyToClipboard","message","App","useEffect","info","truncate","omission","success","ItemsMoviesFilters","save","isDirty","isSaving","vertical","gap","block","danger","type","disabled","prepareFileForDownload","movies","sortJsonKeys","DeleteFilled","ref","React","AntdIcon","_extends","icon","DeleteFilledSvg","ItemsMoviesTable","addEntryToUpdate","sets","givenSets","s","title","itemsIds","Number","itemsTypeaheadQuery","columns","dataIndex","render","year","Table","record","wrap","itemId","justify","RemoveItemFlow","movie","removeDuplicates","direction","rowKey","dataSource","expandable","expandedRowRender","AddItemFlow","rowExpandable","isSuccess","onConfirm","okText","cancelText","ghost","ItemsMovieSets","moviesData","useResourceFirebaseData","tdrResourceName","firebaseDataCollectionName","subtitle","hasSider","PageSider","className","DataLoadingWrapper","isLoading","error","hasResponseData","isEmpty","compareTwoStrings","first","second","replace","firstBigrams","Map","i","bigram","substring","count","has","get","set","intersectionSize","module","exports","findBestMatch","mainString","targetStrings","Array","isArray","find","areArgsValid","Error","ratings","bestMatchIndex","currentTargetString","currentRating","push","target","rating","bestMatch","r","e","t","f","n","o","arguments"],"sourceRoot":""}