"use strict";(self.webpackChunktd_admin=self.webpackChunktd_admin||[]).push([[5404],{8158:(e,t,s)=>{s.d(t,{CQ:()=>g,bN:()=>p,cw:()=>x,hW:()=>h,xL:()=>m});var i=s(2061),a=s(2252),r=s(1310),n=s(2997),l=s(8955),o=s(5458),d=s(1087),u=s(7134),c=s(184);function m(e){let{item:t,width:s,className:i}=e;return(0,c.jsx)(n.ck,{id:t.id,width:s,title:"".concat(t.name.en," | ").concat(t.name.pt),className:i})}function p(e){let{item:t}=e;const s=(0,u._)();return(0,c.jsx)("span",{children:(0,c.jsx)(i.Z,{prefix:t.nsfw?(0,c.jsx)(l.Z,{style:{color:"hotPink"}}):(0,c.jsx)(o.Z,{}),placeholder:"Id",variant:"borderless",size:"small",value:t.id,readOnly:!0,style:{width:"8ch"},onClick:()=>s(t.id)})})}function g(e){let{item:t,language:s}=e;return(0,c.jsx)(i.Z,{prefix:(0,c.jsx)(r.H,{language:s,width:"1em"}),placeholder:"Name in ".concat(s.toUpperCase()),variant:"borderless",size:"small",value:t.name[s],readOnly:!0})}function h(e){let{item:t}=e;return t.nsfw?(0,c.jsx)(l.Z,{style:{color:"hotpink"}}):(0,c.jsx)(c.Fragment,{})}function x(e){let{item:t}=e;const[,s]=(0,d.lr)();return(0,c.jsx)("span",{children:(0,c.jsx)(a.ZP,{size:"small",shape:"round",onClick:()=>{s({itemId:t.id,view:"classifier"})},children:"Go to"})})}},3846:(e,t,s)=>{s.r(t),s.d(t,{default:()=>He});var i=s(1790),a=s(2128),r=s(1087);function n(){var e;const[t,s]=(0,r.lr)();return{view:null!==(e=t.get("view"))&&void 0!==e?e:"classifier",setView:e=>s({view:e}),addQueryParam:(e,i)=>{t.set(e,"".concat(i)),s(t)},removeQueryParam:e=>{t.delete(e),s(t)},searchParams:t}}var l=s(6473),o=s(945),d=s(2252),u=s(7305),c=s(4520),m=s(7128),p=s(1046),g=s(4747),h=s(763),x=s(2791),b=s(5850),j=s(3713),v=s(8027),y=s(5529),f=s(2233);const I={};var Z=s(184);const C=(0,x.createContext)({getItem:()=>(0,b.VL)(),getItemAttributeValues:()=>(0,b.dK)(),isLoading:!0,error:null,hasResponseData:!1,isDirty:!1,jumpToItem:()=>{},activeItem:(0,b.VL)(),itemAttributeValues:(0,b.dK)(),onAttributeChange:()=>{},isSaving:!1,save:()=>{},attributesList:[],availableItemIds:[],addAttributesToUpdate:()=>{},addMultipleAttributesToUpdate:()=>{},prepareItemsAttributesFileForDownload:()=>({}),attributes:{},attributesToUpdate:{}}),N=e=>{let{children:t}=e;const{getItem:s,getItemAttributeValues:i,availableItemIds:a,isLoading:r,error:n,isSaving:l,save:o,addAttributesToUpdate:d,isDirty:u,attributes:c,addMultipleAttributesToUpdate:m,attributesToUpdate:p}=function(){var e;const{notification:t,message:s}=g.Z.useApp(),i=(0,j.NL)(),a=(0,y.N)("items"),r=(0,y.N)("items-attributes"),n=(0,y.N)("items-attribute-values"),l=(0,v.X)("tdr","itemsAttributeValues",{select:b.d_}),[o,d]=(0,x.useState)({}),u=(0,f.B)("tdr","itemsAttributeValues",{onSuccess:()=>{t.success({message:"itemsAttributeValues updated"}),i.refetchQueries({queryKey:["firebase","tdr","itemsAttributeValues"]}),d({})},onError:e=>{t.error({message:"itemsAttributeValues update failed",description:e.message})}}),c=(0,x.useMemo)((()=>{var e,t;return{...null!==(e=n.data)&&void 0!==e?e:{},...null!==(t=l.data)&&void 0!==t?t:{}}}),[n.data,l.data]),m=!(0,h.isEmpty)(o),p=l.data;return{availableItemIds:(0,x.useMemo)((()=>{var e;const t=null!==(e=a.data)&&void 0!==e?e:{};return(0,h.orderBy)(Object.keys(t).filter((e=>{var s,i;return(null!==(s=null===(i=t[e])||void 0===i?void 0:i.decks)&&void 0!==s?s:[]).includes("alien")})),(e=>Number(e)),"asc")}),[a.data]),getItem:e=>{var t,i;return null!==(t=null!==(i=a.data)&&void 0!==i?i:{})&&void 0!==t&&t[e]?a.data[e]:(e&&s.info("Item ".concat(e," not found in TDR. Creating a new item...")),(0,b.VL)({id:e}))},getItemAttributeValues:e=>{var t,s,i;const a=null!==(t=null===c||void 0===c?void 0:c[e])&&void 0!==t?t:{},r=null!==(s=o[e])&&void 0!==s?s:{};return(0,h.isEmpty)(a)&&(0,h.isEmpty)(r)?(I[e]=(0,b.dK)({id:e}),I[e]):(0,h.merge)(null!==(i=null===I||void 0===I?void 0:I[e])&&void 0!==i?i:{},a,r)},attributes:null!==(e=r.data)&&void 0!==e?e:{},isLoading:a.isLoading||r.isLoading||n.isLoading||l.isLoading,error:a.error||r.error||n.error||l.error,firebaseData:p,isSaving:u.isPending,save:()=>{u.mutate((0,b.aS)({...p,...o}))},addAttributesToUpdate:(e,t)=>{d((s=>({...s,[e]:{...t,updatedAt:Date.now()}})))},addMultipleAttributesToUpdate:e=>{d((t=>({...t,...(0,h.mapKeys)(e.map((e=>({...e,updatedAt:Date.now()}))),"id")})))},attributesToUpdate:o,isDirty:m}}(),{message:N}=g.Z.useApp(),[P,w]=(0,x.useState)((0,h.random)(0,a.length-1)),S=s(a[P]),T=i(S.id),E=(0,x.useMemo)((()=>(0,h.orderBy)(Object.values(c),"name.en","asc")),[c]);return(0,Z.jsx)(C.Provider,{value:{getItem:s,getItemAttributeValues:i,availableItemIds:a,isLoading:r,error:n,hasResponseData:a.length>0&&!(0,h.isEmpty)(c),isDirty:u,itemAttributeValues:T,jumpToItem:(e,t)=>{if("next"!==e)if("previous"!==e)if("random"!==e)if("first"!==e)if("last"!==e)if("next10"!==e)if("previous10"!==e)if("incomplete"!==e){if("goTo"===e&&void 0!==t){const e=a.indexOf(t);if(-1!==e)return void w(e);N.error("Item ".concat(t," is not available for attribution."))}}else w((e=>{let t=e+1;for(;t<a.length;){const s=i(a[t]);if(Object.keys(s.attributes).length!==E.length)return t;if(t===a.length-1)return N.info("No more incomplete items found."),e;t++}return e}));else w((e=>(e-10+a.length)%a.length));else w((e=>(e+10)%a.length));else w(a.length-1);else w(0);else w((0,h.random)(0,a.length-1));else w((e=>(e-1+a.length)%a.length));else w((e=>(e+1)%a.length))},activeItem:S,onAttributeChange:(e,t)=>{d(S.id,{...T,attributes:{...T.attributes,[e]:t}})},isSaving:l,save:o,attributes:c,attributesList:E,addAttributesToUpdate:d,addMultipleAttributesToUpdate:m,prepareItemsAttributesFileForDownload:()=>(0,b.Tj)(a.reduce(((e,t)=>{const s=i(t);return(0,h.isEmpty)(s.attributes)||(Object.keys(s.attributes).length===E.length?s.complete=!0:delete s.complete,e[s.id]=s),e}),{})),attributesToUpdate:p},children:t})},P=()=>(0,x.useContext)(C);var w=s(4424),S=s(1431),T=s(9501),E=s(8835),A=s(6591);const k=[{label:"Opposite",value:A.NL.OPPOSITE},{label:"Unrelated",value:A.NL.UNRELATED},{label:"Unclear",value:A.NL.UNCLEAR},{label:"Related",value:A.NL.RELATED},{label:"Deterministic",value:A.NL.DETERMINISTIC}],L=[{label:"Opposite",value:A.NL.OPPOSITE},{label:"Unrelated",value:A.NL.UNRELATED},{label:"Unclear",value:A.NL.UNCLEAR},{label:"Related",value:A.NL.RELATED},{label:"Deterministic",value:A.NL.DETERMINISTIC,disabled:!0}];function D(e){let{attribute:t,value:s,onChange:i,onlyButtons:a,size:r}=e;return t?a?(0,Z.jsx)(w.ZP.Group,{options:t.limited?L:k,onChange:e=>{let{target:{value:s}}=e;return i(t.id,s)},value:s,optionType:"button",buttonStyle:"solid",size:r}):(0,Z.jsxs)("div",{className:"attribute-button-container__row",children:[(0,Z.jsxs)("span",{className:"attribute-button-container__label",children:[t.name.en," ",(0,Z.jsx)(S.Z,{title:t.description.en,children:(0,Z.jsx)(T.Z,{})})]}),(0,Z.jsx)(w.ZP.Group,{options:t.limited?L:k,onChange:e=>{let{target:{value:s}}=e;return i(t.id,s)},value:s,optionType:"button",buttonStyle:"solid",size:r}),(0,Z.jsx)("span",{children:(0,Z.jsx)(E.Z,{style:{color:s&&s>7?"green":"transparent"}})})]},t.id):(0,Z.jsx)(Z.Fragment,{})}var U=s(3733),M=s(8357),O=s(2997);function z(e){let{itemAttributeValues:t,attributes:s}=e;const{searchParams:i,addQueryParam:a}=n(),r="true"===i.get("showUnclear"),l="true"===i.get("showUnrelated"),o=(0,x.useMemo)((()=>(0,b.tt)((0,b.Mg)(t,s),r,l)),[t,s,r,l]),d="true"===i.get("signs")?F:V;return(0,Z.jsxs)(c.Z,{gap:6,vertical:!0,children:[(0,Z.jsx)(M.Do,{label:"Show Unrelated",value:"true"===i.get("showUnrelated"),onChange:e=>a("showUnrelated",e?"true":""),className:"full-width m-0"}),(0,Z.jsx)(M.Do,{label:"Show Unclear",value:"true"===i.get("showUnclear"),onChange:e=>a("showUnclear",e?"true":""),className:"full-width m-0"}),(0,Z.jsx)(M.Do,{label:"Alien Sings",value:"true"===i.get("signs"),onChange:e=>a("signs",e?"true":""),className:"full-width m-0"}),(0,Z.jsx)(c.Z,{gap:6,wrap:"wrap",className:"item-attribute-value-statement",children:o.map(((e,t,i)=>(0,Z.jsx)(d,{keyVariant:e,attributes:s,firstElement:0===t,lastElement:t===i.length-1},e)))})]})}function F(e){let{keyVariant:t,attributes:s,withText:i}=e;const{key:a,className:r,text:n}=(0,b.sB)(t);return(0,Z.jsxs)(c.Z,{vertical:!0,align:"center",children:[(0,Z.jsx)(O.o$,{width:50,id:s[a].spriteId,className:(0,U.Z)("item-attribute-alien-sign","item-attribute-alien-sign--".concat(r))}),i&&(0,Z.jsxs)(c.Z,{wrap:"wrap",justify:"center",align:"center",style:{maxWidth:50,textAlign:"center",wordBreak:"break-word"},children:[n," ",s[a].name.en.toLowerCase()]})]})}function V(e){let{keyVariant:t,attributes:s,firstElement:i,lastElement:a}=e;const{key:r,text:n}=(0,b.sB)(t),l=i?"It's ":"",o=a?".":", ";return(0,Z.jsxs)(Z.Fragment,{children:[l,n," ",s[r].name.en.toLowerCase(),o]})}var R=s(1532),Q=s(4587),G=s(952);function B(e){let{label:t,children:s}=e;return(0,Z.jsxs)(o.Z.Text,{children:[t," ",(0,Z.jsx)(G.Z,{children:s})]})}function _(e){let{attributesList:t,itemAttributeValues:s}=e;const{completion:i,isDeterministic:a,value:r,isOpposing:n,relevancy:l}=(0,x.useMemo)((()=>{const e=t.length,i=Object.keys(s.attributes).length,a=Math.floor(i/e*100);let r=!1,n=!1,l=0;const o=Object.values(s.attributes).reduce(((e,t)=>t<=0?(t===A.NL.UNCLEAR&&(l+=1),t===A.NL.OPPOSITE&&(n=!0,e+=t/2),e):(t===A.NL.DETERMINISTIC&&(r=!0),e+t)),0),d=Math.floor((i-l)/e*100);return{completion:a,isDeterministic:r,value:o,isOpposing:n,relevancy:d}}),[t,s.attributes]);return(0,Z.jsxs)("div",{children:[(0,Z.jsx)(o.Z.Text,{strong:!0,children:"Completion"}),(0,Z.jsx)(Q.Z,{percent:i,size:"small"}),(0,Z.jsx)(o.Z.Text,{strong:!0,children:"Stats"}),(0,Z.jsxs)(c.Z,{vertical:!0,children:[(0,Z.jsx)(B,{label:"Deterministic",children:a?(0,Z.jsx)(E.Z,{style:{color:"green"}}):(0,Z.jsx)(R.Z,{style:{color:"red"}})}),(0,Z.jsx)(B,{label:"Opposing",children:n?(0,Z.jsx)(E.Z,{style:{color:"CornflowerBlue"}}):(0,Z.jsx)(R.Z,{style:{color:"grey"}})}),(0,Z.jsx)(B,{label:"Value",children:r}),(0,Z.jsx)(S.Z,{title:"The percentage of conclusive attributes (not unclear)",children:(0,Z.jsxs)(B,{label:"Reliability",children:[l,"%"]})})]})]})}var K=s(8158);function q(){const{activeItem:e,attributesList:t,itemAttributeValues:s,onAttributeChange:i,jumpToItem:a,attributes:r}=P(),{searchParams:g,removeQueryParam:h}=n(),b=g.get("itemId");(0,x.useEffect)((()=>{b&&(h("itemId"),a("goTo",b))}),[b,a,h]);const j="unset"===g.get("scope"),v=(0,x.useMemo)((()=>j?t.filter((e=>!s.attributes[e.id])):t),[j,e.id]);return e?(0,Z.jsx)(l.Z,{children:(0,Z.jsxs)("div",{className:"item-attribution-card",children:[(0,Z.jsx)(u.Z,{offsetTop:120,className:"item-attribution-card__item",children:(0,Z.jsxs)(c.Z,{vertical:!0,gap:6,children:[(0,Z.jsx)(K.xL,{item:e,width:150}),(0,Z.jsx)(K.bN,{item:e}),(0,Z.jsx)(K.CQ,{item:e,language:"en"}),(0,Z.jsx)(K.CQ,{item:e,language:"pt"}),(0,Z.jsx)(m.Z,{className:"my-2"}),(0,Z.jsx)(_,{attributesList:t,itemAttributeValues:s}),(0,Z.jsx)(m.Z,{className:"my-2"}),(0,Z.jsx)(o.Z.Text,{type:"secondary",children:(0,Z.jsx)(z,{itemAttributeValues:s,attributes:r})})]})}),(0,Z.jsx)(p.Z,{size:"small",direction:"vertical",className:"my-4 attribute-button-container",wrap:!0,children:v.map(((e,t)=>(0,Z.jsx)(D,{attribute:e,value:s.attributes[e.id],onChange:i},e.id)))})]},"".concat(e.id))}):(0,Z.jsx)(l.Z,{children:(0,Z.jsxs)(o.Z.Text,{type:"secondary",children:["No item selected."," ",(0,Z.jsx)(d.ZP,{size:"small",type:"primary",onClick:()=>a("random"),children:"Random Item"})]})})}var $=s(9228),W=s(9515),X=s(5812),J=s(5354),Y=s(7074),H=s(992),ee=s(6588),te=s(8178);function se(){const{jumpToItem:e}=P();return(0,Z.jsxs)(d.ZP.Group,{className:"my-4",children:[(0,Z.jsx)(d.ZP,{onClick:()=>e("first"),icon:(0,Z.jsx)(W.Z,{}),children:"First"}),(0,Z.jsx)(d.ZP,{onClick:()=>e("previous10"),icon:(0,Z.jsx)(X.Z,{}),children:"Previous 10"}),(0,Z.jsx)(d.ZP,{onClick:()=>e("previous"),icon:(0,Z.jsx)(J.Z,{}),children:"Previous"}),(0,Z.jsxs)(d.ZP,{onClick:()=>e("next"),children:["Next ",(0,Z.jsx)(Y.Z,{})]}),(0,Z.jsxs)(d.ZP,{onClick:()=>e("next10"),children:["Next 10 ",(0,Z.jsx)(H.Z,{})]}),(0,Z.jsxs)(d.ZP,{onClick:()=>e("last"),children:["Last ",(0,Z.jsx)(ee.Z,{})]}),(0,Z.jsx)($.Z,{content:(0,Z.jsx)(ie,{}),title:"Title",children:(0,Z.jsx)(d.ZP,{children:"Go To"})}),(0,Z.jsx)(d.ZP,{onClick:()=>e("incomplete"),children:"Next Incomplete"})]})}function ie(){const{jumpToItem:e}=P();return(0,Z.jsx)(te.i,{isPending:!1,onFinish:t=>e("goTo",t)})}var ae=s(4664),re=s(959);function ne(){const{attributesList:e,availableItemIds:t,addAttributesToUpdate:s,getItemAttributeValues:i}=P(),{searchParams:a}=n(),[r,l]=(0,x.useState)([]),[o,d]=(0,x.useState)(),u=()=>{var s,r,n,l;const o=null!==(s=null!==(r=a.get("attribute"))&&void 0!==r?r:null===(n=(0,h.sample)(e))||void 0===n?void 0:n.id)&&void 0!==s?s:"ali",d=null!==(l=e.find((e=>e.id===o)))&&void 0!==l?l:(0,h.sample)(e),u=Number(a.get("size"))||9,c=[],m=(0,h.shuffle)(t);for(let e=0;e<m.length&&c.length!==u;e++){const t=m[e];i(t).attributes[o]||c.push(t)}return{selectedAttribute:d,selected:c}},c=(0,x.useMemo)((()=>o?t.filter((e=>!i(e).attributes[null===o||void 0===o?void 0:o.id])).length:0),[o,t]);return{sampleIds:r,attribute:o,itemsLeftForAttribute:c,onGetSample:()=>{let e=u(),t=0;for(;0===e.selected.length&&t<30;)e=u(),t++;d(e.selectedAttribute),l(e.selected)},updateAttributeValue:(e,t,a)=>{const r=i(e);s(e,{...r,attributes:{...r.attributes,[t]:a}})}}}var le=s(2675);function oe(){const{getItem:e,getItemAttributeValues:t}=P(),{sampleIds:s,attribute:i,onGetSample:a,updateAttributeValue:r,itemsLeftForAttribute:n}=ne();if((0,h.isEmpty)(s)&&(0,h.isEmpty)(i))return(0,Z.jsxs)(l.Z,{className:"my-4",children:[(0,Z.jsxs)(o.Z.Text,{type:"secondary",children:["No sample has been generated. Tweak options and"," ",(0,Z.jsx)(d.ZP,{size:"small",type:"primary",onClick:a,children:"Get Sample"})]}),(0,Z.jsx)(m.Z,{}),(0,Z.jsx)(de,{})]});const u=s.map((s=>({itemAttributes:t(s),item:e(s)}))),p=u.filter((e=>{let{itemAttributes:t}=e;return!t.attributes[i.id]}));return(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsx)(de,{}),(0,Z.jsx)(l.Z,{className:"my-4",title:(0,Z.jsxs)(o.Z.Text,{children:[null===i||void 0===i?void 0:i.name.en," - ",null===i||void 0===i?void 0:i.description.en," (",n," items left)"]}),actions:[(0,Z.jsx)(d.ZP,{onClick:()=>{p.forEach((e=>{let{item:t}=e;r(t.id,i.id,-3)}))},danger:!0,disabled:0===p.length,children:"Mark rest as unrelated"}),(0,Z.jsx)(d.ZP,{type:"primary",ghost:!0,onClick:a,children:"Get New Sample"})],extra:(0,Z.jsx)(d.ZP,{type:"primary",size:"small",onClick:a,children:"Get New Sample"}),children:(0,Z.jsxs)(c.Z,{vertical:!0,gap:6,children:[0===u.length&&(0,Z.jsx)(ae.Z,{description:"No unset items found for this attribute.",image:ae.Z.PRESENTED_IMAGE_SIMPLE}),u.map((e=>{let{item:t,itemAttributes:s}=e;return(0,Z.jsxs)(x.Fragment,{children:[(0,Z.jsxs)(c.Z,{gap:6,children:[(0,Z.jsx)(K.xL,{item:t,width:75}),(0,Z.jsxs)(c.Z,{vertical:!0,gap:6,children:[(0,Z.jsxs)(c.Z,{gap:6,children:[(0,Z.jsx)(K.bN,{item:t}),(0,Z.jsx)(K.cw,{item:t})]}),(0,Z.jsx)(K.CQ,{item:t,language:"en"}),(0,Z.jsx)(K.CQ,{item:t,language:"pt"})]}),(0,Z.jsx)(D,{attribute:i,value:s.attributes[i.id],onChange:(e,s)=>r(t.id,e,s)})]}),(0,Z.jsx)(m.Z,{className:"my-1"})]},"".concat(t.id,"-").concat(s.updatedAt))}))]})})]})}function de(){const[e,t]=(0,le.Z)(!1),{addQueryParam:s,removeQueryParam:i}=n(),{sampleIds:a,attribute:r,onGetSample:l,updateAttributeValue:u}=ne(),{getItem:m,getItemAttributeValues:p}=P(),g=()=>{i("size"),t(!1)},h=a[0],x=m(h),j=p(h);return(0,Z.jsxs)(c.Z,{className:"mt-4",children:[(0,Z.jsx)(d.ZP,{type:"primary",onClick:()=>{s("size","1"),t(!0),l()},children:"Single Sampler"}),(0,Z.jsxs)(re.Z,{title:(0,Z.jsxs)(o.Z,{children:["Single Sampler: ",(0,Z.jsx)("strong",{children:null===r||void 0===r?void 0:r.name.en})]}),open:e,width:"100vw",maskClosable:!1,onOk:g,onClose:g,onCancel:g,cancelButtonProps:{style:{display:"none"}},children:[h&&x&&j&&r&&(0,Z.jsxs)(c.Z,{gap:6,className:"my-10",wrap:"wrap",children:[(0,Z.jsx)(K.xL,{item:x,width:150}),(0,Z.jsxs)(c.Z,{vertical:!0,gap:6,children:[(0,Z.jsxs)(c.Z,{gap:6,children:[(0,Z.jsx)(K.bN,{item:x}),(0,Z.jsx)(K.cw,{item:x})]}),(0,Z.jsx)(K.CQ,{item:x,language:"en"}),(0,Z.jsx)(K.CQ,{item:x,language:"pt"})]}),(0,Z.jsx)(D,{size:"large",attribute:r,value:j.attributes[r.id],onChange:async(e,t)=>{u(x.id,e,t),await(0,b.Dc)(500),l()}})]},h),(0,Z.jsx)(d.ZP,{onClick:l,children:"Another Sample"})]})]})}var ue=s(8528),ce=s(5437),me=s(1082),pe=s(8149);function ge(e){const[t,s]=(0,x.useState)(!1),i=()=>{s(window.pageYOffset>300)};return(0,x.useEffect)((()=>(window.addEventListener("scroll",i),()=>{window.removeEventListener("scroll",i)})),[]),(0,Z.jsx)(d.ZP,{className:"go-to-top-button ".concat(t?"visible":""),onClick:()=>{window.scrollTo({top:0,behavior:"smooth"})},icon:(0,Z.jsx)(pe.Z,{}),...e,children:"Go to Top"})}var he=s(1503),xe=s(3320),be=s(5922);function je(){const{searchParams:e,removeQueryParam:t}=n(),s=e.get("drawer"),[i,a]=(0,x.useState)(!1),{activeItem:r,attributesList:l,itemAttributeValues:o,onAttributeChange:d,jumpToItem:u}=P();(0,x.useEffect)((()=>{s&&u("goTo",s)}),[s,u,t]);const g=(0,x.useMemo)((()=>i?l.filter((e=>!o.attributes[e.id])):l),[i,r.id]);return(0,Z.jsxs)(xe.Z,{open:!!s,title:"Edit: ".concat(r.name.en),onClose:()=>{t("drawer")},width:"640px",children:[(0,Z.jsxs)(c.Z,{gap:6,children:[(0,Z.jsxs)(c.Z,{vertical:!0,gap:6,children:[(0,Z.jsx)(K.xL,{item:r,width:50}),(0,Z.jsx)(K.bN,{item:r})]}),(0,Z.jsxs)(c.Z,{vertical:!0,gap:6,children:[(0,Z.jsx)(K.CQ,{item:r,language:"en"}),(0,Z.jsx)(K.CQ,{item:r,language:"pt"})]}),(0,Z.jsx)(c.Z,{vertical:!0,gap:6,children:(0,Z.jsx)(be.Z,{checked:i,onChange:a,checkedChildren:"Unset",unCheckedChildren:"All"})})]}),(0,Z.jsx)(m.Z,{className:"my-1"}),(0,Z.jsx)(p.Z,{size:"small",direction:"vertical",className:"my-4 attribute-button-container",wrap:!0,children:g.map((e=>(0,Z.jsx)(D,{size:"small",attribute:e,value:o.attributes[e.id],onChange:d},e.id)))})]})}const ve=(e,t)=>"unset"!==t&&t?"".concat(e.percent,"%  - ").concat(e.group," items"):"".concat(100-e.percent,"% done, ").concat(e.group," left");function ye(){const{getItem:e,getItemAttributeValues:t,attributesList:s}=P(),{attribute:i,pageIds:a,updateAttributeValue:r,updatePageItemsAsUnrelated:u,pagination:m,stats:p,sorting:g}=function(){var e,t,s,i;const{attributesList:a,addAttributesToUpdate:r,getItemAttributeValues:l,availableItemIds:o,addMultipleAttributesToUpdate:d}=P(),{searchParams:u,addQueryParam:c}=n(),m=null!==(e=u.get("attribute"))&&void 0!==e?e:"ali",p=null!==(t=u.get("scope"))&&void 0!==t?t:"unset",g=null!==(s=u.get("page"))&&void 0!==s?s:"1",b=null!==(i=u.get("pageSize"))&&void 0!==i?i:"12",[j,v]=(0,x.useState)("ali"),[y,f]=(0,x.useState)("unset"),[I,Z]=(0,x.useState)(null),[C,N]=(0,x.useState)("desc"),w=(0,x.useMemo)((()=>{const e=o.map((e=>l(e))),t="unset"===p?void 0:A.NL[p.toUpperCase()],s=e.filter((e=>{var s;return(null===(s=e.attributes)||void 0===s?void 0:s[m])===t})).map((e=>e.id)),[i,a]=(null!==I&&void 0!==I?I:"::").split("::");return(0,h.orderBy)(s,[e=>{var t,s;return"attribute"!==i||(null===(t=l(e))||void 0===t||null===(s=t.attributes)||void 0===s?void 0:s[a])},e=>"prop"!==i||Number(e),e=>{var t;return null===(t=l(e))||void 0===t?void 0:t.updatedAt},e=>Number(e)],[C,"asc","desc","asc"])}),[m,p,I,C]),S=(0,x.useMemo)((()=>{if(j!==m||y!==p)return v(m),f(p),c("page","1"),w.slice(0,Number(b));const e=(Number(g)-1)*Number(b),t=e+Number(b);return w.slice(e,t)}),[g,b,w]),T=a.find((e=>e.id===m));return{group:w,stats:{total:o.length,group:w.length,percent:Math.round(w.length/o.length*100)},pageIds:S,attribute:T,updateAttributeValue:(e,t,s)=>{const i=l(e);r(e,{...i,attributes:{...i.attributes,[t]:s}})},updatePageItemsAsUnrelated:()=>{d(S.map((e=>{const t=l(e);return t.attributes[m]||(t.attributes[m]=A.NL.UNRELATED),t})))},sorting:{sortBy:I,setSortBy:Z,sortOrder:C,setSortOrder:N},pagination:{total:w.length,current:Number(g),pageSize:Number(b),onChange:e=>c("page",String(e)),onShowSizeChange:(e,t)=>c("pageSize",String(t)),pageSizeOptions:[12,24,48,96]}}}(),{searchParams:b,addQueryParam:j}=n(),v=(0,he.Z)("(max-width: 1024px)");if((0,h.isEmpty)(i))return(0,Z.jsx)(l.Z,{className:"my-4",children:(0,Z.jsx)(o.Z.Text,{type:"secondary",children:"No group attribute has been selected."})});const y=(0,Z.jsx)(ue.Z,{onChange:m.onChange,current:m.current,total:m.total,pageSizeOptions:m.pageSizeOptions,pageSize:m.pageSize,onShowSizeChange:m.onShowSizeChange},"pagination"),f=(0,Z.jsxs)(c.Z,{align:"center",children:[(0,Z.jsx)(o.Z.Text,{className:"mr-2",children:"Sort by"}),(0,Z.jsxs)(ce.Z,{style:{width:120},value:g.sortBy,onChange:e=>g.setSortBy(e),children:[(0,Z.jsx)(ce.Z.Option,{value:null,children:"Last Updated"}),(0,Z.jsx)(ce.Z.Option,{value:"prop::id",children:"Id"}),s.map((e=>(0,Z.jsx)(ce.Z.Option,{value:"attribute::".concat(e.id),children:e.name.en},e.id)))]})]}),I=("unset"===b.get("scope")||!b.get("scope"))&&(0,Z.jsx)(me.Z,{title:"Are you sure everything is unrelated to ".concat(i.name.en,"?"),onConfirm:u,children:(0,Z.jsx)(d.ZP,{type:"primary",danger:!0,disabled:0===a.length,children:"Unrelate Unset Items on Page"})},"unrelate-button");return(0,Z.jsxs)(l.Z,{className:"my-4",title:(0,Z.jsxs)(o.Z.Text,{children:[null===i||void 0===i?void 0:i.name.en," (",ve(p,b.get("scope")),") -"," ",i.description.en]}),extra:(0,Z.jsxs)(c.Z,{align:"center",children:[f,y]}),actions:[I,(0,Z.jsx)(ge,{},"go-to-top"),y].filter(Boolean),children:[0===a.length&&(0,Z.jsx)(ae.Z,{description:"No items found in this scope for this attribute.",image:ae.Z.PRESENTED_IMAGE_SIMPLE}),a.map((s=>{const a=t(s),n=e(s);return(0,Z.jsx)(l.Z.Grid,{style:{width:v?"50%":"25%"},children:(0,Z.jsxs)(c.Z,{gap:6,children:[(0,Z.jsxs)(c.Z,{vertical:!0,gap:6,children:[(0,Z.jsx)(K.xL,{item:n,width:75}),(0,Z.jsx)(K.bN,{item:n}),(0,Z.jsxs)(d.ZP.Group,{children:[(0,Z.jsx)(K.cw,{item:n}),(0,Z.jsx)(d.ZP,{size:"small",shape:"round",onClick:()=>j("drawer",n.id),children:"Drawer"})]}),(0,Z.jsx)(K.CQ,{item:n,language:"en"}),(0,Z.jsx)(K.CQ,{item:n,language:"pt"})]}),(0,Z.jsx)(D,{attribute:i,value:a.attributes[i.id],onlyButtons:!0,onChange:(e,t)=>r(n.id,e,t)})]})},"".concat(s,"-").concat(a.updatedAt))})),(0,Z.jsx)(je,{})]})}var fe=s(4453);function Ie(){const{attributes:e}=P(),{itemMessages:t,grouping:s}=function(){const{attributes:e,getItemAttributeValues:t,availableItemIds:s,getItem:i,isLoading:a}=P(),{searchParams:r}=n(),l="true"===r.get("showComplete"),o="true"===r.get("showUnclear"),d="true"===r.get("showUnrelated"),{itemMessages:u,itemMessagesDict:c,grouping:m}=(0,x.useMemo)((()=>{if(a)return{itemMessages:[],itemMessagesDict:{},grouping:{}};const r=(0,h.orderBy)(s.map((s=>{const a=t(s),r=(0,b.Mg)(a,e);return{item:i(s),itemAttributesValues:a,message:(0,b.tt)(r,o,d),fullMessage:r}})).filter((e=>{let{itemAttributesValues:t}=e;return!l||t.complete})),["message"],["asc"]),n=r.reduce(((e,t)=>{let{message:s,item:{id:i}}=t;const a=s.join(" ");return void 0===e[a]&&(e[a]=[]),e[a].push(i),e}),{}),u=Object.values(n).filter((e=>e.length>1));return u.length>0&&console.log("More than one",u),{itemMessages:r,itemMessagesDict:(0,h.keyBy)(r,"item.id"),grouping:n}}),[e,s,t,i,a,l,o,d]);return{itemMessages:u,itemMessagesDict:c,grouping:m}}(),i=[{title:"Item Id",dataIndex:"item",key:"id",render:e=>(0,Z.jsxs)("div",{children:[(0,Z.jsx)(K.bN,{item:e}),(0,Z.jsx)(K.cw,{item:e})]}),sorter:(e,t)=>Number(e.item.id)-Number(t.item.id)},{title:"Sprite",dataIndex:"item",key:"sprite",render:e=>(0,Z.jsx)(K.xL,{item:e,width:75})},{title:"Name",dataIndex:"item",key:"name",render:e=>(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsx)(K.CQ,{item:e,language:"en"}),(0,Z.jsx)(K.CQ,{item:e,language:"pt"})]}),sorter:(e,t)=>e.item.name.en.localeCompare(t.item.name.en)},{title:"Address",dataIndex:"message",key:"message",render:(t,s)=>{let{item:i}=s;return(0,Z.jsx)(c.Z,{gap:6,children:t.map(((t,s,a)=>(0,Z.jsx)(F,{keyVariant:t,attributes:e,firstElement:0===s,lastElement:s===a.length-1,withText:!0},"".concat(t,"-").concat(i.id))))})},sorter:(e,t)=>e.message.join(" ").localeCompare(t.message.join(" "))},{title:"Complete",dataIndex:"itemAttributesValues",key:"complete",render:e=>e.complete?"Yes":"No"},{title:"Identical",dataIndex:"message",key:"identical",render:e=>{var t;const i=null!==(t=s[e.join(" ")])&&void 0!==t?t:[];return(0,Z.jsx)(Z.Fragment,{children:i.length>1?i.length:"0"})},sorter:(e,t)=>{var i,a;const r=null!==(i=s[e.message.join(" ")])&&void 0!==i?i:[];return(null!==(a=s[t.message.join(" ")])&&void 0!==a?a:[]).length-r.length}}];return(0,Z.jsxs)("div",{className:"my-4",children:[(0,Z.jsx)(o.Z.Title,{level:5,children:"Item Comparator"}),(0,Z.jsx)(fe.Z,{dataSource:t,columns:i,pagination:{showQuickJumper:!0}})]})}var Ze=s(4003),Ce=s(330),Ne=s(7974),Pe=s(2123),we=s(3949),Se=s(9263);function Te(){const e=(0,y.N)("items-attributes"),t=(0,y.N)("items-attribute-values"),[s,i]=(0,x.useState)(null);return(0,Z.jsxs)("div",{className:"my-4",children:[(0,Z.jsx)(o.Z.Title,{level:3,children:"Daily Simulator"}),(0,Z.jsx)(o.Z.Paragraph,{children:"Generates a daily game for Alien Communication"}),(0,Z.jsxs)(p.Z,{children:[(0,Z.jsx)(d.ZP,{type:"primary",onClick:()=>{i(Ee(e.data,t.data))},children:"Generate"}),(0,Z.jsx)(d.ZP,{onClick:()=>{const s={};let i=0;for(;i<300||15===(0,h.keys)(s).length;){const a=Ee(e.data,t.data);if(a.valid&&!s[a.setId]&&(s[a.setId]=a),(0,h.keys)(s).length>=15)break;i+=1}console.log("TRIES",i),console.log(Object.values(s).map(((e,t)=>({...e,number:e.number-t}))))},children:"Generate List"})]}),(0,Z.jsx)("div",{children:Boolean(s)&&(0,Z.jsxs)(p.Z,{direction:"vertical",children:[(0,Z.jsx)(o.Z.Title,{level:5,children:null===s||void 0===s?void 0:s.setId}),!(null!==s&&void 0!==s&&s.valid)&&(0,Z.jsx)(Se.Z,{type:"error",message:"Invalid game"}),(0,Z.jsx)(p.Z,{direction:"vertical",children:null===s||void 0===s?void 0:s.attributes.map((e=>(0,Z.jsxs)(c.Z,{gap:8,children:[(0,Z.jsx)(O.o$,{id:e.spriteId,width:50}),e.itemsIds.map((e=>(0,Z.jsx)(O.ck,{id:e||"0",width:50})))]},e.id)))}),(0,Z.jsx)(m.Z,{className:"my-1"}),(0,Z.jsx)(p.Z,{direction:"horizontal",children:null===s||void 0===s?void 0:s.requests.map((e=>(0,Z.jsxs)(c.Z,{vertical:!0,children:[(0,Z.jsx)(O.o$,{id:e.spritesIds[2],width:50}),(0,Z.jsx)(O.o$,{id:e.spritesIds[1],width:50}),(0,Z.jsx)(O.o$,{id:e.spritesIds[0],width:50})]},e.itemId)))}),(0,Z.jsx)(m.Z,{className:"my-1"}),(0,Z.jsx)(p.Z,{direction:"horizontal",children:null===s||void 0===s?void 0:s.itemsIds.map((e=>(0,Z.jsx)(O.ck,{id:e||"0",width:50})))})]},null===s||void 0===s?void 0:s.setId)})]})}const Ee=(e,t)=>{const s=(0,h.values)(e).filter((e=>!e.limited||"sol"===e.id)),i=(0,h.shuffle)((0,h.values)(t).filter((e=>e.complete))),a=(0,h.shuffle)((0,b.R9)(38,0)),r=(0,h.sampleSize)(s,3).map((e=>({...e,spriteId:"".concat(a.pop())}))),n=[],l=[],o=[],d=[],u=[],c=[],m=[],p=[];i.forEach((e=>{const t=[A.NL.DETERMINISTIC,A.NL.RELATED],s=e.attributes[r[0].id]===A.NL.DETERMINISTIC,i=t.includes(e.attributes[r[0].id]),a=e.attributes[r[0].id]===A.NL.UNRELATED,g=e.attributes[r[1].id]===A.NL.DETERMINISTIC,h=t.includes(e.attributes[r[1].id]),x=e.attributes[r[1].id]===A.NL.UNRELATED,b=e.attributes[r[2].id]===A.NL.DETERMINISTIC,j=t.includes(e.attributes[r[2].id]),v=e.attributes[r[2].id]===A.NL.UNRELATED;if(a&&x&&v)return p.push(e.id);s&&x&&v&&n.push(e.id),a&&g&&v&&l.push(e.id),a&&x&&b&&o.push(e.id),i&&h&&v&&d.push(e.id),i&&x&&j&&u.push(e.id),a&&h&&j&&c.push(e.id),i&&h&&j&&m.push(e.id)}));const g=r.map((e=>({id:e.id,name:e.name.pt,description:e.description.pt,spriteId:e.spriteId,itemsIds:[]})));g[0].itemsIds=(0,h.sampleSize)(n,n.length>3?3:Math.max(n.length-1,1)),g[1].itemsIds=(0,h.sampleSize)(l,l.length>3?3:Math.max(n.length-1,1)),g[2].itemsIds=(0,h.sampleSize)(o,o.length>3?3:Math.max(n.length-1,1));const x=[];g.forEach((e=>{x.push(...e.itemsIds)}));const j=[];d.length>0&&j.push({spritesIds:[r[0].spriteId,r[1].spriteId],itemId:(0,h.sample)(d)}),u.length>0&&j.push({spritesIds:[r[0].spriteId,r[2].spriteId],itemId:(0,h.sample)(u)}),c.length>0&&j.push({spritesIds:[r[1].spriteId,r[2].spriteId],itemId:(0,h.sample)(c)}),m.length>0&&j.push({spritesIds:r.map((e=>e.spriteId)),itemId:(0,h.sample)(m)});const v=[];n.length>0&&v.push({spritesIds:[r[0].spriteId],itemId:n.filter((e=>!x.includes(e)))[0]}),l.length>0&&v.push({spritesIds:[r[1].spriteId],itemId:l.filter((e=>!x.includes(e)))[0]}),o.length>0&&v.push({spritesIds:[r[2].spriteId],itemId:o.filter((e=>!x.includes(e)))[0]}),console.log({attributeA:n,attributeB:l,attributeC:o,attributeAB:d,attributeAC:u,attributeBC:c,attributeABC:m}),console.log("COMPLEX REQUEST SIZE",j.length),console.log("SIMPLE REQUEST SIZE",v.length);let y=(0,h.sampleSize)(j,4);console.log("REQUEST SIZE",y.length),y.length<3&&y.push(...(0,h.sampleSize)(v,4-y.length)),y.length<4&&console.warn("Not enough requests"),y=(0,h.shuffle)(y);const f=y.map((e=>e.itemId)),I={id:"2024-00-00",setId:g.map((e=>e.id)).sort().join("-"),number:0,type:"comunica\xe7\xe3o-alien\xedgena",attributes:g,requests:y,solution:f.join("-"),itemsIds:(0,h.shuffle)([...f,p[0],p[1],p[2],p[3]]).filter(Boolean),valid:!1};return I.valid=[3===I.attributes.length,4===I.requests.length,I.itemsIds.length>5,I.attributes.every((e=>e.itemsIds.length>0)),I.requests.every((e=>e.itemId))].every(Boolean),console.log(I),I},Ae=["","I","II","III","IV","V"];function ke(){const{attributes:e,availableItemIds:t,getItemAttributeValues:s,getItem:i}=P(),{message:a}=g.Z.useApp(),[r,n]=(0,x.useState)(25),[l,u]=(0,x.useState)(90),[m,b]=(0,x.useState)(!1),[j,v]=(0,x.useState)([]),[y,f]=(0,x.useState)([]),[I,C]=(0,x.useState)(null),[N,w]=(0,x.useState)({id:!0,nameEn:!0,namePt:!0,reliability:!0}),S=e=>{w((t=>({...t,[e]:!t[e]})))};return(0,Z.jsxs)("div",{className:"my-4",children:[(0,Z.jsx)(o.Z.Title,{level:3,children:"Simulator"}),(0,Z.jsx)(o.Z.Paragraph,{children:"Generates a board with items different enough to get Deterministic values in all selected attributes."}),(0,Z.jsxs)(c.Z,{wrap:!0,gap:12,children:[(0,Z.jsx)(M.zE,{label:"Grid Size",value:r,onChange:e=>n(e),options:[16,25]}),(0,Z.jsx)(M.xh,{label:"Reliability Threshold",value:l,onChange:e=>u(e),step:5,min:10,max:100}),(0,Z.jsx)(M.Do,{label:"NSFW",value:m,onChange:b}),(0,Z.jsx)(d.ZP,{onClick:()=>{const n={},o=(0,h.shuffle)(t);for(;Object.values(n).length<r;){const e=o.pop();if(!e)break;const t=s(e);t&&(!t.complete||!t.reliability||t.reliability<l||!m&&i(e).nsfw||(t.key&&!n[t.key]?n[t.key]=e:console.log("Item has identical key to another item. Skipping.",i(e).name.en)))}const d=Object.values(n);d.length<r&&a.error("Could not generate sample. Got only ".concat(d.length," items")),v((0,h.sortBy)(d,(e=>Number(e))));const u=function(e,t,s){const i={},a={};e.forEach((e=>{e&&Object.keys(e.attributes).forEach((t=>{e.attributes[t]>0&&(i[t]=(i[t]||0)+1),e.attributes[t]===A.NL.DETERMINISTIC&&(a[t]=!0,i[t]=(i[t]||0)+2),e.attributes[t]===A.NL.OPPOSITE&&(i[t]=(i[t]||0)+1)}))}));const r={1:0,2:0,3:0,4:0};function n(e){return e.filter((e=>(r[s[e].level]++,!(r[4]>1)||(console.log("Discarding level 4 attribute",e),!1))))}const l=n(Object.keys(a)),o=n((0,h.keys)(i).filter((e=>!l.includes(e))));if(console.log({levelCount:r}),t===l.length)return console.log("All keys are deterministic"),l;if(console.log(i),0===l.length)return[];const d=l.reduce(((e,t)=>{const s=i[t];return e[s]||(e[s]=[]),e[s].push(t),e}),{}),u=(0,h.keys)(d).sort(((e,t)=>Number(t)-Number(e)));console.log({sortedDeterministicTiedGroupsKeys:u});const c=o.reduce(((e,t)=>{const s=i[t];return e[s]||(e[s]=[]),e[s].push(t),e}),{});console.log(c);const m=(0,h.keys)(c).sort(((e,t)=>Number(t)-Number(e)));let p=[];for(const g of u){if(p.length===t)break;p.push(...(0,h.sampleSize)(d[g],t-p.length))}for(const g of m){if(p.length===t)break;p.push(...(0,h.sampleSize)(c[g],t-p.length))}return p}(d.map((e=>s(e))),25,e);if(u.length<25){const t=(0,h.keys)(e).filter((e=>!u.includes(e))),s=(0,h.sortBy)(t,(t=>e[t].priority)).slice(0,25-u.length);console.log("Adding more attributes by priority",s),u.push(...s)}const c=u.reduce(((e,t)=>(d.forEach((i=>{const a=s(i);if(a)switch(a.attributes[t]){case A.NL.RELATED:e.relatedCount[t]=(e.relatedCount[t]||0)+1;break;case A.NL.DETERMINISTIC:e.deterministicCount[t]=(e.deterministicCount[t]||0)+1;break;case A.NL.UNCLEAR:e.unclearCount[t]=(e.unclearCount[t]||0)+1;break;case A.NL.OPPOSITE:e.oppositeCount[t]=(e.oppositeCount[t]||0)+1}})),e)),{relatedCount:{},deterministicCount:{},unclearCount:{},oppositeCount:{}});f(u.sort().map((t=>({...e[t],relatedCount:c.relatedCount[t],deterministicCount:c.deterministicCount[t],unclearCount:c.unclearCount[t],oppositeCount:c.oppositeCount[t]}))))},type:"primary",children:"Get Sample Board"})]}),(0,Z.jsxs)(c.Z,{wrap:!0,gap:12,children:[(0,Z.jsx)(M.tj,{label:"Show Id",value:!!N.id,onChange:()=>S("id")}),(0,Z.jsx)(M.tj,{label:"Show Name (EN)",value:!!N.nameEn,onChange:()=>S("nameEn")}),(0,Z.jsx)(M.tj,{label:"Show Name (PT)",value:!!N.namePt,onChange:()=>S("namePt")}),(0,Z.jsx)(M.tj,{label:"Show Reliability",value:!!N.reliability,onChange:()=>S("reliability")})]}),(0,Z.jsx)("div",{className:"simulator-grid",style:{gridTemplateColumns:"repeat(".concat(Math.sqrt(r),", 1fr)")},children:j.map((e=>{const t=i(e),a=s(e);return(0,Z.jsxs)(p.Z,{direction:"vertical",className:(0,U.Z)("simulator-grid__entry",I&&a.attributes[I]>0&&"simulator-grid__entry--highlighted"),align:"center",children:[(0,Z.jsxs)(p.Z,{children:[(0,Z.jsxs)(c.Z,{vertical:!0,children:[N.id&&(0,Z.jsx)(K.bN,{item:t}),N.reliability&&(0,Z.jsx)("span",{children:(0,Z.jsx)(Ze.Z,{prefix:(0,Z.jsx)(Ce.Z,{}),placeholder:"Reliability",variant:"borderless",size:"small",value:a.reliability,readOnly:!0,style:{width:"8ch"},formatter:e=>"".concat(e,"%")})}),N.id&&(0,Z.jsx)(K.cw,{item:t})]}),(0,Z.jsx)(K.xL,{item:t,width:50})]}),N.nameEn&&(0,Z.jsx)(K.CQ,{item:t,language:"en"}),N.namePt&&(0,Z.jsx)(K.CQ,{item:t,language:"pt"})]},e)}))}),(0,Z.jsx)("div",{className:"simulator-grid my-4",children:y.map((e=>{var t,s,i,a;return(0,Z.jsxs)(M.F6,{className:(0,U.Z)("simulator-grid__entry","simulator-grid__button",I===e.id&&"simulator-grid__entry--highlighted"),onClick:()=>C(e.id),children:[e.name.en," ",Ae[e.level],(0,Z.jsxs)(c.Z,{gap:6,justify:"center",className:"my-1",children:[(0,Z.jsxs)("span",{children:[(0,Z.jsx)(Ne.Z,{style:{color:e.deterministicCount?"dodgerblue":void 0}})," ",null!==(t=e.deterministicCount)&&void 0!==t?t:0]}),(0,Z.jsxs)("span",{children:[(0,Z.jsx)(Pe.Z,{style:{color:e.relatedCount?"green":void 0}})," ",null!==(s=e.relatedCount)&&void 0!==s?s:0]}),(0,Z.jsxs)("span",{children:[(0,Z.jsx)(we.Z,{style:{color:e.oppositeCount?"red":void 0}})," ",null!==(i=e.oppositeCount)&&void 0!==i?i:0]}),(0,Z.jsxs)("span",{children:[(0,Z.jsx)(T.Z,{style:{color:e.unclearCount?"gold":void 0}})," ",null!==(a=e.unclearCount)&&void 0!==a?a:0]})]})]},e.id)}))}),(0,Z.jsx)(Te,{})]})}var Le=s(1504),De=s(913),Ue=s(7689),Me=s(4766);function Oe(){const e=[{key:"1",label:"All Attributes",children:(0,Z.jsx)(Fe,{type:"all"})},{key:"2",label:"Default Attributes",children:(0,Z.jsx)(Fe,{type:"default"})},{key:"3",label:"Custom Attributes",children:(0,Z.jsx)(Fe,{type:"custom"})}];return(0,Z.jsxs)("div",{className:"my-4",children:[(0,Z.jsx)(o.Z.Title,{level:5,children:"Stats"}),(0,Z.jsx)(Le.Z,{defaultActiveKey:"1",items:e})]})}const ze=(e,t)=>{let s=0,i=0,a=0,r=0,n=0,l=0,o=0,d=0;t.forEach((t=>{let{attributes:u}=t;if(u[e.id]){s++;const t=u[e.id];10===t?i++:5===t?a++:0!==t&&t?-1===t?n++:-3===t?l++:-10===t&&o++:r++,t>0&&d++}}));const u=t.length,c=i/u*100,m=a/u*100,p=r/u*100,g=n/u*100,h=l/u*100,x=o/u*100,b=d/u*100;return{completionPercentage:(s/u*100).toFixed(1),tensPercentage:c.toFixed(1),fivesPercentage:m.toFixed(1),zerosPercentage:p.toFixed(1),negativeOnesPercentage:g.toFixed(1),negativeThreesPercentage:h.toFixed(1),negativeTensPercentage:x.toFixed(1),positivePercentage:b.toFixed(1)}};function Fe(e){let{type:t}=e;const{availableItemIds:s,getItemAttributeValues:i,attributesList:a}=P(),r=(0,Ue.s0)(),{is:n}=(0,Me.K)(),l=(0,x.useMemo)((()=>"default"===t?a.filter((e=>e.default)):"custom"===t?a.filter((e=>!e.default)):a),[a,t]),u=(0,x.useMemo)((()=>{const e=s.map((e=>i(e)));return l.map((t=>({...t,...ze(t,e)})))}),[l,s,i]),m=[{title:"Attribute",dataIndex:"name",key:"name",render:(e,t)=>(0,Z.jsxs)(c.Z,{align:"center",gap:8,children:[n("showGlyphs")&&(0,Z.jsx)(O.o$,{id:t.spriteId,width:30}),e.en,t.default?(0,Z.jsx)(G.Z,{className:"ml-1",children:"default"}):"",t.limited?(0,Z.jsx)(G.Z,{className:"ml-1",children:"limited"}):""]}),sorter:(e,t)=>e.name.en.localeCompare(t.name.en)},{title:"Priority",dataIndex:"priority",key:"priority",sorter:(e,t)=>e.priority-t.priority},{title:"Positive",dataIndex:"positivePercentage",key:"positivePercentage",render:e=>"".concat(e,"%"),sorter:(e,t)=>parseFloat(e.positivePercentage)-parseFloat(t.positivePercentage)},{title:"10",dataIndex:"tensPercentage",key:"tensPercentage",render:(e,t)=>t.limited?"-":"".concat(e,"%"),sorter:(e,t)=>parseFloat(e.tensPercentage)-parseFloat(t.tensPercentage)},{title:"5",dataIndex:"fivesPercentage",key:"fivesPercentage",render:e=>"".concat(e,"%"),sorter:(e,t)=>parseFloat(e.fivesPercentage)-parseFloat(t.fivesPercentage)},{title:"-1",dataIndex:"negativeOnesPercentage",key:"negativeOnesPercentage",render:e=>"".concat(e,"%"),sorter:(e,t)=>parseFloat(e.negativeOnesPercentage)-parseFloat(t.negativeOnesPercentage)},{title:"-3",dataIndex:"negativeThreesPercentage",key:"negativeThreesPercentage",render:e=>"".concat(e,"%"),sorter:(e,t)=>parseFloat(e.negativeThreesPercentage)-parseFloat(t.negativeThreesPercentage)},{title:"-10",dataIndex:"negativeTensPercentage",key:"negativeTensPercentage",render:e=>"".concat(e,"%"),sorter:(e,t)=>parseFloat(e.negativeTensPercentage)-parseFloat(t.negativeTensPercentage)},{title:"Completion",dataIndex:"completionPercentage",key:"completionPercentage",render:e=>(0,Z.jsx)(Q.Z,{percent:parseFloat(e),size:"small"}),sorter:(e,t)=>parseFloat(e.completionPercentage)-parseFloat(t.completionPercentage)},{title:"Level",dataIndex:"level",key:"level",render:e=>(0,Z.jsx)(De.Z,{count:4,value:e,disabled:!0}),sorter:(e,t)=>e.level-t.level},{title:"Actions",key:"actions",render:e=>(0,Z.jsx)(p.Z,{children:(0,Z.jsxs)(d.ZP.Group,{children:[(0,Z.jsx)(d.ZP,{size:"small",shape:"round",onClick:()=>r("/items/attribution?view=grouping&attribute=".concat(e.id,"&page=1")),children:"Grouping"}),(0,Z.jsx)(d.ZP,{size:"small",shape:"round",onClick:()=>r("/items/attribution?view=sampler&attribute=".concat(e.id,"&size=6")),children:"Sample"})]})})}];return(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsxs)(o.Z.Paragraph,{children:["Total: ",u.length]}),(0,Z.jsx)(fe.Z,{columns:m,dataSource:u,pagination:!1,rowKey:"id",size:"small"})]})}function Ve(){const{view:e}=n();return"classifier"===e?(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsx)(se,{}),(0,Z.jsx)(q,{}),(0,Z.jsx)(c.Z,{justify:"flex-end",className:"my-4",children:(0,Z.jsx)(ge,{})})]}):"sampler"===e?(0,Z.jsx)(oe,{}):"grouping"===e?(0,Z.jsx)(ye,{}):"comparator"===e?(0,Z.jsx)(Ie,{}):"simulator"===e?(0,Z.jsx)(ke,{}):"stats"===e?(0,Z.jsx)(Oe,{}):(0,Z.jsx)(ae.Z,{className:"my-10",description:"Unknown view has been selected"})}var Re=s(7018),Qe=s(7340),Ge=s(7965);function Be(){const{getItemAttributeValues:e,availableItemIds:t,attributesList:s}=P(),{total:i,complete:a,completionPercentage:r,hasDataCount:n,initiatedPercentage:l,progress:d,progressTotal:u,currentProgress:p}=(0,x.useMemo)((()=>{const i=t.length;let a=0,r=0,n=0;t.map((t=>e(t))).forEach((e=>{let{complete:t,attributes:i}=e;(0,h.isEmpty)(i)||(a+=1),Object.values(i).length===s.length&&(r+=1),n+=Object.values(i).length}));const l=Object.values(s).length*t.length;return{total:i,complete:r,completionPercentage:i>0?(r/i*100).toFixed(1):0,hasDataCount:a,initiatedPercentage:i>0?Math.floor(a/i*100):0,progress:(n/l*100).toFixed(1),currentProgress:n,progressTotal:l}}),[s,t,e]);return(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsxs)(c.Z,{vertical:!0,children:[(0,Z.jsx)(o.Z.Text,{strong:!0,className:"mb-2",children:"Items Stats"}),(0,Z.jsx)(B,{label:"Total",children:i}),(0,Z.jsxs)(B,{label:"Complete",children:[a," (",r,"%)"]}),(0,Z.jsxs)(B,{label:"Initiated",children:[n," (",l,"%)"]}),(0,Z.jsx)(o.Z.Text,{strong:!0,className:"mt-4 mb-2",children:"Attributes Stats"}),(0,Z.jsx)(B,{label:"Total",children:u}),(0,Z.jsx)(B,{label:"Set",children:p}),(0,Z.jsxs)(B,{label:"Progress",children:[d,"%"]})]}),(0,Z.jsx)(m.Z,{})]})}function _e(){const{jumpToItem:e}=P(),{searchParams:t,addQueryParam:s}=n();return(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsx)(d.ZP,{block:!0,onClick:()=>e("random"),type:"primary",children:"Random Item"}),(0,Z.jsx)(M.Do,{label:"Unset Only",value:"unset"===t.get("scope"),onChange:e=>s("scope",e?"unset":""),className:"mt-4"})]})}function Ke(){const{searchParams:e,addQueryParam:t}=n(),{attributesList:s}=P(),i=(0,x.useMemo)((()=>[{label:"Random Attribute",value:"random"},...s.map((e=>{let{id:t,name:s}=e;return{label:s.en,value:t}}))]),[s]);return(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsx)(M.zE,{label:"Sampler Attribute",value:e.get("attribute")||"random",onChange:e=>t("attribute",e),options:i}),(0,Z.jsx)(M.xh,{label:"Sample Size",value:Number(e.get("size")||9),onChange:e=>t("size",String(e)),min:3,max:21,step:3})]})}function qe(){const{searchParams:e,addQueryParam:t}=n(),{attributesList:s}=P(),i=(0,x.useMemo)((()=>s.map((e=>{let{id:t,name:s,...i}=e;return{label:"".concat(s.en).concat(i.default?"*":""),value:t}}))),[s]);return(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsx)(M.zE,{label:"Attribute",value:e.get("attribute")||"ali",onChange:e=>t("attribute",e),options:i}),(0,Z.jsx)(M.zE,{label:"Scope",value:e.get("scope")||"unset",onChange:e=>t("scope",e),options:[{value:"unset",label:"Unset"},...A.Ud]}),(0,Z.jsx)(M.zE,{label:"Results per page",value:e.get("pageSize")||12,onChange:e=>t("pageSize",e),options:[12,24,48,96]})]})}function $e(){const{searchParams:e,addQueryParam:t}=n();return(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsx)(M.Do,{label:"Only Complete",value:"true"===e.get("showComplete"),onChange:e=>t("showComplete",e?"true":""),className:"full-width m-0"}),(0,Z.jsx)(M.Do,{label:"Show Unrelated",value:"true"===e.get("showUnrelated"),onChange:e=>t("showUnrelated",e?"true":""),className:"full-width m-0"}),(0,Z.jsx)(M.Do,{label:"Show Unclear",value:"true"===e.get("showUnclear"),onChange:e=>t("showUnclear",e?"true":""),className:"full-width m-0"})]})}function We(){const{searchParams:e,addQueryParam:t}=n();return(0,Z.jsx)(Z.Fragment,{children:(0,Z.jsx)(M.Do,{label:"Show Glyphs",value:"true"===e.get("showGlyphs"),onChange:e=>t("showGlyphs",e?"true":""),className:"full-width m-0"})})}function Xe(){const{isDirty:e,save:t,prepareItemsAttributesFileForDownload:s,attributes:i,isSaving:a,attributesToUpdate:r}=P(),{view:l,setView:o}=n();return(0,Z.jsxs)(Ge.Pd,{children:[(0,Z.jsxs)(c.Z,{vertical:!0,gap:12,children:[(0,Z.jsx)(Qe.k,{isDirty:e,onSave:t,isSaving:a,dirt:JSON.stringify(r)}),(0,Z.jsx)(Re.o,{data:()=>function(e,t){const s=Object.keys(t).length;return Object.keys(e).forEach((i=>{const a=e[i],r=Object.keys(a.attributes).length;if(r===s){a.complete=!0;let e=0;a.score=Object.values(a.attributes).reduce(((t,s)=>s<=0?(s===A.NL.UNCLEAR&&(e+=1),s===A.NL.OPPOSITE&&(t+=s/2),t):t+s),0),a.reliability=Math.floor((r-e)/s*100),a.key=(0,b.Mg)(a,t,!0).join("")}else delete a.complete,delete a.score,delete a.reliability,delete a.key})),(0,b.Tj)(e)}(s(),i),fileName:"items-attribute-values.json",disabled:e,block:!0})]}),(0,Z.jsx)(m.Z,{}),(0,Z.jsx)(Be,{}),(0,Z.jsx)(M.zE,{label:"View",value:l,onChange:o,options:["classifier","sampler","grouping","comparator","simulator","stats"]}),(0,Z.jsx)(m.Z,{}),"classifier"===l&&(0,Z.jsx)(_e,{}),"sampler"===l&&(0,Z.jsx)(Ke,{}),"grouping"===l&&(0,Z.jsx)(qe,{}),"comparator"===l&&(0,Z.jsx)($e,{}),"stats"===l&&(0,Z.jsx)(We,{})]})}var Je=s(4562);function Ye(){const{isLoading:e,error:t,hasResponseData:s}=P();return(0,Z.jsx)(Ge.Xg,{title:"Items",subtitle:"Attribution",children:(0,Z.jsxs)(i.Z,{hasSider:!0,children:[(0,Z.jsx)(Je.p,{children:(0,Z.jsx)(Xe,{})}),(0,Z.jsx)(i.Z.Content,{className:"content",children:(0,Z.jsx)(a.T,{isLoading:e,error:t,hasResponseData:s,children:(0,Z.jsx)(Ve,{})})})]})})}const He=function(){return(0,Z.jsx)(N,{children:(0,Z.jsx)(Ye,{})})}}}]);
//# sourceMappingURL=ItemsAttribution.16d3632c.chunk.js.map