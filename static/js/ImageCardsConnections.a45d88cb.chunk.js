"use strict";(self.webpackChunktd_admin=self.webpackChunktd_admin||[]).push([[7286],{7018:(e,t,s)=>{s.d(t,{o:()=>c});var n=s(1413),a=s(4925),r=s(9475),i=s(5850),l=s(184);const o=["data","fileName","loading","children"];function c(e){let{data:t,fileName:s,loading:c,children:d}=e,h=(0,a.Z)(e,o);return(0,l.jsx)(r.ZP,(0,n.Z)((0,n.Z)({onClick:()=>(0,i.ZN)("function"===typeof t?t():t,s),loading:c},h),{},{children:null!==d&&void 0!==d?d:"Download JSON"}))}},8866:(e,t,s)=>{s.d(t,{N:()=>o});var n=s(1413),a=s(4925),r=s(6178),i=s(184);const l=["children","level"];function o(e){let{children:t,level:s}=e,o=(0,a.Z)(e,l);return(0,i.jsx)(r.Z.Title,(0,n.Z)((0,n.Z)({level:null!==s&&void 0!==s?s:3},o),{},{children:t}))}},8357:(e,t,s)=>{s.d(t,{tj:()=>c.tj,xh:()=>c.xh,H:()=>c.H,zE:()=>c.zE,Do:()=>c.Do,Th:()=>p,F6:()=>o});s(8866);var n=s(1413),a=s(4925),r=s(3733),i=s(184);const l=["children","active","activeClass","className","hoverType"],o=e=>{let{children:t,active:s=!1,activeClass:o="",className:c="",hoverType:d="scale"}=e,h=(0,a.Z)(e,l);return(0,i.jsx)("button",(0,n.Z)((0,n.Z)({className:(0,r.Z)("transparent-button","transparent-button--".concat(d),s&&(o||"transparent-button--active"),c)},h),{},{children:t}))};var c=s(2043),d=s(952),h=s(3070),u=s(7965);function g(e){let{isLoading:t,isIdle:s,error:n,isDirty:a,isError:r,hasResponseData:l}=e;return s?(0,i.jsx)(d.Z,{children:"No Data yet"}):t?(0,i.jsx)(d.Z,{color:"blue",children:"Loading..."}):n||r?(0,i.jsx)(d.Z,{color:"red",children:"Error"}):a?(0,i.jsx)(d.Z,{color:"orange",children:"Modified"}):l?(0,i.jsx)(d.Z,{color:"green",children:"Loaded"}):(0,i.jsx)(d.Z,{children:"No Data"})}function p(e){return(0,i.jsx)(u.Pd,{children:(0,i.jsx)(h.Z.Item,{label:"Status",children:(0,i.jsx)(g,(0,n.Z)({},e))})})}},145:(e,t,s)=>{s.d(t,{f:()=>l});var n=s(2241),a=s(3733),r=s(2606),i=s(184);const l=e=>{let{id:t,width:s=200,className:l="",preview:o=!0,fileExtension:c="jpg"}=e;const{getUrl:d}=(0,r.n)("images"),h=t.replace(/-/g,"/");return(0,i.jsx)("div",{className:(0,a.Z)("image-card",l),children:(0,i.jsx)(n.Z,{width:s,src:d("".concat(h,".").concat(c)),fallback:d("back/default.jpg"),preview:o})})}},7166:(e,t,s)=>{s.d(t,{P:()=>l,l:()=>o});var n=s(2791),a=s(1127),r=s(184);const i=(0,n.createContext)({}),l=e=>{let{children:t}=e;const s=(0,a.AZ)(),[l,o]=(0,n.useState)(15),[c,d]=(0,n.useState)(5),[h,u]=(0,n.useState)(150),[g,p]=(0,n.useState)(!1),v=(0,a.IN)(s.data,s.setDirty,l,c);return(0,r.jsx)(i.Provider,{value:{sampleSize:l,setSampleSize:o,tagThreshold:c,setTagThreshold:d,cardSize:h,setCardSize:u,showIds:g,setShowIds:p,randomGroups:v,query:s},children:t})},o=()=>(0,n.useContext)(i)},9936:(e,t,s)=>{s.d(t,{A:()=>o});var n=s(8622),a=s(3070),r=s(9367),i=s(7166),l=s(184);function o(){const{query:{stats:e}}=(0,i.l)();return(0,l.jsx)(a.Z.Item,{label:(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(r.C,{icon:(0,l.jsx)(n.Z,{}),shape:"square",size:"small",style:{marginRight:6}}),"Stats"]}),children:(0,l.jsxs)("ul",{className:"statistic__list",children:[(0,l.jsxs)("li",{children:["Completion: ",Math.floor(100*e.total/2520),"%"]}),(0,l.jsxs)("li",{children:["Total Relationships: ",e.total]}),(0,l.jsxs)("li",{children:["Complete: ",e.complete]}),(0,l.jsxs)("li",{children:["Overdone: ",e.overdone]}),(0,l.jsxs)("li",{children:["Single Match: ",e.single]})]})})}},1127:(e,t,s)=>{s.d(t,{AZ:()=>m,gU:()=>v,IN:()=>j});var n=s(4747),a=s(9631),r=s(763),i=s(2791),l=s(2592),o=s(5850),c=s(3713),d=s(2010),h=s(8556),u=s(4766);const g=()=>(0,r.padStart)(String((0,r.random)(1,252)),2,"0"),p=()=>(0,r.random)(1,12);function v(e,t){var s,n,a;const[r,l]=(0,i.useState)(p()),[c,d]=(0,i.useState)(g()),[h,v]=(0,i.useState)(p()),[m,j]=(0,i.useState)(g()),x="td-d".concat(r,"-").concat(c),S="td-d".concat(h,"-").concat(m),[f,y]=(0,i.useState)(0),{queryParams:Z}=(0,u.K)(),C=Number(null!==(s=Z.get("cycle"))&&void 0!==s?s:3),b=null!==(n=null===e||void 0===e?void 0:e[x])&&void 0!==n?n:[],I=null!==(a=null===e||void 0===e?void 0:e[S])&&void 0!==a?a:[],E=()=>{y(0),l(p()),d(g()),v(p()),j(g())};return(0,i.useEffect)((()=>{x===S&&j(g())}),[x,S]),{cardAId:x,cardA:b,cardBId:S,cardB:I,relate:()=>{y(0),b.push(S),e[x]=(0,o.R1)(b),I.push(x),e[S]=(0,o.R1)(I),t(!0),l(h),d(m),v(p()),j(g())},unrelate:()=>{f>=C?(y(0),E()):(y((e=>e+1)),v(p()),j(g()))},areRelated:b.includes(S),onRandomCards:E}}function m(){const[e,t]=(0,i.useState)(!1),s=["data/imageCardsRelationships"],r=(0,c.NL)(),{notification:o}=n.Z.useApp(),[u,g]=(0,i.useState)({total:0,overdone:0,complete:0,single:0}),{data:p={},isLoading:v,isSuccess:m,isError:j,error:x,isFetched:S,isRefetching:f,refetch:y}=(0,d.a)({queryKey:s,queryFn:async()=>{var e;const t=(0,a.JU)(l.RZ,"data/imageCardsRelationships");return null!==(e=(await(0,a.QT)(t)).data())&&void 0!==e?e:{}}}),{isPending:Z,isError:C,isSuccess:b,mutate:I}=(0,h.D)({mutationKey:s,mutationFn:async()=>{const e=(0,a.JU)(l.RZ,"data/imageCardsRelationships");return await(0,a.pl)(e,p),p},onSuccess:()=>{o.success({message:"Saved",placement:"bottomLeft"}),r.refetchQueries({queryKey:s}),t(!1)}});return(0,i.useEffect)((()=>{if(!f&&S){const e=Object.keys(p).length;let t=0,s=0,n=0;Object.values(p).forEach((e=>{e.length>8&&(t+=1),1===e.length&&(n+=1),e.length>2&&(s+=1)})),g({total:e,overdone:t,complete:s,single:n})}}),[S,f]),{data:p,isLoading:v,isSuccess:m,isError:j,error:x,hasData:m&&Object.keys(p).length>0,refetch:y,isSaving:Z,isMutationError:C,isSaved:b,save:I,setDirty:t,isDirty:e,stats:u}}function j(e,t,s,n){const[a,r]=(0,i.useState)([]),[l,c]=(0,i.useState)([]),[d,h]=(0,i.useState)([]),[u,v]=(0,i.useState)(0),[m,j]=(0,i.useState)(!0),[x,S]=(0,i.useState)([]),f=t=>{c((null!==t&&void 0!==t?t:a).map((t=>{var s;return null!==(s=null===e||void 0===e?void 0:e[t])&&void 0!==s?s:[]})))},y=()=>{const t=[...x];let a=0;const i=d.length<2e3?d:[];let l=0;for(;l<400&&t.length<s;){var o;const s="td-d".concat(p(),"-").concat(g()),r=null!==(o=e[s])&&void 0!==o?o:[],c=!(n>0)||r.length<n,d=!!m&&i.includes(s);t.includes(s)||d||!c||(t.push(s),a+=1),l+=1}r(t),h((e=>[...e,...t])),f(t),v((e=>e+a))};(0,i.useEffect)((()=>{0===a.length&&y()}),[a]);return{cardIds:a,cards:l,selection:x,onSelect:e=>{S((t=>{const s=[...t],n=s.indexOf(e);return n>-1?s.splice(n,1):s.push(e),s}))},relate:()=>{x.forEach((t=>{var s;const n=null!==(s=e[t])&&void 0!==s?s:[];n.push(...x.filter((e=>e!==t))),e[t]=(0,o.R1)(n)})),t(!0),S([]),f(),h([]),v(0)},nextSet:y,deselectAll:()=>{S([])},cycles:u,filters:{useCycles:m,toggleUseCycles:()=>{j((e=>!e))}}}}},4766:(e,t,s)=>{s.d(t,{K:()=>r});var n=s(1087),a=s(263);function r(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const[t,s]=(0,n.lr)(),r=(e,n,a)=>{void 0===n||""===n||n===a?t.delete(e):t.set(e,String(n)),s(t)},i=function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Object.entries(e).forEach((e=>{let[s,a]=e;n[s]===a?t.delete(s):t.set(s,String(a))})),s(t)},l=e=>{t.delete(e),s(t)},o=function(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"true";return t.get(e)===String(s)};return(0,a.Z)((()=>{Object.entries(e).forEach((e=>{let[s,n]=e;t.has(s)||r(s,n)}))})),{addParam:r,addParams:i,removeParam:l,queryParams:t,is:o}}},6411:(e,t,s)=>{s.r(t),s.d(t,{default:()=>w});var n=s(1790),a=s(4925),r=s(4520),i=s(1046),l=s(952),o=s(2786),c=s(2128),d=s(763),h=s(2791),u=s(7415),g=s(7507),p=s(145),v=s(7166),m=s(184);const j=["isDirty","isSaving","save","stats","data"];function x(){const e=(0,v.l)(),{query:{isDirty:t,isSaving:s,save:n,stats:x,data:f},randomGroups:{cardIds:y},showIds:Z,cardSize:C}=e,b=(0,a.Z)(e.query,j),[I,{width:E}]=(0,u.Z)(),[,w]=(0,h.useMemo)((()=>{const e=Math.floor(E/C)+1;return[e,Math.floor(E/e)]}),[C,E]),N=[{title:"Length",dataIndex:"length",key:"length"},{title:"Relationships",dataIndex:"relationships",key:"relationship",render:(e,t)=>(0,m.jsx)(r.Z,{wrap:"wrap",gap:2,children:e.map((s=>(0,m.jsxs)(i.Z,{children:[(0,m.jsxs)(i.Z,{direction:"vertical",children:[(0,m.jsx)(p.f,{id:s,width:w}),Z&&(0,m.jsx)(l.Z,{children:s})]}),e[e.length-1]!==s&&(0,m.jsx)(g.Z,{})]},"".concat(t.origin,"-").concat(s))))})}],D=(0,h.useMemo)((()=>(0,d.orderBy)(y.map((e=>{const t=S(e,f,"longest",10);return{key:e,origin:e,length:t.length,relationships:t}})),["length"],["desc"])),[y,f]);return(0,m.jsx)(c.T,{isLoading:b.isLoading,error:b.error,hasResponseData:!0,children:(0,m.jsx)("div",{ref:I,className:"my-6",children:(0,m.jsx)(o.Z,{dataSource:D,columns:N})})})}const S=(0,d.memoize)(((e,t,s,n)=>{const a=new Set,r=[];let i=[],l=0;for(r.push({currentId:e,path:[],depth:0});r.length>0&&l<100;){var o;l++;const{currentId:e,path:c,depth:d}=null!==(o=r.pop())&&void 0!==o?o:{currentId:"",path:[],depth:0};if(a.add(e),c.push(e),"longest"===s&&c.length>i.length&&(i=[...c]),"shortest"===s&&(0===i.length||c.length<i.length)&&(i=[...c]),"any"===s&&0===i.length&&(i=[...c]),!(d>=n))for(const s of t[e]||[])a.has(s)||r.push({currentId:s,path:[...c],depth:d+1})}return i}));var f=s(9475),y=s(8357),Z=s(7018),C=s(7965),b=s(6591),I=s(9936);function E(){const{query:{isDirty:e,isSaving:t,data:s,isLoading:n,isError:a},showIds:r,setShowIds:i,sampleSize:l,setSampleSize:o,cardSize:c,setCardSize:h,randomGroups:{nextSet:u}}=(0,v.l)();return(0,m.jsxs)(C.p3,{children:[(0,m.jsx)(y.Th,{isLoading:n||t,isDirty:e,isError:a,hasResponseData:!(0,d.isEmpty)(s)}),(0,m.jsxs)(C.Pd,{children:[(0,m.jsx)(y.Do,{label:"Show Ids",value:r,onChange:e=>i(e)}),(0,m.jsx)(y.zE,{onChange:e=>o(e),value:l,options:b.ZI,label:"Sample Size"}),(0,m.jsx)(y.zE,{onChange:e=>h(e),value:c,options:b.Hn,label:"Card Size"}),(0,m.jsx)(f.ZP,{onClick:u,block:!0,type:"primary",children:"New Random Sample"})]}),(0,m.jsx)(C.Pd,{children:(0,m.jsx)(I.A,{})}),(0,m.jsx)(C.Pd,{children:(0,m.jsx)(Z.o,{data:s,fileName:"imageCardsRelationships.json",loading:t,disabled:(0,d.isEmpty)(s),block:!0})})]})}const w=function(){return(0,m.jsx)(C.Xg,{title:"Image Cards",subtitle:"Connections",children:(0,m.jsx)(v.P,{children:(0,m.jsxs)(n.Z,{hasSider:!0,children:[(0,m.jsx)(E,{}),(0,m.jsx)(n.Z.Content,{className:"content",children:(0,m.jsx)(x,{})})]})})})}}}]);
//# sourceMappingURL=ImageCardsConnections.a45d88cb.chunk.js.map