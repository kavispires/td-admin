"use strict";(self.webpackChunktd_admin=self.webpackChunktd_admin||[]).push([[6213],{7018:(e,a,t)=>{t.d(a,{o:()=>c});var n=t(1413),r=t(4925),o=t(9475),i=t(5850),d=t(184);const s=["data","fileName","loading","children"];function c(e){let{data:a,fileName:t,loading:c,children:l}=e,u=(0,r.Z)(e,s);return(0,d.jsx)(o.ZP,(0,n.Z)((0,n.Z)({onClick:()=>(0,i.ZN)("function"===typeof a?a():a,t),loading:c},u),{},{children:null!==l&&void 0!==l?l:"Download JSON"}))}},8384:(e,a,t)=>{t.d(a,{x:()=>u});var n=t(1413),r=t(4925),o=t(732),i=t(6473),d=t(9475),s=t(3733),c=t(184);const l=["open","onClose"];function u(e){let{open:a,onClose:t}=e,u=(0,r.Z)(e,l);return(0,c.jsx)(i.Z,(0,n.Z)({className:(0,s.Z)("full-screen-modal",!a&&"full-screen-modal--hidden"),bordered:!1,extra:(0,c.jsx)(d.ZP,{onClick:t,type:"text",shape:"circle",icon:(0,c.jsx)(o.Z,{})})},u))}},7340:(e,a,t)=>{t.d(a,{k:()=>f});var n=t(1413),r=t(4925),o=t(9475),i=t(2426),d=t.n(i),s=t(2791),c=t(8211),l=t(4483),u=t(4841),g=t(184);const m=["isDirty","onSave","isSaving","dirt","interval"];function f(e){let{isDirty:a,onSave:t,isSaving:i,dirt:f,interval:v=6e5}=e,p=(0,r.Z)(e,m);const{togglePendingSave:y}=(0,u.b)(),[,h,Z]=(0,c.Z)((()=>{a&&t()}),v);return(0,s.useEffect)((()=>{a?(y(!0),console.log("Save Reset",d()(Date.now()).format("MM/DD/YYYY HH:mm:ss")),Z()):(y(!1),h())}),[a,Z,h,f]),(0,s.useEffect)((()=>{const e=e=>{if(a){const a="You have unsaved changes, are you sure you want to leave?";return e.returnValue=a,a}};return window.addEventListener("beforeunload",e),()=>{window.removeEventListener("beforeunload",e)}}),[a]),(0,g.jsx)(o.ZP,(0,n.Z)((0,n.Z)({type:"primary",size:"large",icon:(0,g.jsx)(l.Z,{}),onClick:t,disabled:!a,loading:i,danger:!0,block:!0},p),{},{children:"Save"}))}},145:(e,a,t)=>{t.d(a,{f:()=>d});var n=t(2241),r=t(3733),o=t(2606),i=t(184);const d=e=>{let{id:a,width:t=200,className:d="",preview:s=!0,fileExtension:c="jpg"}=e;const{getUrl:l}=(0,o.n)("images"),u=a.replace(/-/g,"/");return(0,i.jsx)("div",{className:(0,r.Z)("image-card",d),children:(0,i.jsx)(n.Z,{width:t,src:l("".concat(u,".").concat(c)),fallback:l("back/default.jpg"),preview:s})})}},8027:(e,a,t)=>{t.d(a,{A:()=>s,X:()=>c});var n=t(1413),r=t(9631),o=t(2592),i=t(2010),d=t(5850);function s(e,a){return async()=>{var t;console.log("%cQuerying ".concat(e,"/").concat(a," from firebase: ").concat((0,d.xE)()),"color: #f0f");const n=(0,r.JU)(o.RZ,"".concat(e,"/").concat(a));return null!==(t=(await(0,r.QT)(n)).data())&&void 0!==t?t:{}}}function c(e,a,t){return(0,i.a)((0,n.Z)({queryKey:["firebase",e,a],queryFn:s(e,a)},t))}},4766:(e,a,t)=>{t.d(a,{K:()=>o});var n=t(1087),r=t(263);function o(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const[a,t]=(0,n.lr)(),o=(e,n,r)=>{void 0===n||""===n||n===r?a.delete(e):a.set(e,String(n)),t(a)},i=function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Object.entries(e).forEach((e=>{let[t,r]=e;n[t]===r?a.delete(t):a.set(t,String(r))})),t(a)},d=e=>{a.delete(e),t(a)},s=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"true";return a.get(e)===String(t)};return(0,r.Z)((()=>{Object.entries(e).forEach((e=>{let[t,n]=e;a.has(t)||o(t,n)}))})),{addParam:o,addParams:i,removeParam:d,queryParams:a,is:s}}},8938:(e,a,t)=>{t.d(a,{i:()=>g});var n=t(1413),r=t(4747),o=t(763),i=t(2791),d=t(3713),s=t(5850),c=t(8027),l=t(5529),u=t(2233);function g(e){let{tdrResourceName:a,firebaseDataCollectionName:t,serialize:g}=e;const{notification:m}=r.Z.useApp(),f=(0,d.NL)(),v=(0,l.N)(a),p=(0,c.X)("tdr",t,{select:g?s.d_:void 0}),[y,h]=(0,i.useState)({}),Z=(0,u.B)("tdr",t,{onSuccess:()=>{m.success({message:"".concat(t," updated")}),f.refetchQueries({queryKey:["firebase","tdr",t]}),h({})},onError:e=>{m.error({message:"".concat(t," update failed"),description:e.message})}}),j=(0,i.useMemo)((()=>{var e,r;return v.isSuccess&&p.isSuccess&&!Z.isPending?(console.log("%cMerging ".concat(a,"+").concat(t," data..."),"color: #f0f"),(0,o.cloneDeep)((0,n.Z)((0,n.Z)((0,n.Z)({},null!==(e=v.data)&&void 0!==e?e:{}),null!==(r=p.data)&&void 0!==r?r:{}),y))):{}}),[a,t,v.data,p.data,v.isSuccess,p.isSuccess,Z.isPending,y]),x=!(0,o.isEmpty)(y),C=p.data;return{data:j,isLoading:v.isLoading||p.isLoading,error:v.error||p.error,firebaseData:C,isSaving:Z.isPending,save:()=>{Z.mutate(g?(0,s.aS)(y):y)},addEntryToUpdate:(e,a)=>{h((t=>(0,n.Z)((0,n.Z)({},t),{},{[e]:a})))},entriesToUpdate:y,isDirty:x}}},5529:(e,a,t)=>{t.d(a,{N:()=>d,Y:()=>s});var n=t(1413),r=t(763),o=t(2010),i=t(2606);function d(e){var a;let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const{getUrl:d}=(0,i.n)("resources"),s=(0,o.a)({queryKey:[e],queryFn:async()=>{const a=await fetch(d("".concat(e,".json")));return await a.json()},enabled:t}),c=!(0,r.isEmpty)(s.data);return(0,n.Z)((0,n.Z)({},s),{},{data:null!==(a=s.data)&&void 0!==a?a:{},hasResponseData:c})}function s(e){let a=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const{getUrl:t}=(0,i.n)("resources"),d=(0,o.a)({queryKey:[e],queryFn:async()=>{const a=await fetch(t("".concat(e,".json")));return await a.json()},enabled:a}),s=!(0,r.isEmpty)(d.data);return(0,n.Z)((0,n.Z)({},d),{},{data:d.data,hasResponseData:s})}},548:(e,a,t)=>{t.d(a,{P:()=>r});var n=t(4766);function r(e){var a,t;let{prefix:r="",defaultCurrent:o=1,defaultPageSize:i=10,pageSizeOptions:d=[10,20,50,100],total:s,showQuickJumper:c}=e;const{queryParams:l,addParam:u}=(0,n.K)();return{current:Number(null!==(a=l.get("".concat(r,"page")))&&void 0!==a?a:String(o)),pageSize:Number(null!==(t=l.get("".concat(r,"pageSize")))&&void 0!==t?t:String(i)),onChange:e=>{u("".concat(r,"page"),e.toString(),String(o))},onShowSizeChange:(e,a)=>{u("".concat(r,"pageSize"),a.toString(),String(i))},defaultCurrent:o,defaultPageSize:i,pageSizeOptions:d,total:s,hideOnSinglePage:!0,showQuickJumper:c}}},2233:(e,a,t)=>{t.d(a,{B:()=>s});var n=t(1413),r=t(9631),o=t(2592),i=t(8556);function d(e,a,t){console.log("%cUpdating ".concat(e,"/").concat(a," from firebase"),"color: #f00");const n=(0,r.JU)(o.RZ,"".concat(e,"/").concat(a));return(0,r.r7)(n,t)}function s(e,a){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return(0,i.D)((0,n.Z)({mutationFn:async t=>d(e,a,t)},t))}},204:(e,a,t)=>{t.r(a),t.d(a,{ImageCardsDescriptor:()=>Q,default:()=>Y});var n=t(1413),r=t(1790),o=t(2128),i=t(4766),d=t(5529),s=t(763);function c(){var e;const a=(0,d.N)("images-decks"),t=null!==(e=a.data)&&void 0!==e?e:{},r=()=>{if((0,s.isEmpty)(t))return"td-d0-00";const e=(0,s.sample)(Object.keys(t));if(!e)return"td-d0-00";const a=(0,s.random)(1,t[e]);return console.log({randomDeckNumber:e,randomCardNumber:a}),"".concat(e,"-").concat(a.toString().padStart(2,"0"))};return(0,n.Z)((0,n.Z)({},a),{},{decks:t,decksList:Object.keys(t),onRandomCard:r,onRandomUniqueCard:e=>{let a=0;for(;a<30;){const t=r();if(!e.includes(t))return t;a++}if(a>30)throw new Error("Could not find a unique card")},onRandomCards:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10;const a=[];let t=0;for(;Object.keys(a).length<e&&t<30;){const e=r();a.includes(e)?t++:a.push(e)}if(t>30&&a.length<e)throw new Error("Could not find enough unique cards");return a}})}var l=t(4520),u=t(9475),g=t(5625),m=t(145),f=t(1752),v=t(548),p=t(4925),y=t(8384),h=t(6979),Z=t(7515),j=t(906),x=t(959),C=t(7391),S=t(5850),w=t(184);const b=["imageCard","addEntryToUpdate"],k=["imageCard","addEntryToUpdate","style"],P=["imageCard","addEntryToUpdate","style"];function N(e){var a,t;let{data:n,addEntryToUpdate:r,onClose:o,onNewCard:d}=e;const{queryParams:s,removeParam:c,addParam:g}=(0,i.K)(),f=Number(null!==(a=s.get("cardSize"))&&void 0!==a?a:200),v=s.get("cardId"),p=null!==(t=n[null!==v&&void 0!==v?v:""])&&void 0!==t?t:{id:v,keywords:[]};return(0,w.jsx)(y.x,{title:"Image Card Descriptor for ".concat(v),open:!!v,onClose:()=>c("cardId"),cover:(0,w.jsx)(l.Z,{justify:"center",align:"center",style:{width:"100vw"},children:(0,w.jsx)(m.f,{id:null!==v&&void 0!==v?v:"",width:f})}),actions:[(0,w.jsx)(u.ZP,{className:"my-10",onClick:o,children:"Close"},"cancel"),(0,w.jsx)(u.ZP,{className:"my-10",onClick:d,children:"New Card"},"cancel")],children:(0,w.jsxs)(l.Z,{gap:8,vertical:!0,style:{maxWidth:"500px"},children:[(0,w.jsx)(h.Z,{value:f,min:100,max:500,step:25,style:{maxWidth:500,width:"100%"},onChange:e=>g("cardSize",e,200)}),(0,w.jsx)(E,{imageCard:p,addEntryToUpdate:r,size:"large"}),(0,w.jsx)(D,{imageCard:p,addEntryToUpdate:r,size:"large"}),(0,w.jsx)(U,{imageCard:p,addEntryToUpdate:r,size:"large"})]},v)})}function E(e){let{imageCard:a,addEntryToUpdate:t}=e,r=(0,p.Z)(e,b);const o=a.favorite;return(0,w.jsx)(u.ZP,(0,n.Z)({shape:"circle",icon:o?(0,w.jsx)(x.Z,{style:{color:"red"}}):(0,w.jsx)(C.Z,{}),type:"text",onClick:()=>t(a.id,(0,n.Z)((0,n.Z)({},a),{},{favorite:!o}))},r))}function D(e){let{imageCard:a,addEntryToUpdate:t,style:r}=e,o=(0,p.Z)(e,k);return(0,w.jsx)(Z.Z.Search,(0,n.Z)({defaultValue:a.keywords.join(" "),onSearch:e=>{return r=e,void t(a.id,(0,n.Z)((0,n.Z)({},a),{},{keywords:(0,S.R1)(r.toLocaleLowerCase().split(/, |,| /).filter(Boolean).map((e=>e.trim())).sort())}));var r},style:(0,n.Z)({maxWidth:500,width:"100%"},r),enterButton:"Update"},o))}function U(e){let{imageCard:a,addEntryToUpdate:t,style:r}=e,o=(0,p.Z)(e,P);return(0,w.jsx)(j.Z,(0,n.Z)({mode:"multiple",allowClear:!0,style:(0,n.Z)({width:"100%"},r),placeholder:"Please select",defaultValue:null===a||void 0===a?void 0:a.triggers,onChange:e=>{t(a.id,(0,n.Z)((0,n.Z)({},a),{},{triggers:e}))},options:[{label:"aliens",value:"aliens"},{label:"insets",value:"insets"},{label:"snakes",value:"snakes"},{label:"spiders",value:"spiders"},{label:"scarry",value:"scarry"}]},o))}function T(e){let{data:a,addEntryToUpdate:t}=e;const{addParam:n}=(0,i.K)(),r=[{title:"CardId",dataIndex:"id",key:"id",sorter:(e,a)=>Number(e.id)-Number(a.id)},{title:"Image",dataIndex:"id",key:"image",render:e=>(0,w.jsx)(m.f,{id:e,width:50})},{title:"Keywords",dataIndex:"keywords",key:"keywords",render:e=>null===e||void 0===e?void 0:e.join(", ")},{title:"Triggers",dataIndex:"triggers",key:"triggers",render:e=>null===e||void 0===e?void 0:e.join(", ")},{title:"Actions",key:"actions",render:(e,a)=>(0,w.jsxs)(l.Z,{children:[(0,w.jsx)(E,{imageCard:a,addEntryToUpdate:t}),(0,w.jsx)(u.ZP,{icon:(0,w.jsx)(f.Z,{}),onClick:()=>n("cardId",a.id),children:"Edit"})]})}],o=Object.values(a),d=(0,v.P)({total:o.length,showQuickJumper:!0});return(0,w.jsx)(g.Z,{dataSource:o,columns:r,rowKey:"id",pagination:d})}function R(e){var a;const t=c(),r=(0,d.N)("images-credo"),{addParam:s,removeParam:l}=(0,i.K)();return(0,w.jsxs)(o.T,{isLoading:t.isLoading||r.isLoading,hasResponseData:t.hasResponseData||r.hasResponseData,error:null!==(a=r.error)&&void 0!==a?a:t.error,children:[(0,w.jsx)(T,(0,n.Z)({},e)),(0,w.jsx)(N,(0,n.Z)((0,n.Z)({},e),{},{onNewCard:()=>s("cardId",t.onRandomCard()),onClose:()=>l("cardId")}))]})}var z=t(7128),I=t(7018),L=t(7340),q=t(7965);function K(e){let{data:a,save:t,isDirty:n,isSaving:r,entriesToUpdate:o}=e;const{addParam:d}=(0,i.K)(),{onRandomCard:g}=c();return(0,w.jsxs)(q.Pd,{children:[(0,w.jsxs)(l.Z,{vertical:!0,gap:12,children:[(0,w.jsx)(L.k,{isDirty:n,onSave:t,isSaving:r,dirt:JSON.stringify(o)}),(0,w.jsx)(I.o,{data:()=>function(e){console.log("Preparing file for download...");const a=(0,s.cloneDeep)(e);return(0,S.Tj)(a)}(a),fileName:"image-cards.json",disabled:n,block:!0})]}),(0,w.jsx)(z.Z,{}),(0,w.jsx)(u.ZP,{onClick:()=>d("cardId",g()),block:!0,children:"Random Card"}),(0,w.jsx)(z.Z,{})]})}var O=t(4562),J=t(8938);function Q(){const e=(0,J.i)({tdrResourceName:"image-cards",firebaseDataCollectionName:"imageCards",serialize:!0});return(0,w.jsx)(q.Xg,{title:"Image Cards Descriptor",subtitle:"Teenage Student Cards",children:(0,w.jsxs)(r.Z,{hasSider:!0,children:[(0,w.jsx)(O.p,{children:(0,w.jsx)(K,(0,n.Z)({},e))}),(0,w.jsx)(r.Z.Content,{className:"content",children:(0,w.jsx)(o.T,{isLoading:e.isLoading,error:e.error,hasResponseData:!(0,s.isEmpty)(e.data),children:(0,w.jsx)(R,(0,n.Z)({},e))})})]})})}const Y=Q}}]);
//# sourceMappingURL=ImageCardsDescriptor.72780eb0.chunk.js.map