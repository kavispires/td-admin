"use strict";(self.webpackChunktdr=self.webpackChunktdr||[]).push([[407],{9961:(t,e,a)=>{a.d(e,{m:()=>i});var n=a(2556),r=a(5657),s=a(7134),o=a(184);function i(t){let{content:e,shape:a,icon:i,size:l,...u}=t;const d=(0,s._)();return(0,o.jsx)(n.ZP,{shape:null!==a&&void 0!==a?a:"circle",icon:null!==i&&void 0!==i?i:(0,o.jsx)(r.Z,{}),size:null!==l&&void 0!==l?l:"small",onClick:()=>d(e),...u})}},9547:(t,e,a)=>{a.d(e,{Ld:()=>N,l9:()=>E,ve:()=>S});var n=a(4747),r=a(2481),s=a(2748),o=a(8556);const i={SUFFIX_DATA:{pt:"drawingsPT",en:"drawingsEN"},DAILY:{pt:"diario",en:"daily"}};var l=a(8027),u=a(2791),d=a(2010);function c(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{notification:a}=n.Z.useApp(),r=(0,d.a)({queryKey:[t,"history"],queryFn:(0,l.A)(t,"history"),...e});return(0,u.useEffect)((()=>{r.isSuccess&&(0,s.tS)("Loaded daily/history")}),[r.isSuccess]),(0,u.useEffect)((()=>{r.isError&&a.error({message:"Error loading daily/history",placement:"bottomLeft"})}),[r.isError]),r}var m=a(7342);var f=a(763),v=a(2606);var p=a(5529),h=a(2426),g=a.n(h);function y(){return g()().format("YYYY-MM-DD")}function b(t){return g()(t,"YYYY-MM-DD").add(1,"days").format("YYYY-MM-DD")}function D(t){const e=[],a={};let n=0;for(;e.length<4&&n<500;){var r;const s=null!==(r=(0,f.sample)(t))&&void 0!==r?r:"",o=s.split("");o.every((t=>!a[t]))?(e.push(s),o.forEach((t=>{a[t]=!0}))):n++}if(n>500||e.length<4)for(console.count("Could not find 4 words with unique letters");e.length<4;){var s;const a=null!==(s=(0,f.sample)(t))&&void 0!==s?s:"";e.includes(a)||e.push(a)}return e.length<4&&console.error("Could not find 4 words with unique letters",e),e}function w(t,e){const a=(0,u.useMemo)((()=>{var a;return null!==(a=null===e||void 0===e?void 0:e[t])&&void 0!==a?a:{latestDate:y(),latestNumber:0,used:"[]"}}),[e,t]);return[(0,u.useMemo)((()=>{var t,e,n;return{latestNumber:null!==(t=null===a||void 0===a?void 0:a.latestNumber)&&void 0!==t?t:0,latestDate:null!==(e=null===a||void 0===a?void 0:a.latestDate)&&void 0!==e?e:y(),used:JSON.parse(null!==(n=null===a||void 0===a?void 0:a.used)&&void 0!==n?n:"[]")}}),[a]),a]}function N(t,e,a,r){const o=c(i.DAILY[null!==e&&void 0!==e?e:"pt"],{enabled:t}),h=function(t,e){var a,r;const{notification:o}=n.Z.useApp(),c=(0,d.a)({queryKey:["data","suffixCounts"],queryFn:(0,l.A)("data","suffixCounts"),enabled:t});(0,u.useEffect)((()=>{c.isSuccess&&(0,s.tS)("Loaded data/suffixCounts")}),[c.isSuccess]),(0,u.useEffect)((()=>{c.isError&&o.error({message:"Error loading data/suffixCounts",placement:"bottomLeft"})}),[c.isError]);const f=i.SUFFIX_DATA[null!==e&&void 0!==e?e:"pt"],v=null!==(a=null===(r=c.data)||void 0===r?void 0:r[f])&&void 0!==a?a:0,p="drawings".concat("pt"===e?"PT":"EN"),h=(0,u.useMemo)((()=>new Array(v).fill(0).map(((e,a)=>({queryKey:["data","".concat(p).concat(a+1)],queryFn:(0,l.A)("data","".concat(p).concat(a+1)),enabled:t&&Boolean(v),onSuccess:()=>{o.info({message:"Data Drawings ".concat(p).concat(a+1," loaded"),placement:"bottomLeft"})}})))),[v]);return(0,m.h)({queries:h})}(t,null!==e&&void 0!==e?e:"pt"),g=h.some((t=>t.isLoading)),[y]=w("arte-ruim",o.data),N=(0,u.useMemo)((()=>{console.count("Creating Arte Ruim...");const t=(null!==h&&void 0!==h?h:[]).reduce(((t,a)=>{var n;const r=null!==(n=a.data)&&void 0!==n?n:{};return Object.entries(r).forEach((a=>{var n;let[r,s]=a;const o=null!==(n=s.cardId)&&void 0!==n?n:s.id;if(s.drawing.trim().length<10)return console.warn("Empty drawing",o),t;void 0===t[o]?t[o]={id:o,type:"arte-ruim",language:null!==e&&void 0!==e?e:"pt",cardId:o,text:s.text,drawings:[s.drawing],number:0,dataIds:[r]}:(t[o].drawings.push(s.drawing),t[o].dataIds.push(r))})),t}),{}),n=Object.values(t).filter((t=>{var e;return t.drawings.length>=a&&t.cardId&&!(null!==(e=t.cardId)&&void 0!==e&&e.includes("--"))})),s=Object.values(n).filter((t=>!y.used.includes(t.cardId))),o=(0,f.sampleSize)((0,f.shuffle)(s),r);let i=y.latestDate;return o.map(((t,e)=>{const a=b(i);return i=a,{...t,id:a,number:y.latestNumber+e+1}}))}),[h,e,y,r,a]),q=(0,p.N)("aqui-o-sets"),[A]=w("aqui-o",o.data),E=(0,u.useMemo)((()=>{console.count("Creating Aqui \xd3...");const t=(0,f.shuffle)(Object.values(q.data).filter((t=>t.itemsIds.filter(Boolean).length>=20)));let e=t.filter((t=>!A.used.includes(t.id)));e.length<r&&e.push(...(0,f.shuffle)(t));let a=A.latestDate;const n={};for(let s=0;s<r;s++){const t=e[s];if(!t)break;const r=b(a);a=r,n[r]={id:r,type:"aqui-o",number:A.latestNumber+s+1,setId:t.id,title:t.title,itemsIds:["0",...(0,f.sampleSize)(t.itemsIds,20)]}}return n}),[q,A,r]),S=function(t,e){var a;let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=arguments.length>3?arguments[3]:void 0;const{getUrl:s}=(0,v.n)("tdr"),o=r?"words-".concat(t,"-letters-selected-").concat(e):"words-".concat(t,"-letters-").concat(e),i=(0,d.a)({queryKey:[o],queryFn:async()=>{const t=await fetch(s("".concat(o,".json")));return await t.json()},enabled:n&&!!t&&!!e}),l=!(0,f.isEmpty)(i.data);return{...i,data:null!==(a=i.data)&&void 0!==a?a:[],hasResponseData:l}}(4,e,!0,!0),[x]=w("palavreado",o.data),I=(0,u.useMemo)((()=>{console.count("Creating Palavreado...");let t=x.latestDate;const e={};for(let a=0;a<r;a++){const n=D(S.data),r=(0,f.shuffle)(n.join("").split("")),s=b(t);t=s,e[s]={id:s,type:"palavreado",number:x.latestNumber+a+1,words:n,letters:r}}return e}),[S,x,r]),Z=(0,p.N)("arte-ruim-cards-".concat(e)),[j]=w("artista",o.data),L=(0,u.useMemo)((()=>{console.count("Creating Artista...");let t=j.latestDate;const e={};for(let n=0;n<r;n++){var a;const r=b(t),s=Object.keys(null!==(a=Z.data)&&void 0!==a?a:{}).filter((t=>!y.used.includes(t))),o=(0,f.sampleSize)(s,15).map((t=>Z.data[t]));t=r,e[r]={id:r,type:"artista",number:j.latestNumber+n+1,cards:o}}return e}),[Z,y,j,r]),Y=(0,u.useMemo)((()=>(console.count("Bundling entries..."),N.map((t=>({id:t.id,"arte-ruim":t,"aqui-o":E[t.id],palavreado:I[t.id],artista:L[t.id]}))))),[N,E,I,L]);return{isLoading:g||o.isLoading,entries:Y}}var q=a(5850),A=a(3713);function E(t){const{notification:e}=n.Z.useApp(),a=(0,A.NL)(),l=i.DAILY[null!==t&&void 0!==t?t:"pt"],[d,m]=(0,u.useState)(!1),f=c(l,{enabled:Boolean(l)}),v=(0,o.D)({mutationFn:async t=>{var e;const a=t.map((t=>{const e=(0,r.JU)(s.RZ,"".concat(l,"/").concat(t.id));return(0,r.pl)(e,t)})),n=(0,r.JU)(s.RZ,"".concat(l,"/history")),o=f.data;if(!o)throw new Error("No previous history");const i={...o,"arte-ruim":{latestDate:t[t.length-1].id,latestNumber:t[t.length-1]["arte-ruim"].number,used:JSON.stringify((0,q.R1)([...JSON.parse(o["arte-ruim"].used),...t.map((t=>t["arte-ruim"].cardId))]))},"aqui-o":{latestDate:t[t.length-1].id,latestNumber:t[t.length-1]["aqui-o"].number,used:JSON.stringify((0,q.R1)([...JSON.parse(null!==(e=o["aqui-o"].used)&&void 0!==e?e:"[]"),...t.map((t=>t["aqui-o"].setId))]))},palavreado:{latestDate:t[t.length-1].id,latestNumber:t[t.length-1].palavreado.number,used:"[]"},artista:{latestDate:t[t.length-1].id,latestNumber:t[t.length-1].artista.number,used:"[]"}};return(0,r.pl)(n,i),Promise.all(a)},onSuccess:()=>{e.info({message:"Data saved",placement:"bottomLeft"}),a.invalidateQueries({queryKey:[l,"history"]}),m(!1)},onError:()=>{e.error({message:"Error saving data",placement:"bottomLeft"})}});return{isDirty:d,setIsDirty:m,save:v.mutateAsync,isPending:v.isPending}}function S(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];const{notification:e}=n.Z.useApp(),a=i.DAILY.pt,l=(0,o.D)({mutationFn:async t=>{const e=(0,r.JU)(s.RZ,"".concat(a,"/history"));(0,r.pl)(e,t)},onSuccess:()=>{e.info({message:"New history data saved",placement:"bottomLeft"})}}),u=c(a,{enabled:t});return{mutation:l,historyQuery:u}}},8027:(t,e,a)=>{a.d(e,{A:()=>i,X:()=>l});var n=a(2481),r=a(2748),s=a(2010),o=a(5850);function i(t,e){return async()=>{var a;console.log("%cQuerying ".concat(t,"/").concat(e," from firebase: ").concat((0,o.xE)()),"color: #f0f");const s=(0,n.JU)(r.RZ,"".concat(t,"/").concat(e));return null!==(a=(await(0,n.QT)(s)).data())&&void 0!==a?a:{}}}function l(t,e,a){return(0,s.a)({queryKey:["firebase",t,e],queryFn:i(t,e),...a})}},5906:(t,e,a)=>{a.r(e),a.d(e,{default:()=>v});var n=a(4031),r=a(3990),s=a(7128),o=a(1105),i=a(2791),l=a(6509),u=(a(6591),a(2128),a(5850),a(9961));var d=a(6537),c=a(9547),m=a(184);const{Text:f}=n.Z;const v=function(){(0,l.Z)("Other");const{historyQuery:t,mutation:e}=(0,c.ve)();console.log(t.data);const a=(0,i.useMemo)((()=>JSON.stringify(t.data,null,4)),[t.data]);return(0,m.jsxs)(r.Z,{children:[(0,m.jsx)(d.h,{title:"Other"}),(0,m.jsx)(s.Z,{}),(0,m.jsx)(r.Z.Content,{className:"content",children:(0,m.jsxs)("div",{className:"a",children:[(0,m.jsx)("button",{onClick:()=>e.mutate(t.data),children:"save"}),(0,m.jsxs)(f,{children:["Output ",(0,m.jsx)(u.m,{content:a})]}),(0,m.jsx)(o.Z.TextArea,{name:"search-results",id:"",cols:"10",rows:"10",readOnly:!0,value:a})]})})]})}},5657:(t,e,a)=>{a.d(e,{Z:()=>l});var n=a(7462),r=a(2791),s=a(8291),o=a(4186),i=function(t,e){return r.createElement(o.Z,(0,n.Z)({},t,{ref:e,icon:s.Z}))};const l=r.forwardRef(i)}}]);
//# sourceMappingURL=Other.0396e754.chunk.js.map