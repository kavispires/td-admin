"use strict";(self.webpackChunktdr=self.webpackChunktdr||[]).push([[997],{7018:(e,s,t)=>{t.d(s,{o:()=>i});var a=t(2556),n=t(5850),l=t(184);function i(e){let{data:s,fileName:t,loading:i,...r}=e;return(0,l.jsx)(a.ZP,{onClick:()=>(0,n.ZN)("function"===typeof s?s():s,t),loading:i,...r,children:"Download JSON"})}},2999:(e,s,t)=>{t.d(s,{R:()=>r,T:()=>o});var a=t(952),n=t(5225),l=t(1958),i=t(184);function r(e){let{isLoading:s,isIdle:t,error:n,isDirty:l,isError:r,hasResponseData:o}=e;return t?(0,i.jsx)(a.Z,{children:"No Data yet"}):s?(0,i.jsx)(a.Z,{color:"blue",children:"Loading..."}):n||r?(0,i.jsx)(a.Z,{color:"red",children:"Error"}):l?(0,i.jsx)(a.Z,{color:"orange",children:"Modified"}):o?(0,i.jsx)(a.Z,{color:"green",children:"Loaded"}):(0,i.jsx)(a.Z,{children:"No Data"})}function o(e){return(0,i.jsx)(l.Pd,{children:(0,i.jsx)(n.Z.Item,{label:"Status",children:(0,i.jsx)(r,{...e})})})}},8866:(e,s,t)=>{t.d(s,{N:()=>l});var a=t(4031),n=t(184);function l(e){let{children:s,level:t,...l}=e;return(0,n.jsx)(a.Z.Title,{level:null!==t&&void 0!==t?t:3,...l,children:s})}},6173:(e,s,t)=>{t.d(s,{xh:()=>h,zE:()=>d,Do:()=>u,Th:()=>g.T,F6:()=>l});t(8866);var a=t(3733),n=t(184);const l=e=>{let{children:s,active:t=!1,activeClass:l="",className:i="",hoverType:r="scale",...o}=e;return(0,n.jsx)("button",{className:(0,a.Z)("transparent-button","transparent-button--".concat(r),t&&(l||"transparent-button--active"),i),...o,children:s})};var i=t(5225),r=t(7765),o=t(2326),c=t(5922);function d(e){let{label:s,value:t,onChange:a,options:l,placeholder:o}=e;return(0,n.jsx)(i.Z.Item,{label:s,children:(0,n.jsxs)(r.Z,{style:{minWidth:"150px"},onChange:a,value:t,children:[o&&(0,n.jsx)(r.Z.Option,{value:"",disabled:!0,children:"placeholder"}),l.map((e=>"object"===typeof e?(0,n.jsx)(r.Z.Option,{value:e.value,children:e.label},"".concat(s,"-").concat(e.value)):(0,n.jsx)(r.Z.Option,{value:e,children:e},"".concat(s,"-").concat(e))))]})})}function h(e){let{label:s,value:t,onChange:a,min:l=0,max:r=100,step:c}=e;return(0,n.jsx)(i.Z.Item,{label:s,children:(0,n.jsx)(o.Z,{min:l,max:r,value:t,onChange:e=>a(null!==e&&void 0!==e?e:r),style:{minWidth:"150px",width:"100%"},step:c})})}function u(e){let{label:s,value:t,onChange:a,className:l}=e;return(0,n.jsx)(i.Z.Item,{label:s,valuePropName:"checked",className:l,children:(0,n.jsx)(c.Z,{checked:t,onChange:a,size:"small"})})}var g=t(2999)},145:(e,s,t)=>{t.d(s,{f:()=>r});var a=t(3733),n=t(6340),l=t(2606),i=t(184);const r=e=>{let{id:s,width:t=200,className:r="",preview:o=!0,fileExtension:c="jpg"}=e;const{getUrl:d}=(0,l.n)("tdi"),h=s.replace(/-/g,"/");return(0,i.jsx)("div",{className:(0,a.Z)("image-card",r),children:(0,i.jsx)(n.Z,{width:t,src:d("".concat(h,".").concat(c)),fallback:d("back/default.jpg"),preview:o})})}},6709:(e,s,t)=>{t.d(s,{P:()=>v,l:()=>m});var a=t(2791),n=t(4747),l=t(2481),i=t(763),r=t(2748),o=t(5850),c=t(3713),d=t(2010),h=t(8556);const u=()=>(0,i.padStart)(String((0,i.random)(1,252)),2,"0"),g=()=>(0,i.random)(1,10);var x=t(184);const j=(0,a.createContext)({}),v=e=>{let{children:s}=e;const t=function(){const[e,s]=(0,a.useState)(!1),t=["data/imageCardsRelationships"],i=(0,c.NL)(),{notification:o}=n.Z.useApp(),[u,g]=(0,a.useState)({total:0,overdone:0,complete:0,single:0}),{data:x={},isLoading:j,isSuccess:v,isError:m,isFetched:p,isRefetching:f,refetch:S}=(0,d.a)({queryKey:t,queryFn:async()=>{var e;const s=(0,l.JU)(r.RZ,"data/imageCardsRelationships");return null!==(e=(await(0,l.QT)(s)).data())&&void 0!==e?e:{}}}),{isPending:y,isError:Z,isSuccess:C,mutate:b}=(0,h.D)({mutationKey:t,mutationFn:async()=>{const e=(0,l.JU)(r.RZ,"data/imageCardsRelationships");return await(0,l.pl)(e,x),x},onSuccess:()=>{o.success({message:"Saved",placement:"bottomLeft"}),i.refetchQueries({queryKey:t}),s(!1)}});return(0,a.useEffect)((()=>{if(!f&&p){const e=Object.keys(x).length;let s=0,t=0,a=0;Object.values(x).forEach((e=>{e.length>8&&(s+=1),1===e.length&&(a+=1),e.length>2&&(t+=1)})),g({total:e,overdone:s,complete:t,single:a})}}),[p,f]),{data:x,isLoading:j,isSuccess:v,isError:m,hasData:v&&Object.keys(x).length>0,refetch:S,isSaving:y,isMutationError:Z,isSaved:C,save:b,setDirty:s,isDirty:e,stats:u}}(),[i,v]=(0,a.useState)(15),[m,p]=(0,a.useState)(5),[f,S]=(0,a.useState)(150),[y,Z]=(0,a.useState)(!1),C=function(e,s,t,n){const[l,i]=(0,a.useState)([]),[r,c]=(0,a.useState)([]),[d,h]=(0,a.useState)([]),[x,j]=(0,a.useState)(0),[v,m]=(0,a.useState)(!0),[p,f]=(0,a.useState)([]),S=s=>{c((null!==s&&void 0!==s?s:l).map((s=>{var t;return null!==(t=null===e||void 0===e?void 0:e[s])&&void 0!==t?t:[]})))},y=()=>{const s=[...p];let a=0;const l=d.length<2e3?d:[];let r=0;for(;r<400&&s.length<t;){var o;const t="td-d".concat(g(),"-").concat(u()),i=null!==(o=e[t])&&void 0!==o?o:[],c=!(n>0)||i.length<n,d=!!v&&l.includes(t);s.includes(t)||d||!c||(s.push(t),a+=1),r+=1}i(s),h((e=>[...e,...s])),S(s),j((e=>e+a))};return(0,a.useEffect)((()=>{0===l.length&&y()}),[l]),{cardIds:l,cards:r,selection:p,onSelect:e=>{f((s=>{const t=[...s],a=t.indexOf(e);return a>-1?t.splice(a,1):t.push(e),t}))},relate:()=>{p.forEach((s=>{var t;const a=null!==(t=e[s])&&void 0!==t?t:[];a.push(...p.filter((e=>e!==s))),e[s]=(0,o.R1)(a)})),s(!0),f([]),S(),h([]),j(0)},nextSet:y,deselectAll:()=>{f([])},cycles:x,filters:{useCycles:v,toggleUseCycles:()=>{m((e=>!e))}}}}(t.data,t.setDirty,i,m);return(0,x.jsx)(j.Provider,{value:{sampleSize:i,setSampleSize:v,tagThreshold:m,setTagThreshold:p,cardSize:f,setCardSize:S,showIds:y,setShowIds:Z,randomGroups:C,query:t},children:s})},m=()=>(0,a.useContext)(j)},9936:(e,s,t)=>{t.d(s,{A:()=>o});var a=t(8622),n=t(5225),l=t(9367),i=t(6709),r=t(184);function o(){const{query:{stats:e}}=(0,i.l)();return(0,r.jsx)(n.Z.Item,{label:(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(l.C,{icon:(0,r.jsx)(a.Z,{}),shape:"square",size:"small",style:{marginRight:6}}),"Stats"]}),children:(0,r.jsxs)("ul",{className:"statistic__list",children:[(0,r.jsxs)("li",{children:["Completion: ",Math.floor(100*e.total/2520),"%"]}),(0,r.jsxs)("li",{children:["Total Relationships: ",e.total]}),(0,r.jsxs)("li",{children:["Complete: ",e.complete]}),(0,r.jsxs)("li",{children:["Overdone: ",e.overdone]}),(0,r.jsxs)("li",{children:["Single Match: ",e.single]})]})})}},7416:(e,s,t)=>{t.r(s),t.d(s,{default:()=>T});var a=t(3990),n=t(6709),l=t(2128),i=t(763),r=t(731),o=t(6340),c=t(952),d=t(9884),h=t(7691),u=t(9720),g=t(7974),x=t(4988),j=t(7360),v=t(4057),m=t(145),p=t(1492),f=t(184);function S(e){let{card:s}=e;const t=s.length>10?"red":s.length>5?"blue":s.length>0?"green":void 0;return(0,f.jsx)("div",{children:(0,f.jsxs)(c.Z,{color:t,icon:(0,f.jsx)(p.Z,{}),children:[" ",s.length]})})}var y=t(6173),Z=t(2791),C=t(7415);function b(){const{query:{isDirty:e,isSaving:s,save:t,stats:a,...d},randomGroups:{cardIds:u,cards:g,onSelect:x,selection:j,relate:v,nextSet:p,deselectAll:b,cycles:w},showIds:z,cardSize:D}=(0,n.l)(),E=(0,Z.useRef)(null),[k,{width:I}]=(0,C.Z)(),[R,T]=(0,Z.useMemo)((()=>{const e=Math.floor(I/D)+1;return[e,Math.floor(I/e)]}),[D,I]);return(0,f.jsx)(l.T,{isLoading:d.isLoading,error:d.error,hasResponseData:!(0,i.isEmpty)(d.data),children:(0,f.jsx)("div",{ref:k,className:"my-6",children:(0,f.jsxs)(r.Z,{title:"Card Relationship Matching",extra:(0,f.jsxs)("span",{children:[(0,f.jsx)(h.Z,{})," ",w]}),className:"image-card-categorizer-card",ref:E,children:[(0,f.jsx)(o.Z.PreviewGroup,{children:(0,f.jsx)("div",{className:"image-cards-group",style:{gridTemplateColumns:"repeat(".concat(Math.max(R,1),", 1fr)")},children:u.map(((e,s)=>{const t=j.includes(e),a=g[s];return(0,f.jsx)("div",{className:"image-card-card__image",children:(0,f.jsxs)(y.F6,{onClick:()=>x(e),active:t,className:"image-cards-group__button",activeClass:"image-cards-group__button--active",children:[(0,f.jsx)(m.f,{id:e,width:T-24,preview:!1}),(0,f.jsxs)("div",{children:[z&&(0,f.jsx)(c.Z,{children:e}),(0,f.jsx)(S,{card:a})]})]})},e)}))})}),(0,f.jsx)(N,{isSaving:s,isDirty:e,selection:j,relate:v,deselectAll:b,onNextSet:()=>{var e;p(),null===(e=E.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})}})]})})})}const N=e=>{let{isSaving:s,isDirty:t,selection:a,relate:n,deselectAll:l,onNextSet:i}=e;if(s)return(0,f.jsx)(f.Fragment,{children:(0,f.jsx)(d.Z,{icon:(0,f.jsx)(u.Z,{})})});return(0,f.jsxs)(f.Fragment,{children:[t&&(0,f.jsx)(d.Z,{icon:(0,f.jsx)(g.Z,{}),type:"primary",style:{right:234}}),(0,f.jsx)(d.Z,{icon:(0,f.jsx)(x.Z,{}),style:{right:164},onClick:l}),(0,f.jsx)(d.Z,{icon:(0,f.jsx)(j.Z,{}),style:{right:94},type:a.length<2?"default":"primary",badge:{count:a.length,size:"small"},onClick:()=>{a.length<2||n()}}),(0,f.jsx)(d.Z,{icon:(0,f.jsx)(v.Z,{}),style:{right:24},onClick:i})]})};var w=t(2556),z=t(7018),D=t(1958),E=t(6591),k=t(4483),I=t(9936);function R(){const{query:{isDirty:e,isSaving:s,save:t,data:a,isLoading:l,isError:r},randomGroups:{filters:o},showIds:c,setShowIds:d,tagThreshold:h,setTagThreshold:u,sampleSize:g,setSampleSize:x,cardSize:j,setCardSize:v}=(0,n.l)();return(0,f.jsxs)(D.p3,{children:[(0,f.jsx)(D.Pd,{children:(0,f.jsx)(w.ZP,{type:"primary",size:"large",icon:(0,f.jsx)(k.Z,{}),onClick:()=>t({}),disabled:!e,loading:s,danger:!0,block:!0,children:"Save"})}),(0,f.jsx)(y.Th,{isLoading:l||s,isDirty:e,isError:r,hasResponseData:!(0,i.isEmpty)(a)}),(0,f.jsxs)(D.Pd,{children:[(0,f.jsx)(y.Do,{label:"Use Cycles",value:o.useCycles,onChange:()=>o.toggleUseCycles()}),(0,f.jsx)(y.Do,{label:"Show Ids",value:c,onChange:e=>d(e)}),(0,f.jsx)(y.zE,{onChange:e=>u(e),value:h,options:E.VC,label:"Tag Count"}),(0,f.jsx)(y.zE,{onChange:e=>x(e),value:g,options:E.ZI,label:"Sample Size"}),(0,f.jsx)(y.zE,{onChange:e=>v(e),value:j,options:E.Hn,label:"Card Size"})]}),(0,f.jsx)(D.Pd,{children:(0,f.jsx)(I.A,{})}),(0,f.jsx)(D.Pd,{children:(0,f.jsx)(z.o,{data:a,fileName:"imageCardsRelationships.json",loading:s,disabled:(0,i.isEmpty)(a),block:!0})})]})}const T=function(){return(0,f.jsx)(D.Xg,{title:"Image Cards",subtitle:"Relationships",children:(0,f.jsx)(n.P,{children:(0,f.jsxs)(a.Z,{hasSider:!0,children:[(0,f.jsx)(R,{}),(0,f.jsx)(a.Z.Content,{className:"content",children:(0,f.jsx)(b,{})})]})})})}}}]);
//# sourceMappingURL=ImageCardsRelationships.4da8e1f6.chunk.js.map