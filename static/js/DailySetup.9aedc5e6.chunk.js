"use strict";(self.webpackChunktdr=self.webpackChunktdr||[]).push([[718],{2999:(e,t,a)=>{a.d(t,{R:()=>l,T:()=>o});var n=a(952),r=a(5225),s=a(1958),i=a(184);function l(e){let{isLoading:t,isIdle:a,error:r,isDirty:s,isError:l,hasResponseData:o}=e;return a?(0,i.jsx)(n.Z,{children:"No Data yet"}):t?(0,i.jsx)(n.Z,{color:"blue",children:"Loading..."}):r||l?(0,i.jsx)(n.Z,{color:"red",children:"Error"}):s?(0,i.jsx)(n.Z,{color:"orange",children:"Modified"}):o?(0,i.jsx)(n.Z,{color:"green",children:"Loaded"}):(0,i.jsx)(n.Z,{children:"No Data"})}function o(e){return(0,i.jsx)(s.Pd,{children:(0,i.jsx)(r.Z.Item,{label:"Status",children:(0,i.jsx)(l,{...e})})})}},8866:(e,t,a)=>{a.d(t,{N:()=>s});var n=a(4031),r=a(184);function s(e){let{children:t,level:a,...s}=e;return(0,r.jsx)(n.Z.Title,{level:null!==a&&void 0!==a?a:3,...s,children:t})}},6173:(e,t,a)=>{a.d(t,{xh:()=>u,zE:()=>c,Do:()=>h,Th:()=>m.T,F6:()=>s});a(8866);var n=a(3733),r=a(184);const s=e=>{let{children:t,active:a=!1,activeClass:s="",className:i="",hoverType:l="scale",...o}=e;return(0,r.jsx)("button",{className:(0,n.Z)("transparent-button","transparent-button--".concat(l),a&&(s||"transparent-button--active"),i),...o,children:t})};var i=a(5225),l=a(7765),o=a(2326),d=a(5922);function c(e){let{label:t,value:a,onChange:n,options:s,placeholder:o}=e;return(0,r.jsx)(i.Z.Item,{label:t,children:(0,r.jsxs)(l.Z,{style:{minWidth:"150px"},onChange:n,value:a,children:[o&&(0,r.jsx)(l.Z.Option,{value:"",disabled:!0,children:"placeholder"}),s.map((e=>"object"===typeof e?(0,r.jsx)(l.Z.Option,{value:e.value,children:e.label},"".concat(t,"-").concat(e.value)):(0,r.jsx)(l.Z.Option,{value:e,children:e},"".concat(t,"-").concat(e))))]})})}function u(e){let{label:t,value:a,onChange:n,min:s=0,max:l=100,step:d}=e;return(0,r.jsx)(i.Z.Item,{label:t,children:(0,r.jsx)(o.Z,{min:s,max:l,value:a,onChange:e=>n(null!==e&&void 0!==e?e:l),style:{minWidth:"150px",width:"100%"},step:d})})}function h(e){let{label:t,value:a,onChange:n,className:s}=e;return(0,r.jsx)(i.Z.Item,{label:t,valuePropName:"checked",className:s,children:(0,r.jsx)(d.Z,{checked:a,onChange:n,size:"small"})})}var m=a(2999)},9547:(e,t,a)=>{a.d(t,{Ld:()=>w,l9:()=>L,ve:()=>S});var n=a(4747),r=a(2481),s=a(2748),i=a(8556);const l={SUFFIX_DATA:{pt:"drawingsPT",en:"drawingsEN"},DAILY:{pt:"diario",en:"daily"}};var o=a(8027),d=a(2791),c=a(2010);function u(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{notification:a}=n.Z.useApp(),r=(0,c.a)({queryKey:[e,"history"],queryFn:(0,o.A)(e,"history"),...t});return(0,d.useEffect)((()=>{r.isSuccess&&(0,s.tS)("Loaded daily/history")}),[r.isSuccess]),(0,d.useEffect)((()=>{r.isError&&a.error({message:"Error loading daily/history",placement:"bottomLeft"})}),[r.isError]),r}var h=a(7342);var m=a(763),v=a(2606);var p=a(5529),g=a(2426),f=a.n(g);function x(){return f()().format("YYYY-MM-DD")}function j(e){return f()(e,"YYYY-MM-DD").add(1,"days").format("YYYY-MM-DD")}function b(e){const t=[],a={};let n=0;for(;t.length<4&&n<500;){var r;const s=null!==(r=(0,m.sample)(e))&&void 0!==r?r:"",i=s.split("");i.every((e=>!a[e]))?(t.push(s),i.forEach((e=>{a[e]=!0}))):n++}if(n>500||t.length<4)for(console.count("Could not find 4 words with unique letters");t.length<4;){var s;const a=null!==(s=(0,m.sample)(e))&&void 0!==s?s:"";t.includes(a)||t.push(a)}return t.length<4&&console.error("Could not find 4 words with unique letters",t),t}function y(e,t){const a=(0,d.useMemo)((()=>{var a;return null!==(a=null===t||void 0===t?void 0:t[e])&&void 0!==a?a:{latestDate:x(),latestNumber:0,used:"[]"}}),[t,e]);return[(0,d.useMemo)((()=>{var e,t,n;return{latestNumber:null!==(e=null===a||void 0===a?void 0:a.latestNumber)&&void 0!==e?e:0,latestDate:null!==(t=null===a||void 0===a?void 0:a.latestDate)&&void 0!==t?t:x(),used:JSON.parse(null!==(n=null===a||void 0===a?void 0:a.used)&&void 0!==n?n:"[]")}}),[a]),a]}function w(e,t,a,r){const i=u(l.DAILY[null!==t&&void 0!==t?t:"pt"],{enabled:e}),g=function(e,t){var a,r;const{notification:i}=n.Z.useApp(),u=(0,c.a)({queryKey:["data","suffixCounts"],queryFn:(0,o.A)("data","suffixCounts"),enabled:e});(0,d.useEffect)((()=>{u.isSuccess&&(0,s.tS)("Loaded data/suffixCounts")}),[u.isSuccess]),(0,d.useEffect)((()=>{u.isError&&i.error({message:"Error loading data/suffixCounts",placement:"bottomLeft"})}),[u.isError]);const m=l.SUFFIX_DATA[null!==t&&void 0!==t?t:"pt"],v=null!==(a=null===(r=u.data)||void 0===r?void 0:r[m])&&void 0!==a?a:0,p="drawings".concat("pt"===t?"PT":"EN"),g=(0,d.useMemo)((()=>new Array(v).fill(0).map(((t,a)=>({queryKey:["data","".concat(p).concat(a+1)],queryFn:(0,o.A)("data","".concat(p).concat(a+1)),enabled:e&&Boolean(v),onSuccess:()=>{i.info({message:"Data Drawings ".concat(p).concat(a+1," loaded"),placement:"bottomLeft"})}})))),[v]);return(0,h.h)({queries:g})}(e,null!==t&&void 0!==t?t:"pt"),f=g.some((e=>e.isLoading)),[x]=y("arte-ruim",i.data),w=(0,d.useMemo)((()=>{console.count("Creating Arte Ruim...");const e=(null!==g&&void 0!==g?g:[]).reduce(((e,a)=>{var n;const r=null!==(n=a.data)&&void 0!==n?n:{};return Object.entries(r).forEach((a=>{var n;let[r,s]=a;const i=null!==(n=s.cardId)&&void 0!==n?n:s.id;if(s.drawing.trim().length<10)return console.warn("Empty drawing",i),e;void 0===e[i]?e[i]={id:i,type:"arte-ruim",language:null!==t&&void 0!==t?t:"pt",cardId:i,text:s.text,drawings:[s.drawing],number:0,dataIds:[r]}:(e[i].drawings.push(s.drawing),e[i].dataIds.push(r))})),e}),{}),n=Object.values(e).filter((e=>{var t;return e.drawings.length>=a&&e.cardId&&!(null!==(t=e.cardId)&&void 0!==t&&t.includes("--"))})),s=Object.values(n).filter((e=>!x.used.includes(e.cardId))),i=(0,m.sampleSize)((0,m.shuffle)(s),r);let l=x.latestDate;return i.map(((e,t)=>{const a=j(l);return l=a,{...e,id:a,number:x.latestNumber+t+1}}))}),[g,t,x,r,a]),D=(0,p.N)("aqui-o-sets"),[Z]=y("aqui-o",i.data),L=(0,d.useMemo)((()=>{console.count("Creating Aqui \xd3...");const e=(0,m.shuffle)(Object.values(D.data).filter((e=>e.itemsIds.filter(Boolean).length>=20)));let t=e.filter((e=>!Z.used.includes(e.id)));t.length<r&&t.push(...(0,m.shuffle)(e));let a=Z.latestDate;const n={};for(let s=0;s<r;s++){const e=t[s];if(!e)break;const r=j(a);a=r,n[r]={id:r,type:"aqui-o",number:Z.latestNumber+s+1,setId:e.id,title:e.title,itemsIds:["0",...(0,m.sampleSize)(e.itemsIds,20)]}}return n}),[D,Z,r]),S=function(e,t){var a;let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=arguments.length>3?arguments[3]:void 0;const{getUrl:s}=(0,v.n)("tdr"),i=r?"words-".concat(e,"-letters-selected-").concat(t):"words-".concat(e,"-letters-").concat(t),l=(0,c.a)({queryKey:[i],queryFn:async()=>{const e=await fetch(s("".concat(i,".json")));return await e.json()},enabled:n&&!!e&&!!t}),o=!(0,m.isEmpty)(l.data);return{...l,data:null!==(a=l.data)&&void 0!==a?a:[],hasResponseData:o}}(4,t,!0,!0),[N]=y("palavreado",i.data),I=(0,d.useMemo)((()=>{console.count("Creating Palavreado...");let e=N.latestDate;const t={};for(let a=0;a<r;a++){const n=b(S.data),r=(0,m.shuffle)(n.join("").split("")),s=j(e);e=s,t[s]={id:s,type:"palavreado",number:N.latestNumber+a+1,words:n,letters:r}}return t}),[S,N,r]),C=(0,p.N)("arte-ruim-cards-".concat(t)),[q]=y("artista",i.data),E=(0,d.useMemo)((()=>{console.count("Creating Artista...");let e=q.latestDate;const t={};for(let n=0;n<r;n++){var a;const r=j(e),s=Object.keys(null!==(a=C.data)&&void 0!==a?a:{}).filter((e=>!x.used.includes(e))),i=(0,m.sampleSize)(s,15).map((e=>C.data[e]));e=r,t[r]={id:r,type:"artista",number:q.latestNumber+n+1,cards:i}}return t}),[C,x,q,r]),A=(0,d.useMemo)((()=>(console.count("Bundling entries..."),w.map((e=>({id:e.id,"arte-ruim":e,"aqui-o":L[e.id],palavreado:I[e.id],artista:E[e.id]}))))),[w,L,I,E]);return{isLoading:f||i.isLoading,entries:A}}var D=a(5850),Z=a(3713);function L(e){const{notification:t}=n.Z.useApp(),a=(0,Z.NL)(),o=l.DAILY[null!==e&&void 0!==e?e:"pt"],[c,h]=(0,d.useState)(!1),m=u(o,{enabled:Boolean(o)}),v=(0,i.D)({mutationFn:async e=>{var t;const a=e.map((e=>{const t=(0,r.JU)(s.RZ,"".concat(o,"/").concat(e.id));return(0,r.pl)(t,e)})),n=(0,r.JU)(s.RZ,"".concat(o,"/history")),i=m.data;if(!i)throw new Error("No previous history");const l={...i,"arte-ruim":{latestDate:e[e.length-1].id,latestNumber:e[e.length-1]["arte-ruim"].number,used:JSON.stringify((0,D.R1)([...JSON.parse(i["arte-ruim"].used),...e.map((e=>e["arte-ruim"].cardId))]))},"aqui-o":{latestDate:e[e.length-1].id,latestNumber:e[e.length-1]["aqui-o"].number,used:JSON.stringify((0,D.R1)([...JSON.parse(null!==(t=i["aqui-o"].used)&&void 0!==t?t:"[]"),...e.map((e=>e["aqui-o"].setId))]))},palavreado:{latestDate:e[e.length-1].id,latestNumber:e[e.length-1].palavreado.number,used:"[]"},artista:{latestDate:e[e.length-1].id,latestNumber:e[e.length-1].artista.number,used:"[]"}};return(0,r.pl)(n,l),Promise.all(a)},onSuccess:()=>{t.info({message:"Data saved",placement:"bottomLeft"}),a.invalidateQueries({queryKey:[o,"history"]}),h(!1)},onError:()=>{t.error({message:"Error saving data",placement:"bottomLeft"})}});return{isDirty:c,setIsDirty:h,save:v.mutateAsync,isPending:v.isPending}}function S(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];const{notification:t}=n.Z.useApp(),a=l.DAILY.pt,o=(0,i.D)({mutationFn:async e=>{const t=(0,r.JU)(s.RZ,"".concat(a,"/history"));(0,r.pl)(t,e)},onSuccess:()=>{t.info({message:"New history data saved",placement:"bottomLeft"})}}),d=u(a,{enabled:e});return{mutation:o,historyQuery:d}}},8027:(e,t,a)=>{a.d(t,{A:()=>l,X:()=>o});var n=a(2481),r=a(2748),s=a(2010),i=a(5850);function l(e,t){return async()=>{var a;console.log("%cQuerying ".concat(e,"/").concat(t," from firebase: ").concat((0,i.xE)()),"color: #f0f");const s=(0,n.JU)(r.RZ,"".concat(e,"/").concat(t));return null!==(a=(await(0,n.QT)(s)).data())&&void 0!==a?a:{}}}function o(e,t,a){return(0,s.a)({queryKey:["firebase",e,t],queryFn:l(e,t),...a})}},2950:(e,t,a)=>{a.r(t),a.d(t,{default:()=>b});var n=a(3990),r=a(4031),s=a(1046),i=a(4520),l=a(2556),o=a(2979),d=a(9547),c=a(184);const u=e=>{var t,a;let{drawing:n="",className:r="",width:s=250,height:i,strokeWidth:l="medium",viewBox:o="0 0 500 500"}=e;const d=JSON.parse(n),u=d.map((e=>{let t="";for(let a=0,n=1;n<e.length;a+=2,n+=2)e[a+2]&&e[n+2]&&(t+="M".concat(e[a],",").concat(e[n]," L").concat(e[a+2],",").concat(e[n+2]));return t}));const h=null!==(t=null===(a={small:3,medium:5,large:7})||void 0===a?void 0:a[l])&&void 0!==t?t:5;return(0,c.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:o,overflow:"hidden",className:r,style:{width:"".concat(s,"px"),height:"".concat(i||s,"px")},children:[(0,c.jsx)("defs",{}),u.map(((e,t)=>(0,c.jsx)("path",{d:e,fill:"none",stroke:"#000",strokeWidth:h,strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:"10"},"".concat(n,"-").concat(t))))]})};function h(e){var t,a;let{language:n,dataLoad:r}=e;const h=n,m=[{title:"Id",dataIndex:"id",key:"id"},{title:"Arte Ruim",dataIndex:"arte-ruim",key:"arte-ruim",render:e=>{let{number:t,cardId:a,text:n,drawings:r}=e;return(0,c.jsxs)(s.Z,{direction:"vertical",children:[(0,c.jsxs)(s.Z,{children:[(0,c.jsxs)("span",{children:["#",t]}),(0,c.jsxs)("span",{children:["CardId: ",a]}),(0,c.jsxs)("span",{children:["Count: ",r.length]})]}),(0,c.jsxs)("div",{children:['"',n.split("").map(((e,t)=>t<2||" "===e?e:"\u23f9")).join(""),'"']}),(0,c.jsx)(s.Z,{children:r.map((e=>(0,c.jsx)(u,{drawing:e,width:75,height:75,className:"canvas"},e)))})]})}},{title:"Aqui O",dataIndex:"aqui-o",key:"aqui-o",render:e=>{let{number:t,setId:a,title:r}=e;return(0,c.jsxs)(s.Z,{direction:"vertical",children:[(0,c.jsxs)("span",{children:["#",t]}),(0,c.jsxs)("span",{children:["SetId: ",a]}),(0,c.jsxs)("span",{children:["Title: ",r[n]]})]})}},{title:"Palavreado",dataIndex:"palavreado",key:"palavreado",render:e=>{let{number:t,words:a,letters:n}=e;return(0,c.jsxs)(s.Z,{direction:"vertical",children:[(0,c.jsxs)("span",{children:["#",t]}),(0,c.jsxs)("span",{children:["Letters: ",n.length]}),(0,c.jsx)(s.Z,{direction:"vertical",children:a.map((e=>(0,c.jsx)("span",{children:e.split("").map(((e,t)=>t<1||" "===e?e:"\u23f9")).join("")},"".concat(t,"-").concat(e))))})]})}},{title:"Artista",dataIndex:"artista",key:"artista",render:e=>{let{number:t,cards:a}=e;return(0,c.jsxs)(s.Z,{direction:"vertical",children:[(0,c.jsxs)("span",{children:["#",t]}),a.map(((e,t)=>(0,c.jsx)("span",{children:e.text},"".concat(e.id,"-").concat(t))))]})}}],{save:v,isPending:p}=(0,d.l9)(null!==h&&void 0!==h?h:"pt");return(0,c.jsxs)("div",{children:[r.isLoading&&(0,c.jsx)("div",{children:"Loading..."}),(0,c.jsxs)(i.Z,{justify:"space-between",align:"center",children:[(0,c.jsxs)("h1",{children:["Total: ",r.entries.length]}),(0,c.jsx)(l.ZP,{onClick:()=>v(r.entries),loading:p,disabled:0===(null!==(t=r.entries)&&void 0!==t?t:[]).length,type:"primary",size:"large",children:"Save"})]}),(0,c.jsx)(o.Z,{columns:m,dataSource:null!==(a=r.entries)&&void 0!==a?a:[]})]})}var m=a(6173),v=a(1958),p=a(6591);function g(e){let{language:t,setLanguage:a,drawingsCount:n,setDrawingsCount:r,batchSize:s,setBatchSize:i}=e;return(0,c.jsxs)(v.Pd,{children:[(0,c.jsx)(m.zE,{label:"Language",value:t,onChange:a,options:p.a2,placeholder:"Select a language"}),(0,c.jsx)(m.zE,{label:"Minimum Drawings",value:n,onChange:r,options:[2,3,4],placeholder:"Select a number"}),(0,c.jsx)(m.zE,{label:"Batch Size",value:s,onChange:i,options:[5,15,30,45],placeholder:"Select a number"})]})}var f=a(2128),x=a(4562),j=a(2791);const b=function(){const[e,t]=(0,j.useState)(""),[a,s]=(0,j.useState)(2),[i,l]=(0,j.useState)(45),o=(0,d.Ld)(Boolean(e),e,a,i);return(0,c.jsx)(v.Xg,{title:"Daily Setup",children:(0,c.jsxs)(n.Z,{hasSider:!0,children:[(0,c.jsxs)(x.p,{children:[(0,c.jsx)(m.Th,{isLoading:o.isLoading,error:null,hasResponseData:!o.isLoading}),(0,c.jsx)(g,{language:e,setLanguage:t,drawingsCount:a,setDrawingsCount:s,batchSize:i,setBatchSize:l})]}),(0,c.jsx)(n.Z.Content,{className:"content",children:(0,c.jsxs)(f.T,{isLoading:o.isLoading,error:null,hasResponseData:!o.isLoading,children:[(0,c.jsx)(r.Z.Title,{level:2,children:"Data Population"}),(0,c.jsx)(h,{language:e,dataLoad:o})]})})]})})}}}]);
//# sourceMappingURL=DailySetup.9aedc5e6.chunk.js.map