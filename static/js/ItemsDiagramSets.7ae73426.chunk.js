"use strict";(self.webpackChunktd_admin=self.webpackChunktd_admin||[]).push([[9479],{7340:(e,t,s)=>{s.d(t,{k:()=>o});var n=s(2556),l=s(2426),a=s.n(l),i=s(2791),d=s(8211),r=s(4483),c=s(184);function o(e){let{isDirty:t,onSave:s,isSaving:l,dirt:o,interval:u=6e5,...h}=e;const[,m,p]=(0,d.Z)((()=>{t&&s()}),u);return(0,i.useEffect)((()=>{t?(console.log("Save Reset",a()(Date.now()).format("MM/DD/YYYY HH:mm:ss")),p()):m()}),[t,p,m,o]),(0,i.useEffect)((()=>{const e=e=>{if(t){const t="You have unsaved changes, are you sure you want to leave?";return e.returnValue=t,t}};return window.addEventListener("beforeunload",e),()=>{window.removeEventListener("beforeunload",e)}}),[t]),(0,c.jsx)(n.ZP,{type:"primary",size:"large",icon:(0,c.jsx)(r.Z,{}),onClick:s,disabled:!t,loading:l,danger:!0,block:!0,...h,children:"Save"})}},6728:(e,t,s)=>{s.d(t,{TI:()=>d,ao:()=>i,hD:()=>a});s(763);var n=s(2426),l=s.n(n);function a(){return l()().subtract(1,"days").format("YYYY-MM-DD")}function i(e){return l()(e,"YYYY-MM-DD").add(1,"days").format("YYYY-MM-DD")}function d(e){return 6===l()(e,"YYYY-MM-DD").day()}},8027:(e,t,s)=>{s.d(t,{A:()=>d,X:()=>r});var n=s(2481),l=s(2748),a=s(2010),i=s(5850);function d(e,t){return async()=>{var s;console.log("%cQuerying ".concat(e,"/").concat(t," from firebase: ").concat((0,i.xE)()),"color: #f0f");const a=(0,n.JU)(l.RZ,"".concat(e,"/").concat(t));return null!==(s=(await(0,n.QT)(a)).data())&&void 0!==s?s:{}}}function r(e,t,s){return(0,a.a)({queryKey:["firebase",e,t],queryFn:d(e,t),...s})}},4766:(e,t,s)=>{s.d(t,{K:()=>a});var n=s(2791),l=s(1087);function a(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const[t,s]=(0,l.lr)(),a=(e,n,l)=>{void 0===n||""===n||n===l?t.delete(e):t.set(e,String(n)),s(t)},i=function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Object.entries(e).forEach((e=>{let[s,l]=e;n[s]===l?t.delete(s):t.set(s,String(l))})),s(t)},d=e=>{t.delete(e),s(t)},r=function(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"true";return t.get(e)===String(s)};return(0,n.useEffect)((()=>{Object.entries(e).forEach((e=>{let[s,n]=e;t.has(s)||a(s,n)}))}),[]),{addParam:a,addParams:i,removeParam:d,queryParams:t,is:r}}},8938:(e,t,s)=>{s.d(t,{i:()=>u});var n=s(4747),l=s(763),a=s(2791),i=s(3713),d=s(8027),r=s(5529),c=s(2233),o=s(5850);function u(e){let{tdrResourceName:t,firebaseDataCollectionName:s,serialize:u}=e;const{notification:h}=n.Z.useApp(),m=(0,i.NL)(),p=(0,r.N)(t),g=(0,d.X)("tdr",s,{select:u?o.d_:void 0}),[v,j]=(0,a.useState)({}),x=(0,c.B)("tdr",s,{onSuccess:()=>{h.success({message:"".concat(s," updated")}),m.refetchQueries({queryKey:["firebase","tdr",s]}),j({})},onError:e=>{h.error({message:"".concat(s," update failed"),description:e.message})}}),f=(0,a.useMemo)((()=>{var e,n;return p.isSuccess&&g.isSuccess&&!x.isPending?(console.log("%cMerging ".concat(t,"+").concat(s," data..."),"color: #f0f"),(0,l.cloneDeep)({...null!==(e=p.data)&&void 0!==e?e:{},...null!==(n=g.data)&&void 0!==n?n:{},...v})):{}}),[t,s,p.data,g.data,p.isSuccess,g.isSuccess,x.isPending,v]),y=!(0,l.isEmpty)(v),b=g.data;return{data:f,isLoading:p.isLoading||g.isLoading,error:p.error||g.error,firebaseData:b,isSaving:x.isPending,save:()=>{x.mutate(u?(0,o.aS)(v):v)},addEntryToUpdate:(e,t)=>{j((s=>({...s,[e]:t})))},entriesToUpdate:v,isDirty:y}}},5529:(e,t,s)=>{s.d(t,{N:()=>i,Y:()=>d});var n=s(763),l=s(2010),a=s(2606);function i(e){var t;let s=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const{getUrl:i}=(0,a.n)("resources"),d=(0,l.a)({queryKey:[e],queryFn:async()=>{const t=await fetch(i("".concat(e,".json")));return await t.json()},enabled:s}),r=!(0,n.isEmpty)(d.data);return{...d,data:null!==(t=d.data)&&void 0!==t?t:{},hasResponseData:r}}function d(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const{getUrl:s}=(0,a.n)("resources"),i=(0,l.a)({queryKey:[e],queryFn:async()=>{const t=await fetch(s("".concat(e,".json")));return await t.json()},enabled:t}),d=!(0,n.isEmpty)(i.data);return{...i,data:i.data,hasResponseData:d}}},2233:(e,t,s)=>{s.d(t,{B:()=>d});var n=s(2481),l=s(2748),a=s(8556);function i(e,t,s){console.log("%cUpdating ".concat(e,"/").concat(t," from firebase"),"color: #f00");const a=(0,n.JU)(l.RZ,"".concat(e,"/").concat(t));return(0,n.r7)(a,s)}function d(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return(0,a.D)({mutationFn:async s=>i(e,t,s),...s})}},3106:(e,t,s)=>{s.r(t),s.d(t,{ItemsDiagramSets:()=>de,default:()=>re});var n=s(3990),l=s(4520),a=s(2128),i=s(3660),d=s(9197),r=s(7128),c=s(6173),o=s(7018),u=s(7340),h=s(1958),m=s(4766),p=s(5850),g=s(184);function v(e){var t;let{data:s,save:n,isDirty:a,isSaving:v,entriesToUpdate:j}=e;const{addParams:x,queryParams:f}=(0,m.K)();return(0,g.jsxs)(h.Pd,{children:[(0,g.jsxs)(l.Z,{vertical:!0,gap:12,children:[(0,g.jsx)(u.k,{isDirty:a,onSave:n,isSaving:v,dirt:JSON.stringify(j)}),(0,g.jsx)(o.o,{data:()=>{return e=s,(0,p.Tj)(e);var e},fileName:"daily-diagram-items.json",disabled:a,block:!0})]}),(0,g.jsx)(r.Z,{}),(0,g.jsx)(c.H,{label:"Display",value:null!==(t=f.get("display"))&&void 0!==t?t:"rule",onChange:e=>x({display:e,page:1},{page:1}),options:[{title:"By Rule",icon:(0,g.jsx)(i.Z,{}),value:"rule"},{title:"By Thing",icon:(0,g.jsx)(d.Z,{}),value:"thing"}]})]})}var j=s(4031),x=s(2791),f=s(5529),y=s(1046),b=s(2556),Z=s(7415),T=s(4747),S=s(763),w=s(5225),E=s(959),I=s(1105),k=s(4424),D=s(7305),N=s(5922);const O="abcdefghijklmnopqrstuvwxyz",A="bcdfghjklmnpqrstvwxyz",P="aeiou",M=/[\xe1\xe9\xed\xf3\xfa\xe3\u1ebd\u0129\xf5\u0169\xe2\xea\xee\xf4\xfb\xe0\xe8\xec\xf2\xf9\xe4\xeb\xef\xf6\xfc]/,C=(0,S.memoize)((e=>(0,p.bU)(e).toLowerCase())),z=e=>C(e).length,F=e=>C(e).split("").filter((e=>P.includes(e))).length,R=e=>C(e).split("").filter((e=>A.includes(e))).length,Y={"ddr-7-pt":e=>O.indexOf(C(e)[0])<O.indexOf(C(e)[1]),"ddr-8-pt":e=>z(e)<=5,"ddr-9-pt":e=>5===z(e),"ddr-10-pt":e=>z(e)>=4&&z(e)<=6,"ddr-11-pt":e=>z(e)>=6&&z(e)<=8,"ddr-12-pt":e=>z(e)>7,"ddr-13-pt":e=>e.split(" ").length>1,"ddr-14-pt":e=>{const t=C(e).split("").filter((e=>P.includes(e)));return new Set(t).size>=2},"ddr-15-pt":e=>new Set(C(e).split("")).size<=4,"ddr-16-pt":e=>R(e)>F(e),"ddr-17-pt":e=>F(e)>R(e),"ddr-18-pt":e=>{const t=C(e)[0];return C(e).slice(1).includes(t)},"ddr-19-pt":e=>C(e).split("").some(((t,s)=>C(e).slice(s+1).includes(t))),"ddr-20-pt":e=>C(e).split("").some(((t,s)=>P.includes(t)&&C(e).slice(s+1).includes(t))),"ddr-21-pt":e=>C(e).split("").some(((t,s)=>A.includes(t)&&C(e).slice(s+1).includes(t))),"ddr-22-pt":e=>C(e).split("").some(((t,s)=>P.includes(t)&&P.includes(e[s+1]))),"ddr-23-pt":e=>"abcdefghijklm".includes(C(e)[0]),"ddr-24-pt":e=>"nopqrstuvwxyz".includes(C(e)[0]),"ddr-25-pt":e=>P.includes(C(e)[0]),"ddr-26-pt":e=>A.includes(C(e)[0]),"ddr-27-pt":e=>e.split("").some(((t,s)=>t===e[s+1])),"ddr-28-pt":e=>C(e).includes("a"),"ddr-29-pt":e=>C(e).includes("r"),"ddr-30-pt":e=>C(e).includes("u"),"ddr-31-pt":e=>C(e).includes("q")||C(e).includes("j"),"ddr-32-pt":e=>C(e).includes("c")||C(e).includes("\xe7"),"ddr-33-pt":e=>C(e).includes("m"),"ddr-34-pt":e=>C(e).includes("h"),"ddr-35-pt":e=>C(e).includes("p")||C(e).includes("b"),"ddr-36-pt":e=>C(e).includes("k")||C(e).includes("w")||C(e).includes("y"),"ddr-37-pt":e=>(e=>e.toLowerCase().split("").filter((e=>M.test(e))).length)(e)>0,"ddr-38-pt":e=>!["a","o"].includes(C(e).slice(-1)),"ddr-39-pt":e=>A.includes(C(e).slice(-1)),"ddr-40-pt":e=>"s"===C(e).slice(-1),"ddr-41-pt":e=>{const t=C(e).split("").filter((e=>P.includes(e)));return new Set(t).size===t.length},"ddr-42-pt":e=>{const t=C(e).split("").filter((e=>A.includes(e)));return new Set(t).size===t.length}};var U=s(2997),L=s(3733);function q(e){let{isModalOpen:t,onSaveThing:s,onCancel:n,thing:a,rules:i,width:d,itemAliases:r,subtitle:c}=e;const o=(0,x.useMemo)((()=>(0,S.orderBy)(Object.values(i),[e=>{const t=["manual","dependency","auto"].indexOf(e.method);return-1===t?1/0:t},e=>"grammar"===e.type?0:1,e=>Number(e.id.split("-")[1])])),[i]),[u]=w.Z.useForm(),h=w.Z.useWatch([],u),m=!h||Object.values(null!==h&&void 0!==h?h:{}).some((e=>void 0===e)),p=w.Z.useWatch("name",u);(0,x.useEffect)((()=>{if(console.log("Name changed",p),!p)return;const e={syllables:p.replace(/ /g,":"),stressedSyllable:p.includes(" ")?-1:0};Object.keys(i).forEach((t=>{Y[t]?e[t]=Y[t](p):e[t]=a.rules.length>0?a.rules.includes(t):void 0})),u.setFieldsValue(e)}),[p]);const v=w.Z.useWatch("syllables",u);(0,x.useEffect)((()=>{if(v){const e=v.split(":").length;u.setFieldsValue({"ddr-3-pt":2===e,"ddr-4-pt":e>=3,stressedSyllable:p.includes(" ")?-1:void 0})}}),[v]);const j=u.getFieldValue("stressedSyllable");(0,x.useEffect)((()=>{void 0!==j&&u.setFieldsValue({"ddr-43-pt":0===j,"ddr-44-pt":1===j,"ddr-45-pt":2===j})}),[j]);const f=u.getFieldValue("ddr-1-pt");(0,x.useEffect)((()=>{!0===f&&u.setFieldsValue({"ddr-2-pt":!1})}),[f]);const y=u.getFieldValue("ddr-2-pt");(0,x.useEffect)((()=>{!0===y&&u.setFieldsValue({"ddr-1-pt":!1})}),[y]);const Z=u.getFieldValue("ddr-3-pt");(0,x.useEffect)((()=>{!0===Z&&u.setFieldsValue({"ddr-4-pt":!1})}),[Z]);const T=u.getFieldValue("ddr-4-pt");(0,x.useEffect)((()=>{!0===T&&u.setFieldsValue({"ddr-3-pt":!1})}),[T]),(0,x.useEffect)((()=>{(null===p||void 0===p?void 0:p.includes("-"))&&u.setFieldsValue({"ddr-5-pt":!0})}),[p]);const O=(null!==v&&void 0!==v?v:"").split(":");return(0,g.jsx)(E.Z,{width:d,title:(0,g.jsxs)(g.Fragment,{children:["Edit ",a.name," ",c&&(0,g.jsx)("small",{children:c})]}),open:t,onOk:u.submit,onCancel:n,maskClosable:!1,okButtonProps:{disabled:m,htmlType:"submit",size:"large"},okText:"Add Item",children:(0,g.jsxs)(w.Z,{form:u,name:"new-item-".concat(a.itemId),onFinish:e=>{const t=_(e);s(t)},autoComplete:"off",initialValues:V(a,i),layout:"vertical",size:"small",labelWrap:!0,children:[(0,g.jsxs)("div",{className:"diagram-container",children:[(0,g.jsx)("div",{children:(0,g.jsx)(U.ck,{id:a.itemId,width:50})}),(0,g.jsx)(w.Z.Item,{name:"name",label:"Name",children:(0,g.jsx)(I.Z,{})}),(0,g.jsx)(w.Z.Item,{name:"itemId",label:"Item",children:(0,g.jsx)(I.Z,{readOnly:!0})}),(0,g.jsx)(w.Z.Item,{name:"syllables",label:"Syllables",children:(0,g.jsx)(I.Z,{})}),(0,g.jsx)(w.Z.Item,{name:"stressedSyllable",label:"Stressed Syllable",children:(0,g.jsx)(k.ZP.Group,{optionType:"button",buttonStyle:"solid",children:O.map(((e,t)=>(0,g.jsx)(k.ZP,{value:O.length-t-1,children:e},t)))})}),(0,g.jsx)(w.Z.Item,{name:"updatedAt",label:"Updated At",children:(0,g.jsx)(I.Z,{value:new Date(a.updatedAt).toLocaleString(),readOnly:!0})}),r&&(0,g.jsxs)("div",{children:["Options: ",null===r||void 0===r?void 0:r.join(", ")]}),(0,g.jsx)("div",{children:(0,g.jsx)(D.Z,{offsetTop:50,children:(0,g.jsx)(l.Z,{justify:"center",align:"center",children:(0,g.jsx)(b.ZP,{type:"primary",htmlType:"submit",size:"large",disabled:m,children:"Add Item"})})})})]}),(0,g.jsx)("div",{className:"diagram-container",children:o.map((e=>"auto"===e.method&&Y[e.id]?(0,g.jsx)(w.Z.Item,{name:e.id,label:e.title,valuePropName:"checked",className:(0,L.Z)(a.updatedAt<e.updatedAt&&"diagram-container__outdated-rule"),children:(0,g.jsx)(N.Z,{checkedChildren:"\u2705",unCheckedChildren:"\u274c",disabled:!0})},e.id):"dependency"===e.method?(0,g.jsx)(w.Z.Item,{name:e.id,label:e.title,valuePropName:"checked",className:(0,L.Z)(a.updatedAt<e.updatedAt&&"diagram-container__outdated-rule"),children:(0,g.jsxs)(k.ZP.Group,{optionType:"button",buttonStyle:"solid",disabled:!0,children:[(0,g.jsx)(k.ZP,{value:!0,children:"\u2705"}),(0,g.jsx)(k.ZP,{value:!1,children:"\u274c"})]})},e.id):(0,g.jsx)(w.Z.Item,{name:e.id,label:e.title,className:(0,L.Z)(a.updatedAt<e.updatedAt&&"diagram-container__outdated-rule"),children:(0,g.jsxs)(k.ZP.Group,{optionType:"button",buttonStyle:"solid",children:[(0,g.jsx)(k.ZP,{value:!0,children:"\u2705"}),(0,g.jsx)(k.ZP,{value:!1,children:"\u274c"})]})},e.id)))})]})})}const V=(e,t)=>{var s,n;let l=!1;return{name:e.name,itemId:e.itemId,syllables:null!==(s=e.syllables)&&void 0!==s?s:"",stressedSyllable:null!==(n=e.stressedSyllable)&&void 0!==n?n:0,...Object.keys(t).reduce(((s,n)=>{if(e.updatedAt<t[n].updatedAt)if(Y[n]){const t=Y[n](e.name);t&&e.rules.includes(n)&&(l=!0),s[n]=t}else s[n]=void 0;else s[n]=e.rules.includes(n);return s}),{}),updatedAt:l?Date.now():e.updatedAt}},_=e=>{const{itemId:t,name:s,updatedAt:n,syllables:l,stressedSyllable:a,...i}=e;return{itemId:t,name:s,updatedAt:Date.now(),syllables:l,stressedSyllable:a,rules:Object.keys(i).filter((e=>!0===i[e]))}};function B(e){let{addEntryToUpdate:t,availableThings:s,rules:n,width:l}=e;const{notification:a}=T.Z.useApp(),[i,d]=(0,x.useState)(null),r=()=>{const e=(0,S.sample)(s);d(e?{itemId:e.id,name:K(e),updatedAt:Date.now(),syllables:"",stressedSyllable:0,rules:[]}:null)},c=(0,x.useMemo)((()=>{var e;if(!i)return[];const t=s.find((e=>e.id===i.itemId));return[null===t||void 0===t?void 0:t.name.pt,...null!==(e=null===t||void 0===t?void 0:t.aliasesPt)&&void 0!==e?e:[]].filter(Boolean)}),[i,s]);return(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(b.ZP,{size:"large",onClick:r,children:"Classify New Item"}),!!i&&(0,g.jsx)(q,{isModalOpen:null!==i,onSaveThing:async e=>{i&&(e.name&&e.itemId||a.error({message:"Name and Item ID are required"}),t(e.itemId,e),console.log("COMPLETED SAVE"),d(null),await(0,p.Dc)(250),r())},onCancel:()=>d(null),thing:i,rules:n,width:.9*l,itemAliases:c})]})}const K=e=>{return 1===e.name.pt.split(" ").length?e.name.pt:e.aliasesPt&&null!==(t=e.aliasesPt.find((e=>1===e.split(" ").length)))&&void 0!==t?t:e.name.pt;var t};var W=s(6728);function G(e,t,s,n){const l=(0,S.shuffle)(Object.keys(e).filter((e=>!n.includes(e)))),a=(0,S.sample)(l);if(!a)throw new Error("No available things to choose from");n.push(a);const i=(0,S.capitalize)(e[a].name),d={id:a,name:e[a].name},r=(0,S.sampleSize)(e[a].rules,2),c="".concat(r[0],"-").concat(r[1]);if(2!==r.length)throw new Error("No rules found for this thing");n.push(c);const o=s[r[0]].level+s[r[1]].level-1,u=(0,S.difference)(t[r[0]],t[r[1]]),h=(0,S.difference)(t[r[1]],t[r[0]]),m=(0,S.intersection)(t[r[0]],t[r[1]]),p=u.pop();if(!p)throw new Error("No only in rule 1 things to choose from");const g={id:r[0],text:s[r[0]].title,level:s[r[0]].level,thing:{id:p,name:e[p].name}},v=h.pop();if(!v)throw new Error("No only in rule 2 things to choose from");const j={id:r[1],text:s[r[1]].title,level:s[r[1]].level,thing:{id:v,name:e[v].name}},x=(0,S.sampleSize)(m,4),f=(0,S.sampleSize)(u,8),y=(0,S.sampleSize)(h,8),b={};x.forEach((e=>b[e]=0)),f.forEach((e=>b[e]=1)),y.forEach((e=>b[e]=2));return{title:i,level:o,rule1:g,rule2:j,intersectingThing:d,things:(0,S.sampleSize)([...x,...f,...y],8).map((t=>({id:t,name:e[t].name,rule:b[t]})))}}var Q=s(913),H=s(4691);function J(e){let{itemId:t,name:s,width:n=50}=e;return(0,g.jsxs)(l.Z,{vertical:!0,align:"center",children:[(0,g.jsx)(U.ck,{id:t,width:n}),(0,g.jsx)(j.Z.Text,{code:!0,children:s},t)]})}function X(e){let{game:t}=e;return(0,g.jsxs)(y.Z,{direction:"vertical",align:"center",children:[(0,g.jsx)(j.Z.Title,{level:4,children:"Game Sample"}),(0,g.jsxs)(j.Z.Title,{level:5,children:['"',t.title,'"']}),(0,g.jsx)(Q.Z,{value:t.level,count:t.level,disabled:!0}),(0,g.jsx)(j.Z.Paragraph,{style:{maxWidth:"500px"},children:"O c\xedrculo amarelo tem uma regra gramatical secreta e o circulo vermelho tem outra regra gramatical secreta. O quadrado do meio representa a interse\xe7\xe3o entre a regra amarela e a regra vermelha."}),(0,g.jsxs)(y.Z,{children:[(0,g.jsx)("div",{className:"diagram-simulator__rule-1",children:(0,g.jsx)(J,{itemId:t.rule1.thing.id,name:t.rule1.thing.name})}),(0,g.jsx)("div",{className:"diagram-simulator__rule-intersection",children:(0,g.jsx)(J,{itemId:t.intersectingThing.id,name:t.intersectingThing.name})}),(0,g.jsx)("div",{className:"diagram-simulator__rule-2",children:(0,g.jsx)(J,{itemId:t.rule2.thing.id,name:t.rule2.thing.name})})]}),(0,g.jsx)(j.Z.Text,{children:"Coloque os objetos nos c\xedrculos corretos:"}),(0,g.jsx)(y.Z,{className:"space--center",children:t.things.map((e=>(0,g.jsx)(J,{itemId:e.id,name:e.name},e.id)))}),(0,g.jsx)(H.Z,{items:[{key:"1",label:"Resposta",children:(0,g.jsxs)(y.Z,{direction:"vertical",children:[(0,g.jsx)(j.Z.Text,{strong:!0,children:"Regra Amarela"}),(0,g.jsx)("ul",{children:(0,g.jsx)("li",{children:(0,g.jsx)(j.Z.Text,{children:t.rule1.text})})}),(0,g.jsx)(j.Z.Text,{strong:!0,children:"Regra Vermelha"}),(0,g.jsx)("ul",{children:(0,g.jsx)("li",{children:(0,g.jsx)(j.Z.Text,{children:t.rule2.text})})})]})}]}),(0,g.jsx)("div",{style:{height:"200px"}})]})}function $(e){let{things:t,addEntryToUpdate:s,availableThings:n,rules:l,thingsByRules:a}=e;const[i,{width:d}]=(0,Z.Z)(),[c,o]=(0,x.useState)(null);return(0,g.jsxs)(y.Z,{direction:"vertical",ref:i,children:[(0,g.jsxs)(j.Z.Title,{level:5,children:["Rules By Items (Added: ",Object.keys(t).length," | ",n.length,")"]}),(0,g.jsx)(B,{addEntryToUpdate:s,availableThings:n,rules:l,width:d}),(0,g.jsx)(r.Z,{}),(0,g.jsx)(b.ZP,{size:"large",onClick:()=>{o(Object.values(((e,t,s,n)=>{console.count("Creating Teoria de Conjuntos...");let l=t.latestDate;const a=[...t.used],i=(()=>{const e=Object.values(s).reduce(((e,t)=>(e[t.id]=[],e)),{});return Object.values(n).forEach((t=>{t.rules.forEach((s=>{e[s].push(t.itemId)}))})),e})(),d={};for(let r=0;r<e;r++){const e=(0,W.ao)(l);l=e,d[e]={id:e,type:"teoria-de-conjuntos",number:t.latestNumber+r+1,...G(n,i,s,a)}}return d})(1,{latestDate:"2023/01/01",latestNumber:0,used:[]},l,t))[0])},children:"Simulate"}),c&&(0,g.jsx)(X,{game:c})]})}var ee=s(952),te=s(122);function se(e){let{things:t,addEntryToUpdate:s,availableThings:n,rules:l,thingsByRules:a}=e;const[i,{width:d}]=(0,Z.Z)(),c=(0,x.useMemo)((()=>{const e=Object.values(a).map((e=>e.length));return{maxThings:Math.max(...e),minThings:Math.min(...e),averageThings:Math.round(Object.values(a).reduce(((e,t)=>e+t.length),0)/Object.keys(a).length)}}),[a]),o=[{title:"Id",dataIndex:"id",key:"id",sorter:(e,t)=>Number(e.id.split("-")[1])-Number(t.id.split("-")[1]),render:e=>(0,g.jsx)(j.Z.Text,{children:e})},{title:"Rule",dataIndex:"title",key:"title",sorter:(e,t)=>e.title.localeCompare(t.title),render:e=>(0,g.jsx)(j.Z.Text,{children:e})},{title:"Things",dataIndex:"id",key:"id",render:e=>(0,g.jsxs)(y.Z,{size:"small",children:[(0,g.jsx)(ee.Z,{children:a[e].length}),(0,g.jsxs)(y.Z,{size:"small",wrap:!0,children:[a[e].slice(0,20).map((s=>(0,g.jsx)(J,{itemId:s,name:t[s].name},"".concat(e,"-").concat(s)))),a[e].length>20&&(0,g.jsxs)(j.Z.Text,{children:["+",a[e].length-20," more"]})]})]})},{title:"Level",dataIndex:"level",key:"level",sorter:(e,t)=>e.level-t.level,render:e=>(0,g.jsx)(Q.Z,{value:e,count:3,disabled:!0})}];return(0,g.jsxs)(y.Z,{direction:"vertical",ref:i,children:[(0,g.jsxs)(j.Z.Title,{level:4,children:["Things By Rule (Added: ",Object.keys(t).length," | ",n.length,")"]}),(0,g.jsxs)(y.Z,{split:(0,g.jsx)(r.Z,{type:"vertical"}),children:[(0,g.jsx)(B,{addEntryToUpdate:s,availableThings:n,rules:l,width:d}),(0,g.jsxs)(j.Z.Text,{strong:!0,children:["Average Things: ",(0,g.jsx)(ee.Z,{children:c.averageThings})]}),(0,g.jsxs)(j.Z.Text,{strong:!0,children:["Max Things: ",(0,g.jsx)(ee.Z,{children:c.maxThings})]}),(0,g.jsxs)(j.Z.Text,{strong:!0,children:["Min Things: ",(0,g.jsx)(ee.Z,{children:c.minThings})]})]}),(0,g.jsx)(te.Z,{dataSource:Object.values(l),columns:o})]})}function ne(e){let{children:t,things:s,rules:n,addEntryToUpdate:l}=e;const a=(0,x.useMemo)((()=>Object.values(s).filter((e=>{const t=e.updatedAt,s=Object.values(n).reduce(((e,t)=>Math.max(e,t.updatedAt)),0);return!e.syllables||void 0===e.stressedSyllable||s>t}))),[s,n]),[i,d]=(0,x.useState)(null);(0,x.useEffect)((()=>{console.count("Checking for things that need to update..."),a.length>0&&(async e=>{console.log("Found things that need to update..."),d(null),await(0,p.Dc)(250),d(e)})(a[0])}),[a]);return(0,g.jsxs)(g.Fragment,{children:[i&&(0,g.jsx)(q,{subtitle:"(".concat(a.length," left to update)"),isModalOpen:null!==i,onSaveThing:e=>{l(e.itemId,e)},onCancel:()=>d(null),thing:i,rules:n}),(0,g.jsx)(g.Fragment,{children:t})]})}function le(e){let{data:t,addEntryToUpdate:s}=e;const n=(0,f.N)("items"),l=(0,f.N)("daily-diagram-rules"),i=(0,x.useMemo)((()=>{var e;return Object.values(null!==(e=n.data)&&void 0!==e?e:{}).filter((e=>{var s,n,l;if(t&&void 0!==t[e.id])return!1;if(null!==(s=e.decks)&&void 0!==s&&s.includes("thing"))return!0;const a=1===e.name.pt.split(" ").length;return!(null===(n=e.decks)||void 0===n||!n.includes("alien")||!a)||!(null===(l=e.decks)||void 0===l||!l.includes("manufactured")||!a)}))}),[t,n.data]),d=(0,x.useMemo)((()=>{var e;return null!==(e=l.data)&&void 0!==e?e:{}}),[l.data]),r=(0,x.useMemo)((()=>{const e=Object.values(d).reduce(((e,t)=>(e[t.id]=[],e)),{});return(0,S.orderBy)(Object.values(t),["updatedAt"],["desc"]).forEach((t=>{t.rules.forEach((s=>{e[s].push(t.itemId)}))})),e}),[t,d]),{is:c,queryParams:o}=(0,m.K)();return n.isLoading||l.isLoading?(0,g.jsx)(j.Z.Text,{children:"Loading..."}):(0,g.jsx)(a.T,{isLoading:n.isLoading||l.isLoading,hasResponseData:n.hasResponseData||l.hasResponseData,children:(0,g.jsxs)(ne,{things:t,rules:d,addEntryToUpdate:s,children:[(c("display","rule")||!o.has("display"))&&(0,g.jsx)(se,{things:t,addEntryToUpdate:s,availableThings:i,rules:d,thingsByRules:r}),c("display","thing")&&(0,g.jsx)($,{things:t,addEntryToUpdate:s,availableThings:i,rules:d,thingsByRules:r})]})})}var ae=s(4562),ie=s(8938);function de(){const e=(0,ie.i)({tdrResourceName:"daily-diagram-items",firebaseDataCollectionName:"diagramItems",serialize:!0});return(0,g.jsx)(h.Xg,{title:"Items",subtitle:"Quartet Sets",children:(0,g.jsxs)(n.Z,{hasSider:!0,children:[(0,g.jsx)(ae.p,{children:(0,g.jsx)(v,{...e})}),(0,g.jsx)(n.Z.Content,{className:"content",children:(0,g.jsx)(a.T,{isLoading:e.isLoading||e.isSaving,error:e.error,hasResponseData:!(0,S.isEmpty)(e.data),children:(0,g.jsx)(l.Z,{vertical:!0,gap:24,children:(0,g.jsx)(le,{...e})})})})]})})}const re=de}}]);
//# sourceMappingURL=ItemsDiagramSets.7ae73426.chunk.js.map