"use strict";(self.webpackChunktdr=self.webpackChunktdr||[]).push([[286],{7018:(t,e,s)=>{s.d(e,{o:()=>a});var n=s(2556),r=s(5850),i=s(184);function a(t){let{data:e,fileName:s,loading:a,...o}=t;return(0,i.jsx)(n.ZP,{onClick:()=>(0,r.ZN)("function"===typeof e?e():e,s),loading:a,...o,children:"Download JSON"})}},2999:(t,e,s)=>{s.d(e,{R:()=>o,T:()=>l});var n=s(952),r=s(3070),i=s(1958),a=s(184);function o(t){let{isLoading:e,isIdle:s,error:r,isDirty:i,isError:o,hasResponseData:l}=t;return s?(0,a.jsx)(n.Z,{children:"No Data yet"}):e?(0,a.jsx)(n.Z,{color:"blue",children:"Loading..."}):r||o?(0,a.jsx)(n.Z,{color:"red",children:"Error"}):i?(0,a.jsx)(n.Z,{color:"orange",children:"Modified"}):l?(0,a.jsx)(n.Z,{color:"green",children:"Loaded"}):(0,a.jsx)(n.Z,{children:"No Data"})}function l(t){return(0,a.jsx)(i.Pd,{children:(0,a.jsx)(r.Z.Item,{label:"Status",children:(0,a.jsx)(o,{...t})})})}},8866:(t,e,s)=>{s.d(e,{N:()=>i});var n=s(8914),r=s(184);function i(t){let{children:e,level:s,...i}=t;return(0,r.jsx)(n.Z.Title,{level:null!==s&&void 0!==s?s:3,...i,children:e})}},6173:(t,e,s)=>{s.d(e,{xh:()=>h,zE:()=>u,Do:()=>d,Th:()=>p.T,F6:()=>i});s(8866);var n=s(3733),r=s(184);const i=t=>{let{children:e,active:s=!1,activeClass:i="",className:a="",hoverType:o="scale",...l}=t;return(0,r.jsx)("button",{className:(0,n.Z)("transparent-button","transparent-button--".concat(o),s&&(i||"transparent-button--active"),a),...l,children:e})};var a=s(3070),o=s(1766),l=s(492),c=s(5922);function u(t){let{label:e,value:s,onChange:n,options:i,placeholder:l}=t;return(0,r.jsx)(a.Z.Item,{label:e,children:(0,r.jsxs)(o.Z,{style:{minWidth:"150px"},onChange:n,value:s,children:[l&&(0,r.jsx)(o.Z.Option,{value:"",disabled:!0,children:"placeholder"}),i.map((t=>"object"===typeof t?(0,r.jsx)(o.Z.Option,{value:t.value,children:t.label},"".concat(e,"-").concat(t.value)):(0,r.jsx)(o.Z.Option,{value:t,children:t},"".concat(e,"-").concat(t))))]})})}function h(t){let{label:e,value:s,onChange:n,min:i=0,max:o=100,step:c}=t;return(0,r.jsx)(a.Z.Item,{label:e,children:(0,r.jsx)(l.Z,{min:i,max:o,value:s,onChange:t=>n(null!==t&&void 0!==t?t:o),style:{minWidth:"150px",width:"100%"},step:c})})}function d(t){let{label:e,value:s,onChange:n,className:i}=t;return(0,r.jsx)(a.Z.Item,{label:e,valuePropName:"checked",className:i,children:(0,r.jsx)(c.Z,{checked:s,onChange:n,size:"small"})})}var p=s(2999)},145:(t,e,s)=>{s.d(e,{f:()=>o});var n=s(3733),r=s(2241),i=s(2606),a=s(184);const o=t=>{let{id:e,width:s=200,className:o="",preview:l=!0,fileExtension:c="jpg"}=t;const{getUrl:u}=(0,i.n)("tdi"),h=e.replace(/-/g,"/");return(0,a.jsx)("div",{className:(0,n.Z)("image-card",o),children:(0,a.jsx)(r.Z,{width:s,src:u("".concat(h,".").concat(c)),fallback:u("back/default.jpg"),preview:l})})}},6709:(t,e,s)=>{s.d(e,{P:()=>f,l:()=>g});var n=s(2791),r=s(763);var i=s(6403),a=s(6807),o=s(3418),l=s(5860),c=s(2481),u=s(4747);var h=s(5850);const d=()=>(0,r.padStart)(String((0,r.random)(1,252)),2,"0"),p=()=>(0,r.random)(1,10);var v=s(184);const m=(0,n.createContext)({}),f=t=>{let{children:e}=t;const s=function(){const[t,e]=(0,n.useState)(!1),s=["data/imageCardsRelationships"],r=(0,i.NL)(),{notification:h}=u.Z.useApp(),[d,p]=(0,n.useState)({total:0,overdone:0,complete:0,single:0}),{data:v={},isLoading:m,isSuccess:f,isError:g,isFetched:x,isRefetching:j,refetch:b}=(0,a.a)({queryKey:s,queryFn:async()=>{var t;const e=(0,c.JU)(l.RZ,"data/imageCardsRelationships");return null!==(t=(await(0,c.QT)(e)).data())&&void 0!==t?t:{}}}),{isLoading:S,isError:y,isSuccess:Z,mutate:R}=(0,o.D)({mutationKey:s,mutationFn:async()=>{const t=(0,c.JU)(l.RZ,"data/imageCardsRelationships");return await(0,c.pl)(t,v),v},onSuccess:()=>{h.success({message:"Saved",placement:"bottomLeft"}),r.refetchQueries(s),e(!1)}});return(0,n.useEffect)((()=>{if(!j&&x){const t=Object.keys(v).length;let e=0,s=0,n=0;Object.values(v).forEach((t=>{t.length>8&&(e+=1),1===t.length&&(n+=1),t.length>2&&(s+=1)})),p({total:t,overdone:e,complete:s,single:n})}}),[x,j]),{data:v,isLoading:m,isSuccess:f,isError:g,hasData:f&&Object.keys(v).length>0,refetch:b,isSaving:S,isMutationError:y,isSaved:Z,save:R,setDirty:e,isDirty:t,stats:d}}(),[r,f]=(0,n.useState)(15),[g,x]=(0,n.useState)(5),[j,b]=(0,n.useState)(150),[S,y]=(0,n.useState)(!1),Z=function(t,e,s,r){const[i,a]=(0,n.useState)([]),[o,l]=(0,n.useState)([]),[c,u]=(0,n.useState)([]),[v,m]=(0,n.useState)(0),[f,g]=(0,n.useState)(!0),[x,j]=(0,n.useState)([]),b=e=>{l((null!==e&&void 0!==e?e:i).map((e=>{var s;return null!==(s=null===t||void 0===t?void 0:t[e])&&void 0!==s?s:[]})))},S=()=>{const e=[...x];let n=0;const i=c.length<2e3?c:[];let o=0;for(;o<400&&e.length<s;){var l;const s="td-d".concat(p(),"-").concat(d()),a=null!==(l=t[s])&&void 0!==l?l:[],c=!(r>0)||a.length<r,u=!!f&&i.includes(s);e.includes(s)||u||!c||(e.push(s),n+=1),o+=1}a(e),u((t=>[...t,...e])),b(e),m((t=>t+n))};return(0,n.useEffect)((()=>{0===i.length&&S()}),[i]),{cardIds:i,cards:o,selection:x,onSelect:t=>{j((e=>{const s=[...e],n=s.indexOf(t);return n>-1?s.splice(n,1):s.push(t),s}))},relate:()=>{x.forEach((e=>{var s;const n=null!==(s=t[e])&&void 0!==s?s:[];n.push(...x.filter((t=>t!==e))),t[e]=(0,h.R1)(n)})),e(!0),j([]),b(),u([]),m(0)},nextSet:S,deselectAll:()=>{j([])},cycles:v,filters:{useCycles:f,toggleUseCycles:()=>{g((t=>!t))}}}}(s.data,s.setDirty,r,g);return(0,v.jsx)(m.Provider,{value:{sampleSize:r,setSampleSize:f,tagThreshold:g,setTagThreshold:x,cardSize:j,setCardSize:b,showIds:S,setShowIds:y,randomGroups:Z,query:s},children:e})},g=()=>(0,n.useContext)(m)},9936:(t,e,s)=>{s.d(e,{A:()=>l});var n=s(8622),r=s(3070),i=s(9367),a=s(6709),o=s(184);function l(){const{query:{stats:t}}=(0,a.l)();return(0,o.jsx)(r.Z.Item,{label:(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(i.C,{icon:(0,o.jsx)(n.Z,{}),shape:"square",size:"small",style:{marginRight:6}}),"Stats"]}),children:(0,o.jsxs)("ul",{className:"statistic__list",children:[(0,o.jsxs)("li",{children:["Completion: ",Math.floor(100*t.total/2520),"%"]}),(0,o.jsxs)("li",{children:["Total Relationships: ",t.total]}),(0,o.jsxs)("li",{children:["Complete: ",t.complete]}),(0,o.jsxs)("li",{children:["Overdone: ",t.overdone]}),(0,o.jsxs)("li",{children:["Single Match: ",t.single]})]})})}},8741:(t,e,s)=>{s.r(e),s.d(e,{default:()=>z});var n=s(3990),r=s(4520),i=s(1046),a=s(952),o=s(6402),l=s(2128),c=s(763),u=s(2791),h=s(7415),d=s(7462);const p={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm154.7 454.5l-246 178c-5.3 3.8-12.7 0-12.7-6.5v-46.9c0-10.2 4.9-19.9 13.2-25.9L566.6 512 421.2 406.8c-8.3-6-13.2-15.6-13.2-25.9V334c0-6.5 7.4-10.3 12.7-6.5l246 178c4.4 3.2 4.4 9.8 0 13z"}}]},name:"right-circle",theme:"filled"};var v=s(4315),m=function(t,e){return u.createElement(v.Z,(0,d.Z)({},t,{ref:e,icon:p}))};const f=u.forwardRef(m);var g=s(145),x=s(6709),j=s(184);function b(){const{query:{isDirty:t,isSaving:e,save:s,stats:n,data:d,...p},randomGroups:{cardIds:v},showIds:m,cardSize:b}=(0,x.l)(),[y,{width:Z}]=(0,h.Z)(),[,R]=(0,u.useMemo)((()=>{const t=Math.floor(Z/b)+1;return[t,Math.floor(Z/t)]}),[b,Z]),C=[{title:"Length",dataIndex:"length",key:"length"},{title:"Relationships",dataIndex:"relationships",key:"relationship",render:(t,e)=>(0,j.jsx)(r.Z,{wrap:"wrap",gap:2,children:t.map((s=>(0,j.jsxs)(i.Z,{children:[(0,j.jsxs)(i.Z,{direction:"vertical",children:[(0,j.jsx)(g.f,{id:s,width:R}),m&&(0,j.jsx)(a.Z,{children:s})]}),t[t.length-1]!==s&&(0,j.jsx)(f,{})]},"".concat(e.origin,"-").concat(s))))})}],w=(0,u.useMemo)((()=>(0,c.orderBy)(v.map((t=>{const e=S(t,d,"longest",10);return{key:t,origin:t,length:e.length,relationships:e}})),["length"],["desc"])),[v,d]);return(0,j.jsx)(l.T,{isLoading:p.isLoading,error:p.error,hasResponseData:!0,children:(0,j.jsx)("div",{ref:y,className:"my-6",children:(0,j.jsx)(o.Z,{dataSource:w,columns:C})})})}const S=(0,c.memoize)(((t,e,s,n)=>{const r=new Set,i=[];let a=[],o=0;for(i.push({currentId:t,path:[],depth:0});i.length>0&&o<100;){o++;const{currentId:t,path:l,depth:c}=i.pop();if(r.add(t),l.push(t),"longest"===s&&l.length>a.length&&(a=[...l]),"shortest"===s&&(0===a.length||l.length<a.length)&&(a=[...l]),"any"===s&&0===a.length&&(a=[...l]),!(c>=n))for(const s of e[t]||[])r.has(s)||i.push({currentId:s,path:[...l],depth:c+1})}return a}));var y=s(2556),Z=s(1958),R=s(6173),C=s(7018),w=s(6591),E=s(9936);function M(){const{query:{isDirty:t,isSaving:e,data:s,isLoading:n,isError:r},showIds:i,setShowIds:a,sampleSize:o,setSampleSize:l,cardSize:u,setCardSize:h,randomGroups:{nextSet:d}}=(0,x.l)();return(0,j.jsxs)(Z.p3,{children:[(0,j.jsx)(R.Th,{isLoading:n||e,isDirty:t,isError:r,hasResponseData:!(0,c.isEmpty)(s)}),(0,j.jsxs)(Z.Pd,{children:[(0,j.jsx)(R.Do,{label:"Show Ids",value:i,onChange:t=>a(t)}),(0,j.jsx)(R.zE,{onChange:t=>l(t),value:o,options:w.ZI,label:"Sample Size"}),(0,j.jsx)(R.zE,{onChange:t=>h(t),value:u,options:w.Hn,label:"Card Size"}),(0,j.jsx)(y.ZP,{onClick:d,block:!0,type:"primary",children:"New Random Sample"})]}),(0,j.jsx)(Z.Pd,{children:(0,j.jsx)(E.A,{})}),(0,j.jsx)(Z.Pd,{children:(0,j.jsx)(C.o,{data:s,fileName:"imageCardsRelationships.json",loading:e,disabled:(0,c.isEmpty)(s),block:!0})})]})}const z=function(){return(0,j.jsx)(Z.Xg,{title:"Image Cards",subtitle:"Connections",children:(0,j.jsx)(x.P,{children:(0,j.jsxs)(n.Z,{hasSider:!0,children:[(0,j.jsx)(M,{}),(0,j.jsx)(n.Z.Content,{className:"content",children:(0,j.jsx)(b,{})})]})})})}},8622:(t,e,s)=>{s.d(e,{Z:()=>l});var n=s(7462),r=s(2791);const i={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M888 792H200V168c0-4.4-3.6-8-8-8h-56c-4.4 0-8 3.6-8 8v688c0 4.4 3.6 8 8 8h752c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm-600-80h56c4.4 0 8-3.6 8-8V560c0-4.4-3.6-8-8-8h-56c-4.4 0-8 3.6-8 8v144c0 4.4 3.6 8 8 8zm152 0h56c4.4 0 8-3.6 8-8V384c0-4.4-3.6-8-8-8h-56c-4.4 0-8 3.6-8 8v320c0 4.4 3.6 8 8 8zm152 0h56c4.4 0 8-3.6 8-8V462c0-4.4-3.6-8-8-8h-56c-4.4 0-8 3.6-8 8v242c0 4.4 3.6 8 8 8zm152 0h56c4.4 0 8-3.6 8-8V304c0-4.4-3.6-8-8-8h-56c-4.4 0-8 3.6-8 8v400c0 4.4 3.6 8 8 8z"}}]},name:"bar-chart",theme:"outlined"};var a=s(4315),o=function(t,e){return r.createElement(a.Z,(0,n.Z)({},t,{ref:e,icon:i}))};const l=r.forwardRef(o)},7136:(t,e,s)=>{s.d(e,{ZT:()=>n,jU:()=>r});var n=function(){};var r="undefined"!==typeof window},7415:(t,e,s)=>{s.d(e,{Z:()=>o});var n=s(2791),r=s(7136);const i=r.jU?n.useLayoutEffect:n.useEffect;var a={x:0,y:0,width:0,height:0,top:0,left:0,bottom:0,right:0};const o=r.jU&&"undefined"!==typeof window.ResizeObserver?function(){var t=(0,n.useState)(null),e=t[0],s=t[1],r=(0,n.useState)(a),o=r[0],l=r[1],c=(0,n.useMemo)((function(){return new window.ResizeObserver((function(t){if(t[0]){var e=t[0].contentRect,s=e.x,n=e.y,r=e.width,i=e.height,a=e.top,o=e.left,c=e.bottom,u=e.right;l({x:s,y:n,width:r,height:i,top:a,left:o,bottom:c,right:u})}}))}),[]);return i((function(){if(e)return c.observe(e),function(){c.disconnect()}}),[e]),[s,o]}:function(){return[r.ZT,a]}},3418:(t,e,s)=>{s.d(e,{D:()=>d});var n=s(2791),r=s(9054),i=s(9538),a=s(5511),o=s(3734);class l extends a.l{constructor(t,e){super(),this.client=t,this.setOptions(e),this.bindMethods(),this.updateResult()}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(t){var e;const s=this.options;this.options=this.client.defaultMutationOptions(t),(0,o.VS)(s,this.options)||this.client.getMutationCache().notify({type:"observerOptionsUpdated",mutation:this.currentMutation,observer:this}),null==(e=this.currentMutation)||e.setOptions(this.options)}onUnsubscribe(){var t;this.hasListeners()||(null==(t=this.currentMutation)||t.removeObserver(this))}onMutationUpdate(t){this.updateResult();const e={listeners:!0};"success"===t.type?e.onSuccess=!0:"error"===t.type&&(e.onError=!0),this.notify(e)}getCurrentResult(){return this.currentResult}reset(){this.currentMutation=void 0,this.updateResult(),this.notify({listeners:!0})}mutate(t,e){return this.mutateOptions=e,this.currentMutation&&this.currentMutation.removeObserver(this),this.currentMutation=this.client.getMutationCache().build(this.client,{...this.options,variables:"undefined"!==typeof t?t:this.options.variables}),this.currentMutation.addObserver(this),this.currentMutation.execute()}updateResult(){const t=this.currentMutation?this.currentMutation.state:(0,r.R)(),e={...t,isLoading:"loading"===t.status,isSuccess:"success"===t.status,isError:"error"===t.status,isIdle:"idle"===t.status,mutate:this.mutate,reset:this.reset};this.currentResult=e}notify(t){i.V.batch((()=>{var e,s,n,r;if(this.mutateOptions&&this.hasListeners())if(t.onSuccess)null==(e=(s=this.mutateOptions).onSuccess)||e.call(s,this.currentResult.data,this.currentResult.variables,this.currentResult.context),null==(n=(r=this.mutateOptions).onSettled)||n.call(r,this.currentResult.data,null,this.currentResult.variables,this.currentResult.context);else if(t.onError){var i,a,o,l;null==(i=(a=this.mutateOptions).onError)||i.call(a,this.currentResult.error,this.currentResult.variables,this.currentResult.context),null==(o=(l=this.mutateOptions).onSettled)||o.call(l,void 0,this.currentResult.error,this.currentResult.variables,this.currentResult.context)}t.listeners&&this.listeners.forEach((t=>{let{listener:e}=t;e(this.currentResult)}))}))}}var c=s(7413),u=s(6403),h=s(9608);function d(t,e,s){const r=(0,o.lV)(t,e,s),a=(0,u.NL)({context:r.context}),[d]=n.useState((()=>new l(a,r)));n.useEffect((()=>{d.setOptions(r)}),[d,r]);const v=(0,c.$)(n.useCallback((t=>d.subscribe(i.V.batchCalls(t))),[d]),(()=>d.getCurrentResult()),(()=>d.getCurrentResult())),m=n.useCallback(((t,e)=>{d.mutate(t,e).catch(p)}),[d]);if(v.error&&(0,h.L)(d.options.useErrorBoundary,[v.error]))throw v.error;return{...v,mutate:m,mutateAsync:v.mutate}}function p(){}}}]);
//# sourceMappingURL=ImageCardsConnections.7bf5327f.chunk.js.map