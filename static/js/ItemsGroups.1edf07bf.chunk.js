"use strict";(self.webpackChunktd_admin=self.webpackChunktd_admin||[]).push([[1187],{2043:(e,t,a)=>{a.d(t,{Do:()=>m,H:()=>x,tj:()=>h,xh:()=>p,zE:()=>u});var s=a(5225),n=a(5437),i=a(4003),l=a(5922),r=a(9862),o=a(4248),d=a(1431),c=a(184);function u(e){let{label:t,value:a,onChange:i,options:l,placeholder:r}=e;return(0,c.jsx)(s.Z.Item,{label:t,children:(0,c.jsxs)(n.Z,{style:{minWidth:"150px"},onChange:i,value:a,children:[r&&(0,c.jsx)(n.Z.Option,{value:"",disabled:!0,children:"placeholder"}),l.map((e=>"object"===typeof e?(0,c.jsx)(n.Z.Option,{value:e.value,children:e.label},"".concat(t,"-").concat(e.value)):(0,c.jsx)(n.Z.Option,{value:e,children:e},"".concat(t,"-").concat(e))))]})})}function p(e){let{label:t,value:a,onChange:n,min:l=0,max:r=100,step:o}=e;return(0,c.jsx)(s.Z.Item,{label:t,children:(0,c.jsx)(i.Z,{min:l,max:r,value:a,onChange:e=>n(null!==e&&void 0!==e?e:r),style:{minWidth:"150px",width:"100%"},step:o})})}function m(e){let{label:t,value:a,onChange:n,className:i,disabled:r}=e;return(0,c.jsx)(s.Z.Item,{label:t,valuePropName:"checked",className:i,children:(0,c.jsx)(l.Z,{checked:a,onChange:n,size:"small",disabled:r})})}function h(e){let{label:t,value:a,onChange:n,disabled:i,className:l}=e;return(0,c.jsx)(s.Z.Item,{label:t,valuePropName:"checked",className:l,children:(0,c.jsx)(r.Z,{checked:a,onChange:e=>n(e.target.checked),disabled:i})})}function x(e){let{value:t,label:a,onChange:n,options:i}=e;return(0,c.jsx)(s.Z.Item,{label:a,layout:i.length>2?"vertical":"horizontal",children:(0,c.jsx)(o.Z,{block:!0,value:t,onChange:n,options:i.map((e=>({label:(0,c.jsx)(d.Z,{arrow:!0,trigger:"hover",title:e.title,children:e.icon}),value:e.value})))})})}},2228:(e,t,a)=>{a.d(t,{N:()=>l});var s=a(8528),n=a(1046),i=a(184);function l(e){let{children:t,pagination:a,...l}=e;const r=(0,i.jsx)(s.Z,{showQuickJumper:!0,...a,className:"fixed-pagination"});return(0,i.jsxs)(n.Z,{direction:"vertical",...l,children:[r,t,r]})}},8866:(e,t,a)=>{a.d(t,{N:()=>i});var s=a(8252),n=a(184);function i(e){let{children:t,level:a,...i}=e;return(0,n.jsx)(s.Z.Title,{level:null!==a&&void 0!==a?a:3,...i,children:t})}},8357:(e,t,a)=>{a.d(t,{tj:()=>l.tj,xh:()=>l.xh,H:()=>l.H,zE:()=>l.zE,Do:()=>l.Do,Th:()=>u,F6:()=>i});a(8866);var s=a(3733),n=a(184);const i=e=>{let{children:t,active:a=!1,activeClass:i="",className:l="",hoverType:r="scale",...o}=e;return(0,n.jsx)("button",{className:(0,s.Z)("transparent-button","transparent-button--".concat(r),a&&(i||"transparent-button--active"),l),...o,children:t})};var l=a(2043),r=a(952),o=a(5225),d=a(7965);function c(e){let{isLoading:t,isIdle:a,error:s,isDirty:i,isError:l,hasResponseData:o}=e;return a?(0,n.jsx)(r.Z,{children:"No Data yet"}):t?(0,n.jsx)(r.Z,{color:"blue",children:"Loading..."}):s||l?(0,n.jsx)(r.Z,{color:"red",children:"Error"}):i?(0,n.jsx)(r.Z,{color:"orange",children:"Modified"}):o?(0,n.jsx)(r.Z,{color:"green",children:"Loaded"}):(0,n.jsx)(r.Z,{children:"No Data"})}function u(e){return(0,n.jsx)(d.Pd,{children:(0,n.jsx)(o.Z.Item,{label:"Status",children:(0,n.jsx)(c,{...e})})})}},8158:(e,t,a)=>{a.d(t,{CQ:()=>h,bN:()=>m,cw:()=>g,hW:()=>x,xL:()=>p});var s=a(1105),n=a(2556),i=a(1310),l=a(2997),r=a(8955),o=a(5458),d=a(1087),c=a(7134),u=a(184);function p(e){let{item:t,width:a,className:s}=e;return(0,u.jsx)(l.ck,{id:t.id,width:a,title:"".concat(t.name.en," | ").concat(t.name.pt),className:s})}function m(e){let{item:t}=e;const a=(0,c._)();return(0,u.jsx)("span",{children:(0,u.jsx)(s.Z,{prefix:t.nsfw?(0,u.jsx)(r.Z,{style:{color:"hotPink"}}):(0,u.jsx)(o.Z,{}),placeholder:"Id",variant:"borderless",size:"small",value:t.id,readOnly:!0,style:{width:"8ch"},onClick:()=>a(t.id)})})}function h(e){let{item:t,language:a}=e;return(0,u.jsx)(s.Z,{prefix:(0,u.jsx)(i.H,{language:a,width:"1em"}),placeholder:"Name in ".concat(a.toUpperCase()),variant:"borderless",size:"small",value:t.name[a],readOnly:!0})}function x(e){let{item:t}=e;return t.nsfw?(0,u.jsx)(r.Z,{style:{color:"hotpink"}}):(0,u.jsx)(u.Fragment,{})}function g(e){let{item:t}=e;const[,a]=(0,d.lr)();return(0,u.jsx)("span",{children:(0,u.jsx)(n.ZP,{size:"small",shape:"round",onClick:()=>{a({itemId:t.id,view:"classifier"})},children:"Go to"})})}},4290:(e,t,a)=>{a.d(t,{e:()=>l});var s=a(2791),n=a(4766),i=a(4421);function l(e){var t,a;let{prefix:l="",data:r,defaultCurrent:o=1,defaultPageSize:d=64,pageSizeOptions:c=[16,32,64,128],resetter:u}=e;const{queryParams:p,addParam:m}=(0,n.K)(),h=Number(null!==(t=p.get("".concat(l,"page")))&&void 0!==t?t:String(o)),x=Number(null!==(a=p.get("".concat(l,"pageSize")))&&void 0!==a?a:String(d)),g=(0,i.Z)(u),j=(0,s.useMemo)((()=>{const e=(h-1)*x,t=e+x;return r.slice(e,t)}),[h,x,r]),v=e=>{m("".concat(l,"page"),e.toString(),String(o))};return u!==g&&v(o),{page:j,pagination:{current:h,pageSize:x,onChange:v,onShowSizeChange:(e,t)=>{m("".concat(l,"pageSize"),t.toString(),String(d))},defaultCurrent:o,defaultPageSize:d,pageSizeOptions:c,total:r.length,hideOnSinglePage:!0}}}},8440:(e,t,a)=>{a.r(t),a.d(t,{ItemsGroups:()=>K,default:()=>Q});var s=a(3990),n=a(2128),i=a(4520),l=a(8252),r=a(9481),o=a(3320),d=a(6106),c=a(914),u=a(2228),p=a(2997),m=a(7134),h=a(4290),x=a(4766),g=a(5529),j=a(763),v=a(2791),y=a(5850),f=a(6473),Z=a(1046),b=a(5437),I=a(8158),C=a(184);function N(e){let{item:t,itemGroups:a,groupsTypeahead:s,onUpdateItemGroups:n}=e;const i=(0,m._)();return(0,C.jsxs)(f.Z,{title:(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(l.Z.Text,{onClick:()=>i(t.id),children:t.id}),(0,C.jsx)(I.hW,{item:t})]}),style:{maxWidth:250},children:[(0,C.jsx)(I.xL,{item:t,width:75}),(0,C.jsxs)(Z.Z,{size:"small",direction:"vertical",className:"my-4",children:[(0,C.jsx)(I.CQ,{item:t,language:"en"}),(0,C.jsx)(I.CQ,{item:t,language:"pt"}),(0,C.jsx)(b.Z,{mode:"tags",style:{width:"100%"},placeholder:"Select a group",defaultValue:a,options:s,showSearch:!0,size:"small",onChange:e=>n(t.id,e)},String(a))]})]})}var k=a(548),S=a(8357),w=a(8178),G=a(4850);function O(e){let{data:t,addEntryToUpdate:a}=e;const{is:s,queryParams:n}=(0,x.K)(),i=(0,g.N)("items"),l=(0,v.useMemo)((()=>Object.values(null!==t&&void 0!==t?t:[]).reduce(((e,t)=>(t.itemsIds||console.warn("Group without items",t),t.itemsIds.forEach((a=>{e[a]||(e[a]=[]),e[a].push(t.id)})),e)),{})),[t]),r=(0,v.useMemo)((()=>(0,j.orderBy)(Object.keys(t).map((e=>({label:e,value:e}))),"label")),[t]),o=(e,s)=>{var n;const i=null!==(n=l[e])&&void 0!==n?n:[],r=s.filter((e=>!i.includes(e))),o=i.filter((e=>!s.includes(e)));r.forEach((s=>{var n,i;a(s,{id:s,itemsIds:(0,y.R1)([...null!==(n=null===(i=t[s])||void 0===i?void 0:i.itemsIds)&&void 0!==n?n:[],e])})})),o.forEach((s=>{var n;a(s,{id:s,itemsIds:(0,y.R1)(null===(n=t[s])||void 0===n?void 0:n.itemsIds.filter((t=>t!==e)))})}))},d=(e,t)=>{a(e,{id:e,itemsIds:(0,y.R1)(t)})};return(0,C.jsxs)(C.Fragment,{children:[(s("display","group")||!n.has("display"))&&(0,C.jsx)(z,{data:t,items:i.data,grousByItem:l,groupsTypeahead:r,onUpdateItemGroups:o,onUpdateGroupItems:d}),s("display","item")&&(0,C.jsx)(P,{data:t,items:i.data,grousByItem:l,groupsTypeahead:r,onUpdateItemGroups:o,onUpdateGroupItems:d})]})}function z(e){let{data:t,items:a,grousByItem:s,groupsTypeahead:n,onUpdateItemGroups:d,onUpdateGroupItems:c}=e;const u=(0,m._)(),h=(0,g.N)("items"),[x,j]=(0,v.useState)(null),f=(0,k.P)({showQuickJumper:!0,total:Object.keys(t).length}),Z=[{title:"id",dataIndex:"id",key:"id",render:e=>(0,C.jsx)("span",{children:e})},{title:"Items",dataIndex:"itemsIds",key:"itemsIds",render:(e,t)=>(0,C.jsx)(i.Z,{gap:6,wrap:"wrap",children:e.map((e=>(0,C.jsxs)(i.Z,{gap:2,vertical:!0,children:[(0,C.jsx)(S.F6,{onClick:()=>j(e),children:(0,C.jsx)(p.ck,{id:e,width:60})}),(0,C.jsx)(i.Z,{justify:"center",children:(0,C.jsx)(l.Z.Text,{onClick:()=>u(e),children:e})})]},"".concat(t.id,"-").concat(e))))},"items-".concat(t.id))},r.Z.EXPAND_COLUMN,{title:"Count",dataIndex:"itemsIds",key:"count",render:e=>(0,y.R1)(e).filter(Boolean).length},{title:"Actions",dataIndex:"itemsIds",key:"actions",render:e=>(0,C.jsx)(G.A,{ids:e})}],b=x?a[x]:null;return(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(r.Z,{columns:Z,dataSource:Object.values(t),className:"my-4",rowKey:"id",pagination:f,expandable:{expandedRowRender:e=>(0,C.jsx)(E,{group:e,onUpdateGroupItems:c}),rowExpandable:()=>h.isSuccess}}),(0,C.jsx)(o.Z,{title:"Edit Item Group",onClose:()=>j(null),open:!!b,children:b&&(0,C.jsx)(N,{item:b,itemGroups:s[b.id],groupsTypeahead:n,onUpdateItemGroups:d})})]})}function E(e){let{group:t,onUpdateGroupItems:a}=e;return(0,C.jsx)("div",{children:(0,C.jsx)(w.i,{onFinish:e=>{a(t.id,[...t.itemsIds,e])}})})}function P(e){let{items:t,grousByItem:a,groupsTypeahead:s,onUpdateItemGroups:n}=e;const{is:i}=(0,x.K)(),r=i("emptyOnly"),o=(0,v.useMemo)((()=>r?Object.values(t).filter((e=>!a[e.id])):Object.values(t)),[t,a,r]),{page:p,pagination:m}=(0,h.e)({data:o});return(0,C.jsxs)(C.Fragment,{children:[(0,C.jsxs)(l.Z.Title,{level:2,children:["Groups by Items (",o.length,")"]}),(0,C.jsx)(u.N,{pagination:m,children:(0,C.jsx)(d.Z,{gutter:[16,16],className:"my-4",children:p.map((e=>(0,C.jsx)(c.Z,{xs:24,sm:24,md:12,lg:6,xl:4,children:(0,C.jsx)(N,{item:e,itemGroups:a[e.id],groupsTypeahead:s,onUpdateItemGroups:n})},e.id)))})})]})}var T=a(7128),U=a(7018),D=a(7965),R=a(3660),B=a(9197),L=a(7340);function F(e){var t;let{data:a,save:s,isDirty:n,isSaving:l,entriesToUpdate:r}=e;const{queryParams:o,addParam:d,addParams:c,is:u}=(0,x.K)();return(0,C.jsxs)(D.Pd,{children:[(0,C.jsxs)(i.Z,{vertical:!0,gap:12,children:[(0,C.jsx)(L.k,{isDirty:n,onSave:s,isSaving:l,dirt:JSON.stringify(M(r))}),(0,C.jsx)(U.o,{data:()=>{return e=a,Object.keys(e).forEach((t=>{e[t].itemsIds=(0,y.E4)((0,y.R1)(e[t].itemsIds))})),(0,y.Tj)(M(e));var e},fileName:"items-groups.json",disabled:n,block:!0})]}),(0,C.jsx)(T.Z,{}),(0,C.jsx)(S.H,{label:"Display",value:null!==(t=o.get("display"))&&void 0!==t?t:"group",onChange:e=>c({display:e,page:1},{page:1}),options:[{title:"By Groups",icon:(0,C.jsx)(R.Z,{}),value:"group"},{title:"By Items",icon:(0,C.jsx)(B.Z,{}),value:"item"}]}),u("display","item")&&(0,C.jsx)(S.Do,{label:"No Groups Only",value:u("emptyOnly"),onChange:e=>d("emptyOnly",e,!1)})]})}function M(e){return(0,j.omitBy)((0,j.cloneDeep)(e),(e=>(0,j.isEmpty)(e.itemsIds)))}var _=a(4562),H=a(8938);function K(){const e=(0,H.i)({tdrResourceName:"items-groups",firebaseDataCollectionName:"itemsGroups",serialize:!0}),t=(0,g.N)("items");return(0,C.jsx)(D.Xg,{title:"Items",subtitle:"Groups Sets",children:(0,C.jsxs)(s.Z,{hasSider:!0,children:[(0,C.jsx)(_.p,{children:(0,C.jsx)(F,{...e})}),(0,C.jsx)(s.Z.Content,{className:"content",children:(0,C.jsx)(n.T,{isLoading:e.isLoading||t.isLoading,error:e.error||t.error,hasResponseData:!(0,j.isEmpty)(e.data)&&!(0,j.isEmpty)(t.data),children:(0,C.jsx)(O,{...e})})})]})})}const Q=K}}]);
//# sourceMappingURL=ItemsGroups.1edf07bf.chunk.js.map