"use strict";(self.webpackChunktd_admin=self.webpackChunktd_admin||[]).push([[6213],{8384:(e,a,t)=>{t.d(a,{x:()=>u});var n=t(1413),r=t(4925),o=t(732),s=t(6473),i=t(9475),d=t(3733),c=t(184);const l=["open","onClose"];function u(e){let{open:a,onClose:t}=e,u=(0,r.Z)(e,l);return(0,c.jsx)(s.Z,(0,n.Z)({className:(0,d.Z)("full-screen-modal",!a&&"full-screen-modal--hidden"),bordered:!1,extra:(0,c.jsx)(i.ZP,{onClick:t,type:"text",shape:"circle",icon:(0,c.jsx)(o.Z,{})})},u))}},7340:(e,a,t)=>{t.d(a,{k:()=>p});var n=t(1413),r=t(4925),o=t(9475),s=t(2426),i=t.n(s),d=t(2791),c=t(8211),l=t(4483),u=t(4841),g=t(184);const m=["isDirty","onSave","isSaving","dirt","interval"];function p(e){let{isDirty:a,onSave:t,isSaving:s,dirt:p,interval:f=6e5}=e,v=(0,r.Z)(e,m);const{togglePendingSave:y}=(0,u.b)(),[,h,Z]=(0,c.Z)((()=>{a&&t()}),f);return(0,d.useEffect)((()=>{a?(y(!0),console.log("Save Reset",i()(Date.now()).format("MM/DD/YYYY HH:mm:ss")),Z()):(y(!1),h())}),[a,Z,h,p]),(0,d.useEffect)((()=>{const e=e=>{if(a){const a="You have unsaved changes, are you sure you want to leave?";return e.returnValue=a,a}};return window.addEventListener("beforeunload",e),()=>{window.removeEventListener("beforeunload",e)}}),[a]),(0,g.jsx)(o.ZP,(0,n.Z)((0,n.Z)({type:"primary",size:"large",icon:(0,g.jsx)(l.Z,{}),onClick:t,disabled:!a,loading:s,danger:!0,block:!0},v),{},{children:"Save"}))}},145:(e,a,t)=>{t.d(a,{f:()=>i});var n=t(2402),r=t(3733),o=t(2606),s=t(184);const i=e=>{let{id:a,width:t=200,className:i="",preview:d=!0,fileExtension:c="jpg"}=e;const{getUrl:l}=(0,o.n)("images"),u=a.replace(/-/g,"/");return(0,s.jsx)("div",{className:(0,r.Z)("image-card",i),children:(0,s.jsx)(n.Z,{width:t,src:l("".concat(u,".").concat(c)),fallback:l("back/default.jpg"),preview:d})})}},8027:(e,a,t)=>{t.d(a,{A:()=>d,X:()=>c});var n=t(1413),r=t(9631),o=t(2592),s=t(2010),i=t(5850);function d(e,a){return async()=>{var t;console.log("%cQuerying ".concat(e,"/").concat(a," from firebase: ").concat((0,i.xE)()),"color: #f0f");const n=(0,r.JU)(o.RZ,"".concat(e,"/").concat(a));return null!==(t=(await(0,r.QT)(n)).data())&&void 0!==t?t:{}}}function c(e,a,t){return(0,s.a)((0,n.Z)({queryKey:["firebase",e,a],queryFn:d(e,a)},t))}},8938:(e,a,t)=>{t.d(a,{i:()=>g});var n=t(1413),r=t(4747),o=t(763),s=t(2791),i=t(3713),d=t(5850),c=t(8027),l=t(5529),u=t(2233);function g(e){let{tdrResourceName:a,firebaseDataCollectionName:t,serialize:g}=e;const{notification:m}=r.Z.useApp(),p=(0,i.NL)(),f=(0,l.N)(a),v=(0,c.X)("tdr",t,{select:g?d.d_:void 0}),[y,h]=(0,s.useState)({}),Z=(0,u.B)("tdr",t,{onSuccess:()=>{m.success({message:"".concat(t," updated")}),p.refetchQueries({queryKey:["firebase","tdr",t]}),h({})},onError:e=>{m.error({message:"".concat(t," update failed"),description:e.message})}}),x=(0,s.useMemo)((()=>{var e,r;return f.isSuccess&&v.isSuccess&&!Z.isPending?(console.log("%cMerging ".concat(a,"+").concat(t," data..."),"color: #f0f"),(0,o.cloneDeep)((0,n.Z)((0,n.Z)((0,n.Z)({},null!==(e=f.data)&&void 0!==e?e:{}),null!==(r=v.data)&&void 0!==r?r:{}),y))):{}}),[a,t,f.data,v.data,f.isSuccess,v.isSuccess,Z.isPending,y]),j=!(0,o.isEmpty)(y),C=v.data;return{data:x,isLoading:f.isLoading||v.isLoading,error:f.error||v.error,firebaseData:C,isSaving:Z.isPending,save:()=>{Z.mutate(g?(0,d.aS)(y):y)},addEntryToUpdate:(e,a)=>{h((t=>(0,n.Z)((0,n.Z)({},t),{},{[e]:a})))},entriesToUpdate:y,isDirty:j}}},5529:(e,a,t)=>{t.d(a,{N:()=>i,Y:()=>d});var n=t(1413),r=t(763),o=t(2010),s=t(2606);function i(e){var a;let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const{getUrl:i}=(0,s.n)("resources"),d=(0,o.a)({queryKey:[e],queryFn:async()=>{const a=await fetch(i("".concat(e,".json")));return await a.json()},enabled:t}),c=!(0,r.isEmpty)(d.data);return(0,n.Z)((0,n.Z)({},d),{},{data:null!==(a=d.data)&&void 0!==a?a:{},hasResponseData:c})}function d(e){let a=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const{getUrl:t}=(0,s.n)("resources"),i=(0,o.a)({queryKey:[e],queryFn:async()=>{const a=await fetch(t("".concat(e,".json")));return await a.json()},enabled:a}),d=!(0,r.isEmpty)(i.data);return(0,n.Z)((0,n.Z)({},i),{},{data:i.data,hasResponseData:d})}},548:(e,a,t)=>{t.d(a,{P:()=>r});var n=t(4766);function r(e){var a,t;let{prefix:r="",defaultCurrent:o=1,defaultPageSize:s=10,pageSizeOptions:i=[10,20,50,100],total:d,showQuickJumper:c}=e;const{queryParams:l,addParam:u}=(0,n.K)();return{current:Number(null!==(a=l.get("".concat(r,"page")))&&void 0!==a?a:String(o)),pageSize:Number(null!==(t=l.get("".concat(r,"pageSize")))&&void 0!==t?t:String(s)),onChange:e=>{u("".concat(r,"page"),e.toString(),String(o))},onShowSizeChange:(e,a)=>{u("".concat(r,"pageSize"),a.toString(),String(s))},defaultCurrent:o,defaultPageSize:s,pageSizeOptions:i,total:d,hideOnSinglePage:!0,showQuickJumper:c}}},2233:(e,a,t)=>{t.d(a,{B:()=>d});var n=t(1413),r=t(9631),o=t(2592),s=t(8556);function i(e,a,t){console.log("%cUpdating ".concat(e,"/").concat(a," from firebase"),"color: #f00");const n=(0,r.JU)(o.RZ,"".concat(e,"/").concat(a));return(0,r.r7)(n,t)}function d(e,a){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return(0,s.D)((0,n.Z)({mutationFn:async t=>i(e,a,t)},t))}},204:(e,a,t)=>{t.r(a),t.d(a,{ImageCardsDescriptor:()=>Q,default:()=>Y});var n=t(1413),r=t(1790),o=t(2128),s=t(4766),i=t(5529),d=t(763);function c(){var e;const a=(0,i.N)("images-decks"),t=null!==(e=a.data)&&void 0!==e?e:{},r=()=>{if((0,d.isEmpty)(t))return"td-d0-00";const e=(0,d.sample)(Object.keys(t));if(!e)return"td-d0-00";const a=(0,d.random)(1,t[e]);return console.log({randomDeckNumber:e,randomCardNumber:a}),"".concat(e,"-").concat(a.toString().padStart(2,"0"))};return(0,n.Z)((0,n.Z)({},a),{},{decks:t,decksList:Object.keys(t),onRandomCard:r,onRandomUniqueCard:e=>{let a=0;for(;a<30;){const t=r();if(!e.includes(t))return t;a++}if(a>30)throw new Error("Could not find a unique card")},onRandomCards:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10;const a=[];let t=0;for(;Object.keys(a).length<e&&t<30;){const e=r();a.includes(e)?t++:a.push(e)}if(t>30&&a.length<e)throw new Error("Could not find enough unique cards");return a}})}var l=t(4520),u=t(9475),g=t(5625),m=t(145),p=t(1752),f=t(548),v=t(4925),y=t(8384),h=t(6979),Z=t(7515),x=t(906),j=t(959),C=t(7391),w=t(5850),S=t(184);const k=["imageCard","addEntryToUpdate"],b=["imageCard","addEntryToUpdate","style"],E=["imageCard","addEntryToUpdate","style"];function P(e){var a,t;let{data:n,addEntryToUpdate:r,onClose:o,onNewCard:i}=e;const{queryParams:d,removeParam:c,addParam:g}=(0,s.K)(),p=Number(null!==(a=d.get("cardSize"))&&void 0!==a?a:200),f=d.get("cardId"),v=null!==(t=n[null!==f&&void 0!==f?f:""])&&void 0!==t?t:{id:f,keywords:[]};return(0,S.jsx)(y.x,{title:"Image Card Descriptor for ".concat(f),open:!!f,onClose:()=>c("cardId"),cover:(0,S.jsx)(l.Z,{justify:"center",align:"center",style:{width:"100vw"},children:(0,S.jsx)(m.f,{id:null!==f&&void 0!==f?f:"",width:p})}),actions:[(0,S.jsx)(u.ZP,{className:"my-10",onClick:o,children:"Close"},"cancel"),(0,S.jsx)(u.ZP,{className:"my-10",onClick:i,children:"New Card"},"cancel")],children:(0,S.jsxs)(l.Z,{gap:8,vertical:!0,style:{maxWidth:"500px"},children:[(0,S.jsx)(h.Z,{value:p,min:100,max:500,step:25,style:{maxWidth:500,width:"100%"},onChange:e=>g("cardSize",e,200)}),(0,S.jsx)(N,{imageCard:v,addEntryToUpdate:r,size:"large"}),(0,S.jsx)(D,{imageCard:v,addEntryToUpdate:r,size:"large"}),(0,S.jsx)(U,{imageCard:v,addEntryToUpdate:r,size:"large"})]},f)})}function N(e){let{imageCard:a,addEntryToUpdate:t}=e,r=(0,v.Z)(e,k);const o=a.favorite;return(0,S.jsx)(u.ZP,(0,n.Z)({shape:"circle",icon:o?(0,S.jsx)(j.Z,{style:{color:"red"}}):(0,S.jsx)(C.Z,{}),type:"text",onClick:()=>t(a.id,(0,n.Z)((0,n.Z)({},a),{},{favorite:!o}))},r))}function D(e){let{imageCard:a,addEntryToUpdate:t,style:r}=e,o=(0,v.Z)(e,b);return(0,S.jsx)(Z.Z.Search,(0,n.Z)({defaultValue:a.keywords.join(" "),onSearch:e=>{return r=e,void t(a.id,(0,n.Z)((0,n.Z)({},a),{},{keywords:(0,w.R1)(r.toLocaleLowerCase().split(/, |,| /).filter(Boolean).map((e=>e.trim())).sort())}));var r},style:(0,n.Z)({maxWidth:500,width:"100%"},r),enterButton:"Update"},o))}function U(e){let{imageCard:a,addEntryToUpdate:t,style:r}=e,o=(0,v.Z)(e,E);return(0,S.jsx)(x.Z,(0,n.Z)({mode:"multiple",allowClear:!0,style:(0,n.Z)({width:"100%"},r),placeholder:"Please select",defaultValue:null===a||void 0===a?void 0:a.triggers,onChange:e=>{t(a.id,(0,n.Z)((0,n.Z)({},a),{},{triggers:e}))},options:[{label:"aliens",value:"aliens"},{label:"insets",value:"insets"},{label:"snakes",value:"snakes"},{label:"spiders",value:"spiders"},{label:"scarry",value:"scarry"}]},o))}function T(e){let{data:a,addEntryToUpdate:t}=e;const{addParam:n}=(0,s.K)(),r=[{title:"CardId",dataIndex:"id",key:"id",sorter:(e,a)=>Number(e.id)-Number(a.id)},{title:"Image",dataIndex:"id",key:"image",render:e=>(0,S.jsx)(m.f,{id:e,width:50})},{title:"Keywords",dataIndex:"keywords",key:"keywords",render:e=>null===e||void 0===e?void 0:e.join(", ")},{title:"Triggers",dataIndex:"triggers",key:"triggers",render:e=>null===e||void 0===e?void 0:e.join(", ")},{title:"Actions",key:"actions",render:(e,a)=>(0,S.jsxs)(l.Z,{children:[(0,S.jsx)(N,{imageCard:a,addEntryToUpdate:t}),(0,S.jsx)(u.ZP,{icon:(0,S.jsx)(p.Z,{}),onClick:()=>n("cardId",a.id),children:"Edit"})]})}],o=Object.values(a),i=(0,f.P)({total:o.length,showQuickJumper:!0});return(0,S.jsx)(g.Z,{dataSource:o,columns:r,rowKey:"id",pagination:i})}function R(e){var a;const t=c(),r=(0,i.N)("images-credo"),{addParam:d,removeParam:l}=(0,s.K)();return(0,S.jsxs)(o.T,{isLoading:t.isLoading||r.isLoading,hasResponseData:t.hasResponseData||r.hasResponseData,error:null!==(a=r.error)&&void 0!==a?a:t.error,children:[(0,S.jsx)(T,(0,n.Z)({},e)),(0,S.jsx)(P,(0,n.Z)((0,n.Z)({},e),{},{onNewCard:()=>d("cardId",t.onRandomCard()),onClose:()=>l("cardId")}))]})}var z=t(7128),I=t(7018),L=t(7340),q=t(7965);function K(e){let{data:a,save:t,isDirty:n,isSaving:r,entriesToUpdate:o}=e;const{addParam:i}=(0,s.K)(),{onRandomCard:g}=c();return(0,S.jsxs)(q.Pd,{children:[(0,S.jsxs)(l.Z,{vertical:!0,gap:12,children:[(0,S.jsx)(L.k,{isDirty:n,onSave:t,isSaving:r,dirt:JSON.stringify(o)}),(0,S.jsx)(I.o,{data:()=>function(e){console.log("Preparing file for download...");const a=(0,d.cloneDeep)(e);return(0,w.Tj)(a)}(a),fileName:"image-cards.json",disabled:n,block:!0})]}),(0,S.jsx)(z.Z,{}),(0,S.jsx)(u.ZP,{onClick:()=>i("cardId",g()),block:!0,children:"Random Card"}),(0,S.jsx)(z.Z,{})]})}var O=t(4562),J=t(8938);function Q(){const e=(0,J.i)({tdrResourceName:"image-cards",firebaseDataCollectionName:"imageCards",serialize:!0});return(0,S.jsx)(q.Xg,{title:"Image Cards Descriptor",subtitle:"Teenage Student Cards",children:(0,S.jsxs)(r.Z,{hasSider:!0,children:[(0,S.jsx)(O.p,{children:(0,S.jsx)(K,(0,n.Z)({},e))}),(0,S.jsx)(r.Z.Content,{className:"content",children:(0,S.jsx)(o.T,{isLoading:e.isLoading,error:e.error,hasResponseData:!(0,d.isEmpty)(e.data),children:(0,S.jsx)(R,(0,n.Z)({},e))})})]})})}const Y=Q}}]);
//# sourceMappingURL=ImageCardsDescriptor.ebd39df6.chunk.js.map