"use strict";(self.webpackChunktd_admin=self.webpackChunktd_admin||[]).push([[7286],{7018:(e,t,s)=>{s.d(t,{o:()=>c});var a=s(1413),n=s(4925),l=s(424),r=s(5850),i=s(184);const o=["data","fileName","loading","children"];function c(e){let{data:t,fileName:s,loading:c,children:d}=e,h=(0,n.Z)(e,o);return(0,i.jsx)(l.ZP,(0,a.Z)((0,a.Z)({onClick:()=>(0,r.ZN)("function"===typeof t?t():t,s),loading:c},h),{},{children:null!==d&&void 0!==d?d:"Download JSON"}))}},2043:(e,t,s)=>{s.d(t,{Do:()=>p,H:()=>v,tj:()=>g,xh:()=>u,zE:()=>h});var a=s(4790),n=s(906),l=s(9793),r=s(5922),i=s(9862),o=s(4248),c=s(1431),d=s(184);function h(e){let{label:t,value:s,onChange:l,options:r,placeholder:i}=e;return(0,d.jsx)(a.Z.Item,{label:t,children:(0,d.jsxs)(n.Z,{style:{minWidth:"150px"},onChange:l,value:s,children:[i&&(0,d.jsx)(n.Z.Option,{value:"",disabled:!0,children:"placeholder"}),r.map((e=>"object"===typeof e?(0,d.jsx)(n.Z.Option,{value:e.value,children:e.label},"".concat(t,"-").concat(e.value)):(0,d.jsx)(n.Z.Option,{value:e,children:e},"".concat(t,"-").concat(e))))]})})}function u(e){let{label:t,value:s,onChange:n,min:r=0,max:i=100,step:o}=e;return(0,d.jsx)(a.Z.Item,{label:t,children:(0,d.jsx)(l.Z,{min:r,max:i,value:s,onChange:e=>n(null!==e&&void 0!==e?e:i),style:{minWidth:"150px",width:"100%"},step:o})})}function p(e){let{label:t,value:s,onChange:n,className:l,disabled:i}=e;return(0,d.jsx)(a.Z.Item,{label:t,valuePropName:"checked",className:l,children:(0,d.jsx)(r.Z,{checked:s,onChange:n,size:"small",disabled:i})})}function g(e){let{label:t,value:s,onChange:n,disabled:l,className:r}=e;return(0,d.jsx)(a.Z.Item,{label:t,valuePropName:"checked",className:r,children:(0,d.jsx)(i.Z,{checked:s,onChange:e=>n(e.target.checked),disabled:l})})}function v(e){let{value:t,label:s,onChange:n,options:l}=e;return(0,d.jsx)(a.Z.Item,{label:s,layout:l.length>2?"vertical":"horizontal",children:(0,d.jsx)(o.Z,{block:!0,value:t,onChange:n,options:l.map((e=>({label:(0,d.jsx)(c.Z,{arrow:!0,trigger:"hover",title:e.title,children:e.icon}),value:e.value})))})})}},8866:(e,t,s)=>{s.d(t,{N:()=>o});var a=s(1413),n=s(4925),l=s(6178),r=s(184);const i=["children","level"];function o(e){let{children:t,level:s}=e,o=(0,n.Z)(e,i);return(0,r.jsx)(l.Z.Title,(0,a.Z)((0,a.Z)({level:null!==s&&void 0!==s?s:3},o),{},{children:t}))}},8357:(e,t,s)=>{s.d(t,{tj:()=>c.tj,xh:()=>c.xh,H:()=>c.H,zE:()=>c.zE,Do:()=>c.Do,Th:()=>g,F6:()=>o});s(8866);var a=s(1413),n=s(4925),l=s(3733),r=s(184);const i=["children","active","activeClass","className","hoverType"],o=e=>{let{children:t,active:s=!1,activeClass:o="",className:c="",hoverType:d="scale"}=e,h=(0,n.Z)(e,i);return(0,r.jsx)("button",(0,a.Z)((0,a.Z)({className:(0,l.Z)("transparent-button","transparent-button--".concat(d),s&&(o||"transparent-button--active"),c)},h),{},{children:t}))};var c=s(2043),d=s(952),h=s(4790),u=s(7965);function p(e){let{isLoading:t,isIdle:s,error:a,isDirty:n,isError:l,hasResponseData:i}=e;return s?(0,r.jsx)(d.Z,{children:"No Data yet"}):t?(0,r.jsx)(d.Z,{color:"blue",children:"Loading..."}):a||l?(0,r.jsx)(d.Z,{color:"red",children:"Error"}):n?(0,r.jsx)(d.Z,{color:"orange",children:"Modified"}):i?(0,r.jsx)(d.Z,{color:"green",children:"Loaded"}):(0,r.jsx)(d.Z,{children:"No Data"})}function g(e){return(0,r.jsx)(u.Pd,{children:(0,r.jsx)(h.Z.Item,{label:"Status",children:(0,r.jsx)(p,(0,a.Z)({},e))})})}},145:(e,t,s)=>{s.d(t,{f:()=>i});var a=s(2402),n=s(3733),l=s(2606),r=s(184);const i=e=>{let{id:t,width:s=200,className:i="",preview:o=!0,fileExtension:c="jpg"}=e;const{getUrl:d}=(0,l.n)("images"),h=t.replace(/-/g,"/");return(0,r.jsx)("div",{className:(0,n.Z)("image-card",i),children:(0,r.jsx)(a.Z,{width:s,src:d("".concat(h,".").concat(c)),fallback:d("back/default.jpg"),preview:o})})}},7166:(e,t,s)=>{s.d(t,{P:()=>i,l:()=>o});var a=s(2791),n=s(2671),l=s(184);const r=(0,a.createContext)({}),i=e=>{let{children:t}=e;const s=(0,n.AZ)(),[i,o]=(0,a.useState)(15),[c,d]=(0,a.useState)(5),[h,u]=(0,a.useState)(150),[p,g]=(0,a.useState)(!1),v=(0,n.IN)(s.data,s.setDirty,i,c);return(0,l.jsx)(r.Provider,{value:{sampleSize:i,setSampleSize:o,tagThreshold:c,setTagThreshold:d,cardSize:h,setCardSize:u,showIds:p,setShowIds:g,randomGroups:v,query:s},children:t})},o=()=>(0,a.useContext)(r)},9936:(e,t,s)=>{s.d(t,{A:()=>o});var a=s(8622),n=s(4790),l=s(7861),r=s(7166),i=s(184);function o(){const{query:{stats:e}}=(0,r.l)();return(0,i.jsx)(n.Z.Item,{label:(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(l.Z,{icon:(0,i.jsx)(a.Z,{}),shape:"square",size:"small",style:{marginRight:6}}),"Stats"]}),children:(0,i.jsxs)("ul",{className:"statistic__list",children:[(0,i.jsxs)("li",{children:["Completion: ",Math.floor(100*e.total/2520),"%"]}),(0,i.jsxs)("li",{children:["Total Relationships: ",e.total]}),(0,i.jsxs)("li",{children:["Complete: ",e.complete]}),(0,i.jsxs)("li",{children:["Overdone: ",e.overdone]}),(0,i.jsxs)("li",{children:["Single Match: ",e.single]})]})})}},2671:(e,t,s)=>{s.d(t,{AZ:()=>m,gU:()=>v,IN:()=>x});var a=s(4607),n=s(9631),l=s(763),r=s(2791),i=s(6314),o=s(5850),c=s(3713),d=s(2010),h=s(8556),u=s(4766);const p=()=>(0,l.padStart)(String((0,l.random)(1,252)),2,"0"),g=()=>(0,l.random)(1,12);function v(e,t){var s,a,n;const[l,i]=(0,r.useState)(g()),[c,d]=(0,r.useState)(p()),[h,v]=(0,r.useState)(g()),[m,x]=(0,r.useState)(p()),j="td-d".concat(l,"-").concat(c),f="td-d".concat(h,"-").concat(m),[Z,S]=(0,r.useState)(0),{queryParams:y}=(0,u.K)(),b=Number(null!==(s=y.get("cycle"))&&void 0!==s?s:3),C=null!==(a=null===e||void 0===e?void 0:e[j])&&void 0!==a?a:[],I=null!==(n=null===e||void 0===e?void 0:e[f])&&void 0!==n?n:[],N=()=>{S(0),i(g()),d(p()),v(g()),x(p())};return(0,r.useEffect)((()=>{j===f&&x(p())}),[j,f]),{cardAId:j,cardA:C,cardBId:f,cardB:I,relate:()=>{S(0),C.push(f),e[j]=(0,o.R1)(C),I.push(j),e[f]=(0,o.R1)(I),t(!0),i(h),d(m),v(g()),x(p())},unrelate:()=>{Z>=b?(S(0),N()):(S((e=>e+1)),v(g()),x(p()))},areRelated:C.includes(f),onRandomCards:N}}function m(){const[e,t]=(0,r.useState)(!1),s=["data/imageCardsRelationships"],l=(0,c.NL)(),{notification:o}=a.Z.useApp(),[u,p]=(0,r.useState)({total:0,overdone:0,complete:0,single:0}),{data:g={},isLoading:v,isSuccess:m,isError:x,error:j,isFetched:f,isRefetching:Z,refetch:S}=(0,d.a)({queryKey:s,queryFn:async()=>{var e;const t=(0,n.JU)(i.RZ,"data/imageCardsRelationships");return null!==(e=(await(0,n.QT)(t)).data())&&void 0!==e?e:{}}}),{isPending:y,isError:b,isSuccess:C,mutate:I}=(0,h.D)({mutationKey:s,mutationFn:async()=>{const e=(0,n.JU)(i.RZ,"data/imageCardsRelationships");return await(0,n.pl)(e,g),g},onSuccess:()=>{o.success({message:"Saved",placement:"bottomLeft"}),l.refetchQueries({queryKey:s}),t(!1)}});return(0,r.useEffect)((()=>{if(!Z&&f){const e=Object.keys(g).length;let t=0,s=0,a=0;Object.values(g).forEach((e=>{e.length>8&&(t+=1),1===e.length&&(a+=1),e.length>2&&(s+=1)})),p({total:e,overdone:t,complete:s,single:a})}}),[f,Z]),{data:g,isLoading:v,isSuccess:m,isError:x,error:j,hasData:m&&Object.keys(g).length>0,refetch:S,isSaving:y,isMutationError:b,isSaved:C,save:I,setDirty:t,isDirty:e,stats:u}}function x(e,t,s,a){const[n,l]=(0,r.useState)([]),[i,c]=(0,r.useState)([]),[d,h]=(0,r.useState)([]),[u,v]=(0,r.useState)(0),[m,x]=(0,r.useState)(!0),[j,f]=(0,r.useState)([]),Z=t=>{c((null!==t&&void 0!==t?t:n).map((t=>{var s;return null!==(s=null===e||void 0===e?void 0:e[t])&&void 0!==s?s:[]})))},S=()=>{const t=[...j];let n=0;const r=d.length<2e3?d:[];let i=0;for(;i<400&&t.length<s;){var o;const s="td-d".concat(g(),"-").concat(p()),l=null!==(o=e[s])&&void 0!==o?o:[],c=!(a>0)||l.length<a,d=!!m&&r.includes(s);t.includes(s)||d||!c||(t.push(s),n+=1),i+=1}l(t),h((e=>[...e,...t])),Z(t),v((e=>e+n))};(0,r.useEffect)((()=>{0===n.length&&S()}),[n]);return{cardIds:n,cards:i,selection:j,onSelect:e=>{f((t=>{const s=[...t],a=s.indexOf(e);return a>-1?s.splice(a,1):s.push(e),s}))},relate:()=>{j.forEach((t=>{var s;const a=null!==(s=e[t])&&void 0!==s?s:[];a.push(...j.filter((e=>e!==t))),e[t]=(0,o.R1)(a)})),t(!0),f([]),Z(),h([]),v(0)},nextSet:S,deselectAll:()=>{f([])},cycles:u,filters:{useCycles:m,toggleUseCycles:()=>{x((e=>!e))}}}}},6411:(e,t,s)=>{s.r(t),s.d(t,{default:()=>k});var a=s(1790),n=s(4925),l=s(2402),r=s(4520),i=s(1046),o=s(952),c=s(5240),d=s(2128),h=s(763),u=s(2791),p=s(7415),g=s(7507),v=s(145),m=s(7166),x=s(184);const j=["isDirty","isSaving","save","stats","data"];function f(){const e=(0,m.l)(),{query:{isDirty:t,isSaving:s,save:a,stats:f,data:S},randomGroups:{cardIds:y},showIds:b,cardSize:C}=e,I=(0,n.Z)(e.query,j),[N,{width:w}]=(0,p.Z)(),[,k]=(0,u.useMemo)((()=>{const e=Math.floor(w/C)+1;return[e,Math.floor(w/e)]}),[C,w]),E=[{title:"Length",dataIndex:"length",key:"length"},{title:"Relationships",dataIndex:"relationships",key:"relationship",render:(e,t)=>(0,x.jsx)(l.Z.PreviewGroup,{children:(0,x.jsx)(r.Z,{wrap:"wrap",gap:2,children:e.map((s=>(0,x.jsxs)(i.Z,{children:[(0,x.jsxs)(i.Z,{direction:"vertical",children:[(0,x.jsx)(v.f,{id:s,width:k}),b&&(0,x.jsx)(o.Z,{children:s})]}),e[e.length-1]!==s&&(0,x.jsx)(g.Z,{})]},"".concat(t.origin,"-").concat(s))))})})}],z=(0,u.useMemo)((()=>(0,h.orderBy)(y.map((e=>{const t=Z(e,S,"longest",10);return{key:e,origin:e,length:t.length,relationships:t}})),["length"],["desc"])),[y,S]);return(0,x.jsx)(d.T,{isLoading:I.isLoading,error:I.error,hasResponseData:!0,children:(0,x.jsx)("div",{ref:N,className:"my-6",children:(0,x.jsx)(c.Z,{dataSource:z,columns:E})})})}const Z=(0,h.memoize)(((e,t,s,a)=>{const n=new Set,l=[];let r=[],i=0;for(l.push({currentId:e,path:[],depth:0});l.length>0&&i<100;){var o;i++;const{currentId:e,path:c,depth:d}=null!==(o=l.pop())&&void 0!==o?o:{currentId:"",path:[],depth:0};if(n.add(e),c.push(e),"longest"===s&&c.length>r.length&&(r=[...c]),"shortest"===s&&(0===r.length||c.length<r.length)&&(r=[...c]),"any"===s&&0===r.length&&(r=[...c]),!(d>=a))for(const s of t[e]||[])n.has(s)||l.push({currentId:s,path:[...c],depth:d+1})}return r}));var S=s(424),y=s(8357),b=s(7018),C=s(7965),I=s(6591),N=s(9936);function w(){const{query:{isDirty:e,isSaving:t,data:s,isLoading:a,isError:n},showIds:l,setShowIds:r,sampleSize:i,setSampleSize:o,cardSize:c,setCardSize:d,randomGroups:{nextSet:u}}=(0,m.l)();return(0,x.jsxs)(C.p3,{children:[(0,x.jsx)(y.Th,{isLoading:a||t,isDirty:e,isError:n,hasResponseData:!(0,h.isEmpty)(s)}),(0,x.jsxs)(C.Pd,{children:[(0,x.jsx)(y.Do,{label:"Show Ids",value:l,onChange:e=>r(e)}),(0,x.jsx)(y.zE,{onChange:e=>o(e),value:i,options:I.ZI,label:"Sample Size"}),(0,x.jsx)(y.zE,{onChange:e=>d(e),value:c,options:I.Hn,label:"Card Size"}),(0,x.jsx)(S.ZP,{onClick:u,block:!0,type:"primary",children:"New Random Sample"})]}),(0,x.jsx)(C.Pd,{children:(0,x.jsx)(N.A,{})}),(0,x.jsx)(C.Pd,{children:(0,x.jsx)(b.o,{data:s,fileName:"imageCardsRelationships.json",loading:t,disabled:(0,h.isEmpty)(s),block:!0})})]})}const k=function(){return(0,x.jsx)(C.Xg,{title:"Image Cards",subtitle:"Connections",children:(0,x.jsx)(m.P,{children:(0,x.jsxs)(a.Z,{hasSider:!0,children:[(0,x.jsx)(w,{}),(0,x.jsx)(a.Z.Content,{className:"content",children:(0,x.jsx)(f,{})})]})})})}}}]);
//# sourceMappingURL=ImageCardsConnections.6422d176.chunk.js.map