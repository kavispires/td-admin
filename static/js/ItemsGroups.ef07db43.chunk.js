"use strict";(self.webpackChunktd_admin=self.webpackChunktd_admin||[]).push([[1187],{4850:(e,t,s)=>{s.d(t,{A:()=>l});var i=s(1046),a=s(2556),n=s(7134),r=s(184);function l(e){let{ids:t}=e;const s=(0,n._)();return(0,r.jsx)(i.Z,{direction:"vertical",size:"small",children:(0,r.jsx)(a.ZP,{size:"small",onClick:()=>s(JSON.stringify(t)),children:"Copy Ids"})})}},8158:(e,t,s)=>{s.d(t,{CQ:()=>h,bN:()=>p,cw:()=>x,hW:()=>g,xL:()=>m});var i=s(1105),a=s(2556),n=s(1310),r=s(2997),l=s(8955),o=s(5458),d=s(1087),c=s(7134),u=s(184);function m(e){let{item:t,width:s,className:i}=e;return(0,u.jsx)(r.ck,{id:t.id,width:s,title:"".concat(t.name.en," | ").concat(t.name.pt),className:i})}function p(e){let{item:t}=e;const s=(0,c._)();return(0,u.jsx)("span",{children:(0,u.jsx)(i.Z,{prefix:t.nsfw?(0,u.jsx)(l.Z,{style:{color:"hotPink"}}):(0,u.jsx)(o.Z,{}),placeholder:"Id",variant:"borderless",size:"small",value:t.id,readOnly:!0,style:{width:"8ch"},onClick:()=>s(t.id)})})}function h(e){let{item:t,language:s}=e;return(0,u.jsx)(i.Z,{prefix:(0,u.jsx)(n.H,{language:s,width:"1em"}),placeholder:"Name in ".concat(s.toUpperCase()),variant:"borderless",size:"small",value:t.name[s],readOnly:!0})}function g(e){let{item:t}=e;return t.nsfw?(0,u.jsx)(l.Z,{style:{color:"hotpink"}}):(0,u.jsx)(u.Fragment,{})}function x(e){let{item:t}=e;const[,s]=(0,d.lr)();return(0,u.jsx)("span",{children:(0,u.jsx)(a.ZP,{size:"small",shape:"round",onClick:()=>{s({itemId:t.id,view:"classifier"})},children:"Go to"})})}},548:(e,t,s)=>{s.d(t,{P:()=>a});var i=s(4766);function a(e){var t,s;let{prefix:a="",defaultCurrent:n=1,defaultPageSize:r=10,pageSizeOptions:l=[10,20,50,100],total:o,showQuickJumper:d}=e;const{queryParams:c,addParam:u}=(0,i.K)();return{current:Number(null!==(t=c.get("".concat(a,"page")))&&void 0!==t?t:String(n)),pageSize:Number(null!==(s=c.get("".concat(a,"pageSize")))&&void 0!==s?s:String(r)),onChange:e=>{u("".concat(a,"page"),e.toString(),String(n))},onShowSizeChange:(e,t)=>{u("".concat(a,"pageSize"),t.toString(),String(r))},defaultCurrent:n,defaultPageSize:r,pageSizeOptions:l,total:o,hideOnSinglePage:!0,showQuickJumper:d}}},8440:(e,t,s)=>{s.r(t),s.d(t,{ItemsGroups:()=>K,default:()=>A});var i=s(3990),a=s(2128),n=s(4520),r=s(4031),l=s(122),o=s(3320),d=s(6106),c=s(914),u=s(2228),m=s(2997),p=s(7134),h=s(4290),g=s(4766),x=s(5529),j=s(763),y=s(2791),v=s(5850),I=s(1674),f=s(1046),S=s(7765),Z=s(8158),k=s(184);function b(e){let{item:t,itemGroups:s,groupsTypeahead:i,onUpdateItemGroups:a}=e;const n=(0,p._)();return(0,k.jsxs)(I.Z,{title:(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(r.Z.Text,{onClick:()=>n(t.id),children:t.id}),(0,k.jsx)(Z.hW,{item:t})]}),style:{maxWidth:250},children:[(0,k.jsx)(Z.xL,{item:t,width:75}),(0,k.jsxs)(f.Z,{size:"small",direction:"vertical",className:"my-4",children:[(0,k.jsx)(Z.CQ,{item:t,language:"en"}),(0,k.jsx)(Z.CQ,{item:t,language:"pt"}),(0,k.jsx)(S.Z,{mode:"tags",style:{width:"100%"},placeholder:"Select a group",defaultValue:s,options:i,showSearch:!0,size:"small",onChange:e=>a(t.id,e)},String(s))]})]})}var w=s(548),C=s(6173),G=s(8178),N=s(4850);function O(e){let{data:t,addEntryToUpdate:s}=e;const{is:i,queryParams:a}=(0,g.K)(),n=(0,x.N)("items"),r=(0,y.useMemo)((()=>Object.values(null!==t&&void 0!==t?t:[]).reduce(((e,t)=>(t.itemsIds||console.warn("Group without items",t),t.itemsIds.forEach((s=>{e[s]||(e[s]=[]),e[s].push(t.id)})),e)),{})),[t]),l=(0,y.useMemo)((()=>(0,j.orderBy)(Object.keys(t).map((e=>({label:e,value:e}))),"label")),[t]),o=(e,i)=>{var a;const n=null!==(a=r[e])&&void 0!==a?a:[],l=i.filter((e=>!n.includes(e))),o=n.filter((e=>!i.includes(e)));l.forEach((i=>{var a,n;s(i,{id:i,itemsIds:(0,v.R1)([...null!==(a=null===(n=t[i])||void 0===n?void 0:n.itemsIds)&&void 0!==a?a:[],e])})})),o.forEach((i=>{var a;s(i,{id:i,itemsIds:(0,v.R1)(null===(a=t[i])||void 0===a?void 0:a.itemsIds.filter((t=>t!==e)))})}))},d=(e,t)=>{s(e,{id:e,itemsIds:(0,v.R1)(t)})};return(0,k.jsxs)(k.Fragment,{children:[(i("display","group")||!a.has("display"))&&(0,k.jsx)(z,{data:t,items:n.data,grousByItem:r,groupsTypeahead:l,onUpdateItemGroups:o,onUpdateGroupItems:d}),i("display","item")&&(0,k.jsx)(U,{data:t,items:n.data,grousByItem:r,groupsTypeahead:l,onUpdateItemGroups:o,onUpdateGroupItems:d})]})}function z(e){let{data:t,items:s,grousByItem:i,groupsTypeahead:a,onUpdateItemGroups:d,onUpdateGroupItems:c}=e;const u=(0,p._)(),h=(0,x.N)("items"),[g,j]=(0,y.useState)(null),I=(0,w.P)({showQuickJumper:!0,total:Object.keys(t).length}),f=[{title:"id",dataIndex:"id",key:"id",render:e=>(0,k.jsx)("span",{children:e})},{title:"Items",dataIndex:"itemsIds",key:"itemsIds",render:(e,t)=>(0,k.jsx)(n.Z,{gap:6,wrap:"wrap",children:e.map((e=>(0,k.jsxs)(n.Z,{gap:2,vertical:!0,children:[(0,k.jsx)(C.F6,{onClick:()=>j(e),children:(0,k.jsx)(m.ck,{id:e,width:60})}),(0,k.jsx)(n.Z,{justify:"center",children:(0,k.jsx)(r.Z.Text,{onClick:()=>u(e),children:e})})]},"".concat(t.id,"-").concat(e))))},"items-".concat(t.id))},l.Z.EXPAND_COLUMN,{title:"Count",dataIndex:"itemsIds",key:"count",render:e=>(0,v.R1)(e).filter(Boolean).length},{title:"Actions",dataIndex:"itemsIds",key:"actions",render:e=>(0,k.jsx)(N.A,{ids:e})}],S=g?s[g]:null;return(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(l.Z,{columns:f,dataSource:Object.values(t),className:"my-4",rowKey:"id",pagination:I,expandable:{expandedRowRender:e=>(0,k.jsx)(P,{group:e,onUpdateGroupItems:c}),rowExpandable:()=>h.isSuccess}}),(0,k.jsx)(o.Z,{title:"Edit Item Group",onClose:()=>j(null),open:!!S,children:S&&(0,k.jsx)(b,{item:S,itemGroups:i[S.id],groupsTypeahead:a,onUpdateItemGroups:d})})]})}function P(e){let{group:t,onUpdateGroupItems:s}=e;return(0,k.jsx)("div",{children:(0,k.jsx)(G.i,{onFinish:e=>{s(t.id,[...t.itemsIds,e])}})})}function U(e){let{items:t,grousByItem:s,groupsTypeahead:i,onUpdateItemGroups:a}=e;const{is:n}=(0,g.K)(),l=n("emptyOnly"),o=(0,y.useMemo)((()=>l?Object.values(t).filter((e=>!s[e.id])):Object.values(t)),[t,s,l]),{page:m,pagination:p}=(0,h.e)({data:o});return(0,k.jsxs)(k.Fragment,{children:[(0,k.jsxs)(r.Z.Title,{level:2,children:["Groups by Items (",o.length,")"]}),(0,k.jsx)(u.N,{pagination:p,children:(0,k.jsx)(d.Z,{gutter:[16,16],className:"my-4",children:m.map((e=>(0,k.jsx)(c.Z,{xs:24,sm:24,md:12,lg:6,xl:4,children:(0,k.jsx)(b,{item:e,itemGroups:s[e.id],groupsTypeahead:i,onUpdateItemGroups:a})},e.id)))})})]})}var T=s(7128),E=s(7018),B=s(1958),R=s(3660),D=s(9197),F=s(7340);function _(e){var t;let{data:s,save:i,isDirty:a,isSaving:r,entriesToUpdate:l}=e;const{queryParams:o,addParam:d,addParams:c,is:u}=(0,g.K)();return(0,k.jsxs)(B.Pd,{children:[(0,k.jsxs)(n.Z,{vertical:!0,gap:12,children:[(0,k.jsx)(F.k,{isDirty:a,onSave:i,isSaving:r,dirt:JSON.stringify(L(l))}),(0,k.jsx)(E.o,{data:()=>{return e=s,Object.keys(e).forEach((t=>{e[t].itemsIds=(0,v.E4)((0,v.R1)(e[t].itemsIds))})),(0,v.Tj)(L(e));var e},fileName:"items-groups.json",disabled:a,block:!0})]}),(0,k.jsx)(T.Z,{}),(0,k.jsx)(C.H,{label:"Display",value:null!==(t=o.get("display"))&&void 0!==t?t:"group",onChange:e=>c({display:e,page:1},{page:1}),options:[{title:"By Groups",icon:(0,k.jsx)(R.Z,{}),value:"group"},{title:"By Items",icon:(0,k.jsx)(D.Z,{}),value:"item"}]}),u("display","item")&&(0,k.jsx)(C.Do,{label:"No Groups Only",value:u("emptyOnly"),onChange:e=>d("emptyOnly",e,!1)})]})}function L(e){return(0,j.omitBy)((0,j.cloneDeep)(e),(e=>(0,j.isEmpty)(e.itemsIds)))}var Q=s(4562),J=s(8938);function K(){const e=(0,J.i)({tdrResourceName:"items-groups",firebaseDataCollectionName:"itemsGroups",serialize:!0}),t=(0,x.N)("items");return(0,k.jsx)(B.Xg,{title:"Items",subtitle:"Groups Sets",children:(0,k.jsxs)(i.Z,{hasSider:!0,children:[(0,k.jsx)(Q.p,{children:(0,k.jsx)(_,{...e})}),(0,k.jsx)(i.Z.Content,{className:"content",children:(0,k.jsx)(a.T,{isLoading:e.isLoading||t.isLoading,error:e.error||t.error,hasResponseData:!(0,j.isEmpty)(e.data)&&!(0,j.isEmpty)(t.data),children:(0,k.jsx)(O,{...e})})})]})})}const A=K}}]);
//# sourceMappingURL=ItemsGroups.ef07db43.chunk.js.map