"use strict";(self.webpackChunktd_admin=self.webpackChunktd_admin||[]).push([[5829],{5597:(e,t,a)=>{a.d(t,{FX:()=>u,Pm:()=>d});var n=a(4520),l=a(4766),i=a(763),s=a(2791),r=a(2043),o=a(184);function c(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];const a=Object.keys(Object.values(e).reduce(((e,a)=>(Object.keys(a).forEach((a=>{e[a]||t.includes(a)||(e[a]=!0)})),e)),{})),n=[],l=[];return a.forEach((t=>{const a=Object.values(e).map((e=>e[t])),i=Array.from(new Set(a)),s=i.length/a.length;s>=.05&&n.push(t),s<=.9&&l.push({label:t,options:[{label:"All",value:""},...i.sort().map((e=>({label:String(e),value:e})))]})})),{filters:l,sortableKeys:n}}function d(e){var t,a;let{data:d,ignoreKeys:u=[]}=e;const{queryParams:v,addParam:g}=(0,l.K)(),x=(0,s.useMemo)((()=>c(d,u)),[d,u]);return(0,o.jsxs)(n.Z,{vertical:!0,style:{overflowY:"auto"},children:[x.filters.map((e=>{var t;return(0,o.jsx)(r.zE,{label:(0,i.capitalize)(e.label),options:e.options,onChange:t=>g(e.label.toLowerCase(),t),value:null!==(t=v.get(e.label.toLowerCase()))&&void 0!==t?t:""},e.label)})),(0,o.jsx)(r.zE,{label:"Sort by",options:x.sortableKeys.map((e=>({label:(0,i.capitalize)(e),value:e}))),onChange:e=>g("sort",e),value:null!==(t=v.get("sort"))&&void 0!==t?t:""}),(0,o.jsx)(r.zE,{label:"Order",options:[{label:"Ascending",value:"asc"},{label:"Descending",value:"desc"}],onChange:e=>g("order",e),value:null!==(a=v.get("order"))&&void 0!==a?a:"asc"})]})}function u(e){var t;const{queryParams:a}=(0,l.K)(),n=(0,s.useMemo)((()=>c(e)),[e]),r=(0,s.useMemo)((()=>Array.from(a.entries()).filter((e=>{let[t]=e;return n.filters.some((e=>e.label.toLowerCase()===t))})).reduce(((e,t)=>{let[a,n]=t;return e[a]=n,e}),{})),[a,n]),o=null!==(t=a.get("sort"))&&void 0!==t?t:"id",d="desc"===a.get("order")?"desc":"asc";return(0,s.useMemo)((()=>{const t=Object.values(e).filter((e=>Object.entries(r).every((t=>{let[a,n]=t;return String(e[a])===n}))));return(0,i.orderBy)(t,o,d)}),[e,r,o,d])}},6095:(e,t,a)=>{a.d(t,{N:()=>c});var n=a(1413),l=a(4925),i=a(2658),s=a(1046),r=a(184);const o=["children","pagination"];function c(e){let{children:t,pagination:a}=e,c=(0,l.Z)(e,o);const d=(0,r.jsx)(i.Z,(0,n.Z)((0,n.Z)({showQuickJumper:!0},a),{},{className:"fixed-pagination"}));return(0,r.jsxs)(s.Z,(0,n.Z)((0,n.Z)({direction:"vertical"},c),{},{children:[d,t,d]}))}},7340:(e,t,a)=>{a.d(t,{k:()=>x});var n=a(1413),l=a(4925),i=a(9475),s=a(2426),r=a.n(s),o=a(2791),c=a(8211),d=a(4483),u=a(4841),v=a(184);const g=["isDirty","onSave","isSaving","dirt","interval"];function x(e){let{isDirty:t,onSave:a,isSaving:s,dirt:x,interval:p=6e5}=e,h=(0,l.Z)(e,g);const{togglePendingSave:m}=(0,u.b)(),[,j,b]=(0,c.Z)((()=>{t&&a()}),p);return(0,o.useEffect)((()=>{t?(m(!0),console.log("Save Reset",r()(Date.now()).format("MM/DD/YYYY HH:mm:ss")),b()):(m(!1),j())}),[t,b,j,x]),(0,o.useEffect)((()=>{const e=e=>{if(t){const t="You have unsaved changes, are you sure you want to leave?";return e.returnValue=t,t}};return window.addEventListener("beforeunload",e),()=>{window.removeEventListener("beforeunload",e)}}),[t]),(0,v.jsx)(i.ZP,(0,n.Z)((0,n.Z)({type:"primary",size:"large",icon:(0,v.jsx)(d.Z,{}),onClick:a,disabled:!t,loading:s,danger:!0,block:!0},h),{},{children:"Save"}))}},145:(e,t,a)=>{a.d(t,{f:()=>r});var n=a(2241),l=a(3733),i=a(2606),s=a(184);const r=e=>{let{id:t,width:a=200,className:r="",preview:o=!0,fileExtension:c="jpg"}=e;const{getUrl:d}=(0,i.n)("images"),u=t.replace(/-/g,"/");return(0,s.jsx)("div",{className:(0,l.Z)("image-card",r),children:(0,s.jsx)(n.Z,{width:a,src:d("".concat(u,".").concat(c)),fallback:d("back/default.jpg"),preview:o})})}},4290:(e,t,a)=>{a.d(t,{e:()=>s});var n=a(2791),l=a(4421),i=a(4766);function s(e){var t,a;let{prefix:s="",data:r,defaultCurrent:o=1,defaultPageSize:c=64,pageSizeOptions:d=[16,32,64,128],resetter:u}=e;const{queryParams:v,addParam:g}=(0,i.K)(),x=Number(null!==(t=v.get("".concat(s,"page")))&&void 0!==t?t:String(o)),p=Number(null!==(a=v.get("".concat(s,"pageSize")))&&void 0!==a?a:String(c)),h=(0,l.Z)(u),m=(0,n.useMemo)((()=>{const e=(x-1)*p,t=e+p;return r.slice(e,t)}),[x,p,r]),j=e=>{g("".concat(s,"page"),e.toString(),String(o))};return u!==h&&j(o),{page:m,pagination:{current:x,pageSize:p,onChange:j,onShowSizeChange:(e,t)=>{g("".concat(s,"pageSize"),t.toString(),String(c))},defaultCurrent:o,defaultPageSize:c,pageSizeOptions:d,total:r.length,hideOnSinglePage:!0}}}},8938:(e,t,a)=>{a.d(t,{i:()=>v});var n=a(1413),l=a(4747),i=a(763),s=a(2791),r=a(3713),o=a(5850),c=a(8027),d=a(5529),u=a(2233);function v(e){let{tdrResourceName:t,firebaseDataCollectionName:a,serialize:v}=e;const{notification:g}=l.Z.useApp(),x=(0,r.NL)(),p=(0,d.N)(t),h=(0,c.X)("tdr",a,{select:v?o.d_:void 0}),[m,j]=(0,s.useState)({}),b=(0,u.B)("tdr",a,{onSuccess:()=>{g.success({message:"".concat(a," updated")}),x.refetchQueries({queryKey:["firebase","tdr",a]}),j({})},onError:e=>{g.error({message:"".concat(a," update failed"),description:e.message})}}),f=(0,s.useMemo)((()=>{var e,l;return p.isSuccess&&h.isSuccess&&!b.isPending?(console.log("%cMerging ".concat(t,"+").concat(a," data..."),"color: #f0f"),(0,i.cloneDeep)((0,n.Z)((0,n.Z)((0,n.Z)({},null!==(e=p.data)&&void 0!==e?e:{}),null!==(l=h.data)&&void 0!==l?l:{}),m))):{}}),[t,a,p.data,h.data,p.isSuccess,h.isSuccess,b.isPending,m]),y=!(0,i.isEmpty)(m),Z=h.data;return{data:f,isLoading:p.isLoading||h.isLoading,error:p.error||h.error,firebaseData:Z,isSaving:b.isPending,save:()=>{b.mutate(v?(0,o.aS)(m):m)},addEntryToUpdate:(e,t)=>{j((a=>(0,n.Z)((0,n.Z)({},a),{},{[e]:t})))},entriesToUpdate:m,isDirty:y}}},2233:(e,t,a)=>{a.d(t,{B:()=>o});var n=a(1413),l=a(9631),i=a(2592),s=a(8556);function r(e,t,a){console.log("%cUpdating ".concat(e,"/").concat(t," from firebase"),"color: #f00");const n=(0,l.JU)(i.RZ,"".concat(e,"/").concat(t));return(0,l.r7)(n,a)}function o(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return(0,s.D)((0,n.Z)({mutationFn:async a=>r(e,t,a)},a))}},6654:(e,t,a)=>{a.r(t),a.d(t,{Contenders:()=>U,default:()=>H});var n=a(1413),l=a(1790),i=a(6178),s=a(4520),r=a(5597),o=a(6095),c=a(4290),d=a(1752),u=a(6473),v=a(906),g=a(4424),x=a(9228),p=a(3164),h=a(1310),m=a(145),j=a(763),b=a(5850),f=a(6591),y=a(184);const Z=[{value:"base",label:"Base"},{value:"anime",label:"Anime"},{value:"art",label:"Art"},{value:"cartoon",label:"Cartoon"},{value:"characters",label:"Characters"},{value:"comics",label:"Comics"},{value:"games",label:"Games"},{value:"history",label:"History"},{value:"internet",label:"Internet"},{value:"literature",label:"Literature"},{value:"movies",label:"Movies"},{value:"music",label:"Music"},{value:"mythology",label:"Mythology"},{value:"pop-culture",label:"Pop Culture"},{value:"random",label:"Random"},{value:"sports",label:"Sports"},{value:"television",label:"Television"},{value:"special-td",label:"Special TD"},{value:"special-td-bg",label:"Special TD BG"}],S=(e,t)=>{if(!e||0===e.length)return"warning";return e.filter((e=>!Z.some((t=>t.value===e)))).length>0||t&&e.includes("base")?"error":void 0};function w(e){var t,a,l;let{contender:i,addEntryToUpdate:r}=e;const o=(e,t,a)=>{r(i.id,(0,j.merge)({[t]:{en:"",pt:""}},i,{[t]:{[a]:e}}))};return(0,y.jsxs)(u.Z,{hoverable:!0,"style-":{width:240,maxWidth:240},cover:(0,y.jsx)(m.f,{id:i.id,width:240}),children:[(0,y.jsx)(u.Z.Meta,{title:i.id,description:(0,y.jsxs)(s.Z,{vertical:!0,children:[(0,y.jsx)(p.__,{children:"Name"}),(0,y.jsx)(p.aW,{value:i.name,language:"en",onChange:e=>o(e.target.value,"name","en")}),(0,y.jsx)(p.aW,{value:i.name,language:"pt",onChange:e=>o(e.target.value,"name","pt")}),(0,y.jsx)(p.__,{children:"Description"}),(0,y.jsx)(p.aW,{value:null!==(t=i.description)&&void 0!==t?t:f.Xw,language:"en",onChange:e=>o(e.target.value,"description","en")}),(0,y.jsx)(p.aW,{value:null!==(a=i.description)&&void 0!==a?a:f.Xw,language:"pt",onChange:e=>o(e.target.value,"description","pt")}),(0,y.jsx)(p.__,{children:"Decks"}),(0,y.jsx)(v.Z,{mode:"multiple",defaultValue:null!==(l=i.decks)&&void 0!==l?l:[],size:"small",options:Z,onChange:e=>{return t=e,void r(i.id,(0,n.Z)((0,n.Z)({},i),{},{decks:(0,b.R1)(t).sort()}));var t},style:{maxWidth:"calc(100vw / 9)"},status:S(i.decks,i.exclusivity)}),(0,y.jsxs)(s.Z,{align:"center",children:[(0,y.jsx)(p.__,{children:"NSFW"})," ",(0,y.jsx)(p.js,{value:i.nsfw,size:"small",onChange:e=>{return t=e,void r(i.id,(0,j.merge)(i,{nsfw:t}));var t}})]}),(0,y.jsxs)(s.Z,{align:"center",gap:8,children:[(0,y.jsx)(p.__,{children:"Exclusivity"})," ",(0,y.jsx)(C,{contender:i,addEntryToUpdate:r})]})]})}),(0,y.jsx)(u.Z.Meta,{})]})}function C(e){let{contender:t,addEntryToUpdate:a}=e;const n=[{value:"en",label:(0,y.jsx)(h.H,{language:"en",style:{width:24}})},{value:"pt",label:(0,y.jsx)(h.H,{language:"pt",style:{width:24}})},{value:"none",label:"None"}],l=(0,y.jsx)(s.Z,{gap:8,children:(0,y.jsx)(g.ZP.Group,{options:n,onChange:e=>{return n=e.target.value,void a(t.id,(0,j.merge)(t,{exclusivity:n}));var n},value:null===t||void 0===t?void 0:t.exclusivity})});return(0,y.jsxs)(s.Z,{gap:8,children:["en"===(null===t||void 0===t?void 0:t.exclusivity)&&(0,y.jsx)(h.H,{language:"en",style:{width:24}}),"pt"===(null===t||void 0===t?void 0:t.exclusivity)&&(0,y.jsx)(h.H,{language:"pt",style:{width:24}}),!(null!==t&&void 0!==t&&t.exclusivity)&&"None",(0,y.jsx)(x.Z,{title:"Change exclusivity?",content:l,trigger:"click",children:(0,y.jsx)(d.Z,{})})]})}function E(e){let{data:t,addEntryToUpdate:a}=e;const n=(0,r.FX)(t),{page:l,pagination:d}=(0,c.e)({data:n,resetter:"",defaultPageSize:32});return(0,y.jsx)(y.Fragment,{children:(0,y.jsxs)(y.Fragment,{children:[(0,y.jsxs)(i.Z.Title,{level:2,children:["Listing - Contenders (",n.length," | ",Object.values(null!==t&&void 0!==t?t:{}).length,")"]}),(0,y.jsx)(o.N,{pagination:d,className:"full-width",children:(0,y.jsx)(s.Z,{gap:16,wrap:"wrap",children:l.map((e=>(0,y.jsx)(w,{contender:e,addEntryToUpdate:a},e.id)))})})]})})}var k=a(2128),D=a(7128),P=a(7018),N=a(7340),T=a(7965),z=a(2791);function M(e){let{data:t,isDirty:a,save:n,isSaving:l,entriesToUpdate:i}=e;return(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(T.Pd,{children:(0,y.jsxs)(s.Z,{vertical:!0,gap:12,children:[(0,y.jsx)(N.k,{isDirty:a,onSave:n,isSaving:l,dirt:JSON.stringify(i)}),(0,y.jsx)(P.o,{data:()=>function(e){console.log("Preparing file for download...");const t=(0,j.cloneDeep)(e);return Object.values(t).forEach((e=>{const t=e.exclusivity;void 0!==e.exclusivity&&"none"!==t||(e.exclusivity=void 0)})),(0,b.Tj)((0,b.ET)(t))}(t),fileName:"contenders.json",disabled:a,block:!0})]})}),(0,y.jsx)(T.Pd,{children:(0,y.jsx)(r.Pm,{data:t,ignoreKeys:["description"]})}),(0,y.jsx)(T.Pd,{children:(0,y.jsx)(O,{data:t})})]})}function O(e){let{data:t}=e;const a=(0,z.useMemo)((()=>{let e=0,a=0,n=0;const l=Object.values(t).reduce(((t,l)=>{var i;return(null!==(i=l.decks)&&void 0!==i?i:[]).forEach((e=>{t[e]=t[e]?t[e]+1:1})),"en"===l.exclusivity&&e++,"pt"===l.exclusivity&&a++,l.exclusivity||n++,t}),{});return{deckCounts:l,invalidDecks:Object.keys(l).filter((e=>!Z.some((t=>t.value===e)))),englishExclusivity:e,portugueseExclusivity:a,bothExclusivity:n}}),[t]);return(0,y.jsxs)(s.Z,{vertical:!0,gap:8,children:[(0,y.jsx)(i.Z.Text,{strong:!0,children:"Deck Counts"}),(0,y.jsx)(s.Z,{vertical:!0,gap:8,style:{maxHeight:"300px",overflowY:"auto"},children:Z.map((e=>{var t;return(0,y.jsxs)(i.Z.Text,{children:[e.label,": ",null!==(t=a.deckCounts[e.value])&&void 0!==t?t:0]},e.value)}))}),(0,y.jsx)(D.Z,{className:"my-2"}),(0,y.jsx)(i.Z.Text,{strong:!0,children:"Invalid Decks"}),(0,y.jsx)(s.Z,{vertical:!0,gap:8,style:{maxHeight:"300px",overflowY:"auto"},children:a.invalidDecks.map((e=>(0,y.jsx)(i.Z.Text,{children:e},e)))}),(0,y.jsx)(D.Z,{className:"my-2"}),(0,y.jsx)(i.Z.Text,{strong:!0,children:"Exclusivity"}),(0,y.jsxs)(s.Z,{vertical:!0,gap:8,children:[(0,y.jsxs)(i.Z.Text,{children:["English: ",a.englishExclusivity]}),(0,y.jsxs)(i.Z.Text,{children:["Portuguese: ",a.portugueseExclusivity]}),(0,y.jsxs)(i.Z.Text,{children:["Both: ",a.bothExclusivity]})]})]})}var L=a(4562),_=a(8938);function U(){const e=(0,_.i)({tdrResourceName:"contenders",firebaseDataCollectionName:"contenders",serialize:!0});return(0,y.jsx)(T.Xg,{title:"Contenders",subtitle:"Characters, Celebrities, Personalities",children:(0,y.jsxs)(l.Z,{hasSider:!0,children:[(0,y.jsx)(L.p,{children:(0,y.jsx)(M,(0,n.Z)({},e))}),(0,y.jsx)(l.Z.Content,{className:"content",children:(0,y.jsx)(k.T,{isLoading:e.isLoading,error:e.error,hasResponseData:!(0,j.isEmpty)(e.data),children:(0,y.jsx)(E,(0,n.Z)({},e))})})]})})}const H=U}}]);
//# sourceMappingURL=Contenders.784434fe.chunk.js.map