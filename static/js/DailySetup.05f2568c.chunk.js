"use strict";(self.webpackChunktdr=self.webpackChunktdr||[]).push([[718],{2999:(e,t,a)=>{a.d(t,{R:()=>i,T:()=>l});var n=a(952),r=a(3070),s=a(1958),o=a(184);function i(e){let{isLoading:t,isIdle:a,error:r,isDirty:s,isError:i,hasResponseData:l}=e;return a?(0,o.jsx)(n.Z,{children:"No Data yet"}):t?(0,o.jsx)(n.Z,{color:"blue",children:"Loading..."}):r||i?(0,o.jsx)(n.Z,{color:"red",children:"Error"}):s?(0,o.jsx)(n.Z,{color:"orange",children:"Modified"}):l?(0,o.jsx)(n.Z,{color:"green",children:"Loaded"}):(0,o.jsx)(n.Z,{children:"No Data"})}function l(e){return(0,o.jsx)(s.Pd,{children:(0,o.jsx)(r.Z.Item,{label:"Status",children:(0,o.jsx)(i,{...e})})})}},8866:(e,t,a)=>{a.d(t,{N:()=>s});var n=a(8914),r=a(184);function s(e){let{children:t,level:a,...s}=e;return(0,r.jsx)(n.Z.Title,{level:null!==a&&void 0!==a?a:3,...s,children:t})}},6173:(e,t,a)=>{a.d(t,{xh:()=>u,zE:()=>c,Do:()=>h,Th:()=>m.T,F6:()=>s});a(8866);var n=a(3733),r=a(184);const s=e=>{let{children:t,active:a=!1,activeClass:s="",className:o="",hoverType:i="scale",...l}=e;return(0,r.jsx)("button",{className:(0,n.Z)("transparent-button","transparent-button--".concat(i),a&&(s||"transparent-button--active"),o),...l,children:t})};var o=a(3070),i=a(1766),l=a(492),d=a(5922);function c(e){let{label:t,value:a,onChange:n,options:s,placeholder:l}=e;return(0,r.jsx)(o.Z.Item,{label:t,children:(0,r.jsxs)(i.Z,{style:{minWidth:"150px"},onChange:n,value:a,children:[l&&(0,r.jsx)(i.Z.Option,{value:"",disabled:!0,children:"placeholder"}),s.map((e=>"object"===typeof e?(0,r.jsx)(i.Z.Option,{value:e.value,children:e.label},"".concat(t,"-").concat(e.value)):(0,r.jsx)(i.Z.Option,{value:e,children:e},"".concat(t,"-").concat(e))))]})})}function u(e){let{label:t,value:a,onChange:n,min:s=0,max:i=100,step:d}=e;return(0,r.jsx)(o.Z.Item,{label:t,children:(0,r.jsx)(l.Z,{min:s,max:i,value:a,onChange:e=>n(null!==e&&void 0!==e?e:i),style:{minWidth:"150px",width:"100%"},step:d})})}function h(e){let{label:t,value:a,onChange:n,className:s}=e;return(0,r.jsx)(o.Z.Item,{label:t,valuePropName:"checked",className:s,children:(0,r.jsx)(d.Z,{checked:a,onChange:n,size:"small"})})}var m=a(2999)},5555:(e,t,a)=>{a.d(t,{Ld:()=>j,l9:()=>L,ve:()=>Z});var n=a(4747),r=a(2481),s=a(5860),o=a(3418),i=a(6807),l=a(8027);const d={SUFFIX_DATA:{pt:"drawingsPT",en:"drawingsEN"},DAILY:{pt:"diario",en:"daily"}};var c=a(2791),u=a(829);var h=a(763),m=a(2606);var p=a(5529),v=a(2426),g=a.n(v);function f(){return g()().format("YYYY-MM-DD")}function x(e){return g()(e,"YYYY-MM-DD").add(1,"days").format("YYYY-MM-DD")}function y(e){const t=[],a={};let n=0;for(;t.length<4&&n<500;){var r;const s=null!==(r=(0,h.sample)(e))&&void 0!==r?r:"",o=s.split("");o.every((e=>!a[e]))?(t.push(s),o.forEach((e=>{a[e]=!0}))):n++}if(n>500||t.length<4)for(console.count("Could not find 4 words with unique letters");t.length<4;){var s;const a=null!==(s=(0,h.sample)(e))&&void 0!==s?s:"";t.includes(a)||t.push(a)}return t.length<4&&console.error("Could not find 4 words with unique letters",t),t}function b(e,t){const a=(0,c.useMemo)((()=>{var a;return null!==(a=null===t||void 0===t?void 0:t[e])&&void 0!==a?a:{latestDate:f(),latestNumber:0,used:"[]"}}),[t,e]);return[(0,c.useMemo)((()=>{var e,t,n;return{latestNumber:null!==(e=null===a||void 0===a?void 0:a.latestNumber)&&void 0!==e?e:0,latestDate:null!==(t=null===a||void 0===a?void 0:a.latestDate)&&void 0!==t?t:f(),used:JSON.parse(null!==(n=null===a||void 0===a?void 0:a.used)&&void 0!==n?n:"[]")}}),[a]),a]}function j(e,t,a,r){const{notification:s}=n.Z.useApp(),o=d.DAILY[null!==t&&void 0!==t?t:"pt"],v=(0,i.a)({queryKey:[o,"history"],queryFn:(0,l.A)(o,"history"),enabled:e,onSuccess:()=>{s.info({message:"Data Daily History loaded",placement:"bottomLeft"})},onError:()=>{s.error({message:"Error loading daily history",placement:"bottomLeft"})}}),g=function(e,t){var a,r;const{notification:s}=n.Z.useApp(),o=(0,i.a)({queryKey:["data","suffixCounts"],queryFn:(0,l.A)("data","suffixCounts"),enabled:e,onSuccess:()=>{s.info({message:"Data Suffix Counts loaded",placement:"bottomLeft"})},onError:()=>{s.error({message:"Error loading suffix counts",placement:"bottomLeft"})}}),h=d.SUFFIX_DATA[null!==t&&void 0!==t?t:"pt"],m=null!==(a=null===(r=o.data)||void 0===r?void 0:r[h])&&void 0!==a?a:0,p="drawings".concat("pt"===t?"PT":"EN"),v=(0,c.useMemo)((()=>new Array(m).fill(0).map(((t,a)=>({queryKey:["data","".concat(p).concat(a+1)],queryFn:(0,l.A)("data","".concat(p).concat(a+1)),enabled:e&&Boolean(m),onSuccess:()=>{s.info({message:"Data Drawings ".concat(p).concat(a+1," loaded"),placement:"bottomLeft"})}})))),[m]);return(0,u.h)({queries:v})}(e,null!==t&&void 0!==t?t:"pt"),f=g.some((e=>e.isLoading)),[j]=b("arte-ruim",v.data),D=(0,c.useMemo)((()=>{console.count("Creating Arte Ruim...");const e=(null!==g&&void 0!==g?g:[]).reduce(((e,a)=>{var n;const r=null!==(n=a.data)&&void 0!==n?n:{};return Object.entries(r).forEach((a=>{var n;let[r,s]=a;const o=null!==(n=s.cardId)&&void 0!==n?n:s.id;if(s.drawing.trim().length<10)return console.warn("Empty drawing",o),e;void 0===e[o]?e[o]={id:o,type:"arte-ruim",language:null!==t&&void 0!==t?t:"pt",cardId:o,text:s.text,drawings:[s.drawing],number:0,dataIds:[r]}:(e[o].drawings.push(s.drawing),e[o].dataIds.push(r))})),e}),{}),n=Object.values(e).filter((e=>{var t;return e.drawings.length>=a&&e.cardId&&!(null!==(t=e.cardId)&&void 0!==t&&t.includes("--"))})),s=Object.values(n).filter((e=>!j.used.includes(e.cardId))),o=(0,h.sampleSize)((0,h.shuffle)(s),r);let i=j.latestDate;return o.map(((e,t)=>{const a=x(i);return i=a,{...e,id:a,number:j.latestNumber+t+1}}))}),[g,t,j,r,a]),w=(0,p.N)("aqui-o-sets"),[L]=b("aqui-o",v.data),Z=(0,c.useMemo)((()=>{console.count("Creating Aqui \xd3...");const e=(0,h.shuffle)(Object.values(w.data).filter((e=>e.itemsIds.filter(Boolean).length>=20)));let t=e.filter((e=>!L.used.includes(e.id)));t.length<r&&t.push(...(0,h.shuffle)(e));let a=L.latestDate;const n={};for(let s=0;s<r;s++){const e=t[s];if(!e)break;const r=x(a);a=r,n[r]={id:r,type:"aqui-o",number:L.latestNumber+s+1,setId:e.id,title:e.title,itemsIds:["0",...(0,h.sampleSize)(e.itemsIds,20)]}}return n}),[w,L,r]),S=function(e,t){var a;let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=arguments.length>3?arguments[3]:void 0;const{getUrl:s}=(0,m.n)("tdr"),o=r?"words-".concat(e,"-letters-selected-").concat(t):"words-".concat(e,"-letters-").concat(t),l=(0,i.a)({queryKey:[o],queryFn:async()=>{const e=await fetch(s("".concat(o,".json")));return await e.json()},enabled:n&&!!e&&!!t}),d=!(0,h.isEmpty)(l.data);return{...l,data:null!==(a=l.data)&&void 0!==a?a:[],hasResponseData:d}}(4,t,!0,!0),[N]=b("palavreado",v.data),I=(0,c.useMemo)((()=>{console.count("Creating Palavreado...");let e=N.latestDate;const t={};for(let a=0;a<r;a++){const n=y(S.data),r=(0,h.shuffle)(n.join("").split("")),s=x(e);e=s,t[s]={id:s,type:"palavreado",number:N.latestNumber+a+1,words:n,letters:r}}return t}),[S,N,r]),q=(0,p.N)("arte-ruim-cards-".concat(t)),[C]=b("artista",v.data),A=(0,c.useMemo)((()=>{console.count("Creating Artista...");let e=C.latestDate;const t={};for(let n=0;n<r;n++){var a;const r=x(e),s=Object.keys(null!==(a=q.data)&&void 0!==a?a:{}).filter((e=>!j.used.includes(e))),o=(0,h.sampleSize)(s,15).map((e=>q.data[e]));e=r,t[r]={id:r,type:"artista",number:C.latestNumber+n+1,cards:o}}return t}),[q,j,C,r]),E=(0,c.useMemo)((()=>(console.count("Bundling entries..."),D.map((e=>({id:e.id,"arte-ruim":e,"aqui-o":Z[e.id],palavreado:I[e.id],artista:A[e.id]}))))),[D,Z,I,A]);return{isLoading:f||v.isLoading,entries:E}}var D=a(5850),w=a(6403);function L(e){const{notification:t}=n.Z.useApp(),a=(0,w.NL)(),u=d.DAILY[null!==e&&void 0!==e?e:"pt"],[h,m]=(0,c.useState)(!1),p=(0,i.a)({queryKey:[u,"history"],queryFn:(0,l.A)(u,"history"),enabled:Boolean(u),onSuccess:()=>{t.info({message:"Data Daily History loaded",placement:"bottomLeft"})},onError:()=>{t.error({message:"Error loading daily history",placement:"bottomLeft"})}}),v=(0,o.D)((async e=>{var t;const a=e.map((e=>{const t=(0,r.JU)(s.RZ,"".concat(u,"/").concat(e.id));return(0,r.pl)(t,e)})),n=(0,r.JU)(s.RZ,"".concat(u,"/history")),o=p.data;if(!o)throw new Error("No previous history");const i={...o,"arte-ruim":{latestDate:e[e.length-1].id,latestNumber:e[e.length-1]["arte-ruim"].number,used:JSON.stringify((0,D.R1)([...JSON.parse(o["arte-ruim"].used),...e.map((e=>e["arte-ruim"].cardId))]))},"aqui-o":{latestDate:e[e.length-1].id,latestNumber:e[e.length-1]["aqui-o"].number,used:JSON.stringify((0,D.R1)([...JSON.parse(null!==(t=o["aqui-o"].used)&&void 0!==t?t:"[]"),...e.map((e=>e["aqui-o"].setId))]))},palavreado:{latestDate:e[e.length-1].id,latestNumber:e[e.length-1].palavreado.number,used:"[]"},artista:{latestDate:e[e.length-1].id,latestNumber:e[e.length-1].artista.number,used:"[]"}};return(0,r.pl)(n,i),Promise.all(a)}),{onSuccess:()=>{t.info({message:"Data saved",placement:"bottomLeft"}),a.invalidateQueries([u,"history"]),m(!1)},onError:()=>{t.error({message:"Error saving data",placement:"bottomLeft"})}});return{isDirty:h,setIsDirty:m,save:v.mutateAsync,isLoading:v.isLoading}}function Z(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];const{notification:t}=n.Z.useApp(),a=d.DAILY.pt,c=(0,o.D)({mutationFn:async e=>{const t=(0,r.JU)(s.RZ,"".concat(a,"/history"));(0,r.pl)(t,e)},onSuccess:()=>{t.info({message:"New history data saved",placement:"bottomLeft"})}}),u=(0,i.a)({queryKey:[a,"history"],queryFn:(0,l.A)(a,"history"),enabled:e,onSuccess:e=>{t.info({message:"Data Daily History loaded",placement:"bottomLeft"})},onError:()=>{t.error({message:"Error loading daily history",placement:"bottomLeft"})}});return{mutation:c,historyQuery:u}}},8027:(e,t,a)=>{a.d(t,{A:()=>i,X:()=>l});var n=a(2481),r=a(5860),s=a(6807),o=a(5850);function i(e,t){return async()=>{var a;console.log("%cQuerying ".concat(e,"/").concat(t," from firebase: ").concat((0,o.xE)()),"color: #f0f");const s=(0,n.JU)(r.RZ,"".concat(e,"/").concat(t));return null!==(a=(await(0,n.QT)(s)).data())&&void 0!==a?a:{}}}function l(e,t,a){return(0,s.a)({queryKey:["firebase",e,t],queryFn:i(e,t),...a})}},2950:(e,t,a)=>{a.r(t),a.d(t,{default:()=>b});var n=a(3990),r=a(8914),s=a(1046),o=a(4520),i=a(2556),l=a(6402),d=a(5555),c=a(184);const u=e=>{var t,a;let{drawing:n="",className:r="",width:s=250,height:o,strokeWidth:i="medium",viewBox:l="0 0 500 500"}=e;const d=JSON.parse(n),u=d.map((e=>{let t="";for(let a=0,n=1;n<e.length;a+=2,n+=2)e[a+2]&&e[n+2]&&(t+="M".concat(e[a],",").concat(e[n]," L").concat(e[a+2],",").concat(e[n+2]));return t}));const h=null!==(t=null===(a={small:3,medium:5,large:7})||void 0===a?void 0:a[i])&&void 0!==t?t:5;return(0,c.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:l,overflow:"hidden",className:r,style:{width:"".concat(s,"px"),height:"".concat(o||s,"px")},children:[(0,c.jsx)("defs",{}),u.map(((e,t)=>(0,c.jsx)("path",{d:e,fill:"none",stroke:"#000",strokeWidth:h,strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:"10"},"".concat(n,"-").concat(t))))]})};function h(e){var t,a;let{language:n,dataLoad:r}=e;const h=n,m=[{title:"Id",dataIndex:"id",key:"id"},{title:"Arte Ruim",dataIndex:"arte-ruim",key:"arte-ruim",render:e=>{let{number:t,cardId:a,text:n,drawings:r}=e;return(0,c.jsxs)(s.Z,{direction:"vertical",children:[(0,c.jsxs)(s.Z,{children:[(0,c.jsxs)("span",{children:["#",t]}),(0,c.jsxs)("span",{children:["CardId: ",a]}),(0,c.jsxs)("span",{children:["Count: ",r.length]})]}),(0,c.jsxs)("div",{children:['"',n.split("").map(((e,t)=>t<2||" "===e?e:"\u23f9")).join(""),'"']}),(0,c.jsx)(s.Z,{children:r.map((e=>(0,c.jsx)(u,{drawing:e,width:75,height:75,className:"canvas"},e)))})]})}},{title:"Aqui O",dataIndex:"aqui-o",key:"aqui-o",render:e=>{let{number:t,setId:a,title:r}=e;return(0,c.jsxs)(s.Z,{direction:"vertical",children:[(0,c.jsxs)("span",{children:["#",t]}),(0,c.jsxs)("span",{children:["SetId: ",a]}),(0,c.jsxs)("span",{children:["Title: ",r[n]]})]})}},{title:"Palavreado",dataIndex:"palavreado",key:"palavreado",render:e=>{let{number:t,words:a,letters:n}=e;return(0,c.jsxs)(s.Z,{direction:"vertical",children:[(0,c.jsxs)("span",{children:["#",t]}),(0,c.jsxs)("span",{children:["Letters: ",n.length]}),(0,c.jsx)(s.Z,{direction:"vertical",children:a.map((e=>(0,c.jsx)("span",{children:e.split("").map(((e,t)=>t<1||" "===e?e:"\u23f9")).join("")},"".concat(t,"-").concat(e))))})]})}},{title:"Artista",dataIndex:"artista",key:"artista",render:e=>{let{number:t,cards:a}=e;return(0,c.jsxs)(s.Z,{direction:"vertical",children:[(0,c.jsxs)("span",{children:["#",t]}),a.map(((e,t)=>(0,c.jsx)("span",{children:e.text},"".concat(e.id,"-").concat(t))))]})}}],{save:p,isLoading:v}=(0,d.l9)(null!==h&&void 0!==h?h:"pt");return(0,c.jsxs)("div",{children:[r.isLoading&&(0,c.jsx)("div",{children:"Loading..."}),(0,c.jsxs)(o.Z,{justify:"space-between",align:"center",children:[(0,c.jsxs)("h1",{children:["Total: ",r.entries.length]}),(0,c.jsx)(i.ZP,{onClick:()=>p(r.entries),loading:v,disabled:0===(null!==(t=r.entries)&&void 0!==t?t:[]).length,type:"primary",size:"large",children:"Save"})]}),(0,c.jsx)(l.Z,{columns:m,dataSource:null!==(a=r.entries)&&void 0!==a?a:[]})]})}var m=a(6173),p=a(1958),v=a(6591);function g(e){let{language:t,setLanguage:a,drawingsCount:n,setDrawingsCount:r,batchSize:s,setBatchSize:o}=e;return(0,c.jsxs)(p.Pd,{children:[(0,c.jsx)(m.zE,{label:"Language",value:t,onChange:a,options:v.a2,placeholder:"Select a language"}),(0,c.jsx)(m.zE,{label:"Minimum Drawings",value:n,onChange:r,options:[2,3,4],placeholder:"Select a number"}),(0,c.jsx)(m.zE,{label:"Batch Size",value:s,onChange:o,options:[5,15,30,45],placeholder:"Select a number"})]})}var f=a(2128),x=a(4562),y=a(2791);const b=function(){const[e,t]=(0,y.useState)(""),[a,s]=(0,y.useState)(2),[o,i]=(0,y.useState)(45),l=(0,d.Ld)(Boolean(e),e,a,o);return(0,c.jsx)(p.Xg,{title:"Daily Setup",children:(0,c.jsxs)(n.Z,{hasSider:!0,children:[(0,c.jsxs)(x.p,{children:[(0,c.jsx)(m.Th,{isLoading:l.isLoading,error:null,hasResponseData:!l.isLoading}),(0,c.jsx)(g,{language:e,setLanguage:t,drawingsCount:a,setDrawingsCount:s,batchSize:o,setBatchSize:i})]}),(0,c.jsx)(n.Z.Content,{className:"content",children:(0,c.jsxs)(f.T,{isLoading:l.isLoading,error:null,hasResponseData:!l.isLoading,children:[(0,c.jsx)(r.Z.Title,{level:2,children:"Data Population"}),(0,c.jsx)(h,{language:e,dataLoad:l})]})})]})})}}}]);
//# sourceMappingURL=DailySetup.05f2568c.chunk.js.map