"use strict";(self.webpackChunktdr=self.webpackChunktdr||[]).push([[187],{8158:(e,s,t)=>{t.d(s,{CQ:()=>x,bN:()=>p,cw:()=>j,hW:()=>h,xL:()=>m});var i=t(1105),a=t(2556),n=t(1310),r=t(6020),l=t(8955),d=t(5458),o=t(1087),c=t(7134),u=t(184);function m(e){let{item:s,width:t,className:i}=e;return(0,u.jsx)(r.ck,{id:s.id,width:t,title:"".concat(s.name.en," | ").concat(s.name.pt),className:i})}function p(e){let{item:s}=e;const t=(0,c._)();return(0,u.jsx)("span",{children:(0,u.jsx)(i.Z,{prefix:s.nsfw?(0,u.jsx)(l.Z,{style:{color:"hotPink"}}):(0,u.jsx)(d.Z,{}),placeholder:"Id",variant:"borderless",size:"small",value:s.id,readOnly:!0,style:{width:"8ch"},onClick:()=>t(s.id)})})}function x(e){let{item:s,language:t}=e;return(0,u.jsx)(i.Z,{prefix:(0,u.jsx)(n.H,{language:t,width:"1em"}),placeholder:"Name in ".concat(t.toUpperCase()),variant:"borderless",size:"small",value:s.name[t],readOnly:!0})}function h(e){let{item:s}=e;return s.nsfw?(0,u.jsx)(l.Z,{style:{color:"hotpink"}}):(0,u.jsx)(u.Fragment,{})}function j(e){let{item:s}=e;const[,t]=(0,o.lr)();return(0,u.jsx)("span",{children:(0,u.jsx)(a.ZP,{size:"small",shape:"round",onClick:()=>{t({itemId:s.id,view:"classifier"})},children:"Go to"})})}},1469:(e,s,t)=>{t.r(s),t.d(s,{ItemsGroups:()=>P,default:()=>R});var i=t(3990),a=t(2128),n=t(4520),r=t(4031),l=t(2979),d=t(6106),o=t(914),c=t(2228),u=t(6020),m=t(7134),p=t(4290),x=t(4766),h=t(5529),j=t(763),g=t(2791),y=t(5850),v=t(731),f=t(1046),I=t(7765),Z=t(8158),b=t(184);function k(e){let{item:s,itemGroups:t,groupsTypeahead:i,onUpdateItemGroups:a}=e;const n=(0,m._)();return(0,b.jsxs)(v.Z,{title:(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(r.Z.Text,{onClick:()=>n(s.id),children:s.id}),(0,b.jsx)(Z.hW,{item:s})]}),style:{maxWidth:250},children:[(0,b.jsx)(Z.xL,{item:s,width:75}),(0,b.jsxs)(f.Z,{size:"small",direction:"vertical",className:"my-4",children:[(0,b.jsx)(Z.CQ,{item:s,language:"en"}),(0,b.jsx)(Z.CQ,{item:s,language:"pt"}),(0,b.jsx)(I.Z,{mode:"multiple",style:{width:"100%"},placeholder:"Select a category",defaultValue:t,options:i,showSearch:!0,size:"small",onChange:e=>a(s.id,e)},String(t))]})]})}function w(e){let{data:s,addEntryToUpdate:t}=e;const{is:i}=(0,x.K)(),a=(0,h.N)("items"),n=(0,g.useMemo)((()=>Object.values(null!==s&&void 0!==s?s:[]).reduce(((e,s)=>(s.itemsIds||console.warn("Group without items",s),s.itemsIds.forEach((t=>{e[t]||(e[t]=[]),e[t].push(s.id)})),e)),{})),[s]),r=(0,g.useMemo)((()=>(0,j.orderBy)(Object.keys(s).map((e=>({label:e,value:e}))),"label")),[s]);return(0,b.jsxs)(b.Fragment,{children:[i("display","group")&&(0,b.jsx)(C,{data:s}),i("display","item")&&(0,b.jsx)(N,{items:a.data,grousByItem:n,groupsTypeahead:r,onUpdateItemGroups:(e,i)=>{var a;const r=null!==(a=n[e])&&void 0!==a?a:[],l=i.filter((e=>!r.includes(e))),d=r.filter((e=>!i.includes(e)));l.forEach((i=>{var a,n;t(i,{id:i,itemsIds:(0,y.R1)([...null!==(a=null===(n=s[i])||void 0===n?void 0:n.itemsIds)&&void 0!==a?a:[],e])})})),d.forEach((i=>{var a;t(i,{id:i,itemsIds:(0,y.R1)(null===(a=s[i])||void 0===a?void 0:a.itemsIds.filter((s=>s!==e)))})}))}})]})}function C(e){let{data:s}=e;const t=(0,m._)(),i=[{title:"id",dataIndex:"id",key:"id",render:e=>(0,b.jsx)("span",{children:e})},{title:"Items",dataIndex:"itemsIds",key:"itemsIds",render:(e,s)=>(0,b.jsx)(n.Z,{gap:6,wrap:"wrap",children:e.map((e=>(0,b.jsxs)(n.Z,{gap:2,vertical:!0,children:[(0,b.jsx)(u.ck,{id:e,width:60}),(0,b.jsx)(n.Z,{justify:"center",children:(0,b.jsx)(r.Z.Text,{onClick:()=>t(e),children:e})})]},"".concat(s.id,"-").concat(e))))},"items-".concat(s.id))},{title:"Count",dataIndex:"itemsIds",key:"count",render:e=>(0,y.R1)(e).filter(Boolean).length}];return(0,b.jsx)(l.Z,{columns:i,dataSource:Object.values(s),className:"my-4"})}function N(e){let{items:s,grousByItem:t,groupsTypeahead:i,onUpdateItemGroups:a}=e;const{is:n}=(0,x.K)(),l=n("emptyOnly"),u=(0,g.useMemo)((()=>l?Object.values(s).filter((e=>!t[e.id])):Object.values(s)),[s,t,l]),{page:m,pagination:h}=(0,p.e)({data:u});return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)(r.Z.Title,{level:2,children:["Groups by Items (",u.length,")"]}),(0,b.jsx)(c.N,{pagination:h,children:(0,b.jsx)(d.Z,{gutter:[16,16],className:"my-4",children:m.map((e=>(0,b.jsx)(o.Z,{xs:24,sm:24,md:12,lg:6,xl:4,children:(0,b.jsx)(k,{item:e,itemGroups:t[e.id],groupsTypeahead:i,onUpdateItemGroups:a})},e.id)))})})]})}var G=t(7128),O=t(6173),T=t(7018),S=t(1958),U=t(3660),z=t(9197),B=t(7340);function D(e){var s;let{data:t,save:i,isDirty:a,isSaving:r,entriesToUpdate:l}=e;const{queryParams:d,addParam:o,is:c}=(0,x.K)();return(0,b.jsxs)(S.Pd,{children:[(0,b.jsxs)(n.Z,{vertical:!0,gap:12,children:[(0,b.jsx)(B.k,{isDirty:a,onSave:i,isSaving:r,dirt:JSON.stringify(l)}),(0,b.jsx)(T.o,{data:()=>{return e=t,(0,y.Tj)(e);var e},fileName:"items-groups.json",disabled:a,block:!0})]}),(0,b.jsx)(G.Z,{}),(0,b.jsx)(O.H,{label:"Display",value:null!==(s=d.get("display"))&&void 0!==s?s:"group",onChange:e=>o("display",e),options:[{title:"By Groups",icon:(0,b.jsx)(U.Z,{}),value:"group"},{title:"By Items",icon:(0,b.jsx)(z.Z,{}),value:"item"}]}),(0,b.jsx)(O.Do,{label:"No Groups Only",value:c("emptyOnly"),onChange:e=>o("emptyOnly",e,!1)})]})}var E=t(4562),L=t(8938);function P(){const e=(0,L.i)({tdrResourceName:"items-groups",firebaseDataCollectionName:"itemsGroups",serialize:!0}),s=(0,h.N)("items");return(0,b.jsx)(S.Xg,{title:"Items",subtitle:"Groups Sets",children:(0,b.jsxs)(i.Z,{hasSider:!0,children:[(0,b.jsx)(E.p,{children:(0,b.jsx)(D,{...e})}),(0,b.jsx)(i.Z.Content,{className:"content",children:(0,b.jsx)(a.T,{isLoading:e.isLoading||s.isLoading,error:e.error||s.error,hasResponseData:!(0,j.isEmpty)(e.data)&&!(0,j.isEmpty)(s.data),children:(0,b.jsx)(w,{...e})})})]})})}const R=P}}]);
//# sourceMappingURL=ItemsGroups.9a545d08.chunk.js.map