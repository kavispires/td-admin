import{r,bW as d,j as v,B as b}from"./index-DTFVBFfK.js";import{h as g}from"./moment-B-YVwB4U.js";import{R as p}from"./SaveOutlined-aR-FBBRB.js";function E(e,t){t===void 0&&(t=0);var u=r.useRef(!1),n=r.useRef(),o=r.useRef(e),s=r.useCallback(function(){return u.current},[]),c=r.useCallback(function(){u.current=!1,n.current&&clearTimeout(n.current),n.current=setTimeout(function(){u.current=!0,o.current()},t)},[t]),a=r.useCallback(function(){u.current=null,n.current&&clearTimeout(n.current)},[]);return r.useEffect(function(){o.current=e},[e]),r.useEffect(function(){return c(),a},[t]),[s,a,c]}function w({isDirty:e,onSave:t,isSaving:u,dirt:n,interval:o=600*1e3,children:s,...c}){const[,a,l]=E(()=>{e&&t()},o);return r.useEffect(()=>{e?(d(!0),console.log("Save Reset",g(Date.now()).format("MM/DD/YYYY HH:mm:ss")),l()):(d(!1),a())},[e,l,a,n]),r.useEffect(()=>{const f=m=>{if(e){const i="You have unsaved changes, are you sure you want to leave?";return m.returnValue=i,i}};return window.addEventListener("beforeunload",f),()=>{window.removeEventListener("beforeunload",f)}},[e]),v.jsx(b,{block:!0,danger:!0,disabled:!e,icon:v.jsx(p,{}),loading:u,onClick:t,size:"large",type:"primary",...c,children:s??"Save"})}export{w as S,E as u};
