import{r as u,d as w,n as v,j as t,I as R,F as y,S as j,c as b,B as P,P as L,L as S}from"./index-CTf-mCqX.js";import{D as z}from"./DataLoadingWrapper-gOz-iekJ.js";import{l as g,P as E}from"./useBaseUrl-D2YOm4WP.js";import{I as F}from"./ImageCard-BF6qABLW.js";import{u as C,R as D,I as O}from"./RelationshipsStats-DFk5pcrL.js";import{F as M}from"./Table-BxtTVYUo.js";import{T as N}from"./index-BL7SeXuZ.js";import{b as k,a as I}from"./FilterEntries-C6mDosJ4.js";import{R as B}from"./ResponseState-CbLoJUr6.js";import{D as T}from"./DownloadButton-C5F2g6EI.js";import{S as x}from"./SiderContent-BNiATzc9.js";import{g as _,C as q}from"./constants-D2J5TbS7.js";import"./hooks-BWanxREo.js";import"./useMutation-NSzs5tB7.js";import"./useQueryParams-yhBqKdrw.js";import"./index-B1cA-3FD.js";import"./index-C920Py66.js";import"./index-Dodd8xBe.js";import"./Dropdown-BGUDzd0a.js";import"./index-bNYZ7r0n.js";import"./index-DwUSrJnX.js";import"./useId-Cj2VzGUM.js";import"./scrollTo-YauXU52C.js";import"./Pagination-BSJTbaOJ.js";import"./index-DFmb7Kiu.js";import"./index-DfMWjrZa.js";import"./PlusOutlined-Dk0Fv5SP.js";import"./Item-Dsp7t-q7.js";var G={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm154.7 454.5l-246 178c-5.3 3.8-12.7 0-12.7-6.5v-46.9c0-10.2 4.9-19.9 13.2-25.9L566.6 512 421.2 406.8c-8.3-6-13.2-15.6-13.2-25.9V334c0-6.5 7.4-10.3 12.7-6.5l246 178c4.4 3.2 4.4 9.8 0 13z"}}]},name:"right-circle",theme:"filled"};function f(){return f=Object.assign?Object.assign.bind():function(o){for(var n=1;n<arguments.length;n++){var s=arguments[n];for(var c in s)Object.prototype.hasOwnProperty.call(s,c)&&(o[c]=s[c])}return o},f.apply(this,arguments)}const W=(o,n)=>u.createElement(w,f({},o,{ref:n,icon:G})),$=u.forwardRef(W);function A(){const{query:{data:o,...n},randomGroups:{cardIds:s},showIds:c,cardSize:p}=C(),[h,{width:r}]=v(),[,d]=u.useMemo(()=>{const e=Math.floor(r/p)+1,i=Math.floor(r/e);return[e,i]},[p,r]),m=[{title:"Length",dataIndex:"length",key:"length"},{title:"Relationships",dataIndex:"relationships",key:"relationship",render:(e,i)=>t.jsx(R.PreviewGroup,{children:t.jsx(y,{gap:2,wrap:"wrap",children:e.map(l=>t.jsxs(j,{children:[t.jsxs(j,{orientation:"vertical",children:[t.jsx(F,{cardId:l,cardWidth:d}),c&&t.jsx(N,{children:l})]}),e[e.length-1]!==l&&t.jsx($,{})]},`${i.origin}-${l}`))})})}],a=u.useMemo(()=>g.orderBy(s.map(e=>{const i=Z(e,o,"longest",10);return{key:e,origin:e,length:i.length,relationships:i}}),["length"],["desc"]),[s,o]);return t.jsx(z,{error:n.error,hasResponseData:!0,isLoading:n.isLoading,children:t.jsx("div",{className:"my-6",ref:h,children:t.jsx(M,{columns:m,dataSource:a})})})}const Z=g.memoize((o,n,s,c)=>{const p=new Set,h=[];let r=[],d=0;for(h.push({currentId:o,path:[],depth:0});h.length>0&&d<100;){d++;const{currentId:m,path:a,depth:e}=h.pop()??{currentId:"",path:[],depth:0};if(p.add(m),a.push(m),s==="longest"&&a.length>r.length&&(r=[...a]),s==="shortest"&&(r.length===0||a.length<r.length)&&(r=[...a]),s==="any"&&r.length===0&&(r=[...a]),!(e>=c))for(const i of n[m]||[])p.has(i)||h.push({currentId:i,path:[...a],depth:e+1})}return r});function V(){const{query:{isDirty:o,isSaving:n,data:s,isLoading:c,isError:p},showIds:h,setShowIds:r,sampleSize:d,setSampleSize:m,cardSize:a,setCardSize:e,randomGroups:{nextSet:i}}=C();return t.jsxs(E,{children:[t.jsx(B,{hasResponseData:!g.isEmpty(s),isDirty:o,isError:p,isLoading:c||n}),t.jsxs(x,{children:[t.jsx(k,{label:"Show Ids",onChange:l=>r(l),value:h}),t.jsxs(b,{layout:"vertical",children:[t.jsx(I,{label:"Sample Size",onChange:l=>m(l),options:_,value:d}),t.jsx(I,{label:"Card Size",onChange:l=>e(l),options:q,value:a})]}),t.jsx(P,{block:!0,onClick:i,type:"primary",children:"New Random Sample"})]}),t.jsx(x,{children:t.jsx(D,{})}),t.jsx(x,{children:t.jsx(T,{block:!0,data:s,disabled:g.isEmpty(s),fileName:"imageCardsRelationships.json",loading:n})})]})}function Ct(){return t.jsx(L,{subtitle:"Connections",title:"Image Cards",children:t.jsx(O,{children:t.jsxs(S,{hasSider:!0,children:[t.jsx(V,{}),t.jsx(S.Content,{className:"content",children:t.jsx(A,{})})]})})})}export{Ct as default};
