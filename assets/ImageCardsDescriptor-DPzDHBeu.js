import{r as o,p as Ot,q as it,t as V,n as _e,o as ye,K,m as se,b6 as Qt,aP as Zt,b7 as et,G as je,E as er,x as tr,b8 as rr,y as kt,a3 as ar,aV as nr,aJ as Ve,M as or,N as lr,S as ir,O as de,aF as $t,k as Pe,W as sr,aB as cr,J as Ge,c as Ft,_ as Ht,j as k,F as tt,B as Je,a as ur,ap as dr,D as Et,P as vr,L as Rt}from"./index-CjsC1TtZ.js";import{D as Bt}from"./DataLoadingWrapper-DbTAjc0p.js";import{u as rt}from"./useQueryParams-BFUsLlWt.js";import{u as gr}from"./useTDResource-CgTNzwJv.js";import{u as Nt}from"./useImageCardsDecks-OQgMfL6Z.js";import{F as fr}from"./FullScreenModal-CGnfddA6.js";import{r as mr,a as hr}from"./index-YgvrMsJZ.js";import{I as Tt}from"./ImageCard-k-7nxG6e.js";import{S as br}from"./index-D0oCB7_Z.js";import{u as Cr}from"./useTablePagination-BYSwOQcL.js";import{F as yr}from"./Table-DJbfwj4P.js";import{D as Sr}from"./DownloadButton-1qxoB38Y.js";import{S as pr}from"./SaveButton-Bfn6maPN.js";import{S as xr}from"./SiderContent-rVr-yxwV.js";import{l as It,P as kr}from"./useBaseUrl-glcS4O2w.js";import{u as $r}from"./useResourceFirestoreData-BDp5Ub2V.js";import"./index-D6u6eGHY.js";import"./index-d8bleBx0.js";import"./PlusOutlined-B7QwJL71.js";import"./constants-Bda6tdl2.js";import"./Item-BoNlKYrN.js";import"./index-DcuP6F4H.js";import"./index--feDDYe-.js";import"./index-Bi6KRsS_.js";import"./index-BcKVWCkN.js";import"./scrollTo-DAKVis3x.js";import"./Pagination-CYIjXIN5.js";import"./moment-C5S46NFB.js";import"./SaveOutlined-Dkz9ip0R.js";import"./useGetFirestoreDoc-Bmv8r-Xh.js";import"./useUpdateFirestoreDoc-CmUMmRE7.js";import"./useMutation-B7KDZQSy.js";function st(e,t,r){return(e-t)/(r-t)}function ct(e,t,r,a){var l=st(t,r,a),s={};switch(e){case"rtl":s.right="".concat(l*100,"%"),s.transform="translateX(50%)";break;case"btt":s.bottom="".concat(l*100,"%"),s.transform="translateY(50%)";break;case"ttb":s.top="".concat(l*100,"%"),s.transform="translateY(-50%)";break;default:s.left="".concat(l*100,"%"),s.transform="translateX(-50%)";break}return s}function Le(e,t){return Array.isArray(e)?e[t]:e}var Ae=o.createContext({min:0,max:0,direction:"ltr",step:1,includedStart:0,includedEnd:0,tabIndex:0,keyboard:!0,styles:{},classNames:{}}),Er=o.createContext({}),Rr=["prefixCls","value","valueIndex","onStartMove","onDelete","style","render","dragging","draggingDelete","onOffsetChange","onChangeComplete","onFocus","onMouseEnter"],Dt=o.forwardRef(function(e,t){var r=e.prefixCls,a=e.value,l=e.valueIndex,s=e.onStartMove,d=e.onDelete,c=e.style,S=e.render,g=e.dragging,f=e.draggingDelete,y=e.onOffsetChange,p=e.onChangeComplete,b=e.onFocus,m=e.onMouseEnter,u=Ot(e,Rr),n=o.useContext(Ae),v=n.min,i=n.max,C=n.direction,D=n.disabled,M=n.keyboard,H=n.range,I=n.tabIndex,z=n.ariaLabelForHandle,w=n.ariaLabelledByForHandle,E=n.ariaRequired,x=n.ariaValueTextFormatterForHandle,$=n.styles,q=n.classNames,U="".concat(r,"-handle"),L=function(O){D||s(O,l)},J=function(O){b?.(O,l)},N=function(O){m(O,l)},Se=function(O){if(!D&&M){var R=null;switch(O.which||O.keyCode){case K.LEFT:R=C==="ltr"||C==="btt"?-1:1;break;case K.RIGHT:R=C==="ltr"||C==="btt"?1:-1;break;case K.UP:R=C!=="ttb"?1:-1;break;case K.DOWN:R=C!=="ttb"?-1:1;break;case K.HOME:R="min";break;case K.END:R="max";break;case K.PAGE_UP:R=2;break;case K.PAGE_DOWN:R=-2;break;case K.BACKSPACE:case K.DELETE:d?.(l);break}R!==null&&(O.preventDefault(),y(R,l))}},re=function(O){switch(O.which||O.keyCode){case K.LEFT:case K.RIGHT:case K.UP:case K.DOWN:case K.HOME:case K.END:case K.PAGE_UP:case K.PAGE_DOWN:p?.();break}},fe=ct(C,a,v,i),ve={};if(l!==null){var ae;ve={tabIndex:D?null:Le(I,l),role:"slider","aria-valuemin":v,"aria-valuemax":i,"aria-valuenow":a,"aria-disabled":D,"aria-label":Le(z,l),"aria-labelledby":Le(w,l),"aria-required":Le(E,l),"aria-valuetext":(ae=Le(x,l))===null||ae===void 0?void 0:ae(a),"aria-orientation":C==="ltr"||C==="rtl"?"horizontal":"vertical",onMouseDown:L,onTouchStart:L,onFocus:J,onMouseEnter:N,onKeyDown:Se,onKeyUp:re}}var pe=o.createElement("div",it({ref:t,className:_e(U,ye(ye(ye({},"".concat(U,"-").concat(l+1),l!==null&&H),"".concat(U,"-dragging"),g),"".concat(U,"-dragging-delete"),f),q.handle),style:V(V(V({},fe),c),$.handle)},ve,u));return S&&(pe=S(pe,{index:l,prefixCls:r,value:a,dragging:g,draggingDelete:f})),pe}),Dr=["prefixCls","style","onStartMove","onOffsetChange","values","handleRender","activeHandleRender","draggingIndex","draggingDelete","onFocus"],Mr=o.forwardRef(function(e,t){var r=e.prefixCls,a=e.style,l=e.onStartMove,s=e.onOffsetChange,d=e.values,c=e.handleRender,S=e.activeHandleRender,g=e.draggingIndex,f=e.draggingDelete,y=e.onFocus,p=Ot(e,Dr),b=o.useRef({}),m=o.useState(!1),u=se(m,2),n=u[0],v=u[1],i=o.useState(-1),C=se(i,2),D=C[0],M=C[1],H=function(x){M(x),v(!0)},I=function(x,$){H($),y?.(x)},z=function(x,$){H($)};o.useImperativeHandle(t,function(){return{focus:function(x){var $;($=b.current[x])===null||$===void 0||$.focus()},hideHelp:function(){Qt.flushSync(function(){v(!1)})}}});var w=V({prefixCls:r,onStartMove:l,onOffsetChange:s,render:c,onFocus:I,onMouseEnter:z},p);return o.createElement(o.Fragment,null,d.map(function(E,x){var $=g===x;return o.createElement(Dt,it({ref:function(U){U?b.current[x]=U:delete b.current[x]},dragging:$,draggingDelete:$&&f,style:Le(a,x),key:x,value:E,valueIndex:x},w))}),S&&n&&o.createElement(Dt,it({key:"a11y"},w,{value:d[D],valueIndex:null,dragging:g!==-1,draggingDelete:f,render:S,style:{pointerEvents:"none"},tabIndex:null,"aria-hidden":!0})))}),wr=function(t){var r=t.prefixCls,a=t.style,l=t.children,s=t.value,d=t.onClick,c=o.useContext(Ae),S=c.min,g=c.max,f=c.direction,y=c.includedStart,p=c.includedEnd,b=c.included,m="".concat(r,"-text"),u=ct(f,s,S,g);return o.createElement("span",{className:_e(m,ye({},"".concat(m,"-active"),b&&y<=s&&s<=p)),style:V(V({},u),a),onMouseDown:function(v){v.stopPropagation()},onClick:function(){d(s)}},l)},Pr=function(t){var r=t.prefixCls,a=t.marks,l=t.onClick,s="".concat(r,"-mark");return a.length?o.createElement("div",{className:s},a.map(function(d){var c=d.value,S=d.style,g=d.label;return o.createElement(wr,{key:c,prefixCls:s,style:S,value:c,onClick:l},g)})):null},jr=function(t){var r=t.prefixCls,a=t.value,l=t.style,s=t.activeStyle,d=o.useContext(Ae),c=d.min,S=d.max,g=d.direction,f=d.included,y=d.includedStart,p=d.includedEnd,b="".concat(r,"-dot"),m=f&&y<=a&&a<=p,u=V(V({},ct(g,a,c,S)),typeof l=="function"?l(a):l);return m&&(u=V(V({},u),typeof s=="function"?s(a):s)),o.createElement("span",{className:_e(b,ye({},"".concat(b,"-active"),m)),style:u})},Or=function(t){var r=t.prefixCls,a=t.marks,l=t.dots,s=t.style,d=t.activeStyle,c=o.useContext(Ae),S=c.min,g=c.max,f=c.step,y=o.useMemo(function(){var p=new Set;if(a.forEach(function(m){p.add(m.value)}),l&&f!==null)for(var b=S;b<=g;)p.add(b),b+=f;return Array.from(p)},[S,g,f,l,a]);return o.createElement("div",{className:"".concat(r,"-step")},y.map(function(p){return o.createElement(jr,{prefixCls:r,key:p,value:p,style:s,activeStyle:d})}))},Mt=function(t){var r=t.prefixCls,a=t.style,l=t.start,s=t.end,d=t.index,c=t.onStartMove,S=t.replaceCls,g=o.useContext(Ae),f=g.direction,y=g.min,p=g.max,b=g.disabled,m=g.range,u=g.classNames,n="".concat(r,"-track"),v=st(l,y,p),i=st(s,y,p),C=function(I){!b&&c&&c(I,-1)},D={};switch(f){case"rtl":D.right="".concat(v*100,"%"),D.width="".concat(i*100-v*100,"%");break;case"btt":D.bottom="".concat(v*100,"%"),D.height="".concat(i*100-v*100,"%");break;case"ttb":D.top="".concat(v*100,"%"),D.height="".concat(i*100-v*100,"%");break;default:D.left="".concat(v*100,"%"),D.width="".concat(i*100-v*100,"%")}var M=S||_e(n,ye(ye({},"".concat(n,"-").concat(d+1),d!==null&&m),"".concat(r,"-track-draggable"),c),u.track);return o.createElement("div",{className:M,style:V(V({},D),a),onMouseDown:C,onTouchStart:C})},Fr=function(t){var r=t.prefixCls,a=t.style,l=t.values,s=t.startPoint,d=t.onStartMove,c=o.useContext(Ae),S=c.included,g=c.range,f=c.min,y=c.styles,p=c.classNames,b=o.useMemo(function(){if(!g){if(l.length===0)return[];var u=s??f,n=l[0];return[{start:Math.min(u,n),end:Math.max(u,n)}]}for(var v=[],i=0;i<l.length-1;i+=1)v.push({start:l[i],end:l[i+1]});return v},[l,g,s,f]);if(!S)return null;var m=b!=null&&b.length&&(p.tracks||y.tracks)?o.createElement(Mt,{index:null,prefixCls:r,start:b[0].start,end:b[b.length-1].end,replaceCls:_e(p.tracks,"".concat(r,"-tracks")),style:y.tracks}):null;return o.createElement(o.Fragment,null,m,b.map(function(u,n){var v=u.start,i=u.end;return o.createElement(Mt,{index:n,prefixCls:r,style:V(V({},Le(a,n)),y.track),start:v,end:i,key:n,onStartMove:d})}))},Hr=130;function wt(e){var t="targetTouches"in e?e.targetTouches[0]:e;return{pageX:t.pageX,pageY:t.pageY}}function Br(e,t,r,a,l,s,d,c,S,g,f){var y=o.useState(null),p=se(y,2),b=p[0],m=p[1],u=o.useState(-1),n=se(u,2),v=n[0],i=n[1],C=o.useState(!1),D=se(C,2),M=D[0],H=D[1],I=o.useState(r),z=se(I,2),w=z[0],E=z[1],x=o.useState(r),$=se(x,2),q=$[0],U=$[1],L=o.useRef(null),J=o.useRef(null),N=o.useRef(null),Se=o.useContext(Er),re=Se.onDragStart,fe=Se.onDragChange;Zt(function(){v===-1&&E(r)},[r,v]),o.useEffect(function(){return function(){document.removeEventListener("mousemove",L.current),document.removeEventListener("mouseup",J.current),N.current&&(N.current.removeEventListener("touchmove",L.current),N.current.removeEventListener("touchend",J.current))}},[]);var ve=function(R,_,A){_!==void 0&&m(_),E(R);var Z=R;A&&(Z=R.filter(function(T,X){return X!==v})),d(Z),fe&&fe({rawValues:R,deleteIndex:A?v:-1,draggingIndex:v,draggingValue:_})},ae=et(function(O,R,_){if(O===-1){var A=q[0],Z=q[q.length-1],T=a-A,X=l-Z,ne=R*(l-a);ne=Math.max(ne,T),ne=Math.min(ne,X);var ce=s(A+ne);ne=ce-A;var me=q.map(function(ge){return ge+ne});ve(me)}else{var he=(l-a)*R,be=je(w);be[O]=q[O];var xe=S(be,he,O,"dist");ve(xe.values,xe.value,_)}}),pe=function(R,_,A){R.stopPropagation();var Z=A||r,T=Z[_];i(_),m(T),U(Z),E(Z),H(!1);var X=wt(R),ne=X.pageX,ce=X.pageY,me=!1;re&&re({rawValues:Z,draggingIndex:_,draggingValue:T});var he=function(ge){ge.preventDefault();var oe=wt(ge),Oe=oe.pageX,Fe=oe.pageY,$e=Oe-ne,ue=Fe-ce,F=e.current.getBoundingClientRect(),Y=F.width,ke=F.height,Ce,le;switch(t){case"btt":Ce=-ue/ke,le=$e;break;case"ttb":Ce=ue/ke,le=$e;break;case"rtl":Ce=-$e/Y,le=ue;break;default:Ce=$e/Y,le=ue}me=g?Math.abs(le)>Hr&&f<w.length:!1,H(me),ae(_,Ce,me)},be=function xe(ge){ge.preventDefault(),document.removeEventListener("mouseup",xe),document.removeEventListener("mousemove",he),N.current&&(N.current.removeEventListener("touchmove",L.current),N.current.removeEventListener("touchend",J.current)),L.current=null,J.current=null,N.current=null,c(me),i(-1),H(!1)};document.addEventListener("mouseup",be),document.addEventListener("mousemove",he),R.currentTarget.addEventListener("touchend",be),R.currentTarget.addEventListener("touchmove",he),L.current=he,J.current=be,N.current=R.currentTarget},Q=o.useMemo(function(){var O=je(r).sort(function(T,X){return T-X}),R=je(w).sort(function(T,X){return T-X}),_={};R.forEach(function(T){_[T]=(_[T]||0)+1}),O.forEach(function(T){_[T]=(_[T]||0)-1});var A=g?1:0,Z=Object.values(_).reduce(function(T,X){return T+Math.abs(X)},0);return Z<=A?w:r},[r,w,g]);return[v,b,M,Q,pe]}function Nr(e,t,r,a,l,s){var d=o.useCallback(function(b){return Math.max(e,Math.min(t,b))},[e,t]),c=o.useCallback(function(b){if(r!==null){var m=e+Math.round((d(b)-e)/r)*r,u=function(C){return(String(C).split(".")[1]||"").length},n=Math.max(u(r),u(t),u(e)),v=Number(m.toFixed(n));return e<=v&&v<=t?v:null}return null},[r,e,t,d]),S=o.useCallback(function(b){var m=d(b),u=a.map(function(i){return i.value});r!==null&&u.push(c(b)),u.push(e,t);var n=u[0],v=t-e;return u.forEach(function(i){var C=Math.abs(m-i);C<=v&&(n=i,v=C)}),n},[e,t,a,r,d,c]),g=function b(m,u,n){var v=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"unit";if(typeof u=="number"){var i,C=m[n],D=C+u,M=[];a.forEach(function(E){M.push(E.value)}),M.push(e,t),M.push(c(C));var H=u>0?1:-1;v==="unit"?M.push(c(C+H*r)):M.push(c(D)),M=M.filter(function(E){return E!==null}).filter(function(E){return u<0?E<=C:E>=C}),v==="unit"&&(M=M.filter(function(E){return E!==C}));var I=v==="unit"?C:D;i=M[0];var z=Math.abs(i-I);if(M.forEach(function(E){var x=Math.abs(E-I);x<z&&(i=E,z=x)}),i===void 0)return u<0?e:t;if(v==="dist")return i;if(Math.abs(u)>1){var w=je(m);return w[n]=i,b(w,u-H,n,v)}return i}else{if(u==="min")return e;if(u==="max")return t}},f=function(m,u,n){var v=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"unit",i=m[n],C=g(m,u,n,v);return{value:C,changed:C!==i}},y=function(m){return s===null&&m===0||typeof s=="number"&&m<s},p=function(m,u,n){var v=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"unit",i=m.map(S),C=i[n],D=g(i,u,n,v);if(i[n]=D,l===!1){var M=s||0;n>0&&i[n-1]!==C&&(i[n]=Math.max(i[n],i[n-1]+M)),n<i.length-1&&i[n+1]!==C&&(i[n]=Math.min(i[n],i[n+1]-M))}else if(typeof s=="number"||s===null){for(var H=n+1;H<i.length;H+=1)for(var I=!0;y(i[H]-i[H-1])&&I;){var z=f(i,1,H);i[H]=z.value,I=z.changed}for(var w=n;w>0;w-=1)for(var E=!0;y(i[w]-i[w-1])&&E;){var x=f(i,-1,w-1);i[w-1]=x.value,E=x.changed}for(var $=i.length-1;$>0;$-=1)for(var q=!0;y(i[$]-i[$-1])&&q;){var U=f(i,-1,$-1);i[$-1]=U.value,q=U.changed}for(var L=0;L<i.length-1;L+=1)for(var J=!0;y(i[L+1]-i[L])&&J;){var N=f(i,1,L+1);i[L+1]=N.value,J=N.changed}}return{value:i[n],values:i}};return[S,p]}function Tr(e){return o.useMemo(function(){if(e===!0||!e)return[!!e,!1,!1,0];var t=e.editable,r=e.draggableTrack,a=e.minCount,l=e.maxCount;return[!0,t,!t&&r,a||0,l]},[e])}var Ir=o.forwardRef(function(e,t){var r=e.prefixCls,a=r===void 0?"rc-slider":r,l=e.className,s=e.style,d=e.classNames,c=e.styles,S=e.id,g=e.disabled,f=g===void 0?!1:g,y=e.keyboard,p=y===void 0?!0:y,b=e.autoFocus,m=e.onFocus,u=e.onBlur,n=e.min,v=n===void 0?0:n,i=e.max,C=i===void 0?100:i,D=e.step,M=D===void 0?1:D,H=e.value,I=e.defaultValue,z=e.range,w=e.count,E=e.onChange,x=e.onBeforeChange,$=e.onAfterChange,q=e.onChangeComplete,U=e.allowCross,L=U===void 0?!0:U,J=e.pushable,N=J===void 0?!1:J,Se=e.reverse,re=e.vertical,fe=e.included,ve=fe===void 0?!0:fe,ae=e.startPoint,pe=e.trackStyle,Q=e.handleStyle,O=e.railStyle,R=e.dotStyle,_=e.activeDotStyle,A=e.marks,Z=e.dots,T=e.handleRender,X=e.activeHandleRender,ne=e.track,ce=e.tabIndex,me=ce===void 0?0:ce,he=e.ariaLabelForHandle,be=e.ariaLabelledByForHandle,xe=e.ariaRequired,ge=e.ariaValueTextFormatterForHandle,oe=o.useRef(null),Oe=o.useRef(null),Fe=o.useMemo(function(){return re?Se?"ttb":"btt":Se?"rtl":"ltr"},[Se,re]),$e=Tr(z),ue=se($e,5),F=ue[0],Y=ue[1],ke=ue[2],Ce=ue[3],le=ue[4],ie=o.useMemo(function(){return isFinite(v)?v:0},[v]),Ee=o.useMemo(function(){return isFinite(C)?C:100},[C]),Re=o.useMemo(function(){return M!==null&&M<=0?1:M},[M]),G=o.useMemo(function(){return typeof N=="boolean"?N?Re:!1:N>=0?N:!1},[N,Re]),ee=o.useMemo(function(){return Object.keys(A||{}).map(function(P){var h=A[P],j={value:Number(P)};return h&&er(h)==="object"&&!o.isValidElement(h)&&("label"in h||"style"in h)?(j.style=h.style,j.label=h.label):j.label=h,j}).filter(function(P){var h=P.label;return h||typeof h=="number"}).sort(function(P,h){return P.value-h.value})},[A]),at=Nr(ie,Ee,Re,ee,L,G),We=se(at,2),He=We[0],Ke=We[1],Ue=tr(I,{value:H}),ut=se(Ue,2),Be=ut[0],At=ut[1],te=o.useMemo(function(){var P=Be==null?[]:Array.isArray(Be)?Be:[Be],h=se(P,1),j=h[0],B=j===void 0?ie:j,W=Be===null?[]:[B];if(F){if(W=je(P),w||Be===void 0){var Ne=w>=0?w+1:2;for(W=W.slice(0,Ne);W.length<Ne;){var De;W.push((De=W[W.length-1])!==null&&De!==void 0?De:ie)}}W.sort(function(Me,we){return Me-we})}return W.forEach(function(Me,we){W[we]=He(Me)}),W},[Be,F,ie,w,He]),ze=function(h){return F?h:h[0]},Qe=et(function(P){var h=je(P).sort(function(j,B){return j-B});E&&!rr(h,te,!0)&&E(ze(h)),At(h)}),dt=et(function(P){P&&oe.current.hideHelp();var h=ze(te);$?.(h),kt(!$,"[rc-slider] `onAfterChange` is deprecated. Please use `onChangeComplete` instead."),q?.(h)}),zt=function(h){if(!(f||!Y||te.length<=Ce)){var j=je(te);j.splice(h,1),x?.(ze(j)),Qe(j);var B=Math.max(0,h-1);oe.current.hideHelp(),oe.current.focus(B)}},qt=Br(Oe,Fe,te,ie,Ee,He,Qe,dt,Ke,Y,Ce),Xe=se(qt,5),vt=Xe[0],Wt=Xe[1],Kt=Xe[2],nt=Xe[3],gt=Xe[4],ft=function(h,j){if(!f){var B=je(te),W=0,Ne=0,De=Ee-ie;te.forEach(function(Te,Ze){var xt=Math.abs(h-Te);xt<=De&&(De=xt,W=Ze),Te<h&&(Ne=Ze)});var Me=W;Y&&De!==0&&(!le||te.length<le)?(B.splice(Ne+1,0,h),Me=Ne+1):B[W]=h,F&&!te.length&&w===void 0&&B.push(h);var we=ze(B);if(x?.(we),Qe(B),j){var Ie,qe;(Ie=document.activeElement)===null||Ie===void 0||(qe=Ie.blur)===null||qe===void 0||qe.call(Ie),oe.current.focus(Me),gt(j,Me,B)}else $?.(we),kt(!$,"[rc-slider] `onAfterChange` is deprecated. Please use `onChangeComplete` instead."),q?.(we)}},Ut=function(h){h.preventDefault();var j=Oe.current.getBoundingClientRect(),B=j.width,W=j.height,Ne=j.left,De=j.top,Me=j.bottom,we=j.right,Ie=h.clientX,qe=h.clientY,Te;switch(Fe){case"btt":Te=(Me-qe)/W;break;case"ttb":Te=(qe-De)/W;break;case"rtl":Te=(we-Ie)/B;break;default:Te=(Ie-Ne)/B}var Ze=ie+Te*(Ee-ie);ft(He(Ze),h)},Xt=o.useState(null),mt=se(Xt,2),ot=mt[0],ht=mt[1],Yt=function(h,j){if(!f){var B=Ke(te,h,j);x?.(ze(te)),Qe(B.values),ht(B.value)}};o.useEffect(function(){if(ot!==null){var P=te.indexOf(ot);P>=0&&oe.current.focus(P)}ht(null)},[ot]);var Gt=o.useMemo(function(){return ke&&Re===null?!1:ke},[ke,Re]),bt=et(function(P,h){gt(P,h),x?.(ze(te))}),Ct=vt!==-1;o.useEffect(function(){if(!Ct){var P=te.lastIndexOf(Wt);oe.current.focus(P)}},[Ct]);var Ye=o.useMemo(function(){return je(nt).sort(function(P,h){return P-h})},[nt]),Vt=o.useMemo(function(){return F?[Ye[0],Ye[Ye.length-1]]:[ie,Ye[0]]},[Ye,F,ie]),yt=se(Vt,2),St=yt[0],pt=yt[1];o.useImperativeHandle(t,function(){return{focus:function(){oe.current.focus(0)},blur:function(){var h,j=document,B=j.activeElement;(h=Oe.current)!==null&&h!==void 0&&h.contains(B)&&B?.blur()}}}),o.useEffect(function(){b&&oe.current.focus(0)},[]);var Jt=o.useMemo(function(){return{min:ie,max:Ee,direction:Fe,disabled:f,keyboard:p,step:Re,included:ve,includedStart:St,includedEnd:pt,range:F,tabIndex:me,ariaLabelForHandle:he,ariaLabelledByForHandle:be,ariaRequired:xe,ariaValueTextFormatterForHandle:ge,styles:c||{},classNames:d||{}}},[ie,Ee,Fe,f,p,Re,ve,St,pt,F,me,he,be,xe,ge,c,d]);return o.createElement(Ae.Provider,{value:Jt},o.createElement("div",{ref:Oe,className:_e(a,l,ye(ye(ye(ye({},"".concat(a,"-disabled"),f),"".concat(a,"-vertical"),re),"".concat(a,"-horizontal"),!re),"".concat(a,"-with-marks"),ee.length)),style:s,onMouseDown:Ut,id:S},o.createElement("div",{className:_e("".concat(a,"-rail"),d?.rail),style:V(V({},O),c?.rail)}),ne!==!1&&o.createElement(Fr,{prefixCls:a,style:pe,values:te,startPoint:ae,onStartMove:Gt?bt:void 0}),o.createElement(Or,{prefixCls:a,marks:ee,dots:Z,style:R,activeStyle:_}),o.createElement(Mr,{ref:oe,prefixCls:a,style:Q,values:nt,draggingIndex:vt,draggingDelete:Kt,onStartMove:bt,onOffsetChange:Yt,onFocus:m,onBlur:u,handleRender:T,activeHandleRender:X,onChangeComplete:dt,onDelete:Y?zt:void 0}),o.createElement(Pr,{prefixCls:a,marks:ee,onClick:ft})))});const Lr=o.createContext({}),Pt=o.forwardRef((e,t)=>{const{open:r,draggingDelete:a,value:l}=e,s=o.useRef(null),d=r&&!a,c=o.useRef(null);function S(){Ve.cancel(c.current),c.current=null}function g(){c.current=Ve(()=>{var f;(f=s.current)===null||f===void 0||f.forceAlign(),c.current=null})}return o.useEffect(()=>(d?g():S(),S),[d,e.title,l]),o.createElement(ar,Object.assign({ref:nr(s,t)},e,{open:d}))}),_r=e=>{const{componentCls:t,antCls:r,controlSize:a,dotSize:l,marginFull:s,marginPart:d,colorFillContentHover:c,handleColorDisabled:S,calc:g,handleSize:f,handleSizeHover:y,handleActiveColor:p,handleActiveOutlineColor:b,handleLineWidth:m,handleLineWidthHover:u,motionDurationMid:n}=e;return{[t]:Object.assign(Object.assign({},ir(e)),{position:"relative",height:a,margin:`${de(d)} ${de(s)}`,padding:0,cursor:"pointer",touchAction:"none","&-vertical":{margin:`${de(s)} ${de(d)}`},[`${t}-rail`]:{position:"absolute",backgroundColor:e.railBg,borderRadius:e.borderRadiusXS,transition:`background-color ${n}`},[`${t}-track,${t}-tracks`]:{position:"absolute",transition:`background-color ${n}`},[`${t}-track`]:{backgroundColor:e.trackBg,borderRadius:e.borderRadiusXS},[`${t}-track-draggable`]:{boxSizing:"content-box",backgroundClip:"content-box",border:"solid rgba(0,0,0,0)"},"&:hover":{[`${t}-rail`]:{backgroundColor:e.railHoverBg},[`${t}-track`]:{backgroundColor:e.trackHoverBg},[`${t}-dot`]:{borderColor:c},[`${t}-handle::after`]:{boxShadow:`0 0 0 ${de(m)} ${e.colorPrimaryBorderHover}`},[`${t}-dot-active`]:{borderColor:e.dotActiveBorderColor}},[`${t}-handle`]:{position:"absolute",width:f,height:f,outline:"none",userSelect:"none","&-dragging-delete":{opacity:0},"&::before":{content:'""',position:"absolute",insetInlineStart:g(m).mul(-1).equal(),insetBlockStart:g(m).mul(-1).equal(),width:g(f).add(g(m).mul(2)).equal(),height:g(f).add(g(m).mul(2)).equal(),backgroundColor:"transparent"},"&::after":{content:'""',position:"absolute",insetBlockStart:0,insetInlineStart:0,width:f,height:f,backgroundColor:e.colorBgElevated,boxShadow:`0 0 0 ${de(m)} ${e.handleColor}`,outline:"0px solid transparent",borderRadius:"50%",cursor:"pointer",transition:`
            inset-inline-start ${n},
            inset-block-start ${n},
            width ${n},
            height ${n},
            box-shadow ${n},
            outline ${n}
          `},"&:hover, &:active, &:focus":{"&::before":{insetInlineStart:g(y).sub(f).div(2).add(u).mul(-1).equal(),insetBlockStart:g(y).sub(f).div(2).add(u).mul(-1).equal(),width:g(y).add(g(u).mul(2)).equal(),height:g(y).add(g(u).mul(2)).equal()},"&::after":{boxShadow:`0 0 0 ${de(u)} ${p}`,outline:`6px solid ${b}`,width:y,height:y,insetInlineStart:e.calc(f).sub(y).div(2).equal(),insetBlockStart:e.calc(f).sub(y).div(2).equal()}}},[`&-lock ${t}-handle`]:{"&::before, &::after":{transition:"none"}},[`${t}-mark`]:{position:"absolute",fontSize:e.fontSize},[`${t}-mark-text`]:{position:"absolute",display:"inline-block",color:e.colorTextDescription,textAlign:"center",wordBreak:"keep-all",cursor:"pointer",userSelect:"none","&-active":{color:e.colorText}},[`${t}-step`]:{position:"absolute",background:"transparent",pointerEvents:"none"},[`${t}-dot`]:{position:"absolute",width:l,height:l,backgroundColor:e.colorBgElevated,border:`${de(m)} solid ${e.dotBorderColor}`,borderRadius:"50%",cursor:"pointer",transition:`border-color ${e.motionDurationSlow}`,pointerEvents:"auto","&-active":{borderColor:e.dotActiveBorderColor}},[`&${t}-disabled`]:{cursor:"not-allowed",[`${t}-rail`]:{backgroundColor:`${e.railBg} !important`},[`${t}-track`]:{backgroundColor:`${e.trackBgDisabled} !important`},[`
          ${t}-dot
        `]:{backgroundColor:e.colorBgElevated,borderColor:e.trackBgDisabled,boxShadow:"none",cursor:"not-allowed"},[`${t}-handle::after`]:{backgroundColor:e.colorBgElevated,cursor:"not-allowed",width:f,height:f,boxShadow:`0 0 0 ${de(m)} ${S}`,insetInlineStart:0,insetBlockStart:0},[`
          ${t}-mark-text,
          ${t}-dot
        `]:{cursor:"not-allowed !important"}},[`&-tooltip ${r}-tooltip-inner`]:{minWidth:"unset"}})}},Lt=(e,t)=>{const{componentCls:r,railSize:a,handleSize:l,dotSize:s,marginFull:d,calc:c}=e,S=t?"paddingBlock":"paddingInline",g=t?"width":"height",f=t?"height":"width",y=t?"insetBlockStart":"insetInlineStart",p=t?"top":"insetInlineStart",b=c(a).mul(3).sub(l).div(2).equal(),m=c(l).sub(a).div(2).equal(),u=t?{borderWidth:`${de(m)} 0`,transform:`translateY(${de(c(m).mul(-1).equal())})`}:{borderWidth:`0 ${de(m)}`,transform:`translateX(${de(e.calc(m).mul(-1).equal())})`};return{[S]:a,[f]:c(a).mul(3).equal(),[`${r}-rail`]:{[g]:"100%",[f]:a},[`${r}-track,${r}-tracks`]:{[f]:a},[`${r}-track-draggable`]:Object.assign({},u),[`${r}-handle`]:{[y]:b},[`${r}-mark`]:{insetInlineStart:0,top:0,[p]:c(a).mul(3).add(t?0:d).equal(),[g]:"100%"},[`${r}-step`]:{insetInlineStart:0,top:0,[p]:a,[g]:"100%",[f]:a},[`${r}-dot`]:{position:"absolute",[y]:c(a).sub(s).div(2).equal()}}},Ar=e=>{const{componentCls:t,marginPartWithMark:r}=e;return{[`${t}-horizontal`]:Object.assign(Object.assign({},Lt(e,!0)),{[`&${t}-with-marks`]:{marginBottom:r}})}},zr=e=>{const{componentCls:t}=e;return{[`${t}-vertical`]:Object.assign(Object.assign({},Lt(e,!1)),{height:"100%"})}},qr=e=>{const r=e.controlHeightLG/4,a=e.controlHeightSM/2,l=e.lineWidth+1,s=e.lineWidth+1*1.5,d=e.colorPrimary,c=new $t(d).setA(.2).toRgbString();return{controlSize:r,railSize:4,handleSize:r,handleSizeHover:a,dotSize:8,handleLineWidth:l,handleLineWidthHover:s,railBg:e.colorFillTertiary,railHoverBg:e.colorFillSecondary,trackBg:e.colorPrimaryBorder,trackHoverBg:e.colorPrimaryBorderHover,handleColor:e.colorPrimaryBorder,handleActiveColor:d,handleActiveOutlineColor:c,handleColorDisabled:new $t(e.colorTextDisabled).onBackground(e.colorBgContainer).toHexString(),dotBorderColor:e.colorBorderSecondary,dotActiveBorderColor:e.colorPrimaryBorder,trackBgDisabled:e.colorBgContainerDisabled}},Wr=or("Slider",e=>{const t=lr(e,{marginPart:e.calc(e.controlHeight).sub(e.controlSize).div(2).equal(),marginFull:e.calc(e.controlSize).div(2).equal(),marginPartWithMark:e.calc(e.controlHeightLG).sub(e.controlSize).equal()});return[_r(t),Ar(t),zr(t)]},qr);function lt(){const[e,t]=o.useState(!1),r=o.useRef(null),a=()=>{Ve.cancel(r.current)},l=s=>{a(),s?t(s):r.current=Ve(()=>{t(s)})};return o.useEffect(()=>a,[]),[e,l]}var Kr=function(e,t){var r={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(r[a]=e[a]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var l=0,a=Object.getOwnPropertySymbols(e);l<a.length;l++)t.indexOf(a[l])<0&&Object.prototype.propertyIsEnumerable.call(e,a[l])&&(r[a[l]]=e[a[l]]);return r};function Ur(e,t){return e||e===null?e:t||t===null?t:r=>typeof r=="number"?r.toString():""}const Xr=Pe.forwardRef((e,t)=>{const{prefixCls:r,range:a,className:l,rootClassName:s,style:d,disabled:c,tooltipPrefixCls:S,tipFormatter:g,tooltipVisible:f,getTooltipPopupContainer:y,tooltipPlacement:p,tooltip:b={},onChangeComplete:m,classNames:u,styles:n}=e,v=Kr(e,["prefixCls","range","className","rootClassName","style","disabled","tooltipPrefixCls","tipFormatter","tooltipVisible","getTooltipPopupContainer","tooltipPlacement","tooltip","onChangeComplete","classNames","styles"]),{vertical:i}=e,{getPrefixCls:C,direction:D,className:M,style:H,classNames:I,styles:z,getPopupContainer:w}=sr("slider"),E=Pe.useContext(cr),x=c??E,{handleRender:$,direction:q}=Pe.useContext(Lr),L=(q||D)==="rtl",[J,N]=lt(),[Se,re]=lt(),fe=Object.assign({},b),{open:ve,placement:ae,getPopupContainer:pe,prefixCls:Q,formatter:O}=fe,R=ve??f,_=(J||Se)&&R!==!1,A=Ur(O,g),[Z,T]=lt(),X=F=>{m?.(F),T(!1)},ne=(F,Y)=>F||(Y?L?"left":"right":"top"),ce=C("slider",r),[me,he,be]=Wr(ce),xe=Ge(l,M,I.root,u?.root,s,{[`${ce}-rtl`]:L,[`${ce}-lock`]:Z},he,be);L&&!v.vertical&&(v.reverse=!v.reverse),Pe.useEffect(()=>{const F=()=>{Ve(()=>{re(!1)},1)};return document.addEventListener("mouseup",F),()=>{document.removeEventListener("mouseup",F)}},[]);const ge=a&&!R,oe=$||((F,Y)=>{const{index:ke}=Y,Ce=F.props;function le(G,ee,at){var We,He,Ke,Ue;at&&((He=(We=v)[G])===null||He===void 0||He.call(We,ee)),(Ue=(Ke=Ce)[G])===null||Ue===void 0||Ue.call(Ke,ee)}const ie=Object.assign(Object.assign({},Ce),{onMouseEnter:G=>{N(!0),le("onMouseEnter",G)},onMouseLeave:G=>{N(!1),le("onMouseLeave",G)},onMouseDown:G=>{re(!0),T(!0),le("onMouseDown",G)},onFocus:G=>{var ee;re(!0),(ee=v.onFocus)===null||ee===void 0||ee.call(v,G),le("onFocus",G,!0)},onBlur:G=>{var ee;re(!1),(ee=v.onBlur)===null||ee===void 0||ee.call(v,G),le("onBlur",G,!0)}}),Ee=Pe.cloneElement(F,ie),Re=(!!R||_)&&A!==null;return ge?Ee:Pe.createElement(Pt,Object.assign({},fe,{prefixCls:C("tooltip",Q??S),title:A?A(Y.value):"",value:Y.value,open:Re,placement:ne(ae??p,i),key:ke,classNames:{root:`${ce}-tooltip`},getPopupContainer:pe||y||w}),Ee)}),Oe=ge?(F,Y)=>{const ke=Pe.cloneElement(F,{style:Object.assign(Object.assign({},F.props.style),{visibility:"hidden"})});return Pe.createElement(Pt,Object.assign({},fe,{prefixCls:C("tooltip",Q??S),title:A?A(Y.value):"",open:A!==null&&_,placement:ne(ae??p,i),key:"tooltip",classNames:{root:`${ce}-tooltip`},getPopupContainer:pe||y||w,draggingDelete:Y.draggingDelete}),ke)}:void 0,Fe=Object.assign(Object.assign(Object.assign(Object.assign({},z.root),H),n?.root),d),$e=Object.assign(Object.assign({},z.tracks),n?.tracks),ue=Ge(I.tracks,u?.tracks);return me(Pe.createElement(Ir,Object.assign({},v,{classNames:Object.assign({handle:Ge(I.handle,u?.handle),rail:Ge(I.rail,u?.rail),track:Ge(I.track,u?.track)},ue?{tracks:ue}:{}),styles:Object.assign({handle:Object.assign(Object.assign({},z.handle),n?.handle),rail:Object.assign(Object.assign({},z.rail),n?.rail),track:Object.assign(Object.assign({},z.track),n?.track)},Object.keys($e).length?{tracks:$e}:{}),step:v.step,range:a,className:xe,style:Fe,disabled:x,ref:t,prefixCls:ce,handleRender:oe,activeHandleRender:Oe,onChangeComplete:X})))});var Yr={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M923 283.6a260.04 260.04 0 00-56.9-82.8 264.4 264.4 0 00-84-55.5A265.34 265.34 0 00679.7 125c-49.3 0-97.4 13.5-139.2 39-10 6.1-19.5 12.8-28.5 20.1-9-7.3-18.5-14-28.5-20.1-41.8-25.5-89.9-39-139.2-39-35.5 0-69.9 6.8-102.4 20.3-31.4 13-59.7 31.7-84 55.5a258.44 258.44 0 00-56.9 82.8c-13.9 32.3-21 66.6-21 101.9 0 33.3 6.8 68 20.3 103.3 11.3 29.5 27.5 60.1 48.2 91 32.8 48.9 77.9 99.9 133.9 151.6 92.8 85.7 184.7 144.9 188.6 147.3l23.7 15.2c10.5 6.7 24 6.7 34.5 0l23.7-15.2c3.9-2.5 95.7-61.6 188.6-147.3 56-51.7 101.1-102.7 133.9-151.6 20.7-30.9 37-61.5 48.2-91 13.5-35.3 20.3-70 20.3-103.3.1-35.3-7-69.6-20.9-101.9z"}}]},name:"heart",theme:"filled"},Gr=function(t,r){return o.createElement(Ft,Ht({},t,{ref:r,icon:Yr}))},Vr=o.forwardRef(Gr),Jr={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M923 283.6a260.04 260.04 0 00-56.9-82.8 264.4 264.4 0 00-84-55.5A265.34 265.34 0 00679.7 125c-49.3 0-97.4 13.5-139.2 39-10 6.1-19.5 12.8-28.5 20.1-9-7.3-18.5-14-28.5-20.1-41.8-25.5-89.9-39-139.2-39-35.5 0-69.9 6.8-102.4 20.3-31.4 13-59.7 31.7-84 55.5a258.44 258.44 0 00-56.9 82.8c-13.9 32.3-21 66.6-21 101.9 0 33.3 6.8 68 20.3 103.3 11.3 29.5 27.5 60.1 48.2 91 32.8 48.9 77.9 99.9 133.9 151.6 92.8 85.7 184.7 144.9 188.6 147.3l23.7 15.2c10.5 6.7 24 6.7 34.5 0l23.7-15.2c3.9-2.5 95.7-61.6 188.6-147.3 56-51.7 101.1-102.7 133.9-151.6 20.7-30.9 37-61.5 48.2-91 13.5-35.3 20.3-70 20.3-103.3.1-35.3-7-69.6-20.9-101.9zM512 814.8S156 586.7 156 385.5C156 283.6 240.3 201 344.3 201c73.1 0 136.5 40.8 167.7 100.4C543.2 241.8 606.6 201 679.7 201c104 0 188.3 82.6 188.3 184.5 0 201.2-356 429.3-356 429.3z"}}]},name:"heart",theme:"outlined"},Qr=function(t,r){return o.createElement(Ft,Ht({},t,{ref:r,icon:Jr}))},Zr=o.forwardRef(Qr);const jt=200;function ea({data:e,addEntryToUpdate:t,onClose:r,onNewCard:a}){const{queryParams:l,removeParam:s,addParam:d}=rt(),c=Number(l.get("cardSize")??jt),S=l.get("cardId"),g=e[S??""]??{id:S,keywords:[]};return k.jsx(fr,{actions:[k.jsx(Je,{className:"my-10",onClick:r,children:"Close"},"cancel"),k.jsx(Je,{className:"my-10",onClick:a,children:"New Card"},"cancel")],cover:k.jsx(tt,{align:"center",justify:"center",style:{width:"100vw"},children:k.jsx(Tt,{cardId:S??"",width:c})}),onClose:()=>s("cardId"),open:!!S,title:`Image Card Descriptor for ${S}`,children:k.jsxs(tt,{gap:8,style:{maxWidth:"500px"},vertical:!0,children:[k.jsx(Xr,{max:500,min:100,onChange:f=>d("cardSize",f,jt),step:25,style:{maxWidth:500,width:"100%"},value:c}),k.jsx(_t,{addEntryToUpdate:t,imageCard:g,size:"large"}),k.jsx(ta,{addEntryToUpdate:t,imageCard:g,size:"large"}),k.jsx(ra,{addEntryToUpdate:t,imageCard:g,size:"large"})]},S)})}function _t({imageCard:e,addEntryToUpdate:t,...r}){const a=e.favorite;return k.jsx(Je,{icon:a?k.jsx(Vr,{style:{color:"red"}}):k.jsx(Zr,{}),onClick:()=>t(e.id,{...e,favorite:!a}),shape:"circle",type:"text",...r})}function ta({imageCard:e,addEntryToUpdate:t,style:r,...a}){const l=s=>{t(e.id,{...e,keywords:mr(s.toLocaleLowerCase().split(/, |,| /).filter(Boolean).map(d=>d.trim()).sort())})};return k.jsx(ur.Search,{defaultValue:e.keywords.join(" "),enterButton:"Update",onSearch:s=>l(s),style:{maxWidth:500,width:"100%",...r},...a})}function ra({imageCard:e,addEntryToUpdate:t,style:r,...a}){const l=s=>{t(e.id,{...e,triggers:s})};return k.jsx(br,{allowClear:!0,defaultValue:e?.triggers,mode:"multiple",onChange:l,options:[{label:"aliens",value:"aliens"},{label:"insets",value:"insets"},{label:"snakes",value:"snakes"},{label:"spiders",value:"spiders"},{label:"scarry",value:"scarry"}],placeholder:"Please select",style:{width:"100%",...r},...a})}function aa({data:e,addEntryToUpdate:t}){const{addParam:r}=rt(),a=[{title:"CardId",dataIndex:"id",key:"id",sorter:(d,c)=>Number(d.id)-Number(c.id)},{title:"Image",dataIndex:"id",key:"image",render:d=>k.jsx(Tt,{cardId:d,width:50})},{title:"Keywords",dataIndex:"keywords",key:"keywords",render:d=>d?.join(", ")},{title:"Triggers",dataIndex:"triggers",key:"triggers",render:d=>d?.join(", ")},{title:"Actions",key:"actions",render:(d,c)=>k.jsxs(tt,{children:[k.jsx(_t,{addEntryToUpdate:t,imageCard:c}),k.jsx(Je,{icon:k.jsx(dr,{}),onClick:()=>r("cardId",c.id),children:"Edit"})]})}],l=Object.values(e),s=Cr({total:l.length,showQuickJumper:!0});return k.jsx(yr,{columns:a,dataSource:l,pagination:s,rowKey:"id"})}function na(e){const t=Nt(),r=gr("images-credo"),{addParam:a,removeParam:l}=rt();return k.jsxs(Bt,{error:r.error??t.error,hasResponseData:t.hasResponseData||r.hasResponseData,isLoading:t.isLoading||r.isLoading,children:[k.jsx(aa,{...e}),k.jsx(ea,{...e,onClose:()=>l("cardId"),onNewCard:()=>a("cardId",t.onRandomCard())})]})}function oa({data:e,save:t,isDirty:r,isSaving:a,entriesToUpdate:l}){const{addParam:s}=rt(),{onRandomCard:d}=Nt();return k.jsxs(xr,{children:[k.jsxs(tt,{gap:12,vertical:!0,children:[k.jsx(pr,{dirt:JSON.stringify(l),isDirty:r,isSaving:a,onSave:t}),k.jsx(Sr,{block:!0,data:()=>la(e),disabled:r,fileName:"image-cards.json"})]}),k.jsx(Et,{}),k.jsx(Je,{block:!0,onClick:()=>s("cardId",d()),children:"Random Card"}),k.jsx(Et,{})]})}function la(e){console.log("Preparing file for download...");const t=It.cloneDeep(e);return hr(t)}function La(){const e=$r({tdrResourceName:"image-cards",firestoreDataCollectionName:"imageCards",serialize:!0});return k.jsx(vr,{subtitle:"Descriptors",title:"Image Cards",children:k.jsxs(Rt,{hasSider:!0,children:[k.jsx(kr,{children:k.jsx(oa,{...e})}),k.jsx(Rt.Content,{className:"content",children:k.jsx(Bt,{error:e.error,hasResponseData:!It.isEmpty(e.data),isLoading:e.isLoading,children:k.jsx(na,{...e})})})]})})}export{La as ImageCardsDescriptor,La as default};
