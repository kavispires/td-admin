import{r as f,a as D,_ as G,j as e,T as x,I as E,B as w,D as T,P as L,L as H}from"./index-BpOPtDno.js";import{D as O}from"./DataLoadingWrapper-B86QopG6.js";import{l as v,P as M}from"./useBaseUrl-DGQ0WeaR.js";import{I as _}from"./ImageCard-BNF_1J-X.js";import{u as y}from"./useCardWidth-8M-t-Sdr.js";import{u as N}from"./useQueryParams-0iU09vdH.js";import{g as R}from"./utils-D1c9hPZl.js";import{D as C}from"./index-BsivHQMC.js";import{F as S}from"./index-CoMLl3xt.js";import{R as I,a as F}from"./WomanOutlined-G2ApPrjq.js";import{R as B}from"./index-aKvSwoWC.js";import{S as z}from"./index-D5RiZbBy.js";import{S as A}from"./index-Opn2dpJE.js";import{T as $}from"./index-BVwjVxAw.js";import{R as W,a as q}from"./ColumnWidthOutlined-Bq4Jvu-v.js";import{a as k,b as J}from"./FilterEntries-Ca_ivSrS.js";import{S as Q}from"./SiderContent-B5DdMimI.js";import{D as U}from"./DownloadButton-B1eA7G8a.js";import{S as V}from"./SaveButton-DrwiZphv.js";import{a as Y}from"./index-DDOyUl_x.js";import{u as K}from"./useResourceFirestoreData-DF7DAJgT.js";import"./gapSize-U1swVQyS.js";import"./index-Bso3DuBd.js";import"./index-BJjapmBU.js";import"./index-DixHne5n.js";import"./moment-C5S46NFB.js";import"./SaveOutlined-BgQlvX8X.js";import"./constants-CR1AS5tN.js";import"./Item-E5GiKY6X.js";import"./useGetFirestoreDoc-b19109Z3.js";import"./useTDResource-Gj2sjeOb.js";import"./useUpdateFirestoreDoc-BW6mGRPr.js";import"./useMutation-DYAWxsN6.js";var X={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M880 836H144c-17.7 0-32 14.3-32 32v36c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-36c0-17.7-14.3-32-32-32zm-622.3-84c2 0 4-.2 6-.5L431.9 722c2-.4 3.9-1.3 5.3-2.8l423.9-423.9a9.96 9.96 0 000-14.1L694.9 114.9c-1.9-1.9-4.4-2.9-7.1-2.9s-5.2 1-7.1 2.9L256.8 538.8c-1.5 1.5-2.4 3.3-2.8 5.3l-29.5 168.2a33.5 33.5 0 009.4 29.8c6.6 6.4 14.9 9.9 23.8 9.9z"}}]},name:"edit",theme:"filled"},Z=function(n,l){return f.createElement(D,G({},n,{ref:l,icon:X}))},ee=f.forwardRef(Z);function se({data:s,addEntryToUpdate:n}){const{removeParam:l,queryParams:a}=N(),c=a.get("suspectId"),o=a.get("version")??"gb",t=s[c??""];return t?e.jsx(C,{title:t.name.pt,placement:"right",onClose:()=>l("suspectId"),open:!!t,width:400,children:e.jsxs("div",{className:"suspect__drawer",children:[e.jsxs("div",{className:"grid grid-2",children:[e.jsx(_,{id:R(t.id,o),width:100}),e.jsxs(S,{vertical:!0,gap:4,children:[e.jsxs("div",{children:["ðŸ‡§ðŸ‡· ",t.name.pt]}),e.jsxs("div",{children:["ðŸ‡ºðŸ‡¸ ",t.name.en]}),e.jsx("div",{children:e.jsx("strong",{children:t.age})}),e.jsxs("div",{children:[t.gender==="male"?e.jsx(I,{}):e.jsx(F,{})," ",t.gender]}),e.jsx("div",{children:e.jsx("em",{children:t.ethnicity})})]})]}),e.jsxs("div",{className:"grid grid-2",children:[e.jsxs(S,{vertical:!0,children:[e.jsx(x.Text,{strong:!0,children:"Build"}),e.jsx(B.Group,{size:"small",value:t.build,onChange:u=>{n(t.id,{...t,build:u.target.value})},options:ae,style:{display:"flex",flexDirection:"column",gap:3}})]}),e.jsxs(S,{vertical:!0,children:[e.jsx(x.Text,{strong:!0,children:"Height"}),e.jsx(B.Group,{size:"small",value:t.height,onChange:u=>{n(t.id,{...t,height:u.target.value})},options:re,style:{display:"flex",flexDirection:"column",gap:3}})]})]}),e.jsx(ie,{suspect:t,addEntryToUpdate:n})]})}):null}function ie({suspect:s,addEntryToUpdate:n}){const l=s.features??[],a=c=>{const o=l.includes(c)?l.filter(t=>t!==c):[...l,c];n(s.id,{...s,features:o})};return e.jsx("div",{className:"grid grid-2",children:P.map(c=>e.jsxs("div",{className:"my-4",children:[e.jsx(x.Text,{strong:!0,children:c.title}),c.features.map(o=>e.jsxs(S,{className:"my-2",gap:4,children:[e.jsx(z,{size:"small",checked:l.includes(o.id),onChange:()=>a(o.id)})," ",o.label]},o.id))]},c.title))})}const ae=["thin","average","muscular","large"],re=["short","medium","tall"],P=[{title:"Hair Length",features:[{id:"shortHair",label:"Short Hair"},{id:"longHair",label:"Long Hair"},{id:"mediumHair",label:"Medium Hair"},{id:"bald",label:"Bald"}]},{title:"Hair Color",features:[{id:"blackHair",label:"Black Hair"},{id:"brownHair",label:"Brown Hair"},{id:"blondeHair",label:"Blonde Hair"},{id:"redHair",label:"Red Hair"},{id:"greyHair",label:"Grey Hair"},{id:"coloredHair",label:"Colored Hair"}]},{title:"Face",features:[{id:"beard",label:"Beard"},{id:"mustache",label:"Mustache"},{id:"goatee",label:"Goatee"},{id:"lipstick",label:"Lipstick"}]},{title:"Accessories",features:[{id:"glasses",label:"Glasses"},{id:"piercings",label:"Piercings"},{id:"earrings",label:"Earrings"},{id:"necklace",label:"Necklace"},{id:"hat",label:"Hat"},{id:"scarf",label:"Scarf"},{id:"hoodie",label:"Hoodie"},{id:"tie",label:"Tie"},{id:"headscarf",label:"Headscarf/Bandana"}]}];function te({data:s,addEntryToUpdate:n}){const{addParam:l,queryParams:a}=N(),c=a.get("version")??"ct",o=a.get("sortBy")??"id",t=Number(a.get("cardsPerRow"))||8,[u,p]=y(t),i=f.useMemo(()=>v.orderBy(Object.values(s),r=>o==="id"?Number(r.id.split("-").at(-1)):r[o]??r.id,["asc"]),[s,o]);return e.jsxs(e.Fragment,{children:[e.jsxs(x.Title,{level:2,children:["Deck ",c," (",i.length,")"]}),e.jsx(E.PreviewGroup,{children:e.jsx(A,{ref:p,wrap:!0,className:"my-2",children:i.map(r=>{var j,d;return e.jsxs("div",{className:"suspect",style:{width:`${u}px`},children:[e.jsx(_,{id:R(r.id,c),width:u,className:"suspect__image"}),e.jsxs("div",{className:"suspect__name",children:[e.jsx("div",{children:e.jsx($,{children:r.id})}),e.jsxs("div",{children:["ðŸ‡§ðŸ‡· ",r.name.pt]}),e.jsxs("div",{children:["ðŸ‡ºðŸ‡¸ ",r.name.en]}),e.jsxs("div",{className:"suspect__info",style:le(r),children:[e.jsxs("div",{children:[e.jsxs("div",{children:[r.gender==="male"?e.jsx(I,{}):e.jsx(F,{})," ",r.age]}),e.jsx("div",{children:e.jsx("em",{children:r.ethnicity})})]}),e.jsxs("div",{className:"uppercase",children:[e.jsx(W,{}),e.jsx("br",{}),r.build.charAt(0)]}),e.jsxs("div",{className:"uppercase",children:[e.jsx(q,{}),e.jsx("br",{}),r.height.charAt(0)]}),e.jsxs("div",{children:[((j=r==null?void 0:r.features)==null?void 0:j.length)??0," features"]})]}),e.jsx(w,{size:"small",block:!0,onClick:()=>l("suspectId",r.id),danger:!(r!=null&&r.features)||((d=r==null?void 0:r.features)==null?void 0:d.length)<2,children:e.jsx(ee,{})})]})]},r.id)})},c)}),e.jsx(se,{data:s,addEntryToUpdate:n})]})}const le=s=>!s.build||!s.height||s.build.length===1||s.height.length===1?{borderColor:"red"}:{};function b(s,n){return v.orderBy(Object.entries(s).map(([l,a])=>({key:l,label:v.capitalize(l),value:a,percentage:Math.round(a/n*100)})),["percentage"],["desc"])}function ne({data:s}){const[n,l]=f.useState(!1);return e.jsxs(e.Fragment,{children:[e.jsx(w,{onClick:()=>l(!0),block:!0,children:"See Stats"}),n&&e.jsx(ce,{data:s,open:n,onClose:()=>l(!1)})]})}function ce({data:s,open:n,onClose:l}){const{ages:a,ethnicities:c,genders:o,builds:t,heights:u}=f.useMemo(()=>{const i={},r={},j={},d={},m={};Object.values(s).forEach(h=>{i[h.age]=(i[h.age]??0)+1,r[h.ethnicity]=(r[h.ethnicity]??0)+1,j[h.gender]=(j[h.gender]??0)+1,d[h.build||"?"]=(d[h.build||"?"]??0)+1,m[h.height||"?"]=(m[h.height||"?"]??0)+1});const g=Object.keys(s).length;return{ages:b(i,g),ethnicities:b(r,g),genders:b(j,g),builds:b(d,g),heights:b(m,g)}},[s]),p=f.useMemo(()=>{const i={};Object.values(s).forEach(d=>{var m;(m=d.features)==null||m.forEach(g=>{i[g]=(i[g]??0)+1})});const r=Object.keys(s).length,j=P.reduce((d,m)=>{const g=m.features.map(h=>h.id);return d.push(...g),d},[]);return v.orderBy(b(i,r),d=>j.findIndex(m=>m===d.key),["asc"])},[s]);return e.jsxs(C,{title:"Suspects Statistics",placement:"right",onClose:l,open:n,width:400,children:[e.jsx(x.Text,{strong:!0,children:"Ethnicity"}),e.jsx("ul",{className:"statistic__list",children:c.map(i=>e.jsxs("li",{children:[e.jsx("strong",{children:i.label})," - ",i.percentage,"%"]},i.key))}),e.jsx(x.Text,{strong:!0,children:"Gender"}),e.jsx("ul",{className:"statistic__list",children:o.map(i=>e.jsxs("li",{children:[e.jsx("strong",{children:i.label})," - ",i.percentage,"%"]},i.key))}),e.jsx(x.Text,{strong:!0,children:"Age"}),e.jsx("ul",{className:"statistic__list",children:a.map(i=>e.jsxs("li",{children:[e.jsx("strong",{children:i.label})," - ",i.percentage,"%"]},i.key))}),e.jsx(x.Text,{strong:!0,children:"Build"}),e.jsx("ul",{className:"statistic__list",children:t.map(i=>e.jsxs("li",{children:[e.jsx("strong",{children:i.label})," - ",i.percentage,"%"]},i.key))}),e.jsx(x.Text,{strong:!0,children:"Height"}),e.jsx("ul",{className:"statistic__list",children:u.map(i=>e.jsxs("li",{children:[e.jsx("strong",{children:i.label})," - ",i.percentage,"%"]},i.key))}),e.jsx(x.Text,{strong:!0,children:"Features"}),e.jsx("ul",{className:"statistic__list",children:p.map(i=>e.jsxs("li",{children:[e.jsx("strong",{children:i.label})," - ",i.percentage,"% (",i.value,")"]},i.key))})]})}const oe=[{value:"ct",label:"Cartoon"},{value:"gb",label:"Ghibli"},{value:"ai",label:"AI"},{value:"md",label:"Models"},{value:"wc",label:"Wacky"}],de=[{value:"id",label:"Id"},{value:"name.pt",label:"Name (PT)"},{value:"name.en",label:"Name (EN)"},{value:"ethnicity",label:"Ethnicity"},{value:"gender",label:"Gender"},{value:"age",label:"Age"},{value:"height",label:"Height"},{value:"build",label:"Build"}];function ue({data:s,save:n,isDirty:l,isSaving:a,entriesToUpdate:c,hasFirestoreData:o}){const{addParam:t,queryParams:u}=N();return e.jsxs(Q,{children:[e.jsxs(S,{vertical:!0,gap:12,children:[e.jsx(V,{isDirty:l,onSave:n,isSaving:a,dirt:JSON.stringify(c)}),e.jsx(U,{data:()=>he(s),fileName:"suspects.json",disabled:l,hasNewData:o,block:!0})]}),e.jsx(T,{}),e.jsx(k,{label:"Version",value:u.get("version")??"gb",onChange:p=>t("version",p),options:oe}),e.jsx(J,{label:"Cards Per Row",value:Number(u.get("cardsPerRow")??"8"),onChange:p=>t("cardsPerRow",p),min:2,max:12}),e.jsx(k,{label:"Sort By",value:u.get("sortBy")??"id",onChange:p=>t("sortBy",p),options:de}),e.jsx(ne,{data:s})]})}function he(s){const n=v.cloneDeep(s);for(const l in n){const a=n[l];(a.height.length===1||a.build.length===1)&&(a.height==="S"&&(a.height="short"),a.height==="M"&&(a.height="medium"),a.height==="L"&&(a.height="tall"),a.build==="S"&&(a.build="thin"),a.build==="M"&&(a.build="average")),a.build==="fat"&&(a.build="large"),a.build==="heavy"&&(a.build="large")}return Y(n,["gender","ethnicity","age","height","build","features"])}function Je(){const s=K({tdrResourceName:"suspects",firestoreDataCollectionName:"suspects",serialize:!0});return e.jsx(L,{title:"Suspects",subtitle:"Information",children:e.jsxs(H,{hasSider:!0,children:[e.jsx(M,{children:e.jsx(ue,{...s})}),e.jsx(H.Content,{className:"content",children:e.jsx(O,{isLoading:s.isLoading,error:s.error,hasResponseData:!v.isEmpty(s.data),children:e.jsx(te,{...s})})})]})})}export{Je as default};
