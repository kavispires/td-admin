import{r as p,O as ot,a as $,af as lt,ag as ct,ah as ut,ai as dt,X as Pe,W as mt,j as e,T as D,D as Q,B as P,U as pt,x as ke,ae as Ne,aj as gt,ak as ht,P as ft,L as Ue}from"./index-B-CB-hmC.js";import{D as bt}from"./DataLoadingWrapper-GIYtl44F.js";import{c as K,a as te,b as Ge,d as le,T as xt}from"./FilterEntries-CILsmA30.js";import{S as jt}from"./SiderContent-FZX9emIy.js";import{D as Qe}from"./DownloadButton-BzY0paAD.js";import{S as It}from"./SaveButton-C_jpPclL.js";import{l as b}from"./lodash-Czkt6pVA.js";import{A as F,d as S,e as vt,f as H}from"./constants-CICODHNU.js";import{e as yt,g as At,a as Re,d as Ke,w as Tt,m as Ct}from"./index-lGkeVY1X.js";import{u as Et}from"./useGetFirebaseDoc-CmSt-g-E.js";import{u as ne}from"./useTDResource-VDQIHIMH.js";import{u as wt}from"./useUpdateFirebaseDoc-vKfuE25D.js";import{T as re}from"./index-C7MdlUJs.js";import{F as w}from"./index-BGd500q_.js";import{V as St}from"./VerticalAlignTopOutlined-v_ZPtoJ9.js";import{I as W,a as Z,b as _,c as ae}from"./ItemBuildingBlocks-BoIyXScu.js";import{Q as Ot}from"./index-Bo__JzcK.js";import{R as Me}from"./index-Dna_Lvgx.js";import{R as ce}from"./CheckCircleFilled-BSn0ZXO7.js";import{c as ue,E as ie,P as Pt}from"./useBaseUrl-xjSpq_uF.js";import{I as Ve}from"./Item-D9agdC9N.js";import{P as qe}from"./progress-BhywAKcK.js";import{C as J}from"./index-CO_wYkA1.js";import{A as Nt}from"./index-CIJD847L.js";import{S as k}from"./index-Dpykzcri.js";import{u as Le}from"./useQueryParams-B-K0E8XR.js";import{I as Rt}from"./ItemsTypeahead-B-F3oIDH.js";import{D as Lt,a as Dt,P as Ut}from"./Pagination-Dw_THTpl.js";import{S as ee}from"./index-06Xp2EXn.js";import{a as Mt,P as Vt,F as He}from"./Table-DtHi6rd_.js";import{D as $t}from"./index-BKZfFrQt.js";import{S as Ft}from"./index-4F-tsTm3.js";import{P as zt}from"./index-BsQMfOKq.js";import{u as Bt}from"./useToggle-C07fyKlK.js";import{M as _t}from"./index-CxhqJQjm.js";import{T as kt}from"./TransparentButton-DmkOepxx.js";import{T as Gt}from"./index-cPYsJV-S.js";import{R as Qt}from"./SkinOutlined-CjYt73aQ.js";import{R as Kt}from"./index-DhW3cHaL.js";import"./index-kQHTayh-.js";import"./moment-C5S46NFB.js";import"./SaveOutlined-C1T5zzwQ.js";import"./useMutation-DpWGO1_H.js";import"./gapSize-U1swVQyS.js";import"./LanguageFlag-BkaoqNMu.js";import"./useCopyToClipboardFunction-CgWdZ1Nu.js";import"./index-DCTDI9bN.js";import"./Input-QpefR0Z_.js";import"./FireFilled-CdjnO2WV.js";import"./IdcardOutlined-DiWW65D9.js";import"./throttleByAnimationFrame-B9ejVTA1.js";import"./useDebounce-Bt98GF_7.js";import"./index-BLsm4Xwq.js";import"./scrollTo-DTu61Nla.js";import"./extendsObject-keMuGWqj.js";import"./PlusOutlined-ByZyTB3m.js";var qt={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M433.1 657.7a31.8 31.8 0 0051.7 0l210.6-292c3.8-5.3 0-12.7-6.5-12.7H642c-10.2 0-19.9 4.9-25.9 13.3L459 584.3l-71.2-98.8c-6-8.3-15.6-13.3-25.9-13.3H315c-6.5 0-10.3 7.4-6.5 12.7l124.6 172.8z"}},{tag:"path",attrs:{d:"M880 112H144c-17.7 0-32 14.3-32 32v736c0 17.7 14.3 32 32 32h736c17.7 0 32-14.3 32-32V144c0-17.7-14.3-32-32-32zm-40 728H184V184h656v656z"}}]},name:"check-square",theme:"outlined"},Ht={icon:{tag:"svg",attrs:{"fill-rule":"evenodd",viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64c247.4 0 448 200.6 448 448S759.4 960 512 960 64 759.4 64 512 264.6 64 512 64zm0 76c-205.4 0-372 166.6-372 372s166.6 372 372 372 372-166.6 372-372-166.6-372-372-372zm128.01 198.83c.03 0 .05.01.09.06l45.02 45.01a.2.2 0 01.05.09.12.12 0 010 .07c0 .02-.01.04-.05.08L557.25 512l127.87 127.86a.27.27 0 01.05.06v.02a.12.12 0 010 .07c0 .03-.01.05-.05.09l-45.02 45.02a.2.2 0 01-.09.05.12.12 0 01-.07 0c-.02 0-.04-.01-.08-.05L512 557.25 384.14 685.12c-.04.04-.06.05-.08.05a.12.12 0 01-.07 0c-.03 0-.05-.01-.09-.05l-45.02-45.02a.2.2 0 01-.05-.09.12.12 0 010-.07c0-.02.01-.04.06-.08L466.75 512 338.88 384.14a.27.27 0 01-.05-.06l-.01-.02a.12.12 0 010-.07c0-.03.01-.05.05-.09l45.02-45.02a.2.2 0 01.09-.05.12.12 0 01.07 0c.02 0 .04.01.08.06L512 466.75l127.86-127.86c.04-.05.06-.06.08-.06a.12.12 0 01.07 0z"}}]},name:"close-circle",theme:"outlined"},Yt={icon:{tag:"svg",attrs:{"fill-rule":"evenodd",viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M880 112c17.7 0 32 14.3 32 32v736c0 17.7-14.3 32-32 32H144c-17.7 0-32-14.3-32-32V144c0-17.7 14.3-32 32-32zm-40 72H184v656h656V184zM640.01 338.83c.03 0 .05.01.09.06l45.02 45.01a.2.2 0 01.05.09.12.12 0 010 .07c0 .02-.01.04-.05.08L557.25 512l127.87 127.86a.27.27 0 01.05.06v.02a.12.12 0 010 .07c0 .03-.01.05-.05.09l-45.02 45.02a.2.2 0 01-.09.05.12.12 0 01-.07 0c-.02 0-.04-.01-.08-.05L512 557.25 384.14 685.12c-.04.04-.06.05-.08.05a.12.12 0 01-.07 0c-.03 0-.05-.01-.09-.05l-45.02-45.02a.2.2 0 01-.05-.09.12.12 0 010-.07c0-.02.01-.04.06-.08L466.75 512 338.88 384.14a.27.27 0 01-.05-.06l-.01-.02a.12.12 0 010-.07c0-.03.01-.05.05-.09l45.02-45.02a.2.2 0 01.09-.05.12.12 0 01.07 0c.02 0 .04.01.08.06L512 466.75l127.86-127.86c.04-.05.06-.06.08-.06a.12.12 0 01.07 0z"}}]},name:"close-square",theme:"outlined"},Jt={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M880.1 154H143.9c-24.5 0-39.8 26.7-27.5 48L349 597.4V838c0 17.7 14.2 32 31.8 32h262.4c17.6 0 31.8-14.3 31.8-32V597.4L907.7 202c12.2-21.3-3.1-48-27.6-48zM603.4 798H420.6V642h182.9v156zm9.6-236.6l-9.5 16.6h-183l-9.5-16.6L212.7 226h598.6L613 561.4z"}}]},name:"filter",theme:"outlined"},Wt={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M888 792H200V168c0-4.4-3.6-8-8-8h-56c-4.4 0-8 3.6-8 8v688c0 4.4 3.6 8 8 8h752c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM305.8 637.7c3.1 3.1 8.1 3.1 11.3 0l138.3-137.6L583 628.5c3.1 3.1 8.2 3.1 11.3 0l275.4-275.3c3.1-3.1 3.1-8.2 0-11.3l-39.6-39.6a8.03 8.03 0 00-11.3 0l-230 229.9L461.4 404a8.03 8.03 0 00-11.3 0L266.3 586.7a8.03 8.03 0 000 11.3l39.5 39.7z"}}]},name:"line-chart",theme:"outlined"},Zt={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M762 164h-64c-4.4 0-8 3.6-8 8v688c0 4.4 3.6 8 8 8h64c4.4 0 8-3.6 8-8V172c0-4.4-3.6-8-8-8zm-508 0v72.4c0 9.5 4.2 18.4 11.4 24.5L564.6 512 265.4 763.1c-7.2 6.1-11.4 15-11.4 24.5V860c0 6.8 7.9 10.5 13.1 6.1L689 512 267.1 157.9A7.95 7.95 0 00254 164z"}}]},name:"vertical-left",theme:"outlined"},Xt={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M326 164h-64c-4.4 0-8 3.6-8 8v688c0 4.4 3.6 8 8 8h64c4.4 0 8-3.6 8-8V172c0-4.4-3.6-8-8-8zm444 72.4V164c0-6.8-7.9-10.5-13.1-6.1L335 512l421.9 354.1c5.2 4.4 13.1.7 13.1-6.1v-72.4c0-9.4-4.2-18.4-11.4-24.5L459.4 512l299.2-251.1c7.2-6.1 11.4-15.1 11.4-24.5z"}}]},name:"vertical-right",theme:"outlined"},es=function(t,s){return ot?window.matchMedia(t).matches:!1},ts=function(t,s){var r=p.useState(es(t)),n=r[0],l=r[1];return p.useEffect(function(){var i=!0,o=window.matchMedia(t),c=function(){i&&l(!!o.matches)};return o.addEventListener("change",c),l(o.matches),function(){i=!1,o.removeEventListener("change",c)}},[t]),n};function de(){return de=Object.assign?Object.assign.bind():function(t){for(var s=1;s<arguments.length;s++){var r=arguments[s];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},de.apply(this,arguments)}const ss=(t,s)=>p.createElement($,de({},t,{ref:s,icon:qt})),rs=p.forwardRef(ss);function me(){return me=Object.assign?Object.assign.bind():function(t){for(var s=1;s<arguments.length;s++){var r=arguments[s];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},me.apply(this,arguments)}const ns=(t,s)=>p.createElement($,me({},t,{ref:s,icon:Ht})),$e=p.forwardRef(ns);function pe(){return pe=Object.assign?Object.assign.bind():function(t){for(var s=1;s<arguments.length;s++){var r=arguments[s];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},pe.apply(this,arguments)}const is=(t,s)=>p.createElement($,pe({},t,{ref:s,icon:Yt})),as=p.forwardRef(is);function ge(){return ge=Object.assign?Object.assign.bind():function(t){for(var s=1;s<arguments.length;s++){var r=arguments[s];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},ge.apply(this,arguments)}const os=(t,s)=>p.createElement($,ge({},t,{ref:s,icon:Lt})),ls=p.forwardRef(os);function he(){return he=Object.assign?Object.assign.bind():function(t){for(var s=1;s<arguments.length;s++){var r=arguments[s];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},he.apply(this,arguments)}const cs=(t,s)=>p.createElement($,he({},t,{ref:s,icon:Dt})),us=p.forwardRef(cs);function fe(){return fe=Object.assign?Object.assign.bind():function(t){for(var s=1;s<arguments.length;s++){var r=arguments[s];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},fe.apply(this,arguments)}const ds=(t,s)=>p.createElement($,fe({},t,{ref:s,icon:Mt})),ms=p.forwardRef(ds);function be(){return be=Object.assign?Object.assign.bind():function(t){for(var s=1;s<arguments.length;s++){var r=arguments[s];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},be.apply(this,arguments)}const ps=(t,s)=>p.createElement($,be({},t,{ref:s,icon:Jt})),gs=p.forwardRef(ps);function xe(){return xe=Object.assign?Object.assign.bind():function(t){for(var s=1;s<arguments.length;s++){var r=arguments[s];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},xe.apply(this,arguments)}const hs=(t,s)=>p.createElement($,xe({},t,{ref:s,icon:lt})),fs=p.forwardRef(hs);function je(){return je=Object.assign?Object.assign.bind():function(t){for(var s=1;s<arguments.length;s++){var r=arguments[s];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},je.apply(this,arguments)}const bs=(t,s)=>p.createElement($,je({},t,{ref:s,icon:Wt})),xs=p.forwardRef(bs);function Ie(){return Ie=Object.assign?Object.assign.bind():function(t){for(var s=1;s<arguments.length;s++){var r=arguments[s];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Ie.apply(this,arguments)}const js=(t,s)=>p.createElement($,Ie({},t,{ref:s,icon:Vt})),Is=p.forwardRef(js);function ve(){return ve=Object.assign?Object.assign.bind():function(t){for(var s=1;s<arguments.length;s++){var r=arguments[s];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},ve.apply(this,arguments)}const vs=(t,s)=>p.createElement($,ve({},t,{ref:s,icon:Ot})),Ye=p.forwardRef(vs);function ye(){return ye=Object.assign?Object.assign.bind():function(t){for(var s=1;s<arguments.length;s++){var r=arguments[s];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},ye.apply(this,arguments)}const ys=(t,s)=>p.createElement($,ye({},t,{ref:s,icon:ct})),As=p.forwardRef(ys);function Ae(){return Ae=Object.assign?Object.assign.bind():function(t){for(var s=1;s<arguments.length;s++){var r=arguments[s];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Ae.apply(this,arguments)}const Ts=(t,s)=>p.createElement($,Ae({},t,{ref:s,icon:ut})),Cs=p.forwardRef(Ts);function Te(){return Te=Object.assign?Object.assign.bind():function(t){for(var s=1;s<arguments.length;s++){var r=arguments[s];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Te.apply(this,arguments)}const Es=(t,s)=>p.createElement($,Te({},t,{ref:s,icon:St})),ws=p.forwardRef(Es);function Ce(){return Ce=Object.assign?Object.assign.bind():function(t){for(var s=1;s<arguments.length;s++){var r=arguments[s];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Ce.apply(this,arguments)}const Ss=(t,s)=>p.createElement($,Ce({},t,{ref:s,icon:Zt})),Os=p.forwardRef(Ss);function Ee(){return Ee=Object.assign?Object.assign.bind():function(t){for(var s=1;s<arguments.length;s++){var r=arguments[s];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Ee.apply(this,arguments)}const Ps=(t,s)=>p.createElement($,Ee({},t,{ref:s,icon:Xt})),Ns=p.forwardRef(Ps),Je={OPPOSITE:{value:-10,prefix:"^",name:"OPPOSITE",label:{en:"Opposite",pt:"Oposto"},prefixLabel:{en:"really not ",pt:"muito não "}},UNRELATED:{value:-3,prefix:"!",name:"UNRELATED",label:{en:"Unrelated",pt:"Desconexo"},prefixLabel:{en:"not ",pt:"não "}},UNCLEAR:{value:-1,prefix:"~",name:"UNCLEAR",label:{en:"Unclear",pt:"Incerto"},prefixLabel:{en:"sorta ",pt:"meio "}},RELATED:{value:5,prefix:"+",name:"RELATED",label:{en:"Related",pt:"Relacionado"},prefixLabel:{en:"",pt:""}},DETERMINISTIC:{value:10,prefix:"*",name:"DETERMINISTIC",label:{en:"Deterministic",pt:"Determinístico"},prefixLabel:{en:"very ",pt:"muito "}}};b.keyBy(Je,"prefix");const Rs=["*","^","+","~","!"],q={ATTRIBUTE_VALUE_DICT:Je,ATTRIBUTE_VALUE_PRIORITY:Rs},we=(t={})=>b.cloneDeep(b.merge({id:"",name:{en:"",pt:""},groups:[],attributes:{}},t)),Se=(t={})=>b.cloneDeep(b.merge({id:"",attributes:{}},t)),We=(t,s,r)=>{const n=b.orderBy(Object.values(s),["priority","id"],["asc","asc"]).map(a=>a.id);function l(a,u){return b.orderBy(a,j=>n.indexOf(j),["asc"]).map(j=>`${u}${j}`)}const i=[],o=[],c=[],m=[],x=[];return Object.entries(t.attributes).forEach(([a,u])=>{if(s[a])switch(u){case S.OPPOSITE:i.push(a);break;case S.DETERMINISTIC:o.push(a);break;case S.RELATED:c.push(a);break;case S.UNRELATED:m.push(a);break;case S.UNCLEAR:x.push(a);break;default:x.push(a);break}}),[...l(i,F.OPPOSITE),...l(o,F.DETERMINISTIC),...l(c,F.RELATED),...l(m,F.UNRELATED),...l(x,F.UNCLEAR)]},Ze=b.memoize(t=>{if(t.length===3)return{key:t,className:"",text:""};const s=t[0];return{key:t.slice(1,4),className:{[F.DETERMINISTIC]:"deterministic",[F.UNRELATED]:"unrelated",[F.UNCLEAR]:"unclear",[F.OPPOSITE]:"opposite"}[s],text:{[F.DETERMINISTIC]:"very",[F.UNRELATED]:"not",[F.UNCLEAR]:"maybe",[F.OPPOSITE]:"very not"}[s]}}),Xe=(t,s,r)=>t.filter(n=>!(!s&&n.includes(F.UNCLEAR)||!r&&n.includes(F.UNRELATED)));function Oe(t,s,r){const n=[];for(const[o,c]of Object.entries(t.attributes)){const m=s[o];if(m){const x=Object.values(q.ATTRIBUTE_VALUE_DICT).find(a=>a.value===c);x&&n.push({prefix:x.prefix,id:m.id,priority:m.priority})}}const l=b.sortBy(n,[o=>q.ATTRIBUTE_VALUE_PRIORITY.indexOf(o.prefix),o=>o.prefix===q.ATTRIBUTE_VALUE_DICT.UNRELATED.prefix?-1:o.priority,["asc","asc"]]),i=r!=null&&r.length?l.slice(0,r==null?void 0:r.length):l;return r!=null&&r.onlyRelevant?i.filter(o=>[q.ATTRIBUTE_VALUE_DICT.UNCLEAR.prefix,q.ATTRIBUTE_VALUE_DICT.UNRELATED.prefix].includes(o.prefix)).map(o=>`${o.prefix}${o.id}`).join(""):i.map(o=>`${o.prefix}${o.id}`).join((r==null?void 0:r.delimiter)??"")}const Ls=b.keyBy(q.ATTRIBUTE_VALUE_DICT,"prefix");function Ds(t){return(t.match(/[\^*+~!][a-zA-Z0-9]+/g)??[]).reduce((r,n)=>{const l=n[0],i=n.slice(1),o=Ls[l].value;return r[i]=o,r},{})}function et(t){return Object.values(t.attributes).reduce((s,r)=>{let n=s;return r<=0?(r===q.ATTRIBUTE_VALUE_DICT.OPPOSITE.value&&(n+=r/2),n):n+r},0)}function tt(t,s){const r=Object.values(t.attributes).filter(n=>n===q.ATTRIBUTE_VALUE_DICT.UNCLEAR.value).length;return Math.floor((s-r)/s*100)}function V(){const[t,s]=dt(),r=(l,i)=>{t.set(l,`${i}`),s(t)},n=l=>{t.delete(l),s(t)};return{view:t.get("view")??"classifier",setView:l=>s({view:l}),addQueryParam:r,removeQueryParam:n,searchParams:t}}const se={};function Us(){const{notification:t,message:s}=Pe.useApp(),r=mt(),n=ne("items"),l=ne("items-attributes"),i=ne("items-attribute-values"),o=Et("tdr","itemsAttributeValues",{select:I=>Vs({itemAttributesValues:I,itemAttributes:l.data??{}})}),[c,m]=p.useState({}),x=wt("tdr","itemsAttributeValues",{onSuccess:()=>{t.success({message:"itemsAttributeValues updated"}),r.refetchQueries({queryKey:["firebase","tdr","itemsAttributeValues"]}),m({})},onError:I=>{t.error({message:"itemsAttributeValues update failed",description:I.message})}}),a=p.useMemo(()=>({...i.data??{},...o.data??{}}),[i.data,o.data]),u=!b.isEmpty(c),j=(I,y)=>{m(d=>({...d,[I]:{...y,updatedAt:Date.now()}}))},f=I=>{m(y=>({...y,...b.mapKeys(I.map(d=>({...d,updatedAt:Date.now()})),"id")}))},g=o.data,h=()=>{x.mutate(Ms({...g,...c},l.data))};return{availableItemIds:p.useMemo(()=>{const I=n.data??{};return b.orderBy(Object.keys(I).filter(y=>{var d;return(((d=I[y])==null?void 0:d.decks)??[]).includes("alien")}),y=>Number(y),"asc")},[n.data]),getItem:I=>{var y;return(y=n.data)!=null&&y[I]?n.data[I]:(I&&s.info(`Item ${I} not found in TDR. Creating a new item...`),we({id:I}))},getItemAttributeValues:I=>{const y=(a==null?void 0:a[I])??{},d=c[I]??{};return b.isEmpty(y)&&b.isEmpty(d)?(se[I]=Se({id:I}),se[I]):b.merge((se==null?void 0:se[I])??{},y,d)},attributes:l.data??{},isLoading:n.isLoading||l.isLoading||i.isLoading||o.isLoading,error:n.error||l.error||i.error||o.error,firebaseData:g,hasFirestoreData:!b.isEmpty(o.data),isSaving:x.isPending,save:h,addAttributesToUpdate:j,addMultipleAttributesToUpdate:f,attributesToUpdate:c,isDirty:u}}const Ms=(t,s)=>At(t,n=>({id:n.id,tempSignature:Oe(n,s),updatedAt:n.updatedAt})),Vs=t=>{const{itemAttributesValues:s,itemAttributes:r}=t,n=Object.keys(r).length;return yt(s,i=>{const o=Ds(i.tempSignature),c=Object.keys(o).length===n,m={id:i.id,updatedAt:i.updatedAt,attributes:o};return c?{...m,complete:c,reliability:tt(m,n),score:et(m)}:m})},st=p.createContext({getItem:()=>we(),getItemAttributeValues:()=>Se(),isLoading:!0,error:null,hasResponseData:!1,isDirty:!1,jumpToItem:()=>{},activeItem:we(),itemAttributeValues:Se(),onAttributeChange:()=>{},isSaving:!1,save:()=>{},attributesList:[],availableItemIds:[],addAttributesToUpdate:()=>{},addMultipleAttributesToUpdate:()=>{},prepareItemsAttributesFileForDownload:()=>({}),attributes:{},attributesToUpdate:{},hasFirestoreData:!1}),$s=({children:t})=>{const{getItem:s,getItemAttributeValues:r,availableItemIds:n,isLoading:l,error:i,isSaving:o,save:c,addAttributesToUpdate:m,isDirty:x,attributes:a,addMultipleAttributesToUpdate:u,attributesToUpdate:j,hasFirestoreData:f}=Us(),{message:g}=Pe.useApp(),h=p.useMemo(()=>b.orderBy(Object.values(a),"name.en","asc"),[a]),{searchParams:T}=V(),A=T.get("sortBy"),C=p.useMemo(()=>A==="id"?b.orderBy(n,v=>Number(v),"asc"):A==="updatedAt"?b.orderBy(n,v=>r(v).updatedAt,"desc"):A==="fewestAttributesLeft"?b.orderBy(n,v=>{const E=h.length-Object.keys(r(v).attributes).length;return E===0?Number.POSITIVE_INFINITY:E},"asc"):n,[n,A]),[I,y]=p.useState(b.random(0,C.length-1)),d=s(C[I]),M=r(d.id),z=(v,E)=>{if(v==="next"){y(O=>(O+1)%C.length);return}if(v==="previous"){y(O=>(O-1+C.length)%C.length);return}if(v==="random"){y(b.random(0,C.length-1));return}if(v==="first"){y(0);return}if(v==="last"){y(C.length-1);return}if(v==="next10"){y(O=>(O+10)%C.length);return}if(v==="previous10"){y(O=>(O-10+C.length)%C.length);return}if(v==="incomplete"){y(O=>{let R=O+1;for(;R<C.length;){const B=r(C[R]);if(Object.keys(B.attributes).length!==h.length)return R;if(R===C.length-1)return g.info("No more incomplete items found."),O;R++}return O});return}if(v==="goTo"&&E!==void 0){const O=C.indexOf(E);if(O!==-1){y(O);return}g.error(`Item ${E} is not available for attribution.`)}},N=(v,E)=>{m(d.id,{...M,attributes:{...M.attributes,[v]:E}})},L=()=>Re(n.reduce((v,E)=>{const O=r(E);return b.isEmpty(O.attributes)||(Object.keys(O.attributes).length===h.length?O.complete=!0:delete O.complete,v[O.id]=O),v},{}));return e.jsx(st.Provider,{value:{getItem:s,getItemAttributeValues:r,availableItemIds:n,isLoading:l,error:i,hasResponseData:n.length>0&&!b.isEmpty(a),isDirty:x,itemAttributeValues:M,jumpToItem:z,activeItem:d,onAttributeChange:N,isSaving:o,save:c,attributes:a,attributesList:h,addAttributesToUpdate:m,addMultipleAttributesToUpdate:u,prepareItemsAttributesFileForDownload:L,attributesToUpdate:j,hasFirestoreData:f},children:t})},U=()=>p.useContext(st);function G({label:t,children:s}){return e.jsxs(D.Text,{children:[t," ",e.jsx(re,{children:s})]})}function Fs(){const{getItemAttributeValues:t,availableItemIds:s,attributesList:r}=U(),{total:n,complete:l,completionPercentage:i,hasDataCount:o,initiatedPercentage:c,progress:m,progressTotal:x,currentProgress:a}=p.useMemo(()=>{const u=s.length;let j=0,f=0,g=0;s.map(A=>t(A)).forEach(({attributes:A})=>{b.isEmpty(A)||(j+=1),Object.values(A).length===r.length&&(f+=1),g+=Object.values(A).length});const T=Object.values(r).length*s.length;return{total:u,complete:f,completionPercentage:u>0?(f/u*100).toFixed(1):0,hasDataCount:j,initiatedPercentage:u>0?Math.floor(j/u*100):0,progress:(g/T*100).toFixed(1),currentProgress:g,progressTotal:T}},[r,s,t]);return e.jsxs(e.Fragment,{children:[e.jsxs(w,{vertical:!0,children:[e.jsx(D.Text,{strong:!0,className:"mb-2",children:"Items Stats"}),e.jsx(G,{label:"Total",children:n}),e.jsxs(G,{label:"Complete",children:[l," (",i,"%)"]}),e.jsxs(G,{label:"Initiated",children:[o," (",c,"%)"]}),e.jsx(D.Text,{strong:!0,className:"mt-4 mb-2",children:"Attributes Stats"}),e.jsx(G,{label:"Total",children:x}),e.jsx(G,{label:"Set",children:a}),e.jsxs(G,{label:"Progress",children:[m,"%"]})]}),e.jsx(Q,{})]})}function zs(){const{jumpToItem:t}=U(),{searchParams:s,addQueryParam:r}=V();return e.jsxs(e.Fragment,{children:[e.jsx(P,{block:!0,onClick:()=>t("random"),type:"primary",children:"Random Item"}),e.jsx(K,{label:"Unset Only",value:s.get("scope")==="unset",onChange:n=>r("scope",n?"unset":""),className:"mt-4"})]})}function Bs(){const{searchParams:t,addQueryParam:s}=V(),{attributesList:r}=U(),n=p.useMemo(()=>[{label:"Random Attribute",value:"random"},...r.map(({id:l,name:i})=>({label:i.en,value:l}))],[r]);return e.jsxs(e.Fragment,{children:[e.jsx(te,{label:"Sampler Attribute",value:t.get("attribute")||"random",onChange:l=>s("attribute",l),options:n}),e.jsx(Ge,{label:"Sample Size",value:Number(t.get("size")||9),onChange:l=>s("size",String(l)),min:3,max:21,step:3})]})}function _s(){const{searchParams:t,addQueryParam:s}=V(),{attributesList:r}=U(),n=p.useMemo(()=>r.map(({id:l,name:i,...o})=>({label:`${i.en}${o.default?"*":""}`,value:l})),[r]);return e.jsxs(e.Fragment,{children:[e.jsx(te,{label:"Attribute",value:t.get("attribute")||"ali",onChange:l=>s("attribute",l),options:n}),e.jsx(te,{label:"Scope",value:t.get("scope")||"unset",onChange:l=>s("scope",l),options:[{value:"unset",label:"Unset"},...vt]}),e.jsx(te,{label:"Results per page",value:t.get("pageSize")||12,onChange:l=>s("pageSize",l),options:[12,24,48,96]})]})}function ks(){const{searchParams:t,addQueryParam:s}=V();return e.jsxs(e.Fragment,{children:[e.jsx(K,{label:"Only Complete",value:t.get("showComplete")==="true",onChange:r=>s("showComplete",r?"true":""),className:"full-width m-0"}),e.jsx(K,{label:"Show Unrelated",value:t.get("showUnrelated")==="true",onChange:r=>s("showUnrelated",r?"true":""),className:"full-width m-0"}),e.jsx(K,{label:"Show Unclear",value:t.get("showUnclear")==="true",onChange:r=>s("showUnclear",r?"true":""),className:"full-width m-0"})]})}function Gs(){const{searchParams:t,addQueryParam:s}=V();return e.jsx(e.Fragment,{children:e.jsx(K,{label:"Show Glyphs",value:t.get("showGlyphs")==="true",onChange:r=>s("showGlyphs",r?"true":""),className:"full-width m-0"})})}function Qs(){const{isDirty:t,save:s,prepareItemsAttributesFileForDownload:r,attributes:n,isSaving:l,attributesToUpdate:i,hasFirestoreData:o}=U(),{view:c,setView:m}=V();return e.jsxs(jt,{children:[e.jsxs(w,{vertical:!0,gap:12,children:[e.jsx(It,{isDirty:t,onSave:s,isSaving:l,dirt:JSON.stringify(i)}),e.jsx(Qe,{data:()=>Ks(r(),n),fileName:"items-attribute-values.json",disabled:t,hasNewData:o,block:!0})]}),e.jsx(Q,{}),e.jsx(Fs,{}),e.jsx(te,{label:"View",value:c,onChange:m,options:["classifier","sampler","grouping","comparator","simulator","stats"]}),e.jsx(Q,{}),c==="classifier"&&e.jsx(zs,{}),c==="sampler"&&e.jsx(Bs,{}),c==="grouping"&&e.jsx(_s,{}),c==="comparator"&&e.jsx(ks,{}),c==="stats"&&e.jsx(Gs,{})]})}function Ks(t,s){const r=Object.keys(s).length;Object.keys(t).forEach(l=>{const i=t[l],o=Object.keys(i.attributes);o.forEach(m=>{s[m]||delete i.attributes[m]}),o.length===r?(i.complete=!0,i.score=et(i),i.reliability=tt(i,r),i.signature=Oe(i,s,{onlyRelevant:!0})):(i.complete=void 0,i.score=void 0,i.reliability=void 0,i.signature=void 0)});const n={};return Object.values(t).forEach(l=>{n[l.id]={id:l.id,updatedAt:l.updatedAt,signature:Oe(l,s,{delimiter:":"})},l.complete&&(n[l.id].complete=l.complete)}),console.log(n),Re(Ke(t))}function rt(t){const[s,r]=p.useState(!1),n=()=>{r(window.scrollY>300)},l=()=>{window.scrollTo({top:0,behavior:"smooth"})};return pt(()=>(window.addEventListener("scroll",n),()=>{window.removeEventListener("scroll",n)})),e.jsx(P,{className:`go-to-top-button ${s?"visible":""}`,onClick:l,icon:e.jsx(ws,{}),...t,children:"Go to Top"})}function nt({title:t,icon:s}){return e.jsx(ke,{title:t,children:s??e.jsx(Ye,{})})}const Fe=[{label:"Opposite",value:S.OPPOSITE},{label:"Unrelated",value:S.UNRELATED},{label:"Unclear",value:S.UNCLEAR},{label:"Related",value:S.RELATED},{label:"Deterministic",value:S.DETERMINISTIC}],ze=[{label:"Opposite",value:S.OPPOSITE},{label:"Unrelated",value:S.UNRELATED},{label:"Unclear",value:S.UNCLEAR},{label:"Related",value:S.RELATED},{label:"Deterministic",value:S.DETERMINISTIC,disabled:!0}];function oe({attribute:t,value:s,onChange:r,onlyButtons:n,size:l}){return t?n?e.jsx(Me.Group,{options:t.limited?ze:Fe,onChange:({target:{value:i}})=>r(t.id,i),value:s,optionType:"button",buttonStyle:"solid",size:l}):e.jsxs("div",{className:"attribute-button-container__row",children:[e.jsxs("span",{className:"attribute-button-container__label",children:[b.truncate(t.name.en,{length:12})," ",e.jsx(nt,{title:t.description.en})]}),e.jsx(Me.Group,{options:t.limited?ze:Fe,onChange:({target:{value:i}})=>r(t.id,i),value:s,optionType:"button",buttonStyle:"solid",size:l}),e.jsx("span",{children:e.jsx(ce,{style:{color:s&&s>7?"green":"transparent"}})})]},t.id):e.jsx(e.Fragment,{})}function qs({itemAttributeValues:t,attributes:s}){const{searchParams:r,addQueryParam:n}=V(),l=r.get("showUnclear")==="true",i=r.get("showUnrelated")==="true",o=p.useMemo(()=>Xe(We(t,s),l,i),[t,s,l,i]),c=r.get("signs")==="true"?it:Hs;return e.jsxs(w,{gap:6,vertical:!0,children:[e.jsx(K,{label:"Show Unrelated",value:r.get("showUnrelated")==="true",onChange:m=>n("showUnrelated",m?"true":""),className:"full-width m-0"}),e.jsx(K,{label:"Show Unclear",value:r.get("showUnclear")==="true",onChange:m=>n("showUnclear",m?"true":""),className:"full-width m-0"}),e.jsx(K,{label:"Alien Sings",value:r.get("signs")==="true",onChange:m=>n("signs",m?"true":""),className:"full-width m-0"}),e.jsx(w,{gap:6,wrap:"wrap",className:"item-attribute-value-statement",children:o.map((m,x,a)=>e.jsx(c,{keyVariant:m,attributes:s,firstElement:x===0,lastElement:x===a.length-1},m))})]})}function it({keyVariant:t,attributes:s,withText:r}){const{key:n,className:l,text:i}=Ze(t);return e.jsxs(w,{vertical:!0,align:"center",children:[e.jsx(H,{width:50,id:s[n].spriteId,className:ue("item-attribute-alien-sign",`item-attribute-alien-sign--${l}`)}),r&&e.jsxs(w,{wrap:"wrap",justify:"center",align:"center",style:{maxWidth:50,textAlign:"center",wordBreak:"break-word"},children:[i," ",s[n].name.en.toLowerCase()]})]})}function Hs({keyVariant:t,attributes:s,firstElement:r,lastElement:n}){const{key:l,text:i}=Ze(t),o=r?"It's ":"",c=n?".":", ";return e.jsxs(e.Fragment,{children:[o,i," ",s[l].name.en.toLowerCase(),c]})}function Ys({attributesList:t,itemAttributeValues:s}){const{completion:r,isDeterministic:n,value:l,isOpposing:i,relevancy:o}=p.useMemo(()=>{const c=t.length,m=Object.keys(s.attributes).length,x=Math.floor(m/c*100);let a=!1,u=!1,j=0;const f=Object.values(s.attributes).reduce((h,T)=>T<=0?(T===S.UNCLEAR&&(j+=1),T===S.OPPOSITE&&(u=!0,h+=T/2),h):(T===S.DETERMINISTIC&&(a=!0),h+T),0),g=Math.floor((m-j)/c*100);return{completion:x,isDeterministic:a,value:f,isOpposing:u,relevancy:g}},[t,s.attributes]);return e.jsxs("div",{children:[e.jsx(D.Text,{strong:!0,children:"Completion"}),e.jsx(qe,{percent:r,size:"small"}),e.jsx(D.Text,{strong:!0,children:"Stats"}),e.jsxs(w,{vertical:!0,children:[e.jsx(G,{label:"Deterministic",children:n?e.jsx(ce,{style:{color:"green"}}):e.jsx($e,{style:{color:"red"}})}),e.jsx(G,{label:"Opposing",children:i?e.jsx(ce,{style:{color:"CornflowerBlue"}}):e.jsx($e,{style:{color:"grey"}})}),e.jsx(G,{label:"Value",children:l}),e.jsx(ke,{title:"The percentage of conclusive attributes (not unclear)",children:e.jsxs(G,{label:"Reliability",children:[o,"%"]})})]})]})}function Js(){const{activeItem:t,attributesList:s,itemAttributeValues:r,onAttributeChange:n,jumpToItem:l,attributes:i}=U(),{searchParams:o,removeQueryParam:c}=V(),m=o.get("itemId"),x=o.get("filters");p.useEffect(()=>{m&&(c("itemId"),l("goTo",m))},[m,l,c]);const a=o.get("scope")==="unset",u=p.useMemo(()=>{const j=a?s.filter(f=>!r.attributes[f.id]):s;if(x){const f=x.split(",").reduce((g,h)=>(g[h]=!0,g),{});return j.filter(g=>f[g.id])}return j},[a,t.id,x]);return t?e.jsx(J,{children:e.jsxs("div",{className:"item-attribution-card",children:[e.jsx(Nt,{offsetTop:120,className:"item-attribution-card__item",children:e.jsxs(w,{vertical:!0,gap:6,children:[e.jsx(W,{item:t,width:150}),e.jsx(Z,{item:t}),e.jsx(_,{item:t,language:"en"}),e.jsx(_,{item:t,language:"pt"}),e.jsx(Q,{className:"my-2"}),e.jsx(Ys,{attributesList:s,itemAttributeValues:r}),e.jsx(Q,{className:"my-2"}),e.jsx(D.Text,{type:"secondary",children:e.jsx(qs,{itemAttributeValues:r,attributes:i})})]})}),e.jsx(k,{size:"small",direction:"vertical",className:"my-4 attribute-button-container",wrap:!0,children:u.map(j=>e.jsx(oe,{attribute:j,value:r.attributes[j.id],onChange:n},j.id))})]},`${t.id}`)}):e.jsx(J,{children:e.jsxs(D.Text,{type:"secondary",children:["No item selected."," ",e.jsx(P,{size:"small",type:"primary",onClick:()=>l("random"),children:"Random Item"})]})})}function Ws(){const{jumpToItem:t}=U();return e.jsxs(k.Compact,{children:[e.jsx(P,{onClick:()=>t("first"),icon:e.jsx(Ns,{}),children:"First"}),e.jsx(P,{onClick:()=>t("previous10"),icon:e.jsx(ls,{}),children:"Previous 10"}),e.jsx(P,{onClick:()=>t("previous"),icon:e.jsx(fs,{}),children:"Previous"}),e.jsxs(P,{onClick:()=>t("next"),children:["Next ",e.jsx(As,{})]}),e.jsxs(P,{onClick:()=>t("next10"),children:["Next 10 ",e.jsx(us,{})]}),e.jsxs(P,{onClick:()=>t("last"),children:["Last ",e.jsx(Os,{})]}),e.jsx(Ne,{content:e.jsx(Zs,{}),title:"Go to item",children:e.jsx(P,{children:"Go To"})}),e.jsx(P,{onClick:()=>t("incomplete"),children:"Next Incomplete"})]})}function Zs(){const{jumpToItem:t}=U();return e.jsx(Rt,{isPending:!1,onFinish:s=>t("goTo",s)})}function Xs(){const{addParam:t,queryParams:s}=Le(),{attributesList:r}=U(),n=p.useMemo(()=>r.map(c=>({label:c.name.en,value:c.id})),[r]),l=c=>{t("filters",c.join(","))},i=s.get("filters"),o=e.jsx(ee,{mode:"multiple",style:{width:300},options:n,value:i==null?void 0:i.split(","),onChange:c=>l(c),allowClear:!0});return e.jsx(Ne,{content:o,title:"Filter Attributes",children:e.jsx(P,{children:i?e.jsx(ms,{style:{color:"gold"}}):e.jsx(gs,{})})})}function er(){const{addParam:t,queryParams:s}=Le(),r=[{label:"Id",value:"id"},{label:"Updated At",value:"updatedAt"},{label:"Fewest Attributes Left",value:"fewestAttributesLeft"}],n=s.get("sortBy"),l=e.jsx(ee,{style:{width:120},options:r,value:n,onChange:i=>t("sortBy",i),allowClear:!0});return e.jsx(Ne,{content:l,title:"Sort By",children:e.jsx(P,{children:"Sort"})})}function tr(){const{attributes:t,getItemAttributeValues:s,availableItemIds:r,getItem:n,isLoading:l}=U(),{searchParams:i}=V(),o=i.get("showComplete")==="true",c=i.get("showUnclear")==="true",m=i.get("showUnrelated")==="true",{itemMessages:x,itemMessagesDict:a,grouping:u}=p.useMemo(()=>{if(l)return{itemMessages:[],itemMessagesDict:{},grouping:{}};const j=b.orderBy(r.map(h=>{const T=s(h),A=We(T,t);return{item:n(h),itemAttributesValues:T,message:Xe(A,c,m),fullMessage:A}}).filter(({itemAttributesValues:h})=>o?h.complete:!0),["message"],["asc"]),f=j.reduce((h,{message:T,item:{id:A}})=>{const C=T.join(" ");return h[C]===void 0&&(h[C]=[]),h[C].push(A),h},{}),g=Object.values(f).filter(h=>h.length>1);return g.length>0&&console.log("More than one",g),{itemMessages:j,itemMessagesDict:b.keyBy(j,"item.id"),grouping:f}},[t,r,s,n,l,o,c,m]);return{itemMessages:x,itemMessagesDict:a,grouping:u}}function De(){const{searchParams:t,removeQueryParam:s}=V(),r=t.get("drawer"),[n,l]=p.useState(!1),{activeItem:i,attributesList:o,itemAttributeValues:c,onAttributeChange:m,jumpToItem:x}=U(),a=()=>{s("drawer")};p.useEffect(()=>{r&&x("goTo",r)},[r,x,s]);const u=p.useMemo(()=>n?o.filter(j=>!c.attributes[j.id]):o,[n,i.id]);return e.jsxs($t,{open:!!r,title:`Edit: ${i.name.en}`,onClose:a,width:"640px",children:[e.jsxs(w,{gap:6,children:[e.jsxs(w,{vertical:!0,gap:6,children:[e.jsx(W,{item:i,width:50}),e.jsx(Z,{item:i})]}),e.jsxs(w,{vertical:!0,gap:6,children:[e.jsx(_,{item:i,language:"en"}),e.jsx(_,{item:i,language:"pt"})]}),e.jsx(w,{vertical:!0,gap:6,children:e.jsx(Ft,{checked:n,onChange:l,checkedChildren:"Unset",unCheckedChildren:"All"})})]}),e.jsx(Q,{className:"my-1"}),e.jsx(k,{size:"small",direction:"vertical",className:"my-4 attribute-button-container",wrap:!0,children:u.map(j=>e.jsx(oe,{size:"small",attribute:j,value:c.attributes[j.id],onChange:m},j.id))})]})}function sr(){const{attributes:t}=U(),{itemMessages:s,grouping:r}=tr(),{addQueryParam:n}=V(),l=[{title:"Item Id",dataIndex:"item",key:"id",render:i=>e.jsxs("div",{children:[e.jsx(Z,{item:i}),e.jsxs(P.Group,{children:[e.jsx(ae,{item:i}),e.jsx(P,{size:"small",shape:"round",onClick:()=>n("drawer",i.id),children:"Drawer"})]})]}),sorter:(i,o)=>Number(i.item.id)-Number(o.item.id)},{title:"Sprite",dataIndex:"item",key:"sprite",render:i=>e.jsx(W,{item:i,width:75})},{title:"Name",dataIndex:"item",key:"name",render:i=>e.jsxs(e.Fragment,{children:[e.jsx(_,{item:i,language:"en"}),e.jsx(_,{item:i,language:"pt"})]}),sorter:(i,o)=>i.item.name.en.localeCompare(o.item.name.en)},{title:"Address",dataIndex:"message",key:"message",render:(i,{item:o})=>e.jsx(w,{gap:6,children:i.map((c,m,x)=>e.jsx(it,{keyVariant:c,attributes:t,firstElement:m===0,lastElement:m===x.length-1,withText:!0},`${c}-${o.id}`))}),sorter:(i,o)=>i.message.join(" ").localeCompare(o.message.join(" "))},{title:"Complete",dataIndex:"itemAttributesValues",key:"complete",render:i=>i.complete?"Yes":"No"},{title:"Identical",dataIndex:"message",key:"identical",render:i=>{const o=r[i.join(" ")]??[];return e.jsx(e.Fragment,{children:o.length>1?o.length:"0"})},sorter:(i,o)=>{const c=r[i.message.join(" ")]??[];return(r[o.message.join(" ")]??[]).length-c.length}}];return e.jsxs("div",{className:"my-4",children:[e.jsx(D.Title,{level:5,children:"Item Comparator"}),e.jsx(He,{dataSource:s,columns:l,pagination:{showQuickJumper:!0}}),e.jsx(De,{})]})}function rr(){const{attributesList:t,addAttributesToUpdate:s,getItemAttributeValues:r,availableItemIds:n,addMultipleAttributesToUpdate:l}=U(),{searchParams:i,addQueryParam:o}=V(),c=i.get("attribute")??"ali",m=i.get("scope")??"unset",x=i.get("page")??"1",a=i.get("pageSize")??"12",[u,j]=p.useState("ali"),[f,g]=p.useState("unset"),[h,T]=p.useState(null),[A,C]=p.useState("desc"),I=p.useMemo(()=>{const N=n.map(R=>r(R)),L=m==="unset"?void 0:S[m.toUpperCase()],v=N.filter(R=>{var B;return((B=R.attributes)==null?void 0:B[c])===L}).map(R=>R.id),[E,O]=(h??"::").split("::");return b.orderBy(v,[R=>{var B,Y;return E==="attribute"?(Y=(B=r(R))==null?void 0:B.attributes)==null?void 0:Y[O]:!0},R=>E==="prop"?Number(R):!0,R=>{var B;return(B=r(R))==null?void 0:B.updatedAt},R=>Number(R)],[A,"asc","desc","asc"])},[c,m,h,A]),y=p.useMemo(()=>{if(u!==c||f!==m)return j(c),g(m),o("page","1"),I.slice(0,Number(a));const N=(Number(x)-1)*Number(a),L=N+Number(a);return I.slice(N,L)},[x,a,I]),d=t.find(N=>N.id===c),M=(N,L,v)=>{const E=r(N);s(N,{...E,attributes:{...E.attributes,[L]:v}})},z=()=>{l(y.map(N=>{const L=r(N);return L.attributes[c]||(L.attributes[c]=S.UNRELATED),L}))};return{group:I,stats:{total:n.length,group:I.length,percent:Math.round(I.length/n.length*100)},pageIds:y,attribute:d,updateAttributeValue:M,updatePageItemsAsUnrelated:z,sorting:{sortBy:h,setSortBy:T,sortOrder:A,setSortOrder:C},pagination:{total:I.length,current:Number(x),pageSize:Number(a),onChange:N=>o("page",String(N)),onShowSizeChange:(N,L)=>o("pageSize",String(L)),pageSizeOptions:[12,24,48,96]}}}const nr=(t,s)=>s==="unset"||!s?`${100-t.percent}% done, ${t.group} left`:`${t.percent}%  - ${t.group} items`;function ir(){const{getItem:t,getItemAttributeValues:s,attributesList:r}=U(),{attribute:n,pageIds:l,updateAttributeValue:i,updatePageItemsAsUnrelated:o,pagination:c,stats:m,sorting:x}=rr(),{searchParams:a,addQueryParam:u}=V(),j=ts("(max-width: 1024px)");if(b.isEmpty(n))return e.jsx(J,{className:"my-4",children:e.jsx(D.Text,{type:"secondary",children:"No group attribute has been selected."})});const f=e.jsx(Ut,{onChange:c.onChange,current:c.current,total:c.total,pageSizeOptions:c.pageSizeOptions,pageSize:c.pageSize,onShowSizeChange:c.onShowSizeChange},"pagination"),g=e.jsxs(w,{align:"center",children:[e.jsx(D.Text,{className:"mr-2",children:"Sort by"}),e.jsxs(ee,{style:{width:120},value:x.sortBy,onChange:A=>x.setSortBy(A),children:[e.jsx(ee.Option,{value:null,children:"Last Updated"}),e.jsx(ee.Option,{value:"prop::id",children:"Id"}),r.map(A=>e.jsx(ee.Option,{value:`attribute::${A.id}`,children:A.name.en},A.id))]})]}),T=(a.get("scope")==="unset"||!a.get("scope"))&&e.jsx(zt,{title:`Are you sure everything is unrelated to ${n.name.en}?`,onConfirm:o,children:e.jsx(P,{type:"primary",danger:!0,disabled:l.length===0,children:"Unrelate Unset Items on Page"})},"unrelate-button");return e.jsxs(J,{className:"my-4",title:e.jsxs(D.Text,{children:[n==null?void 0:n.name.en," (",nr(m,a.get("scope")),") -"," ",n.description.en]}),extra:e.jsxs(w,{align:"center",children:[g,f]}),actions:[T,e.jsx(rt,{},"go-to-top"),f].filter(Boolean),children:[l.length===0&&e.jsx(ie,{description:"No items found in this scope for this attribute.",image:ie.PRESENTED_IMAGE_SIMPLE}),l.map(A=>{const C=s(A),I=t(A);return e.jsx(J.Grid,{style:{width:j?"50%":"25%"},children:e.jsxs(w,{gap:6,children:[e.jsxs(w,{vertical:!0,gap:6,children:[e.jsx(W,{item:I,width:75}),e.jsx(Z,{item:I}),e.jsxs(P.Group,{children:[e.jsx(ae,{item:I}),e.jsx(P,{size:"small",shape:"round",onClick:()=>u("drawer",I.id),children:"Drawer"})]}),e.jsx(_,{item:I,language:"en"}),e.jsx(_,{item:I,language:"pt"})]}),e.jsx(oe,{attribute:n,value:C.attributes[n.id],onlyButtons:!0,onChange:(y,d)=>i(I.id,y,d)})]})},`${A}-${C.updatedAt}`)}),e.jsx(De,{})]})}function at(){const{attributesList:t,availableItemIds:s,addAttributesToUpdate:r,getItemAttributeValues:n}=U(),{searchParams:l}=V(),[i,o]=p.useState([]),[c,m]=p.useState(),x=()=>{var C;const f=l.get("attribute")??((C=b.sample(t))==null?void 0:C.id)??"ali",g=t.find(I=>I.id===f)??b.sample(t),h=Number(l.get("size"))||9,T=[],A=b.shuffle(s);for(let I=0;I<A.length&&T.length!==h;I++){const y=A[I];n(y).attributes[f]||T.push(y)}return{selectedAttribute:g,selected:T}},a=()=>{let f=x(),g=0;for(;f.selected.length===0&&g<30;)f=x(),g++;m(f.selectedAttribute),o(f.selected)},u=p.useMemo(()=>c?s.filter(f=>!n(f).attributes[c==null?void 0:c.id]).length:0,[c,s]);return{sampleIds:i,attribute:c,itemsLeftForAttribute:u,onGetSample:a,updateAttributeValue:(f,g,h)=>{const T=n(f);r(f,{...T,attributes:{...T.attributes,[g]:h}})}}}function ar(){const{getItem:t,getItemAttributeValues:s}=U(),{sampleIds:r,attribute:n,onGetSample:l,updateAttributeValue:i,itemsLeftForAttribute:o}=at(),{addQueryParam:c}=V();if(b.isEmpty(r)&&b.isEmpty(n))return e.jsxs(J,{className:"my-4",children:[e.jsxs(D.Text,{type:"secondary",children:["No sample has been generated. Tweak options and"," ",e.jsx(P,{size:"small",type:"primary",onClick:l,children:"Get Sample"})]}),e.jsx(Q,{}),e.jsx(Be,{})]});const m=r.map(u=>({itemAttributes:s(u),item:t(u)})),x=m.filter(({itemAttributes:u})=>(n==null?void 0:n.id)&&!u.attributes[n.id]),a=()=>{x.forEach(({item:u})=>{n!=null&&n.id&&i(u.id,n.id,-3)})};return e.jsxs(e.Fragment,{children:[e.jsx(Be,{}),e.jsxs(J,{className:"my-4",title:e.jsxs(D.Text,{children:[n==null?void 0:n.name.en," - ",n==null?void 0:n.description.en," (",o," items left)"]}),actions:[e.jsx(P,{onClick:a,danger:!0,disabled:x.length===0,children:"Mark rest as unrelated"},"1"),e.jsx(P,{type:"primary",ghost:!0,onClick:l,children:"Get New Sample"},"2")],extra:e.jsx(P,{type:"primary",size:"small",onClick:l,children:"Get New Sample"}),children:[e.jsxs(w,{vertical:!0,gap:6,children:[m.length===0&&e.jsx(ie,{description:"No unset items found for this attribute.",image:ie.PRESENTED_IMAGE_SIMPLE}),m.map(({item:u,itemAttributes:j})=>e.jsxs(p.Fragment,{children:[e.jsxs(w,{gap:6,children:[e.jsx(W,{item:u,width:75}),e.jsxs(w,{vertical:!0,gap:6,children:[e.jsxs(w,{gap:6,children:[e.jsx(Z,{item:u}),e.jsxs(P.Group,{children:[e.jsx(ae,{item:u}),e.jsx(P,{size:"small",shape:"round",onClick:()=>c("drawer",u.id),children:"Drawer"})]})]}),e.jsx(_,{item:u,language:"en"}),e.jsx(_,{item:u,language:"pt"})]}),!!n&&e.jsx(oe,{attribute:n,value:j.attributes[n.id],onChange:(f,g)=>i(u.id,f,g)})]}),e.jsx(Q,{className:"my-1"})]},`${u.id}-${j.updatedAt}`))]}),e.jsx(De,{})]})]})}function Be(){const[t,s]=Bt(!1),{addQueryParam:r,removeQueryParam:n}=V(),{sampleIds:l,attribute:i,onGetSample:o,updateAttributeValue:c}=at(),{getItem:m,getItemAttributeValues:x}=U(),a=()=>{r("size","1"),s(!0),o()},u=()=>{n("size"),s(!1)},j=l[0],f=m(j),g=x(j);return e.jsxs(w,{className:"mt-4",children:[e.jsx(P,{type:"primary",onClick:a,children:"Single Sampler"}),e.jsxs(_t,{title:e.jsxs(D,{children:["Single Sampler: ",e.jsx("strong",{children:i==null?void 0:i.name.en})]}),open:t,width:"100vw",maskClosable:!1,onOk:u,onClose:u,onCancel:u,cancelButtonProps:{style:{display:"none"}},children:[j&&f&&g&&i&&e.jsxs(w,{gap:6,className:"my-10",wrap:"wrap",children:[e.jsx(W,{item:f,width:150}),e.jsxs(w,{vertical:!0,gap:6,children:[e.jsxs(w,{gap:6,children:[e.jsx(Z,{item:f}),e.jsx(ae,{item:f})]}),e.jsx(_,{item:f,language:"en"}),e.jsx(_,{item:f,language:"pt"})]}),!!i&&e.jsx(oe,{size:"large",attribute:i,value:g.attributes[i.id],onChange:async(h,T)=>{c(f.id,h,T),await Tt(500),o()}})]},j),e.jsx(P,{onClick:o,children:"Another Sample"})]})]})}function or(){const t=ne("items-attributes"),s=ne("items-attribute-values"),[r,n]=p.useState(null),l=()=>{n(_e(t.data,s.data))},i=()=>{const o={};let c=0;for(;c<300||b.keys(o).length===15;){const m=_e(t.data,s.data);if(m.valid&&!o[m.setId]&&(o[m.setId]=m),b.keys(o).length>=15)break;c+=1}console.log("TRIES",c),console.log(Object.values(o).map((m,x)=>({...m,number:m.number-x})))};return e.jsxs("div",{className:"my-4",children:[e.jsx(D.Title,{level:3,children:"Daily Simulator"}),e.jsx(D.Paragraph,{children:"Generates a daily game for Alien Communication"}),e.jsxs(k,{children:[e.jsx(P,{type:"primary",onClick:l,children:"Generate"}),e.jsx(P,{onClick:i,children:"Generate List"})]}),e.jsx("div",{children:!!r&&e.jsxs(k,{direction:"vertical",children:[e.jsx(D.Title,{level:5,children:r==null?void 0:r.setId}),!(r!=null&&r.valid)&&e.jsx(gt,{type:"error",message:"Invalid game"}),e.jsx(k,{direction:"vertical",children:r==null?void 0:r.attributes.map(o=>e.jsxs(w,{gap:8,children:[e.jsx(H,{id:o.spriteId,width:50}),o.itemsIds.map(c=>e.jsx(Ve,{id:c||"0",width:50},c))]},o.id))}),e.jsx(Q,{className:"my-1"}),e.jsx(k,{direction:"horizontal",children:r==null?void 0:r.requests.map(o=>e.jsxs(w,{vertical:!0,children:[e.jsx(H,{id:o.spritesIds[2],width:50}),e.jsx(H,{id:o.spritesIds[1],width:50}),e.jsx(H,{id:o.spritesIds[0],width:50})]},o.itemId))}),e.jsx(Q,{className:"my-1"}),e.jsx(k,{direction:"horizontal",children:r==null?void 0:r.itemsIds.map(o=>e.jsx(Ve,{id:o||"0",width:50},o))})]},r==null?void 0:r.setId)})]})}const _e=(t,s)=>{const r=b.values(t).filter(d=>!d.limited||d.id==="sol"),n=b.shuffle(b.values(s).filter(d=>d.complete)),l=b.shuffle(Ct(38,0)),i=b.sampleSize(r,3).map(d=>({...d,spriteId:`${l.pop()}`})),o=[],c=[],m=[],x=[],a=[],u=[],j=[],f=[];n.forEach(d=>{const M=[S.DETERMINISTIC,S.RELATED],z=d.attributes[i[0].id]===S.DETERMINISTIC,N=M.includes(d.attributes[i[0].id]),L=d.attributes[i[0].id]===S.UNRELATED,v=d.attributes[i[1].id]===S.DETERMINISTIC,E=M.includes(d.attributes[i[1].id]),O=d.attributes[i[1].id]===S.UNRELATED,R=d.attributes[i[2].id]===S.DETERMINISTIC,B=M.includes(d.attributes[i[2].id]),Y=d.attributes[i[2].id]===S.UNRELATED;if(L&&O&&Y)return f.push(d.id);z&&O&&Y&&o.push(d.id),L&&v&&Y&&c.push(d.id),L&&O&&R&&m.push(d.id),N&&E&&Y&&x.push(d.id),N&&O&&B&&a.push(d.id),L&&E&&B&&u.push(d.id),N&&E&&B&&j.push(d.id)});const g=i.map(d=>({id:d.id,name:d.name.pt,description:d.description.pt,spriteId:d.spriteId,itemsIds:[]}));g[0].itemsIds=b.sampleSize(o,o.length>3?3:Math.max(o.length-1,1)),g[1].itemsIds=b.sampleSize(c,c.length>3?3:Math.max(o.length-1,1)),g[2].itemsIds=b.sampleSize(m,m.length>3?3:Math.max(o.length-1,1));const h=[];g.forEach(d=>{h.push(...d.itemsIds)});const T=[];x.length>0&&T.push({spritesIds:[i[0].spriteId,i[1].spriteId],itemId:b.sample(x)??""}),a.length>0&&T.push({spritesIds:[i[0].spriteId,i[2].spriteId],itemId:b.sample(a)??""}),u.length>0&&T.push({spritesIds:[i[1].spriteId,i[2].spriteId],itemId:b.sample(u)??""}),j.length>0&&T.push({spritesIds:i.map(d=>d.spriteId),itemId:b.sample(j)??""});const A=[];o.length>0&&A.push({spritesIds:[i[0].spriteId],itemId:o.filter(d=>!h.includes(d))[0]}),c.length>0&&A.push({spritesIds:[i[1].spriteId],itemId:c.filter(d=>!h.includes(d))[0]}),m.length>0&&A.push({spritesIds:[i[2].spriteId],itemId:m.filter(d=>!h.includes(d))[0]}),console.log({attributeA:o,attributeB:c,attributeC:m,attributeAB:x,attributeAC:a,attributeBC:u,attributeABC:j}),console.log("COMPLEX REQUEST SIZE",T.length),console.log("SIMPLE REQUEST SIZE",A.length);let C=b.sampleSize(T,4);console.log("REQUEST SIZE",C.length),C.length<3&&C.push(...b.sampleSize(A,4-C.length)),C.length<4&&console.warn("Not enough requests"),C=b.shuffle(C);const I=C.map(d=>d.itemId),y={id:"2024-00-00",setId:g.map(d=>d.id).sort().join("-"),number:0,type:"comunicação-alienígena",attributes:g,requests:C,solution:I.join("-"),itemsIds:b.shuffle([...I,f[0],f[1],f[2],f[3]]).filter(Boolean),valid:!1};return y.valid=[y.attributes.length===3,y.requests.length===4,y.itemsIds.length>5,y.attributes.every(d=>d.itemsIds.length>0),y.requests.every(d=>d.itemId)].every(Boolean),console.log(y),y},lr=["","I","II","III","IV","V"];function cr(){const{attributes:t,availableItemIds:s,getItemAttributeValues:r,getItem:n}=U(),{message:l}=Pe.useApp(),[i,o]=p.useState(25),[c,m]=p.useState(80),[x,a]=p.useState(!1),[u,j]=p.useState([]),[f,g]=p.useState([]),[h,T]=p.useState(null),[A,C]=p.useState({id:!0,nameEn:!0,namePt:!0,reliability:!0}),I=()=>{const d={},M=b.shuffle(s);for(;Object.values(d).length<i;){const v=M.pop();if(!v)break;const E=r(v);E&&(!E.complete||!E.reliability||E.reliability<c||!x&&n(v).nsfw||(E.signature&&!d[E.signature]?d[E.signature]=v:console.log("Item has identical key to another item. Skipping.",n(v).name.en)))}const z=Object.values(d);z.length<i&&l.error(`Could not generate sample. Got only ${z.length} items`),j(b.sortBy(z,v=>Number(v)));const N=ur(z.map(v=>r(v)),25,t);if(N.length<25){const v=b.keys(t).filter(R=>!N.includes(R)),O=b.sortBy(v,R=>t[R].priority).slice(0,25-N.length);console.log("Adding more attributes by priority",O),N.push(...O)}const L=N.reduce((v,E)=>(z.forEach(O=>{const R=r(O);if(R)switch(R.attributes[E]){case S.RELATED:v.relatedCount[E]=(v.relatedCount[E]||0)+1;break;case S.DETERMINISTIC:v.deterministicCount[E]=(v.deterministicCount[E]||0)+1;break;case S.UNCLEAR:v.unclearCount[E]=(v.unclearCount[E]||0)+1;break;case S.OPPOSITE:v.oppositeCount[E]=(v.oppositeCount[E]||0)+1;break}}),v),{relatedCount:{},deterministicCount:{},unclearCount:{},oppositeCount:{}});g(N.sort().map(v=>({...t[v],relatedCount:L.relatedCount[v],deterministicCount:L.deterministicCount[v],unclearCount:L.unclearCount[v],oppositeCount:L.oppositeCount[v]})))},y=d=>{C(M=>({...M,[d]:!M[d]}))};return e.jsxs("div",{className:"my-4",children:[e.jsx(D.Title,{level:3,children:"Simulator"}),e.jsx(D.Paragraph,{children:"Generates a board with items different enough to get Deterministic values in all selected attributes."}),e.jsxs(w,{wrap:!0,gap:12,children:[e.jsx(te,{label:"Grid Size",value:i,onChange:d=>o(d),options:[16,25]}),e.jsx(Ge,{label:"Reliability Threshold",value:c,onChange:d=>m(d),step:5,min:10,max:100}),e.jsx(K,{label:"NSFW",value:x,onChange:a}),e.jsx(P,{onClick:I,type:"primary",children:"Get Sample Board"})]}),e.jsxs(w,{wrap:!0,gap:12,children:[e.jsx(le,{label:"Show Id",value:!!A.id,onChange:()=>y("id")}),e.jsx(le,{label:"Show Name (EN)",value:!!A.nameEn,onChange:()=>y("nameEn")}),e.jsx(le,{label:"Show Name (PT)",value:!!A.namePt,onChange:()=>y("namePt")}),e.jsx(le,{label:"Show Reliability",value:!!A.reliability,onChange:()=>y("reliability")})]}),e.jsx("div",{className:"simulator-grid",style:{gridTemplateColumns:`repeat(${Math.sqrt(i)}, 1fr)`},children:u.map(d=>{const M=n(d),z=r(d);return e.jsxs(k,{direction:"vertical",className:ue("simulator-grid__entry",h&&z.attributes[h]>0&&"simulator-grid__entry--highlighted"),align:"center",children:[e.jsxs(k,{children:[e.jsxs(w,{vertical:!0,children:[A.id&&e.jsx(Z,{item:M}),A.reliability&&e.jsx("span",{children:e.jsx(xt,{prefix:e.jsx(xs,{}),placeholder:"Reliability",variant:"borderless",size:"small",value:z.reliability,readOnly:!0,style:{width:"8ch"},formatter:N=>`${N}%`})}),A.id&&e.jsx(ae,{item:M})]}),e.jsx(W,{item:M,width:50})]}),A.nameEn&&e.jsx(_,{item:M,language:"en"}),A.namePt&&e.jsx(_,{item:M,language:"pt"})]},d)})}),e.jsx("div",{className:"simulator-grid my-4",children:f.map(d=>e.jsxs(kt,{className:ue("simulator-grid__entry","simulator-grid__button",h===d.id&&"simulator-grid__entry--highlighted"),onClick:()=>T(d.id),children:[d.name.en," ",lr[d.level],e.jsxs(w,{gap:6,justify:"center",className:"my-1",children:[e.jsxs("span",{children:[e.jsx(rs,{style:{color:d.deterministicCount?"dodgerblue":void 0}})," ",d.deterministicCount??0]}),e.jsxs("span",{children:[e.jsx(Is,{style:{color:d.relatedCount?"green":void 0}})," ",d.relatedCount??0]}),e.jsxs("span",{children:[e.jsx(as,{style:{color:d.oppositeCount?"red":void 0}})," ",d.oppositeCount??0]}),e.jsxs("span",{children:[e.jsx(Ye,{style:{color:d.unclearCount?"gold":void 0}})," ",d.unclearCount??0]})]})]},d.id))}),e.jsx(or,{})]})}function ur(t,s,r){const n={},l={};t.forEach(g=>{g&&Object.keys(g.attributes).forEach(h=>{g.attributes[h]>0&&(n[h]=(n[h]||0)+1),g.attributes[h]===S.DETERMINISTIC&&(l[h]=!0,n[h]=(n[h]||0)+2),g.attributes[h]===S.OPPOSITE&&(n[h]=(n[h]||0)+1)})});const i={1:0,2:0,3:0,4:0};function o(g){return g.filter(h=>(i[r[h].level]++,i[4]>1?(console.log("Discarding level 4 attribute",h),!1):!0))}const c=o(Object.keys(l)),m=o(b.keys(n).filter(g=>!c.includes(g)));if(console.log({levelCount:i}),s===c.length)return console.log("All keys are deterministic"),c;if(console.log(n),c.length===0)return[];const x=c.reduce((g,h)=>{const T=n[h];return g[T]||(g[T]=[]),g[T].push(h),g},{}),a=b.keys(x).sort((g,h)=>Number(h)-Number(g));console.log({sortedDeterministicTiedGroupsKeys:a});const u=m.reduce((g,h)=>{const T=n[h];return g[T]||(g[T]=[]),g[T].push(h),g},{});console.log(u);const j=b.keys(u).sort((g,h)=>Number(h)-Number(g)),f=[];for(const g of a){if(f.length===s)break;f.push(...b.sampleSize(x[g],s-f.length))}for(const g of j){if(f.length===s)break;f.push(...b.sampleSize(u[g],s-f.length))}return f}function dr(){const{attributes:t}=U(),s=[{key:"1",label:"All Attributes",children:e.jsx(X,{type:"all"})},{key:"2",label:"Default",children:e.jsx(X,{type:"default"})},{key:"3",label:"Custom",children:e.jsx(X,{type:"custom"})},{key:"4",label:"Limited",children:e.jsx(X,{type:"limited"})},{key:"5",label:"Specific",children:e.jsx(X,{type:"specific"})},{key:"6",label:"Opposite",children:e.jsx(X,{type:"opposite"})}];return e.jsxs("div",{className:"my-4",children:[e.jsxs(w,{justify:"space-between",align:"center",children:[e.jsx(D.Title,{level:5,children:"Stats"}),e.jsx(Qe,{data:()=>pr(t),fileName:"items-attributes.json",children:"Download Attribute Json"})]}),e.jsx(Gt,{defaultActiveKey:"1",items:s})]})}const mr=(t,s)=>{let r=0,n=0,l=0,i=0,o=0,c=0,m=0,x=0;s.forEach(({attributes:I})=>{if(I[t.id]){r++;const y=I[t.id];y===10?n++:y===5?l++:y===0||!y?i++:y===-1?o++:y===-3?c++:y===-10&&m++,y>0&&x++}});const a=s.length,u=r/a*100,j=n/a*100,f=l/a*100,g=i/a*100,h=o/a*100,T=c/a*100,A=m/a*100,C=x/a*100;return{completionPercentage:u.toFixed(1),tensPercentage:j.toFixed(1),fivesPercentage:f.toFixed(1),zerosPercentage:g.toFixed(1),negativeOnesPercentage:h.toFixed(1),negativeThreesPercentage:T.toFixed(1),negativeTensPercentage:A.toFixed(1),positivePercentage:C.toFixed(1)}};function X({type:t}){const{availableItemIds:s,getItemAttributeValues:r,attributesList:n}=U(),l=ht(),{is:i}=Le(),o=p.useMemo(()=>{const a=new Array(65).fill(0).map((j,f)=>f),u=n.map(j=>j.spriteId);return a.filter(j=>!u.includes(`sign-${j}`))},[n]),c=p.useMemo(()=>t==="default"?n.filter(a=>a.default):t==="custom"?n.filter(a=>!a.default):t==="limited"?n.filter(a=>a.limited):t==="specific"?n.filter(a=>a.specific):t==="opposite"?n.filter(a=>a.oppositeId):n,[n,t]),m=p.useMemo(()=>{const a=s.map(u=>r(u));return c.map(u=>({...u,...mr(u,a)}))},[c,s,r]),x=[{title:"Attribute",dataIndex:"name",key:"name",render:(a,u)=>e.jsxs(w,{align:"center",gap:8,children:[i("showGlyphs")&&e.jsx(H,{id:u.spriteId,width:30}),a.en,u.default&&e.jsx(re,{className:"ml-1",children:"default"}),u.limited&&e.jsx(re,{className:"ml-1",children:"limited"}),(u.specific||u.parentId)&&e.jsx(re,{className:"ml-1",children:"specific"}),u.oppositeId&&e.jsx(re,{className:"ml-1",children:e.jsx(Cs,{})}),e.jsx(nt,{title:u.description.en})]}),sorter:(a,u)=>a.name.en.localeCompare(u.name.en)},{title:e.jsx(Qt,{}),dataIndex:"spriteId",key:"spriteId",render:a=>e.jsx(H,{id:a,width:18,padding:0})},{title:"Priority",dataIndex:"priority",key:"priority",sorter:(a,u)=>a.priority-u.priority},{title:"Positive",dataIndex:"positivePercentage",key:"positivePercentage",render:a=>`${a}%`,sorter:(a,u)=>Number.parseFloat(a.positivePercentage)-Number.parseFloat(u.positivePercentage)},{title:"10",dataIndex:"tensPercentage",key:"tensPercentage",render:(a,u)=>u.limited?"-":`${a}%`,sorter:(a,u)=>Number.parseFloat(a.tensPercentage)-Number.parseFloat(u.tensPercentage)},{title:"5",dataIndex:"fivesPercentage",key:"fivesPercentage",render:a=>`${a}%`,sorter:(a,u)=>Number.parseFloat(a.fivesPercentage)-Number.parseFloat(u.fivesPercentage)},{title:"-1",dataIndex:"negativeOnesPercentage",key:"negativeOnesPercentage",render:a=>`${a}%`,sorter:(a,u)=>Number.parseFloat(a.negativeOnesPercentage)-Number.parseFloat(u.negativeOnesPercentage)},{title:"-3",dataIndex:"negativeThreesPercentage",key:"negativeThreesPercentage",render:a=>`${a}%`,sorter:(a,u)=>Number.parseFloat(a.negativeThreesPercentage)-Number.parseFloat(u.negativeThreesPercentage)},{title:"-10",dataIndex:"negativeTensPercentage",key:"negativeTensPercentage",render:a=>`${a}%`,sorter:(a,u)=>Number.parseFloat(a.negativeTensPercentage)-Number.parseFloat(u.negativeTensPercentage)},{title:"Completion",dataIndex:"completionPercentage",key:"completionPercentage",render:a=>e.jsx(qe,{percent:Number.parseFloat(a),size:"small"}),sorter:(a,u)=>Number.parseFloat(a.completionPercentage)-Number.parseFloat(u.completionPercentage)},{title:"Level",dataIndex:"level",key:"level",render:a=>e.jsx(Kt,{count:4,value:a,disabled:!0}),sorter:(a,u)=>a.level-u.level},{title:"Actions",key:"actions",render:a=>e.jsx(k,{children:e.jsxs(P.Group,{children:[e.jsx(P,{size:"small",shape:"round",onClick:()=>l(`/items/attribution?view=grouping&attribute=${a.id}&page=1`),children:"Grouping"}),e.jsx(P,{size:"small",shape:"round",onClick:()=>l(`/items/attribution?view=sampler&attribute=${a.id}&size=6`),children:"Sample"})]})})}];return e.jsxs(e.Fragment,{children:[e.jsxs(D.Paragraph,{children:["Total: ",m.length]}),e.jsx(He,{columns:x,dataSource:m,pagination:!1,rowKey:"id",size:"small"}),e.jsx(w,{wrap:"wrap",gap:8,children:o.map(a=>e.jsxs("div",{children:["#",a,e.jsx(H,{id:`sign-${a}`},a)]},a))})]})}function pr(t){const s=b.cloneDeep(t);return Re(Ke(s),["description","priority","level","spriteId","oppositeId","relatedId","default","limited","specific","keywords"])}function gr(){const{view:t}=V();return t==="classifier"?e.jsxs(e.Fragment,{children:[e.jsxs(w,{className:"my-4",gap:8,children:[e.jsx(Ws,{}),e.jsx(Xs,{}),e.jsx(er,{})]}),e.jsx(Js,{}),e.jsx(w,{justify:"flex-end",className:"my-4",children:e.jsx(rt,{})})]}):t==="sampler"?e.jsx(ar,{}):t==="grouping"?e.jsx(ir,{}):t==="comparator"?e.jsx(sr,{}):t==="simulator"?e.jsx(cr,{}):t==="stats"?e.jsx(dr,{}):e.jsx(ie,{className:"my-10",description:"Unknown view has been selected"})}function hr(){const{isLoading:t,error:s,hasResponseData:r}=U();return e.jsx(ft,{title:"Items",subtitle:"Attribution",children:e.jsxs(Ue,{hasSider:!0,children:[e.jsx(Pt,{children:e.jsx(Qs,{})}),e.jsx(Ue.Content,{className:"content",children:e.jsx(bt,{isLoading:t,error:s,hasResponseData:r,children:e.jsx(gr,{})})})]})})}function jn(){return e.jsx($s,{children:e.jsx(hr,{})})}export{jn as default};
