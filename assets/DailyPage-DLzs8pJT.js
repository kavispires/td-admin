import{r as b,d as ye,j as t,T as V,F as C,S as F,b as ue,B,e as ie,f as re,g as Re,A as T,h as Pe,D as Ye,i as Ge,u as Ue,s as fe,k as _e,P as qe,L as ge}from"./index-Bl1jfJHn.js";import{u as be}from"./useQueryParams-BmQiP3JR.js";import{R as De}from"./main-DZTN2rKk.js";import{u as Fe,C as Ve,a as ve}from"./useArteRuimDrawings-BpaOjvzs.js";import{u as Ae}from"./useMutation-DKqmMZTu.js";import{g as $e,u as Qe}from"./useGetFirestoreDoc-CLYR9ssq.js";import{h as U}from"./moment-B-YVwB4U.js";import{a as ae,m as Be,r as Ce,b as We}from"./index-C8-I1wI_.js";import{T as He,a as ne,F as ze}from"./FilterEntries-CrUHyoRW.js";import{T as H}from"./index-DAR1ycs3.js";import{S as Ke}from"./index-BpL3IJlO.js";import{F as me}from"./FirestoreConsoleLink-D7TLbPpZ.js";import{C as Se}from"./CopyToClipboardButton-DoK9eXNN.js";import{I as Z}from"./ImageCard-CxKWhgO2.js";import{A as Je,W as Xe,b as $,c as he}from"./constants-DXzj78ES.js";import{I as Q}from"./Item-BHxkj8-I.js";import{S as Ze,t as et,g as Ee,c as tt}from"./useTestimoniesResource-DrVKJBXy.js";import{l as h,P as st}from"./useBaseUrl-Dk0cVXCz.js";import{g as nt,u as _,D as y,a as q,c as z,A as it,L as we}from"./useParsedHistory-CS0Q2tKp.js";import{R as rt,a as at}from"./Pagination-DndbgHRq.js";import{F as Ne}from"./Table-OgMT2KJS.js";import{D as ot}from"./DataLoadingWrapper-Bps_4g2X.js";import{u as R}from"./useTDResource-DMA8QwN5.js";import{a as W,c as lt,u as ct}from"./warnings-Dneq4HJG.js";import{d as pe,u as dt,a as ut,t as P}from"./daily-espionagem-DKUqIZBJ.js";import{u as oe}from"./useLoadWordLibrary-DyVqQQdS.js";import{u as mt}from"./daily-quartetos-C3j7WtHf.js";import{u as ht}from"./daily-teoria-de-conjuntos-EioeKqFV.js";import{u as Te}from"./useDailyHistoryQuery-DDTl9hAx.js";import{R as pt}from"./CloudSyncOutlined-Dp1jv6pW.js";import{R as ft}from"./SaveOutlined-D0d549j5.js";import{S as le}from"./SiderContent-CEm5V-VF.js";import{R as gt}from"./ContainerOutlined-BokFQnDG.js";import{C as Y}from"./index-BHfkKfMc.js";import"./index-C9yLx269.js";import"./index-CpcfmBtc.js";import"./PlusOutlined-78NXxaF9.js";import"./index-BNuApvwJ.js";import"./useCopyToClipboardFunction-CmXuRkRd.js";import"./VirtualizationWrapper-C4BynriN.js";import"./useResourceFirestoreData-JvuRoPo2.js";import"./useUpdateFirestoreDoc-SeBKhASe.js";import"./index-CZEJRKee.js";import"./Dropdown-BUMd9h61.js";import"./index-d5hN45Li.js";import"./scrollTo-LCsUDcON.js";var xt={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M518.3 459a8 8 0 00-12.6 0l-112 141.7a7.98 7.98 0 006.3 12.9h73.9V856c0 4.4 3.6 8 8 8h60c4.4 0 8-3.6 8-8V613.7H624c6.7 0 10.4-7.7 6.3-12.9L518.3 459z"}},{tag:"path",attrs:{d:"M811.4 366.7C765.6 245.9 648.9 160 512.2 160S258.8 245.8 213 366.6C127.3 389.1 64 467.2 64 560c0 110.5 89.5 200 199.9 200H304c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8h-40.1c-33.7 0-65.4-13.4-89-37.7-23.5-24.2-36-56.8-34.9-90.6.9-26.4 9.9-51.2 26.2-72.1 16.7-21.3 40.1-36.8 66.1-43.7l37.9-9.9 13.9-36.6c8.6-22.8 20.6-44.1 35.7-63.4a245.6 245.6 0 0152.4-49.9c41.1-28.9 89.5-44.2 140-44.2s98.9 15.3 140 44.2c19.9 14 37.5 30.8 52.4 49.9 15.1 19.3 27.1 40.7 35.7 63.4l13.8 36.5 37.8 10C846.1 454.5 884 503.8 884 560c0 33.1-12.9 64.3-36.3 87.7a123.07 123.07 0 01-87.6 36.3H720c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h40.1C870.5 760 960 670.5 960 560c0-92.7-63.1-170.7-148.6-193.3z"}}]},name:"cloud-upload",theme:"outlined"};function ce(){return ce=Object.assign?Object.assign.bind():function(e){for(var i=1;i<arguments.length;i++){var r=arguments[i];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},ce.apply(this,arguments)}const jt=(e,i)=>b.createElement(ye,ce({},e,{ref:i,icon:xt})),It=b.forwardRef(jt);var yt={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M396 512a112 112 0 10224 0 112 112 0 10-224 0zm546.2-25.8C847.4 286.5 704.1 186 512 186c-192.2 0-335.4 100.5-430.2 300.3a60.3 60.3 0 000 51.5C176.6 737.5 319.9 838 512 838c192.2 0 335.4-100.5 430.2-300.3 7.7-16.2 7.7-35 0-51.5zM508 688c-97.2 0-176-78.8-176-176s78.8-176 176-176 176 78.8 176 176-78.8 176-176 176z"}}]},name:"eye",theme:"filled"};function de(){return de=Object.assign?Object.assign.bind():function(e){for(var i=1;i<arguments.length;i++){var r=arguments[i];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},de.apply(this,arguments)}const bt=(e,i)=>b.createElement(ye,de({},e,{ref:i,icon:yt})),Dt=b.forwardRef(bt);function vt(){const[e,i]=b.useState(""),[r,a]=b.useState(7),[s,n]=b.useState(!1),[o,c]=b.useState(!1),[l,d]=b.useState(""),{isLoading:m,isError:u,data:f}=At(e,r,o),g=j=>{n(!1),c(!1),i(j.trim())},I=j=>{c(!1),a(j)},x=()=>{const j=U(e,"YYYY-MM-DD",!0).isValid();n(j),c(j)},S=b.useMemo(()=>{if(!f||Object.keys(f).length===0)return{};if(!l)return f;const j=l;if(!Object.values(f).every(D=>D?.[j]))return f;const A={};return Object.values(f).forEach(D=>{const p=D?.[j],w=p?.number;A[w]&&console.error(`Duplicate entry for game ${j} with number ${w}`),A[w]=ae(p,["number","language","text"])}),A},[f,l]);return t.jsxs("div",{children:[t.jsx(V.Title,{level:2,children:"Data Archive"}),t.jsxs(C,{align:"center",className:"mb-6",justify:"space-between",children:[t.jsxs(C,{align:"center",gap:12,children:[t.jsxs(F.Compact,{children:[t.jsx(ue,{onChange:j=>g(j.target.value),placeholder:"YYYY-MM-DD",value:e}),t.jsx(He,{max:100,min:1,onChange:j=>I(j??1),value:r}),t.jsx(B,{disabled:!e||!U(e,"YYYY-MM-DD",!0).isValid(),onClick:x,type:"primary",children:"Load"})]}),e&&t.jsxs("span",{children:[t.jsx(H,{children:e}),r>1&&t.jsxs(t.Fragment,{children:["to"," ",t.jsx(H,{children:U(e).add(r-1,"days").format("YYYY-MM-DD")})]})]}),t.jsx("span",{children:t.jsx(H,{color:m?"blue":u?"red":s?"green":"gray",children:m?"Loading...":u?"Error":s?"Valid":"Ready"})})]}),t.jsxs(C,{align:"center",gap:12,children:[t.jsx(Ct,{}),t.jsx(Ke,{allowClear:!0,onChange:j=>d(j),options:[{value:"",label:"All games"},{value:"aqui-o",label:"Aqui Ã“"},{value:"arte-ruim",label:"Arte Ruim"},{value:"artista",label:"Artista"},{value:"comunicacao-alienigena",label:"ComunicaÃ§Ã£o AlienÃ­gena"},{value:"controle-de-estoque",label:"Controle de Estoque"},{value:"filmaco",label:"FilmaÃ§o"},{value:"palavreado",label:"Palavreado"},{value:"portais-magicos",label:"Portais MÃ¡gicos"},{value:"quartetos",label:"Quartetos"},{value:"ta-na-cara",label:"TÃ¡ na Cara"},{value:"teoria-de-conjuntos",label:"Teoria de Conjuntos"}],placeholder:"Filter by game",style:{width:200}})]})]}),t.jsx(De,{collapsed:1,src:S,theme:"twilight"})]})}const At=(e,i,r)=>{const a=b.useMemo(()=>{if(!r||!U(e,"YYYY-MM-DD",!0).isValid())return[];const l=[],d=U(e);for(let m=0;m<i;m++){const u=d.clone().add(m,"days").format("YYYY-MM-DD");l.push({queryKey:["firebase","diario",u],queryFn:$e("diario",u),enabled:!0})}return l},[e,i,r]),s=Fe({queries:a}),n=s.some(l=>l.isLoading),o=s.some(l=>l.isError),c=b.useMemo(()=>n||o?{}:s.reduce((l,d,m)=>{if(d.data&&Object.keys(d.data).length>0){const u=U(e).add(m,"days").format("YYYY-MM-DD");l[u]=d.data}return l},{}),[s,e,n,o]);return{isLoading:n,isError:o,data:c,results:s}};function Ct(){const e=Ae({mutationFn:async()=>{const i="2024-01-01",r="2024-04-30";try{const a=U(i),s=U(r);for(let n=0;n<=s.diff(a,"days");n++){const o=a.clone().add(n,"days").format("YYYY-MM-DD"),c=ie(re,"diario",o);await Re(c)}}catch(a){throw new Error(a)}},onError:i=>{console.error("Error deleting documents:",i)},onSuccess:()=>{console.log(" Documents deleted successfully")}});return t.jsx(B,{danger:!0,disabled:!0,loading:e.isPending,onClick:()=>e.mutate(),children:"Delete secured documents"})}function O({children:e}){return t.jsx(F,{orientation:"vertical",style:{maxWidth:120},children:e})}function k({children:e}){return t.jsxs(H,{color:"cyan",children:["#",e]})}function E({label:e,children:i}){return t.jsxs(V.Text,{children:[t.jsxs("strong",{children:[e,":"]})," ",i]})}function L({children:e,entry:i}){return t.jsx(Pe,{content:e,title:t.jsxs(C,{justify:"space-between",children:[t.jsx(V.Text,{children:"Sneak Peek"}),t.jsx(Se,{content:JSON.stringify(i)})]}),trigger:"click",children:t.jsx(B,{icon:t.jsx(Dt,{})})})}const Oe=[{title:"Id",dataIndex:"id",key:"id",fixed:"left",render:e=>t.jsxs(V.Text,{children:[e," ",t.jsx("br",{})," ",U(e,"YYYY-MM-DD").format("dddd")]})},{title:"Arte Ruim",dataIndex:"arte-ruim",key:"arte-ruim",render:e=>{if(!e)return t.jsx(T,{message:"No entry",type:"error"});const{number:i,cardId:r,text:a,drawings:s}=e;return t.jsxs(O,{children:[t.jsx(k,{children:i}),t.jsx(E,{label:"CardId",children:r}),t.jsx(E,{label:"Drawings",children:s.length}),t.jsx(L,{entry:e,children:t.jsxs(C,{gap:6,vertical:!0,children:[t.jsxs("div",{children:['"',a.split("").map((n,o)=>o<2||n===" "?n:"â¹").join(""),'"']}),t.jsx(F,{wrap:!0,children:s.map(n=>t.jsx(Ve,{className:"canvas",drawing:n,height:75,width:75},n))})]})})]})}},{title:"Aqui O",dataIndex:"aqui-o",key:"aqui-o",render:e=>{if(!e)return t.jsx(T,{message:"No entry",type:"error"});const{number:i,setId:r,title:a,itemsIds:s}=e;return t.jsxs(O,{children:[t.jsx(k,{children:i}),t.jsx(E,{label:"SetId",children:r}),t.jsx(E,{label:"Title",children:a.pt}),t.jsx(E,{label:"Items",children:s.length}),t.jsx(L,{entry:e,children:t.jsx(C,{gap:6,style:{maxWidth:500},wrap:!0,children:s.map(n=>t.jsx(Q,{itemId:n,width:48},n))})})]})}},{title:"AlienÃ­gena",dataIndex:"comunicacao-alienigena",key:"comunicacao-alienigena",render:e=>{if(!e)return t.jsx(T,{message:"No entry",type:"error"});const{number:i,itemsIds:r,attributes:a}=e;return t.jsxs(O,{children:[t.jsx(k,{children:i}),t.jsx(E,{label:"Items",children:r.length}),t.jsx(L,{entry:e,children:t.jsxs(C,{gap:6,style:{maxWidth:"300px"},vertical:!0,children:[t.jsx(F,{wrap:!0,children:a.map(s=>t.jsx(Je,{signId:`sign-${s.spriteId}`,width:48},s.spriteId))}),t.jsx(F,{wrap:!0,children:r.map(s=>t.jsx(Q,{itemId:s,width:48},s))})]})})]})}},{title:"Conjuntos",dataIndex:"teoria-de-conjuntos",key:"teoria-de-conjuntos",render:e=>{if(!e)return t.jsx(T,{message:"No entry",type:"error"});const{number:i,rule1:r,intersectingThing:a,rule2:s,title:n,things:o}=e;return t.jsxs(O,{children:[t.jsx(k,{children:i}),t.jsx(E,{label:"Title",children:n}),t.jsx(L,{entry:e,children:t.jsxs(C,{gap:6,vertical:!0,children:[t.jsxs(C,{gap:6,children:[t.jsx(Q,{itemId:r.thing.id,width:48}),t.jsx(Q,{itemId:a.id,width:48}),t.jsx(Q,{itemId:s.thing.id,width:48})]}),t.jsx(C,{gap:6,children:o.map(c=>t.jsx(Q,{itemId:c.id,width:35},c.id))})]})})]})}},{title:"Estoque",dataIndex:"controle-de-estoque",key:"controle-de-estoque",render:e=>{if(!e)return t.jsx(T,{message:"No entry",type:"error"});const{number:i,title:r,goods:a}=e;return t.jsxs(O,{children:[t.jsx(k,{children:i}),t.jsx(E,{label:"Title",children:r}),t.jsx(E,{label:"Goods",children:a.length}),t.jsx(L,{entry:e,children:t.jsx(C,{gap:6,style:{maxWidth:245},wrap:!0,children:a.map(s=>t.jsx(Xe,{goodId:s,width:48},s))})})]})}},{title:"Espionagem",dataIndex:"espionagem",key:"espionagem",render:e=>{if(!e)return t.jsx(T,{message:"No entry",type:"error"});const{number:i,statements:r,additionalStatements:a,suspects:s,culpritId:n}=e;return t.jsxs(O,{children:[t.jsx(k,{children:i}),t.jsx(E,{label:"Suspects",children:s.length}),t.jsx(E,{label:"Culprit",children:n}),t.jsx(E,{label:"Statements",children:r.length}),t.jsx(L,{entry:e,children:t.jsxs(C,{gap:6,vertical:!0,children:[t.jsx(F,{style:{maxHeight:200,overflowY:"auto"},wrap:!0,children:s.map(o=>t.jsx(Ze,{cardId:o.id,cardWidth:48},o.id))}),r.slice(0,3).map(o=>t.jsx(T,{banner:!0,message:o.text,showIcon:!0,type:"info"},o.key)),a.map(o=>t.jsx(T,{banner:!0,message:o.text,showIcon:!0,type:"warning"},o.key))]})})]})}},{title:"FilmaÃ§o",dataIndex:"filmaco",key:"filmaco",render:e=>{if(!e)return t.jsx(T,{message:"No entry",type:"error"});const{number:i,setId:r,title:a,year:s}=e;return t.jsxs(O,{children:[t.jsx(k,{children:i}),t.jsx(E,{label:"SetId",children:r}),t.jsx(L,{entry:e,children:t.jsxs(C,{gap:6,vertical:!0,children:[t.jsxs("span",{children:["Year: ",s]}),t.jsxs("span",{children:["Title:"," ",a.split("").map((n,o)=>o<1||n===" "?n:"â¹").join("")]})]})})]})}},{title:"Organiku",dataIndex:"organiku",key:"organiku",render:e=>{if(!e)return t.jsx(T,{message:"No entry",type:"error"});const{number:i,setId:r,title:a,grid:s,defaultRevealedIndexes:n}=e;return t.jsxs(O,{children:[t.jsx(k,{children:i}),t.jsx(E,{label:"SetId",children:r}),t.jsx(E,{label:"Title",children:a}),t.jsx(L,{entry:e,children:t.jsx("div",{className:"grid",style:{gridTemplateColumns:`repeat(${s?.length%5===0?5:6}, 1fr)`,gap:"8px"},children:(s??[]).map((o,c)=>t.jsx("div",{className:"grid-item",children:t.jsx(Q,{className:n.includes(c)?"red-border":"",itemId:n.includes(c)&&o||"0",width:48})},`${o}-${c}`))})})]})}},{title:"Palavreado",dataIndex:"palavreado",key:"palavreado",render:e=>{if(!e)return t.jsx(T,{message:"No entry",type:"error"});const{number:i,letters:r,keyword:a,words:s}=e;return t.jsxs(O,{children:[t.jsx(k,{children:i}),t.jsx(E,{label:"Letters",children:r.length}),t.jsx(E,{label:"Keyword",children:a}),t.jsx(L,{entry:e,children:t.jsx(F,{orientation:"vertical",children:s.map((n,o)=>t.jsx("span",{children:n.split("").map((c,l)=>l===o||c===" "?c:"â¹").join("")},`${i}-${n}`))})})]})}},{title:"Portais",dataIndex:"portais-magicos",key:"portais-magicos",render:e=>{if(!e)return t.jsx(T,{message:"No entry",type:"error"});const{number:i,setId:r,corridors:a}=e;return t.jsxs(O,{children:[t.jsx(k,{children:i}),t.jsx(E,{label:"SetId",children:h.truncate(r,{length:9})}),t.jsx(L,{entry:e,children:t.jsx(C,{gap:6,vertical:!0,children:a.map(s=>t.jsxs(C,{gap:6,vertical:!0,children:[t.jsxs("span",{children:["Passcode: ",s.passcode," (",s.goal,")"]}),t.jsx(C,{children:s.imagesIds.map(n=>t.jsx(Z,{cardId:n,cardWidth:48},n))})]},s.passcode))})})]})}},{title:"Quartetos",dataIndex:"quartetos",key:"quartetos",render:e=>{if(!e)return t.jsx(T,{message:"No entry",type:"error"});const{number:i,setId:r,sets:a}=e;return t.jsxs(O,{children:[t.jsx(k,{children:i}),t.jsx(E,{label:"SetId",children:h.truncate(r,{length:9})}),t.jsx(L,{entry:e,children:t.jsx(C,{gap:6,children:a.map(s=>t.jsx(C,{gap:6,vertical:!0,children:s.itemsIds.map(n=>t.jsx(Q,{itemId:n,width:48},n))},s.id))})})]})}},{title:"Vitrais",dataIndex:"vitrais",key:"vitrais",render:e=>{if(!e)return t.jsx(T,{message:"No entry",type:"error"});const{number:i,title:r,pieces:a}=e;return t.jsxs(O,{children:[t.jsx(k,{children:i}),t.jsx(E,{label:"Title",children:r}),t.jsx(E,{label:"Pieces",children:a.length}),t.jsx(L,{entry:e,children:t.jsx(C,{gap:6,style:{maxWidth:"300px"},wrap:!0,children:t.jsx(Z,{cardId:e.cardId,cardWidth:75})})})]})}},{title:"PicaÃ§o",dataIndex:"artista",key:"artista",render:e=>{if(!e)return t.jsx(T,{message:"No entry",type:"error"});const{number:i,cards:r}=e;return t.jsxs(O,{children:[t.jsx(k,{children:i}),t.jsx(E,{label:"Cards",children:r.length}),t.jsx(L,{entry:e,children:t.jsx(C,{gap:6,style:{maxHeight:500,overflowY:"auto"},vertical:!0,children:r.map((a,s)=>t.jsx("span",{children:a.text},`${a.id}-${s}`))})})]})}},{title:"TÃ¡ Na Cara",dataIndex:"ta-na-cara",key:"ta-na-cara",render:e=>{if(!e)return t.jsx(T,{message:"No entry",type:"error"});const{number:i,suspectsIds:r,testimonies:a}=e;return t.jsxs(O,{children:[t.jsx(k,{children:i}),t.jsx(E,{label:"Suspects",children:r?.length}),t.jsx(E,{label:"Questions",children:a.length}),t.jsx(L,{entry:e,children:t.jsxs(C,{vertical:!0,children:[t.jsx(F,{orientation:"vertical",style:{maxHeight:100,overflowY:"auto"},children:a.map(s=>t.jsxs(C,{vertical:!0,children:[t.jsxs("span",{children:[s.question," (",s.testimonyId,")"]}),t.jsx(C,{children:s.suspectsIds?.map(n=>t.jsx(Z,{cardId:n,cardWidth:48},n))})]},s.testimonyId))}),t.jsx(F,{style:{maxHeight:200,maxWidth:"500px",overflowY:"auto"},wrap:!0,children:r?.map(s=>t.jsx(Z,{cardId:s,cardWidth:48},s))})]})})]})}}];function St(){const[e,i]=b.useState(""),[r,a]=b.useState(!1),{isLoading:s,data:n,dataUpdatedAt:o}=Qe("diario",e,{enabled:!!e&&r}),c=b.useMemo(()=>n?[ae(n,["number"])]:[],[n]),l=f=>{a(!1),i(f.trim())},d=()=>{a(U(e,"YYYY-MM-DD",!0).isValid())},m=()=>{const f=U(e).subtract(1,"days").format("YYYY-MM-DD");i(f)},u=()=>{const f=U(e).add(1,"days").format("YYYY-MM-DD");i(f)};return b.useEffect(()=>{!s&&n&&console.log(ae(n))},[o]),t.jsxs("div",{children:[t.jsx(V.Title,{level:2,children:"Data Verification"}),t.jsx(C,{align:"center",className:"mb-6",justify:"space-between",children:t.jsxs(C,{align:"center",gap:12,children:[t.jsxs(F.Compact,{children:[t.jsx(ue,{onChange:f=>l(f.target.value),placeholder:"YYYY-MM-DD"}),t.jsx(B,{onClick:d,type:"primary",children:"Load"})]}),e&&t.jsxs(C,{align:"center",gap:6,children:[t.jsx(B,{icon:t.jsx(rt,{}),onClick:m}),t.jsx("span",{children:t.jsx(H,{children:e})}),t.jsx(B,{disabled:e===nt(),icon:t.jsx(at,{}),onClick:u})]}),t.jsx("span",{children:t.jsx(H,{color:s?"blue":r?"green":"red",children:s?"Loading...":r?"Valid":"Invalid"})}),t.jsx(me,{disabled:!n,path:`/diario/${e}`})]})}),t.jsx(Ne,{columns:Oe,dataSource:c,loading:s,scroll:{x:"max-content"}}),t.jsx(Ye,{}),t.jsxs(C,{align:"center",className:"mb-4",justify:"space-between",wrap:!0,children:[t.jsx(Se,{className:"mb-4",content:JSON.stringify(c[0],null,2),disabled:!n,shape:"default",children:"Copy to Clipboard"}),t.jsx(Et,{data:n})]}),t.jsx(De,{src:c[0]??{},theme:"twilight"})]})}const xe=(e,i)=>{if(!e||!i||i.length<2)return[];const r=[],a=i.toLowerCase(),s=(n,o=[])=>{n&&typeof n=="object"&&Object.entries(n).forEach(([c,l])=>{c.toLowerCase().includes(a)&&r.push([...o,c].join(".")),typeof l=="string"&&l.toLowerCase().includes(a)&&r.push([...o,c].join(".")),typeof l=="object"&&l!==null&&s(l,[...o,c])})};return s(e),r};function Et({data:e}){const[i,r]=b.useState([]),a=o=>{if(n(o),o.trim().length>1){const c=xe(e??{},o.trim());r(c)}else r([])},[s,n]=b.useState("");return b.useEffect(()=>{if(e&&s.trim().length>1){const o=xe(e,s.trim());r(o)}else r([])},[e]),t.jsxs(C,{gap:8,vertical:!0,children:[t.jsx(ue.Search,{allowClear:!0,onChange:o=>a(o.target.value),onSearch:a,placeholder:"Search in data...",style:{width:250}}),i.length>0&&t.jsxs("div",{children:[t.jsxs(V.Text,{children:["Found ",i.length," matches:"]}),t.jsx("ul",{style:{maxHeight:"200px",overflow:"auto",margin:"4px 0"},children:i.map((o,c)=>t.jsx("li",{children:t.jsx(V.Text,{code:!0,copyable:!0,children:o})},c))})]})]})}const wt=(...e)=>{pe.state["aqui-o"]&&console.log(...e)},Nt=e=>{pe.state["aqui-o"]&&console.count(e)},Tt=(...e)=>{pe.state["aqui-o"]&&console.error(...e)},Ot=(e,i,r,a)=>{const[s]=_(y.AQUI_O,a),n=R("items",{enabled:e}),o=R("daily-disc-sets",{enabled:e});return{entries:b.useMemo(()=>!e||!o.isSuccess||!s||!n.isSuccess?{}:kt(r,s,o.data,n.data),[e,o.dataUpdatedAt,n.dataUpdatedAt,s,r]),isLoading:n.isLoading||o.isLoading}},kt=(e,i,r,a)=>{Nt("Creating Aqui Ã“...");const s=h.shuffle(Object.values(r).filter(d=>d.itemsIds.filter(Boolean).length>=20)),n=s.filter(d=>!i.used.includes(d.id));n.length<e&&(wt("ðŸ”† Not enough aqui-o sets left, shuffling..."),W("aqui-o","Not enough aqui-o sets left"),n.push(...h.shuffle(s)));const o=Object.values(a).filter(d=>d?.nsfw?!1:h.intersection(d.decks??[],["alien","dream","thing"]).length>0);let c=i.latestDate;const l={};for(let d=0;d<e;d++){let m=n[d];m||Tt("No aqui-o sets left");const u=q(c),f=z(u);c=u,u==="2026-01-01"&&(m=r["2a97f"]),f?l[u]={id:u,type:"aqui-o",number:i.latestNumber+d+1,setId:"special",title:{pt:"Especial Fim de Semana",en:"Weekend Special"},itemsIds:["0",...h.sampleSize(o,45).map(g=>g.id)]}:l[u]={id:u,type:"aqui-o",number:i.latestNumber+d+1,setId:m.id,title:m.title,itemsIds:["0",...h.sampleSize(m.itemsIds,20)]}}return l},Lt=(e,i,r,a)=>{const[s]=_(y.ARTE_RUIM,a),n=ve(e,i);return{entries:b.useMemo(()=>!e||n.isLoading||!s?[]:Mt(r,s,n,i),[e,n.dataUpdatedAt,i,s,r]),isLoading:n.isLoading}},Mt=(e,i,r,a)=>{console.count("Creating Arte Ruim...");const s=Object.values(r.drawings).filter(l=>!(i.used.includes(l.id)||l.drawings.length<3)).map(l=>({id:l.id,type:"arte-ruim",language:a??"pt",cardId:l.id,text:l.text,drawings:l.drawings.map(d=>d.drawing),number:0,dataIds:l.drawings.map(d=>d.id)})),n=h.sampleSize(h.shuffle(s),e);let o=i.latestDate;return n.map((l,d)=>{const m=q(o);return o=m,{...l,id:m,number:i.latestNumber+d+1}})},Rt=(e,i,r,a,s)=>{const[n]=_(y.ARTISTA,a),[o]=_(y.ARTE_RUIM,a),c=R(`arte-ruim-cards-${i}`,{enabled:e}),l=ve(e,i);return{entries:b.useMemo(()=>{if(!e||!c.isSuccess||!l.hasResponseData||!n)return{};const m=s.map(u=>u.cardId);return Pt(r,n,o,c.data,m,l.drawings)},[e,c.dataUpdatedAt,o,n,r,s,l.dataUpdatedAt,l.hasResponseData]),isLoading:c.isLoading||l.isLoading}},Pt=(e,i,r,a,s,n)=>{console.count("Creating Artista...");let o=i.latestDate;const c={};for(let l=0;l<e;l++){const d=q(o),m=Object.keys(a??{}).filter(f=>!r.used.includes(f)&&!s.includes(f)&&n?.[f]?.drawings?.length<3),u=h.sampleSize(m,20).map(f=>a[f]);o=d,c[d]={id:d,type:"artista",number:i.latestNumber+l+1,cards:u}}return c},Yt=(e,i,r,a)=>{const[s]=_(y.COMUNICACAO_ALIENIGENA,a),n=R("items",{enabled:e}),o=R("items-attributes",{enabled:e}),c=R("items-attribute-values",{enabled:e});return{entries:b.useMemo(()=>!e||!s||!o.isSuccess||!c.isSuccess||!n.isSuccess?{}:Gt(r,s,o.data,c.data,n.data),[e,r,s,s,o.dataUpdatedAt,c.dataUpdatedAt,n.dataUpdatedAt]),isLoading:n.isLoading||o.isLoading||c.isLoading}},Gt=(e,i,r,a,s)=>{console.count("Creating Comunicacao Alienigena...");let n=i.latestDate;const o=h.values(r),c=h.values(a).filter(u=>u.complete&&s?.[u.id]?.nsfw!==!0),l={};let d=0;for(;h.keys(l).length<e+5&&d<it;){const u=Ut(o,c);if(u.valid&&!l[u.setId]&&!i.used.includes(u.setId)&&(l[u.setId]=u),h.keys(l).length>=e)break;d+=1}console.log(`ðŸ”† Generating this batch took ${d} tries`),d>=100&&W("comunicacao-alienigena","Not enough valid comunicacao alienigena games (over 100 attempts)");const m={};return Object.values(l).forEach((u,f)=>{const g=q(n);n=g;let I=h.shuffle(u.itemsIds);z(g)?I=h.shuffle([...I,...h.sampleSize(u.additionalItems,2)].filter(Boolean)):I=h.shuffle(I),m[g]={id:g,number:i.latestNumber+f+1,type:"comunicacao-alienigena",setId:u.setId,attributes:u.attributes,requests:u.requests,solution:u.solution,itemsIds:I}}),m},Ut=(e,i)=>{const r=h.shuffle(i),a=h.shuffle(Be(50,0)),s=h.sampleSize(e,3).map(p=>({...p,spriteId:`${a.pop()}`})),n=[],o=[],c=[],l=[],d=[],m=[],u=[],f=[];r.forEach(p=>{const w=[$.DETERMINISTIC,$.RELATED],v=p.attributes[s[0].id]===$.DETERMINISTIC,N=w.includes(p.attributes[s[0].id]),G=p.attributes[s[0].id]===$.UNRELATED,ee=p.attributes[s[1].id]===$.DETERMINISTIC,te=w.includes(p.attributes[s[1].id]),J=p.attributes[s[1].id]===$.UNRELATED,Me=p.attributes[s[2].id]===$.DETERMINISTIC,se=w.includes(p.attributes[s[2].id]),X=p.attributes[s[2].id]===$.UNRELATED;if(G&&J&&X){f.push(p.id);return}v&&J&&X&&n.push(p.id),G&&ee&&X&&o.push(p.id),G&&J&&Me&&c.push(p.id),N&&te&&X&&l.push(p.id),N&&J&&se&&d.push(p.id),G&&te&&se&&m.push(p.id),N&&te&&se&&u.push(p.id)});const g=s.map(p=>({id:p.id,name:p.name.pt,description:p.description.pt,spriteId:p.spriteId,itemsIds:[]}));g[0].itemsIds=h.sampleSize(n,n.length>3?3:Math.max(n.length-1,1)),g[1].itemsIds=h.sampleSize(o,o.length>3?3:Math.max(n.length-1,1)),g[2].itemsIds=h.sampleSize(c,c.length>3?3:Math.max(n.length-1,1));const I=[];g.forEach(p=>{I.push(...p.itemsIds)});const x=[];l.length>0&&x.push({spritesIds:[s[0].spriteId,s[1].spriteId],itemId:h.sample(l)??""}),d.length>0&&x.push({spritesIds:[s[0].spriteId,s[2].spriteId],itemId:h.sample(d)??""}),m.length>0&&x.push({spritesIds:[s[1].spriteId,s[2].spriteId],itemId:h.sample(m)??""}),u.length>0&&x.push({spritesIds:s.map(p=>p.spriteId),itemId:h.sample(u)??""});const S=[];n.length>0&&S.push({spritesIds:[s[0].spriteId],itemId:n.filter(p=>!I.includes(p))[0]}),o.length>0&&S.push({spritesIds:[s[1].spriteId],itemId:o.filter(p=>!I.includes(p))[0]}),c.length>0&&S.push({spritesIds:[s[2].spriteId],itemId:c.filter(p=>!I.includes(p))[0]});let j=h.sampleSize(x,4);j.length<3&&j.push(...h.sampleSize(S,4-j.length)),j.length<4&&console.log("ðŸ”† Not enough requests for an alien communication, marking it as invalid"),j=h.shuffle(j);const A=j.map(p=>p.itemId),D={setId:g.map(p=>p.id).sort().join("-"),attributes:g,requests:j,solution:A.join("-"),itemsIds:A,additionalItems:f.filter(Boolean),valid:!1};return D.valid=[D.attributes.length===3,D.requests.length===4,D.itemsIds.length===4,D.attributes.every(p=>p.itemsIds.length>0),D.requests.every(p=>p.itemId)].every(Boolean),D},_t=(e,i,r,a)=>{const[s]=_(y.CONTROLE_DE_ESTOQUE,a);return{entries:b.useMemo(()=>!e||!s?{}:qt(r,s),[e,r,s]),isLoading:!1}},qt=(e,i)=>{console.count("Creating Controle de Estoque...");let r=i.latestDate;const a={};for(let s=0;s<e;s++){const n=q(r);r=n,a[n]=Bt(n,i.latestNumber+s+1)}return a},Ft=256,Vt=16,$t=4,Qt=1,Bt=(e,i)=>{const[r,a,s]=e.split("-").map(Number),o=new Date(r,a-1,s).getDay(),c=["Domingo","Segunda-feira","TerÃ§a-feira","Quarta-feira","Quinta-feira","Sexta-feira","SÃ¡bado"][o],l={id:e,number:i,type:"controle-de-estoque",language:"pt",title:c,goods:[],orders:[]},d=h.sampleSize(Array(Ft).fill("").map((u,f)=>`good-${f+1}`),Vt+Qt),m=d.pop();if(l.goods=d,l.orders=h.sampleSize(l.goods,$t),!m)throw new Error("No out of stock good");return l.orders.push(m),l.orders=h.shuffle(l.orders),l},Wt=(e,i,r,a)=>{const[s]=_(y.FILMACO,a),n=R("daily-movie-sets",{enabled:e});return{entries:b.useMemo(()=>!e||!n.isSuccess||!s?{}:(Object.values(n.data).filter(l=>l.itemsIds.length>0&&!s.used.includes(l.id)).length<=r&&W("filmaco","Not enough unused films"),Ht(r,s,n.data)),[e,n.dataUpdatedAt,s,r]),isLoading:n.isLoading}},Ht=(e,i,r)=>{console.count("Creating FilmaÃ§o...");const a=h.shuffle(Object.values(r).filter(l=>l.itemsIds.filter(Boolean).length>0)),s=h.shuffle(a.filter(l=>!i.used.includes(l.id)));s.length<e&&s.push(...h.shuffle(a));const n=h.shuffle(Object.values(r).filter(l=>l.itemsIds.length>0&&i.used.includes(l.id)));let o=i.latestDate;const c={};for(let l=0;l<e;l++){const d=q(o),m=z(d),u=m?zt(n):s[l];if(!u){W("filmaco","No filmaÃ§o sets left");break}o=d,c[d]={id:d,type:"filmaco",number:i.latestNumber+l+1,setId:u.id,title:u.title,itemsIds:u.itemsIds,year:u.year},m&&(c[d].isDoubleFeature=!0)}return c},zt=e=>{let i=[];for(;i.length<2&&e.length>0;){const a=e.pop();a&&h.intersection(a.itemsIds,i?.[0]?.itemsIds||[]).length===0&&i.push(a)}return i=h.orderBy(i,a=>a.year,"asc"),{id:`df-${i.map(a=>a.id).join("-")}`,title:`${i.map(a=>a.title).join(" Ã— ")}`,itemsIds:h.shuffle(Ce(i.flatMap(a=>a.itemsIds))),year:i.map(a=>a.year).join(" Ã— ")}},Kt=(e,i,r,a)=>{const[s]=_(y.ORGANIKU,a),n=R("items-groups",{enabled:e});return{entries:b.useMemo(()=>!e||!n.isSuccess||!s?{}:Jt(r,s,i,n.data),[e,i,s,r,n.dataUpdatedAt]),isLoading:n.isLoading}},Jt=(e,i,r,a)=>{console.count("Creating Organiku...");const s=h.shuffle(Object.values(a).filter(c=>c.itemsIds.length>6&&i.used.includes(c.id)===!1));s.length<e&&W("organiku","Not enough organiku groups left");let n=i.latestDate;const o={};for(let c=0;c<e;c++){const l=q(n);n=l;const d=z(l);if(l==="2026-01-01"){const m=a["2a97f"],u=h.sampleSize(m.itemsIds,d?6:5),f=Ie(u),g=je(f,u,1);o[l]={id:l,number:i.latestNumber+c+1,setId:m.id,type:"organiku",title:h.capitalize(m.name[r]),grid:f,defaultRevealedIndexes:g,itemsIds:u}}else{const m=s[c],u=h.sampleSize(m.itemsIds,d?6:5),f=Ie(u),g=je(f,u,1);o[l]={id:l,number:i.latestNumber+c+1,setId:m.id,type:"organiku",title:h.capitalize(m.name[r]),grid:f,defaultRevealedIndexes:g,itemsIds:u}}}return o};function je(e,i,r){const a=new Set,s={};e.forEach((n,o)=>{s[n]||(s[n]=[]),s[n].push(o)});for(const n of i){const o=s[n]??[],l=o.length%2===0?2:1,d=h.shuffle(o);for(let m=0;m<l&&m<d.length;m++)a.add(d[m])}for(let n=0;n<r;n++){const o=i[n%i.length],c=(s[o]??[]).filter(d=>!a.has(d)),l=h.shuffle(c);for(let d=0;d<2&&d<l.length;d++)a.add(l[d])}return Array.from(a)}function Ie(e){const i=e.length,r=[];r.push(h.shuffle(e));function a(n,o){for(let c=0;c<i;c++)for(let l=0;l<o;l++)if(r[l][c]===n[c])return!1;return!0}function s(n){if(n===i)return!0;const o=ke(e);for(;o.length>0;){const c=o.splice(Math.floor(Math.random()*o.length),1)[0];if(a(c,n)){if(r.push(c),s(n+1))return!0;r.pop()}}return!1}return s(1),r.flat()}function ke(e){if(e.length<=1)return[e.slice()];const i=[];for(let r=0;r<e.length;r++){const a=[...e.slice(0,r),...e.slice(r+1)];for(const s of ke(a))i.push([e[r],...s])}return i}const Xt=(e,i,r,a)=>{const[s]=_(y.PALAVREADO,a),n=oe(4,i,e),o=oe(5,i,e);return{entries:b.useMemo(()=>!e||!n.data||!n.data.length||!o.data||!o.data.length||!s?{}:Zt(r,s,n.data,o.data),[e,n.dataUpdatedAt,o.dataUpdatedAt,s,r]),isLoading:n.isLoading||o.isLoading}},Zt=(e,i,r,a)=>{console.count("Creating Palavreado...");let s=i.latestDate;const n=[],o={};for(let c=0;c<e;c++){const l=q(s),d=z(l),m=d?5:4;s=l;let u;l==="2026-01-01"&&(u="novo"),o[l]={id:l,type:"palavreado",number:i.latestNumber+c+1,...es(d?a:r,[...Object.values(o).map(f=>f.keyword),...i.used],n,m,u)}}return o},es=(e,i,r,a=4,s)=>{let n=h.shuffle(h.difference(e,r,i));const o=s||(n.pop()??"");s&&(n=h.difference(n,[s]));const c=[];for(let l=0;l<a;l++){const d=ts(e,o,c,l);c.push(d)}return r.push(o,...c),{keyword:o,words:c,letters:ss(c,o.length)}},ts=(e,i,r,a)=>{const s=h.uniq([...h.flatMap(r.map(c=>c.split(""))),...i.split("")]),n=h.shuffle(e.filter(c=>c[a]===i[a]&&!r.includes(c)));return h.sortBy(n,c=>h.intersection(c.split(""),s).length)[0]},ss=(e,i)=>{const r=h.flatMap(e.map(o=>o.split(""))),a=i===4?[0,5,10,15]:[0,6,12,18,24],s=h.shuffle(r.filter((o,c)=>!a.includes(c))),n=[];for(let o=0;o<r.length;o++)a.includes(o)?n.push(r[o]):n.push(s.shift()??"");return n},ns=(e,i,r,a)=>{const[s]=_(y.PORTAIS_MAGICOS,a),n=R("daily-passcode-sets",{enabled:e}),o=oe(3,i,e);return{entries:b.useMemo(()=>{if(!e||!n.isSuccess||!o.isSuccess||!s)return{};const l=o.data.reduce((d,m)=>(m.split("").forEach(u=>{d[u]||(d[u]=[]),d[u].push(m)}),d),{" ":["  "],"-":[" - "]});return is(r,s,n.data,l)},[e,r,n.dataUpdatedAt,o.isSuccess,o.dataUpdatedAt,s]),isLoading:n.isLoading||o.isLoading}},is=(e,i,r,a)=>{console.count("Creating Portais MÃ¡gicos...");let s=i.latestDate;const n=i.used,o={};let c=h.shuffle(Object.values(r).filter(d=>d.imageCardsIds.length>0));const l={};for(let d=0;d<e;d++){const m=q(s),u=[];let f=[...c];const g=[];for(;g.length<3;){const I=f.pop();if(!I){W("portais-magicos",`Not enough passcode sets to build Portais MÃ¡gicos for ${m}`),console.error("Not enough sets available to build more corridors");break}const x=h.sample(I.passcode.filter(D=>D.length<=12&&!n.includes(D)))||"";if(!x)continue;const S=g.length+1;u.push(I.id),o[I.id]=!0;const j=x.split("").map(D=>h.sample(a[D])||` ${D} `),A=h.sampleSize(I.imageCardsIds,S);g.push({passcode:x,imagesIds:A,words:j,goal:rs(x,j)}),f=f.filter(D=>!o[D.id]&&D.imageCardsIds.length>S)}s=m,l[m]={id:m,type:"portais-magicos",setId:u.join(he),number:i.latestNumber+d+1,corridors:g.reverse(),goal:g.reduce((I,x)=>I+x.goal,0)},c=c.filter(I=>!o[I.id])}return l};function rs(e,i){if(e.length!==i.length)throw new Error("Secret word length must match the number of 3-letter words");let r=0;for(let a=0;a<e.length;a++){const s=e[a].toUpperCase(),n=i[a].toUpperCase();let o=-1;for(let l=0;l<3;l++)if(n[l]===s){o=l;break}if(o===-1)throw new Error(`Target letter '${s}' not found in word '${n}' at position ${a}`);let c=0;o===0?c=2:o===1?c=0:o===2&&(c=1),r+=c}return r}const as=(e,i,r,a)=>{const[s]=_(y.TA_NA_CARA,a),n=R("suspects",{enabled:e}),o=R(`testimony-questions-${i}`,{enabled:e}),c=R("testimony-answers",{select:et,enabled:e});return{entries:b.useMemo(()=>{if(!e||!n.isSuccess||!o.isSuccess||!s||!c.isSuccess)return{};const d=ms(o.data,c.data,n.data),m=n.data??{},u=Object.keys(n.data).map(f=>Ee(f,"gb"));return ls(r,s,u,o.data,d,m)},[e,n.dataUpdatedAt,o.dataUpdatedAt,c.dataUpdatedAt,s,r]),isLoading:n.isLoading||o.isLoading}},os=15,Le=7,ls=(e,i,r,a,s,n)=>{console.count("Creating TÃ¡ Na Cara...");let o=0,c=i.latestDate;const l={};for(let d=0;d<e;d++){const m=q(c);c=m;const u={},f=[];for(let x=0;x<os;x++){o>=s.length&&(o=0);const S=s[o];f.push(cs(S,a[S.testimonyId])),o+=1}const g=We(f.flatMap(x=>x.suspectsIds||[]),!0);Object.keys(g).forEach(x=>{u[x]=n[K(x)].name.pt});const I=[];for(const x of h.shuffle(r)){if(I.length>=Le)break;if(g[x])continue;let S=!1;for(const j of f){const A=j.testimonyId,D=K(x),p=s.find(w=>w.testimonyId===A);if(p){const w=p.counts,v=["5+","32+"];for(const N of v)if(w[N]?.includes(D)){S=!0;break}}if(S)break}S||(I.push(x),u[x]=n[K(x)].name.pt)}l[m]={id:m,type:"ta-na-cara",number:i.latestNumber+d+1,suspectsIds:I,testimonies:f,names:u}}return l},cs=(e,i)=>{const r=[...h.shuffle([...e.counts[3],...e.counts[2]]),...h.shuffle([...e.counts[1],...e.counts[4]]),...e.counts[0],...e.counts[5],...e.counts["5+"]].filter(Boolean).slice(0,Le).map(a=>Ee(a,"gb"));return{testimonyId:i.id,question:i.question,nsfw:!!i.nsfw,suspectsIds:r}},ds=e=>e.reduce((i,r)=>{const a=r.split(he),s=a[0],n=Number(a[1]);if(s.startsWith("us")){const o=K(s);return o.includes("undefined")||(i[o]=n||0),i}return i[s]=n||0,i},{}),us=(e,i)=>{const r=ds(e);return i.forEach(a=>{a.testimonies.forEach(s=>{r[s.testimonyId]===void 0&&(r[s.testimonyId]=0),r[s.testimonyId]+=1}),a.suspectsIds?.forEach(s=>{const n=K(s);r[n]===void 0&&(r[n]=0),r[n]+=1})}),Object.entries(r).map(([a,s])=>`${a}${he}${s}`)},ms=(e,i,r)=>{const a={};Object.keys(e).forEach(n=>{a[n]===void 0&&(a[n]={0:[],1:[],2:[],3:[],4:[],5:[],"5+":[],"32+":[]});const o=i[n]||{};Object.keys(r).forEach(c=>{const l=o[c]||[],d=tt(l);if(d>=32)a[n]["32+"].push(c);else if(d>5&&d<32)a[n]["5+"].push(c);else try{a[n][d].push(c)}catch(m){console.error("Error updating globalCounts:",m)}})});const s=h.orderBy(Object.keys(a).map(n=>({testimonyId:n,counts:a[n]})),[n=>n.counts[3].length,n=>n.counts[1].length,n=>n.counts[2].length,n=>n.counts[4].length,n=>n.counts[0].length],["desc"]);for(let n=0;n<s.length;n+=13){const o=s.slice(n,n+13),c=h.shuffle(o);s.splice(n,13,...c)}return s},K=e=>{const i=e.split("-");return i.length<3?e:`${i[0]}-${i[2]}`},hs=(e,i,r)=>{const[a]=_(y.VITRAIS,r),s=R("daily-puzzle-set",{enabled:e});return{entries:b.useMemo(()=>!e||s.isLoading||!a?{}:ps(i,a,s.data),[e,a,i,s.dataUpdatedAt]),isLoading:s.isLoading}},ps=(e,i,r)=>{console.count("Creating Vitrais...");let a=h.shuffle(Object.values(r).filter(l=>!i.used.includes(l.id)));const s={id:"td-d2-41"},n={id:"td-d1-14"};a=a.filter(l=>l.id!==s.id&&l.id!==n.id),console.log(`Eligible Vitrais sets available: ${a.length}`);let o=i.latestDate;const c={};return Array.from({length:e}).forEach((l,d)=>{const m=q(o),u=z(m);o=m;let f=a[d];if(m==="2026-01-01"&&(f=r["td-d5-21"]),!f){W("vitrais",`Not enough eligible Daily Vitrais sets to create a new puzzle for date ${m}. Please add more sets or clear used history.`);return}const g=u?h.random(15,20):h.random(9,14);let I;try{I=gs(f.id,h.capitalize(f.title),g)}catch(x){W("vitrais",`Error generating Daily Vitrais puzzle for date ${m} with set ${f.title}: ${x}`);return}c[m]={id:m,number:i.latestNumber+d+1,type:"vitrais",...I}}),c},fs=7,gs=(e,i,r=12,a=6)=>{const s=Math.max(9,Math.min(24,r)),n=Math.round(a*1.5),o=[],c=[];let l=0;for(let x=0;x<n;x++){const S=[];for(let j=0;j<a;j++)S.push(l),c.push({id:l,blocks:[{x:j,y:x}]}),l++;o.push(S)}let d=0;for(;c.length>s&&!(d>50);){let x=Number.POSITIVE_INFINITY;c.forEach(A=>{A.blocks.length<x&&(x=A.blocks.length)});const S=h.shuffle(c.filter(A=>A.blocks.length===x));let j=!1;for(const A of S){const D=new Set;if(A.blocks.forEach(p=>{[{x:p.x+1,y:p.y},{x:p.x-1,y:p.y},{x:p.x,y:p.y+1},{x:p.x,y:p.y-1}].forEach(v=>{if(v.x>=0&&v.x<a&&v.y>=0&&v.y<n){const N=o[v.y][v.x];if(N!==A.id){const G=c.find(ee=>ee.id===N);G&&A.blocks.length+G.blocks.length<=fs&&D.add(N)}}})}),D.size>0){const p=Array.from(D),w=p[h.random(0,p.length-1)],v=c.findIndex(G=>G.id===w),N=c[v];A.blocks=[...A.blocks,...N.blocks],N.blocks.forEach(G=>{o[G.y][G.x]=A.id}),c.splice(v,1),j=!0;break}}j?d=0:d++}const m=c.map((x,S)=>{x.blocks.sort((p,w)=>p.y-w.y||p.x-w.x);const j=x.blocks[0],A=j.y*a+j.x,D=x.blocks.map(p=>({x:p.x-j.x,y:p.y-j.y}));return{id:`piece-${S}`,correctPos:A,shape:D}}),u=a/2,f=n/2;let g=m[0]?.id||"",I=Number.POSITIVE_INFINITY;return m.forEach(x=>{const S=x.correctPos%a,j=Math.floor(x.correctPos/a);let A=0,D=0;x.shape.forEach(N=>{A+=S+N.x,D+=j+N.y});const p=A/x.shape.length,w=D/x.shape.length,v=Math.sqrt((p-u)**2+(w-f)**2);v<I&&(I=v,g=x.id)}),{title:i,cardId:e,gridCols:a,gridRows:n,startingPieceId:g,pieces:m}};function xs(e,i,r){const a=we.DAILY[i??"pt"],s=Te(a,{enabled:e});b.useEffect(()=>{},[r]);const n=e&&s.isSuccess,o=R("items",{enabled:n}),c=Ot(n,i,r,s.data??{}),l=Lt(n,i,r,s.data??{}),d=Yt(n,i,r,s.data??{}),m=_t(n,i,r,s.data??{}),u=Wt(n,i,r,s.data??{}),f=Xt(n,i,r,s.data??{}),g=mt(n,i,r,s.data??{}),I=ht(n,i,r,s.data??{}),x=ns(n,i,r,s.data??{}),S=Kt(n,i,r,s.data??{}),j=dt(n,i,r,s.data??{}),A=hs(n,r,s.data??{}),D=Rt(n,i,r,s.data??{},l.entries),p=as(n,i,r,s.data??{}),w=b.useMemo(()=>l.entries.length===0?[]:(console.count("Bundling entries..."),l.entries.map(v=>{const N={id:v.id,"arte-ruim":v,"aqui-o":c.entries[v.id],"comunicacao-alienigena":d.entries[v.id],"controle-de-estoque":m.entries[v.id],espionagem:j.entries[v.id],filmaco:u.entries[v.id],organiku:S.entries[v.id],palavreado:f.entries[v.id],"portais-magicos":x.entries[v.id],quartetos:g.entries[v.id],"teoria-de-conjuntos":I.entries[v.id],vitrais:A.entries[v.id],artista:D.entries[v.id],"ta-na-cara":p.entries[v.id],dictionary:{}};return N.dictionary=js(N,o.data),N})),[l.entries,c.entries,d.entries,m.entries,u.entries,S.entries,f.entries,x.entries,g.entries,I.entries,D.entries,p.entries,j.entries,A.entries,o.data]);return{isLoading:s.isLoading||c.isLoading||l.isLoading||d.isLoading||m.isLoading||u.isLoading||f.isLoading||x.isLoading||g.isLoading||I.isLoading||D.isLoading||p.isLoading||j.isLoading||S.isLoading||A.isLoading||o.isLoading,entries:w}}const js=(e,i)=>{const r={};return e["aqui-o"].itemsIds.forEach(a=>{const s=i[a];s&&(r[a]=s.name.pt)}),e["comunicacao-alienigena"].itemsIds.forEach(a=>{const s=i[a];s&&(r[a]=s.name.pt)}),e["comunicacao-alienigena"].attributes.forEach(a=>{a.itemsIds.forEach(s=>{const n=i[s];n&&(r[s]=n.name.pt)})}),e.filmaco.itemsIds.forEach(a=>{const s=i[a];s&&(r[a]=s.name.pt)}),e.quartetos.grid.forEach(a=>{const s=i[a];s&&(r[a]=s.name.pt)}),e.organiku.itemsIds.forEach(a=>{const s=i[a];s&&(r[a]=s.name.pt)}),r};function Is(e){const{notification:i}=Ge.useApp(),r=Ue(),a=we.DAILY[e??"pt"],[s,n]=b.useState(!1),o=Te(a,{enabled:!!a}),c=Ae({mutationFn:async l=>{const d=l.map(g=>{const I=ie(re,`${a}/${g.id}`);return fe(I,g)}),m=ie(re,`${a}/history`),u=o.data;if(!u)throw new Error("No previous history");const f={...u,[y.AQUI_O]:M(y.AQUI_O,u,l,g=>g.setId),[y.ARTE_RUIM]:M(y.ARTE_RUIM,u,l,g=>g.cardId),[y.ARTISTA]:M(y.ARTISTA,u,l,null),[y.COMUNICACAO_ALIENIGENA]:M(y.COMUNICACAO_ALIENIGENA,u,l,g=>g.setId),[y.CONTROLE_DE_ESTOQUE]:M(y.CONTROLE_DE_ESTOQUE,u,l,null),[y.FILMACO]:M(y.FILMACO,u,l,g=>g.setId),[y.PALAVREADO]:M(y.PALAVREADO,u,l,g=>g.keyword),[y.PORTAIS_MAGICOS]:M(y.PORTAIS_MAGICOS,u,l,g=>g.corridors.map(I=>I.passcode)),[y.TA_NA_CARA]:M(y.TA_NA_CARA,u,l,null,us),[y.QUARTETOS]:M(y.QUARTETOS,u,l,g=>g.sets.map(I=>I.id)),[y.TEORIA_DE_CONJUNTOS]:M(y.TEORIA_DE_CONJUNTOS,u,l,g=>[g.intersectingThing.id,g.setId]),[y.ORGANIKU]:M(y.ORGANIKU,u,l,g=>g.setId),[y.ESPIONAGEM]:M(y.ESPIONAGEM,u,l,g=>g.culpritId),[y.VITRAIS]:M(y.VITRAIS,u,l,g=>g.cardId)};return fe(m,f),Promise.all(d)},onSuccess:()=>{i.info({title:"Data saved",placement:"bottomLeft"}),r.invalidateQueries({queryKey:[a,"history"]}),n(!1)},onError:()=>{i.error({title:"Error saving data",placement:"bottomLeft"})}});return{isDirty:s,setIsDirty:n,save:c.mutateAsync,isPending:c.isPending}}const M=(e,i,r,a,s)=>{const n=JSON.parse(i[e]?.used??"[]");return s?{latestDate:r[r.length-1].id,latestNumber:r[r.length-1][e].number,used:JSON.stringify(s(n,r.map(o=>o[e])))}:a===null?{latestDate:r[r.length-1].id,latestNumber:r[r.length-1][e].number,used:"[]"}:{latestDate:r[r.length-1].id,latestNumber:r[r.length-1][e].number,used:JSON.stringify(Ce([...n,...r.map(o=>o[e]).map(a)]).flat())}},ys="pt";function bs(){const[e,i]=b.useState(""),[r,a]=b.useState(3),[s,n]=b.useState(7),[o,c]=b.useState(Date.now());return t.jsxs("div",{children:[t.jsx(V.Title,{level:2,children:"Data Population"}),t.jsxs(C,{gap:12,children:[t.jsx(ne,{label:"Language",onChange:i,options:[ys],placeholder:"Select a language",value:e}),t.jsx(ne,{label:"Minimum Drawings",onChange:a,options:[2,3,4],placeholder:"Select a number",value:r}),t.jsx(ne,{label:"Batch Size",onChange:n,options:[1,3,7,14,21,28],placeholder:"Select a number",value:s}),t.jsx(B,{icon:t.jsx(pt,{}),onClick:()=>{lt(),c(Date.now())}}),t.jsx(me,{className:"ml-2",path:"diario/history"})]}),t.jsx(Ds,{batchSize:s,language:e},o)]})}function Ds({language:e,batchSize:i}){const r=e,a=xs(!!r,r,i),s=ct(),n=b.useMemo(()=>Object.values(s),[s]);b.useEffect(()=>{h.isEmpty(s)||console.log(s)},[s]);const{save:o,isPending:c}=Is(r??"pt");return t.jsxs(ot,{error:null,hasResponseData:!a.isLoading,isLoading:a.isLoading,children:[t.jsxs(C,{align:"center",justify:"space-between",children:[t.jsxs(V.Title,{level:4,children:["Total: ",a.entries.length]}),t.jsx(B,{disabled:(a.entries??[]).length===0||n.length>0,icon:t.jsx(ft,{}),loading:c,onClick:()=>o(a.entries),size:"large",type:"primary",children:"Save"})]}),n.map(l=>t.jsx(T,{banner:!0,message:l,showIcon:!0,type:"warning"},l)),t.jsx(Ne,{columns:Oe,dataSource:a.entries??[],scroll:{x:"max-content"}})]})}function vs(){const{queryParams:e}=be();return e.get("display")==="archive"?t.jsx(vt,{}):e.get("display")==="check"?t.jsx(St,{}):t.jsx(bs,{})}function As(){const{queryParams:e,addParams:i}=be();return t.jsxs(t.Fragment,{children:[t.jsx(le,{children:t.jsx(ze,{label:"Display",onChange:r=>i({display:r}),options:[{title:"Population",icon:t.jsx(It,{}),value:"population"},{title:"Check",icon:t.jsx(_e,{}),value:"check"},{title:"Archive",icon:t.jsx(gt,{}),value:"archive"}],value:e.get("display")??"population"})}),t.jsx(le,{children:t.jsx(me,{label:"History",path:"/diario/history"})}),t.jsx(Cs,{})]})}function Cs(){const e=ut();return t.jsxs(le,{children:[t.jsx(V.Title,{level:5,children:"Debuggers"}),t.jsx("div",{children:t.jsx(Y,{checked:e["aqui-o"],disabled:!0,onChange:()=>P("aqui-o"),children:"Aqui o"})}),t.jsx("div",{children:t.jsx(Y,{checked:e["arte-ruim"],disabled:!0,onChange:()=>P("arte-ruim"),children:"Arte Ruim"})}),t.jsx("div",{children:t.jsx(Y,{checked:e.artista,disabled:!0,onChange:()=>P("artista"),children:"Artista"})}),t.jsx("div",{children:t.jsx(Y,{checked:e["comunicacao-alienigena"],disabled:!0,onChange:()=>P("comunicacao-alienigena"),children:"Com. AlienÃ­gena"})}),t.jsx("div",{children:t.jsx(Y,{checked:e["controle-de-estoque"],disabled:!0,onChange:()=>P("controle-de-estoque"),children:"Controle de Estoque"})}),t.jsx("div",{children:t.jsx(Y,{checked:e.espionagem,disabled:!0,onChange:()=>P("espionagem"),children:"Espionagem"})}),t.jsx("div",{children:t.jsx(Y,{checked:e.filmaco,disabled:!0,onChange:()=>P("filmaco"),children:"Filmaco"})}),t.jsx("div",{children:t.jsx(Y,{checked:e.organiku,disabled:!0,onChange:()=>P("organiku"),children:"Organiku"})}),t.jsx("div",{children:t.jsx(Y,{checked:e.palavreado,disabled:!0,onChange:()=>P("palavreado"),children:"Palavreado"})}),t.jsx("div",{children:t.jsx(Y,{checked:e["portais-magicos"],disabled:!0,onChange:()=>P("portais-magicos"),children:"Portais MÃ¡gicos"})}),t.jsx("div",{children:t.jsx(Y,{checked:e.quartetos,disabled:!0,onChange:()=>P("quartetos"),children:"Quartetos"})}),t.jsx("div",{children:t.jsx(Y,{checked:e["ta-na-cara"],disabled:!0,onChange:()=>P("ta-na-cara"),children:"TÃ¡ na Cara"})}),t.jsx("div",{children:t.jsx(Y,{checked:e["teoria-de-conjuntos"],disabled:!0,onChange:()=>P("teoria-de-conjuntos"),children:"Teoria de Conjuntos"})})]})}function In(){return t.jsx(qe,{title:"Daily Setup",children:t.jsxs(ge,{hasSider:!0,children:[t.jsx(st,{children:t.jsx(As,{})}),t.jsx(ge.Content,{className:"content",children:t.jsx(vs,{})})]})})}export{In as default};
