import{r as f,a as y,_ as L,M as P,j as e,I as b,B as z,P as E,L as I}from"./index-CTqAsA_o.js";import{D as F}from"./DataLoadingWrapper-Dk0jKqZ1.js";import{l as S,P as D}from"./useBaseUrl-CfIxsWS4.js";import{I as M}from"./ImageCard-B7IPpvE0.js";import{u as R,R as k,I as N}from"./RelationshipsStats-B0OKvF2F.js";import{F as _}from"./Table-BMQsW9r8.js";import{F as B}from"./index-CqyweTda.js";import{S as C}from"./index-J20xQDFc.js";import{T}from"./index-CiNQcl16.js";import{c as q,a as w}from"./FilterEntries-DKUgjbtn.js";import{R as O}from"./ResponseState-BT0ASRjz.js";import{D as G}from"./DownloadButton-CL9t0Pp_.js";import{S as j}from"./SiderContent-B0McUjmA.js";import{c as W,C as $}from"./constants-COkG863P.js";import"./hooks-D7NuiXBW.js";import"./useMutation-BlHvKcpM.js";import"./useQueryParams-DqPkNU1y.js";import"./index-CYoT0uSg.js";import"./index-jT5de-T3.js";import"./index-CGHZ3ZJ-.js";import"./index-ZuSYxOkb.js";import"./index-CBE_GNRC.js";import"./index-DEdHXK8i.js";import"./scrollTo-De5D9bdo.js";import"./Pagination-Cs6cIB1f.js";import"./extendsObject-keMuGWqj.js";import"./Input-BkRdKyg_.js";import"./gapSize-U1swVQyS.js";import"./index-BI9BNfae.js";import"./Item-CcptkV8V.js";var A={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm154.7 454.5l-246 178c-5.3 3.8-12.7 0-12.7-6.5v-46.9c0-10.2 4.9-19.9 13.2-25.9L566.6 512 421.2 406.8c-8.3-6-13.2-15.6-13.2-25.9V334c0-6.5 7.4-10.3 12.7-6.5l246 178c4.4 3.2 4.4 9.8 0 13z"}}]},name:"right-circle",theme:"filled"},Z=function(l,r){return f.createElement(y,L({},l,{ref:r,icon:A}))},V=f.forwardRef(Z);function H(){const{query:{isDirty:u,isSaving:l,save:r,stats:g,data:c,...o},randomGroups:{cardIds:t},showIds:p,cardSize:a}=R(),[s,{width:n}]=P(),[,m]=f.useMemo(()=>{const i=Math.floor(n/a)+1,d=Math.floor(n/i);return[i,d]},[a,n]),h=[{title:"Length",dataIndex:"length",key:"length"},{title:"Relationships",dataIndex:"relationships",key:"relationship",render:(i,d)=>e.jsx(b.PreviewGroup,{children:e.jsx(B,{wrap:"wrap",gap:2,children:i.map(x=>e.jsxs(C,{children:[e.jsxs(C,{direction:"vertical",children:[e.jsx(M,{id:x,width:m}),p&&e.jsx(T,{children:x})]}),i[i.length-1]!==x&&e.jsx(V,{})]},`${d.origin}-${x}`))})})}],v=f.useMemo(()=>S.orderBy(t.map(i=>{const d=J(i,c,"longest",10);return{key:i,origin:i,length:d.length,relationships:d}}),["length"],["desc"]),[t,c]);return e.jsx(F,{isLoading:o.isLoading,error:o.error,hasResponseData:!0,children:e.jsx("div",{ref:s,className:"my-6",children:e.jsx(_,{dataSource:v,columns:h})})})}const J=S.memoize((u,l,r,g)=>{const c=new Set,o=[];let t=[],p=0;for(o.push({currentId:u,path:[],depth:0});o.length>0&&p<100;){p++;const{currentId:a,path:s,depth:n}=o.pop()??{currentId:"",path:[],depth:0};if(c.add(a),s.push(a),r==="longest"&&s.length>t.length&&(t=[...s]),r==="shortest"&&(t.length===0||s.length<t.length)&&(t=[...s]),r==="any"&&t.length===0&&(t=[...s]),!(n>=g))for(const m of l[a]||[])c.has(m)||o.push({currentId:m,path:[...s],depth:n+1})}return t});function K(){const{query:{isDirty:u,isSaving:l,data:r,isLoading:g,isError:c},showIds:o,setShowIds:t,sampleSize:p,setSampleSize:a,cardSize:s,setCardSize:n,randomGroups:{nextSet:m}}=R();return e.jsxs(D,{children:[e.jsx(O,{isLoading:g||l,isDirty:u,isError:c,hasResponseData:!S.isEmpty(r)}),e.jsxs(j,{children:[e.jsx(q,{label:"Show Ids",value:o,onChange:h=>t(h)}),e.jsx(w,{onChange:h=>a(h),value:p,options:W,label:"Sample Size"}),e.jsx(w,{onChange:h=>n(h),value:s,options:$,label:"Card Size"}),e.jsx(z,{onClick:m,block:!0,type:"primary",children:"New Random Sample"})]}),e.jsx(j,{children:e.jsx(k,{})}),e.jsx(j,{children:e.jsx(G,{data:r,fileName:"imageCardsRelationships.json",loading:l,disabled:S.isEmpty(r),block:!0})})]})}function Le(){return e.jsx(E,{title:"Image Cards",subtitle:"Connections",children:e.jsx(N,{children:e.jsxs(I,{hasSider:!0,children:[e.jsx(K,{}),e.jsx(I.Content,{className:"content",children:e.jsx(H,{})})]})})})}export{Le as default};
