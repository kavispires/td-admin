import{r as f,a as P,_ as D,j as e,T as x,I as E,B,D as T,P as G,L as N}from"./index--ZN08wDu.js";import{D as L}from"./DataLoadingWrapper-Dj_-u3Q9.js";import{P as O}from"./useBaseUrl-BBgSjbf3.js";import{I as k}from"./ImageCard-NVN8kv3H.js";import{u as z}from"./useCardWidth-3uPRGD9M.js";import{u as _}from"./useQueryParams-cx1saSCA.js";import{l as v}from"./lodash-C4Hxytv_.js";import{D as I}from"./index-edGriaUJ.js";import{S}from"./index-BREe-kUz.js";import{F as R}from"./index-B-6VEyuq.js";import{S as $}from"./index-h5cVVWuI.js";import{S as M}from"./index-CILhh8AU.js";import{T as A}from"./index-C861Mivw.js";import{R as V,a as W}from"./WomanOutlined-B4_avEfe.js";import{R as q,a as y}from"./ColumnWidthOutlined-DIKwXDNw.js";import{a as w,b as J}from"./FilterEntries-Bt5hb3C_.js";import{S as Q}from"./SiderContent-BGog9jVv.js";import{D as U}from"./DownloadButton-Bv12psgp.js";import{S as Y}from"./SaveButton-fIKqx0J1.js";import{a as K}from"./index-BdxyXXU_.js";import{u as X}from"./useResourceFirebaseData-DHb-t2Io.js";import"./gapSize-U1swVQyS.js";import"./index-BDlbjGSh.js";import"./index-Cy6P54MH.js";import"./moment-C5S46NFB.js";import"./SaveOutlined-w-cKtu32.js";import"./constants-Blyo5O-7.js";import"./Item-CaPucQvD.js";import"./useGetFirebaseDoc-TTiolrDv.js";import"./useTDResource-Bhl0DGmZ.js";import"./useUpdateFirebaseDoc-C_CYbUVF.js";import"./useMutation-Cq17nn2b.js";var Z={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M880 836H144c-17.7 0-32 14.3-32 32v36c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-36c0-17.7-14.3-32-32-32zm-622.3-84c2 0 4-.2 6-.5L431.9 722c2-.4 3.9-1.3 5.3-2.8l423.9-423.9a9.96 9.96 0 000-14.1L694.9 114.9c-1.9-1.9-4.4-2.9-7.1-2.9s-5.2 1-7.1 2.9L256.8 538.8c-1.5 1.5-2.4 3.3-2.8 5.3l-29.5 168.2a33.5 33.5 0 009.4 29.8c6.6 6.4 14.9 9.9 23.8 9.9z"}}]},name:"edit",theme:"filled"},ee=function(l,r){return f.createElement(P,D({},l,{ref:r,icon:Z}))},se=f.forwardRef(ee);const C=v.memoize((i,l)=>{const r=i.split("-");return`${r[0]}-${l??"gb"}-${r[1]}`});function ie({data:i,addEntryToUpdate:l}){const{removeParam:r,queryParams:d}=_(),c=d.get("suspectId"),o=d.get("version")??"gb",t=i[c??""];return t?e.jsx(I,{title:t.name.pt,placement:"right",onClose:()=>r("suspectId"),open:!!t,width:400,children:e.jsxs("div",{className:"suspect__drawer",children:[e.jsx("div",{className:"suspect__drawer__image",children:e.jsx(k,{id:C(t.id,o),width:100})}),e.jsxs("div",{className:"suspect__drawer__info",children:[e.jsx(x.Text,{strong:!0,children:"Build:"}),e.jsx(S,{size:"small",defaultValue:t.build,onChange:n=>{l(t.id,{...t,build:n})},placeholder:"Select Build",children:H.map(n=>e.jsx(S.Option,{value:n,children:n},n))}),e.jsx(x.Text,{strong:!0,children:"Height:"}),e.jsx(S,{size:"small",defaultValue:t.height,onChange:n=>{l(t.id,{...t,height:n})},children:H.map(n=>e.jsx(S.Option,{value:n,children:n},n))}),e.jsx(ae,{suspect:t,addEntryToUpdate:l})]})]})}):null}function ae({suspect:i,addEntryToUpdate:l}){const r=i.features??[],d=c=>{const o=r.includes(c)?r.filter(t=>t!==c):[...r,c];l(i.id,{...i,features:o})};return e.jsx("div",{children:F.map(c=>e.jsxs("div",{className:"my-4",children:[e.jsx(x.Text,{strong:!0,children:c.title}),c.features.map(o=>e.jsxs(R,{className:"my-2",gap:4,children:[e.jsx($,{size:"small",checked:r.includes(o.id),onChange:()=>d(o.id)})," ",o.label]},o.id))]},c.title))})}const H=["S","M","L"],F=[{title:"Hair Length",features:[{id:"shortHair",label:"Short Hair"},{id:"longHair",label:"Long Hair"},{id:"bald",label:"Bald"}]},{title:"Hair Color",features:[{id:"blackHair",label:"Black Hair"},{id:"brownHair",label:"Brown Hair"},{id:"blondeHair",label:"Blonde Hair"},{id:"redHair",label:"Red Hair"},{id:"greyHair",label:"Grey Hair"},{id:"coloredHair",label:"Colored Hair"}]},{title:"Face",features:[{id:"beard",label:"Beard"},{id:"mustache",label:"Mustache"},{id:"goatee",label:"Goatee"},{id:"lipstick",label:"Lipstick"}]},{title:"Accessories",features:[{id:"glasses",label:"Glasses"},{id:"piercings",label:"Piercings"},{id:"earrings",label:"Earrings"},{id:"necklace",label:"Necklace"},{id:"hat",label:"Hat"},{id:"scarf",label:"Scarf"},{id:"hoodie",label:"Hoodie"},{id:"tie",label:"Tie"},{id:"headscarf",label:"Headscarf/Bandana"}]}];function re({data:i,addEntryToUpdate:l}){const{addParam:r,queryParams:d}=_(),c=d.get("version")??"ct",o=d.get("sortBy")??"id",t=Number(d.get("cardsPerRow"))||8,[n,g]=z(t),s=f.useMemo(()=>v.orderBy(Object.values(i),a=>o==="id"?Number(a.id.split("-").at(-1)):a[o]??a.id,["asc"]),[i,o]);return e.jsxs(e.Fragment,{children:[e.jsxs(x.Title,{level:2,children:["Deck ",c," (",s.length,")"]}),e.jsx(E.PreviewGroup,{children:e.jsx(M,{ref:g,wrap:!0,className:"my-2",children:s.map(a=>{var j,u;return e.jsxs("div",{className:"suspect",style:{width:`${n}px`},children:[e.jsx(k,{id:C(a.id,c),width:n,className:"suspect__image"}),e.jsxs("div",{className:"suspect__name",children:[e.jsx("div",{children:e.jsx(A,{children:a.id})}),e.jsxs("div",{children:["ðŸ‡§ðŸ‡· ",a.name.pt]}),e.jsxs("div",{children:["ðŸ‡ºðŸ‡¸ ",a.name.en]}),e.jsxs("div",{className:"suspect__info",children:[e.jsxs("div",{children:[e.jsxs("div",{children:[a.gender==="male"?e.jsx(V,{}):e.jsx(W,{})," ",a.age]}),e.jsx("div",{children:e.jsx("em",{children:a.ethnicity})})]}),e.jsxs("div",{children:[e.jsx(q,{}),e.jsx("br",{}),a.build]}),e.jsxs("div",{children:[e.jsx(y,{}),e.jsx("br",{}),a.height]}),e.jsxs("div",{children:[((j=a==null?void 0:a.features)==null?void 0:j.length)??0," features"]})]}),e.jsx(B,{size:"small",block:!0,onClick:()=>r("suspectId",a.id),danger:!(a!=null&&a.features)||((u=a==null?void 0:a.features)==null?void 0:u.length)<2,children:e.jsx(se,{})})]})]},a.id)})},c)}),e.jsx(ie,{data:i,addEntryToUpdate:l})]})}function b(i,l){return v.orderBy(Object.entries(i).map(([r,d])=>({key:r,label:v.capitalize(r),value:d,percentage:Math.round(d/l*100)})),["percentage"],["desc"])}function te({data:i}){const[l,r]=f.useState(!1);return e.jsxs(e.Fragment,{children:[e.jsx(B,{onClick:()=>r(!0),block:!0,children:"See Stats"}),l&&e.jsx(le,{data:i,open:l,onClose:()=>r(!1)})]})}function le({data:i,open:l,onClose:r}){const{ages:d,ethnicities:c,genders:o,builds:t,heights:n}=f.useMemo(()=>{const s={},a={},j={},u={},m={};Object.values(i).forEach(h=>{s[h.age]=(s[h.age]??0)+1,a[h.ethnicity]=(a[h.ethnicity]??0)+1,j[h.gender]=(j[h.gender]??0)+1,u[h.build||"?"]=(u[h.build||"?"]??0)+1,m[h.height||"?"]=(m[h.height||"?"]??0)+1});const p=Object.keys(i).length;return{ages:b(s,p),ethnicities:b(a,p),genders:b(j,p),builds:b(u,p),heights:b(m,p)}},[i]),g=f.useMemo(()=>{const s={};Object.values(i).forEach(u=>{var m;(m=u.features)==null||m.forEach(p=>{s[p]=(s[p]??0)+1})});const a=Object.keys(i).length,j=F.reduce((u,m)=>{const p=m.features.map(h=>h.id);return u.push(...p),u},[]);return v.orderBy(b(s,a),u=>j.findIndex(m=>m===u.key),["asc"])},[i]);return e.jsxs(I,{title:"Suspects Statistics",placement:"right",onClose:r,open:l,width:400,children:[e.jsx(x.Text,{strong:!0,children:"Ethnicity"}),e.jsx("ul",{className:"statistic__list",children:c.map(s=>e.jsxs("li",{children:[e.jsx("strong",{children:s.label})," - ",s.percentage,"%"]},s.key))}),e.jsx(x.Text,{strong:!0,children:"Gender"}),e.jsx("ul",{className:"statistic__list",children:o.map(s=>e.jsxs("li",{children:[e.jsx("strong",{children:s.label})," - ",s.percentage,"%"]},s.key))}),e.jsx(x.Text,{strong:!0,children:"Age"}),e.jsx("ul",{className:"statistic__list",children:d.map(s=>e.jsxs("li",{children:[e.jsx("strong",{children:s.label})," - ",s.percentage,"%"]},s.key))}),e.jsx(x.Text,{strong:!0,children:"Build"}),e.jsx("ul",{className:"statistic__list",children:t.map(s=>e.jsxs("li",{children:[e.jsx("strong",{children:s.label})," - ",s.percentage,"%"]},s.key))}),e.jsx(x.Text,{strong:!0,children:"Height"}),e.jsx("ul",{className:"statistic__list",children:n.map(s=>e.jsxs("li",{children:[e.jsx("strong",{children:s.label})," - ",s.percentage,"%"]},s.key))}),e.jsx(x.Text,{strong:!0,children:"Features"}),e.jsx("ul",{className:"statistic__list",children:g.map(s=>e.jsxs("li",{children:[e.jsx("strong",{children:s.label})," - ",s.percentage,"% (",s.value,")"]},s.key))})]})}const ne=[{value:"ct",label:"Cartoon"},{value:"gb",label:"Ghibli"},{value:"ai",label:"AI"},{value:"md",label:"Models"},{value:"wc",label:"Wacky"}],ce=[{value:"id",label:"Id"},{value:"name.pt",label:"Name (PT)"},{value:"name.en",label:"Name (EN)"},{value:"ethnicity",label:"Ethnicity"},{value:"gender",label:"Gender"},{value:"age",label:"Age"},{value:"height",label:"Height"},{value:"build",label:"Build"}];function oe({data:i,save:l,isDirty:r,isSaving:d,entriesToUpdate:c,hasFirestoreData:o}){const{addParam:t,queryParams:n}=_();return e.jsxs(Q,{children:[e.jsxs(R,{vertical:!0,gap:12,children:[e.jsx(Y,{isDirty:r,onSave:l,isSaving:d,dirt:JSON.stringify(c)}),e.jsx(U,{data:()=>de(i),fileName:"suspects.json",disabled:r,hasNewData:o,block:!0})]}),e.jsx(T,{}),e.jsx(w,{label:"Version",value:n.get("version")??"gb",onChange:g=>t("version",g),options:ne}),e.jsx(J,{label:"Cards Per Row",value:Number(n.get("cardsPerRow")??"8"),onChange:g=>t("cardsPerRow",g),min:2,max:12}),e.jsx(w,{label:"Sort By",value:n.get("sortBy")??"id",onChange:g=>t("sortBy",g),options:ce}),e.jsx(te,{data:i})]})}function de(i){return K(i,["gender","ethnicity","age","height","build","features"])}function Ve(){const i=X({tdrResourceName:"suspects",firebaseDataCollectionName:"suspects",serialize:!0});return e.jsx(G,{title:"Suspects",subtitle:"Information",children:e.jsxs(N,{hasSider:!0,children:[e.jsx(O,{children:e.jsx(oe,{...i})}),e.jsx(N.Content,{className:"content",children:e.jsx(L,{isLoading:i.isLoading,error:i.error,hasResponseData:!v.isEmpty(i.data),children:e.jsx(re,{...i})})})]})})}export{Ve as default};
