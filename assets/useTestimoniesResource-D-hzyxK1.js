import{l as L}from"./useBaseUrl-HNzBeRFU.js";import{u as R}from"./useResourceFirestoreData-CYhxhXFF.js";import{u as E}from"./useTDResource-BdlfzREJ.js";const x=(s,o,t,u)=>{const{reliabilityThreshold:c=4,projectionThreshold:f=55}={},m=`us-gb-${s.split("-")[1].padStart(3,"0")}`,e=L.isEmpty(t[s])?[]:t[s],r=e.some(n=>n===32||n===-32);let h=0,l=0,a=0,b=0,i=0;e.forEach(n=>{n===32?h+=35:n===-32?l+=35:n===4?h+=4:n===-4?l+=4:n>0?a+=n:n<0&&(b+=Math.abs(n)),i+=Math.abs(n)});const O=a+b,y=Math.max(i,c),p=i===0?0:Math.round((h+a)/y*100),d=i===0?0:Math.round((l+b)/y*100),M=h+a,D=l+b,T=i===0?100:Math.round((y-M-D)/y*100),j=r||i>=c,S=r||O>c/1.5||i>=4,A=S&&i>c&&Math.abs(p-d)>=40,z=A&&Math.abs(p-d)>40?p>d?"ğŸ‘":"ğŸ‘":null,C=Math.abs(p-d)<50?null:p>=f?"ğŸ‘":d>=f?"ğŸ‘":null;return{suspectCardId:s,imageId:m,questionId:o,enoughData:S,reliable:A,total:i,yesCount:M,yesPercentage:p,noCount:D,noPercentage:d,blankPercentage:T,complete:j,values:e,resolution:z,projection:C}};function P(s){const o=s.map(e=>e===0?-1:e),t=s.filter(e=>e===-32||e===32||e===4||e===-4),u=o.filter(e=>e===-1||e===1),c=o.filter(e=>![-32,32,4,-4,-1,1].includes(e)).flatMap(e=>Array.from({length:Math.abs(e)},()=>e>0?1:-1)),f=[...u,...c].sort((e,r)=>e-r),g={"-1":0,1:0};f.forEach(e=>{(e===-1||e===1)&&(g[e]+=1)});const m=8;for(const[e,r]of Object.entries(g)){const h=Math.floor(r/m),l=r%m;for(let a=0;a<h;a++)t.push(e==="-1"?-m:m);if(l>0){const a=Array.from({length:l},()=>e==="-1"?-1:1);t.push(...a)}}return t.sort((e,r)=>e-r)}const Q=s=>s.reduce((o,t)=>{const u=Math.abs(t);return u?o+u:o},0);function V(){const s=E("suspects"),o=E("testimony-questions-pt"),t=R({tdrResourceName:"testimony-answers",firestoreDataCollectionName:"testimonies",serialize:!0,deserializer:F});return{...t,isLoading:t.isLoading||o.isLoading||s.isLoading,isSuccess:t.isSuccess&&o.isSuccess&&s.isSuccess,error:t.error||o.error||s.error,questions:o.data,suspects:s.data,hasNewData:t.hasFirestoreData}}function F(s){const o={};return Object.entries(s).forEach(([t,u])=>{o[t]={},Object.entries(u).forEach(([c,f])=>{o[t][c]=JSON.parse(f)})}),o}export{x as a,Q as c,P as n,F as t,V as u};
