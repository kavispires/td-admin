import{r as u,j as x,b as I}from"./index-DyjSH4OM.js";import{u as P}from"./useTDResource-CGE34CFt.js";import{l as E}from"./useBaseUrl-CGDFxb01.js";import{u as R}from"./useDebounce-D7MRSMNC.js";import{A as w}from"./index-nZGt43g9.js";function N({items:p,isPending:c,style:C,size:A,placeholder:S,allowClear:$,onFinish:m,onFinishMultiple:f,...g}){const O=P("items",{enabled:!p&&!c}),{namesDict:n,options:b}=u.useMemo(()=>{console.log("Recomputing item names typeahead...");const t=Object.values(p??O.data??{}).reduce((o,e)=>{const i=`${e.name.en} (${e.id})`,l=`${e.name.pt} (${e.id})`;return o[i]=e.id,o[l]=e.id,e.aliasesEn&&e.aliasesEn.forEach(a=>{o[`${a} (${e.id})*`]=e.id}),e.aliasesPt&&e.aliasesPt.forEach(a=>{o[`${a} (${e.id})*`]=e.id}),o},{}),s=E.orderBy(Object.keys(t),[o=>o.toLowerCase()]).map(o=>({value:o}));return{namesDict:t,options:s}},[p,c]),[r,h]=u.useState([]),[d,j]=u.useState("");R(()=>{d&&D(d)},500,[d]);const D=t=>{if(!t){h([]);return}const s=t.trim().toUpperCase(),o=b.filter(i=>String(i?.value??"").toUpperCase().includes(s)),e=E.orderBy(o,[i=>{const l=String(i?.value??"").toUpperCase();if(l===s)return 0;const a=l.match(/\((.*?)\)/);if(a&&a[1]===s)return 1;const v=l.indexOf(s);return v===0?2:v>0?3:4}]);h(e)},T=()=>{if(r.length>0){const t=r.map(s=>n[s.value]).filter(Boolean);f&&t.length>0?f(t):n[r[0].value]!==void 0&&m(n[r[0].value])}},U=t=>{n[t]!==void 0&&m(n[t])};return x.jsx(w,{allowClear:$??!0,filterOption:(t,s)=>String(s?.value??"").toUpperCase().indexOf(t?.toUpperCase())!==-1,notFoundContent:d.length>0?"No items found":"Type to search...",onSearch:j,onSelect:U,options:r,placeholder:S??"Search by name or id...",style:{width:250,...C},...g,children:x.jsx(I,{onPressEnter:T})})}export{N as I};
