import{r as x,a as H,_ as B,j as s,T as P,B as V,a2 as ae,a4 as ie,aT as Te,at as S,ao as Le,D as ke,a1 as Me,a0 as Re,a3 as he,P as Ge,L as pe}from"./index-BNJYKVIC.js";import{u as ge}from"./useQueryParams-DLTpWxK3.js";import{R as xe}from"./main-DcP01F_6.js";import{a as Ue,C as Ye,u as je}from"./useArteRuimDrawings-DmGE8mGY.js";import{u as Ie}from"./useMutation-DjmQ5E5Z.js";import{g as qe,u as Pe}from"./useGetFirestoreDoc-Cs8Hi5gn.js";import{h as G}from"./moment-C5S46NFB.js";import{a as re,m as _e,r as ve,k as Fe}from"./index-C9mPKTN_.js";import{F as y}from"./index-FDrAMI0R.js";import{S as Y}from"./index-BwvjNAnM.js";import{I as ce}from"./index-CuHbruYb.js";import{T as Ve,a as se,F as $e}from"./FilterEntries-CCoAyxlA.js";import{T as $}from"./index-aBvBbvdh.js";import{S as Qe}from"./index-PmBYYg5g.js";import{F as de}from"./FirestoreConsoleLink-CdfoW4TO.js";import{C as ye}from"./CopyToClipboardButton-DYVnB9r_.js";import{I as ne}from"./ImageCard-D6AuhLer.js";import{f as He,W as Be,d as _,g as ue}from"./constants-DeGr9eff.js";import{I as F}from"./Item-_XCH4_tE.js";import{S as We,g as be}from"./SuspectImageCard-Z7WD1T3q.js";import{l as m,P as Ke}from"./useBaseUrl-CnhjxzNY.js";import{g as ze,u as U,D as I,a as q,c as W,A as Je,b as Ze,L as De}from"./useParsedHistory-B1n2wDHq.js";import{R as Xe,a as et}from"./Pagination-CSwq09lh.js";import{F as Ce}from"./Table-CRIM2HBm.js";import{D as tt}from"./DataLoadingWrapper-DdDgtoI9.js";import{u as M}from"./useTDResource-CUg3mPxk.js";import{a as K,c as st,u as nt,b as at}from"./daily-quartetos-D6mmcbvB.js";import{d as me,c as it,u as rt,a as ot,t as w}from"./useTestimoniesResource-CgZu76jc.js";import{u as oe}from"./useLoadWordLibrary-BebnKkwv.js";import{u as lt}from"./daily-teoria-de-conjuntos-D1TgcpGW.js";import{u as Ae}from"./useDailyHistoryQuery-BrDgtEH0.js";import{R as ct}from"./SaveOutlined-BuXNrql8.js";import{S as le}from"./SiderContent-hSemqOY9.js";import{C as O}from"./index-BqxBltHX.js";import"./gapSize-U1swVQyS.js";import"./Input-B6Tvl3x4.js";import"./index-BxojlLAl.js";import"./index-B4ksTH7Q.js";import"./index-B77dLZ4L.js";import"./useCopyToClipboardFunction-D1E4SsD2.js";import"./index-D5MZdaPn.js";import"./index-HOUFTjH0.js";import"./scrollTo-nlbBddAi.js";import"./useResourceFirestoreData-DQFh0yeH.js";import"./useUpdateFirestoreDoc-Cm4FBSXk.js";var dt={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M880 184H712v-64c0-4.4-3.6-8-8-8h-56c-4.4 0-8 3.6-8 8v64H384v-64c0-4.4-3.6-8-8-8h-56c-4.4 0-8 3.6-8 8v64H144c-17.7 0-32 14.3-32 32v664c0 17.7 14.3 32 32 32h736c17.7 0 32-14.3 32-32V216c0-17.7-14.3-32-32-32zm-40 656H184V460h656v380zM184 392V256h128v48c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8v-48h256v48c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8v-48h128v136H184z"}}]},name:"calendar",theme:"outlined"},ut=function(i,a){return x.createElement(H,B({},i,{ref:a,icon:dt}))},mt=x.forwardRef(ut),ht={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M811.4 368.9C765.6 248 648.9 162 512.2 162S258.8 247.9 213 368.8C126.9 391.5 63.5 470.2 64 563.6 64.6 668 145.6 752.9 247.6 762c4.7.4 8.7-3.3 8.7-8v-60.4c0-4-3-7.4-7-7.9-27-3.4-52.5-15.2-72.1-34.5-24-23.5-37.2-55.1-37.2-88.6 0-28 9.1-54.4 26.2-76.4 16.7-21.4 40.2-36.9 66.1-43.7l37.9-10 13.9-36.7c8.6-22.8 20.6-44.2 35.7-63.5 14.9-19.2 32.6-36 52.4-50 41.1-28.9 89.5-44.2 140-44.2s98.9 15.3 140 44.3c19.9 14 37.5 30.8 52.4 50 15.1 19.3 27.1 40.7 35.7 63.5l13.8 36.6 37.8 10c54.2 14.4 92.1 63.7 92.1 120 0 33.6-13.2 65.1-37.2 88.6-19.5 19.2-44.9 31.1-71.9 34.5-4 .5-6.9 3.9-6.9 7.9V754c0 4.7 4.1 8.4 8.8 8 101.7-9.2 182.5-94 183.2-198.2.6-93.4-62.7-172.1-148.6-194.9z"}},{tag:"path",attrs:{d:"M376.9 656.4c1.8-33.5 15.7-64.7 39.5-88.6 25.4-25.5 60-39.8 96-39.8 36.2 0 70.3 14.1 96 39.8 1.4 1.4 2.7 2.8 4.1 4.3l-25 19.6a8 8 0 003 14.1l98.2 24c5 1.2 9.9-2.6 9.9-7.7l.5-101.3c0-6.7-7.6-10.5-12.9-6.3L663 532.7c-36.6-42-90.4-68.6-150.5-68.6-107.4 0-195 85.1-199.4 191.7-.2 4.5 3.4 8.3 8 8.3H369c4.2-.1 7.7-3.4 7.9-7.7zM703 664h-47.9c-4.2 0-7.7 3.3-8 7.6-1.8 33.5-15.7 64.7-39.5 88.6-25.4 25.5-60 39.8-96 39.8-36.2 0-70.3-14.1-96-39.8-1.4-1.4-2.7-2.8-4.1-4.3l25-19.6a8 8 0 00-3-14.1l-98.2-24c-5-1.2-9.9 2.6-9.9 7.7l-.4 101.4c0 6.7 7.6 10.5 12.9 6.3l23.2-18.2c36.6 42 90.4 68.6 150.5 68.6 107.4 0 195-85.1 199.4-191.7.2-4.5-3.4-8.3-8-8.3z"}}]},name:"cloud-sync",theme:"outlined"},pt=function(i,a){return x.createElement(H,B({},i,{ref:a,icon:ht}))},ft=x.forwardRef(pt),gt={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M518.3 459a8 8 0 00-12.6 0l-112 141.7a7.98 7.98 0 006.3 12.9h73.9V856c0 4.4 3.6 8 8 8h60c4.4 0 8-3.6 8-8V613.7H624c6.7 0 10.4-7.7 6.3-12.9L518.3 459z"}},{tag:"path",attrs:{d:"M811.4 366.7C765.6 245.9 648.9 160 512.2 160S258.8 245.8 213 366.6C127.3 389.1 64 467.2 64 560c0 110.5 89.5 200 199.9 200H304c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8h-40.1c-33.7 0-65.4-13.4-89-37.7-23.5-24.2-36-56.8-34.9-90.6.9-26.4 9.9-51.2 26.2-72.1 16.7-21.3 40.1-36.8 66.1-43.7l37.9-9.9 13.9-36.6c8.6-22.8 20.6-44.1 35.7-63.4a245.6 245.6 0 0152.4-49.9c41.1-28.9 89.5-44.2 140-44.2s98.9 15.3 140 44.2c19.9 14 37.5 30.8 52.4 49.9 15.1 19.3 27.1 40.7 35.7 63.4l13.8 36.5 37.8 10C846.1 454.5 884 503.8 884 560c0 33.1-12.9 64.3-36.3 87.7a123.07 123.07 0 01-87.6 36.3H720c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h40.1C870.5 760 960 670.5 960 560c0-92.7-63.1-170.7-148.6-193.3z"}}]},name:"cloud-upload",theme:"outlined"},xt=function(i,a){return x.createElement(H,B({},i,{ref:a,icon:gt}))},jt=x.forwardRef(xt),It={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M832 64H192c-17.7 0-32 14.3-32 32v832c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V96c0-17.7-14.3-32-32-32zm-40 824H232V687h97.9c11.6 32.8 32 62.3 59.1 84.7 34.5 28.5 78.2 44.3 123 44.3s88.5-15.7 123-44.3c27.1-22.4 47.5-51.9 59.1-84.7H792v-63H643.6l-5.2 24.7C626.4 708.5 573.2 752 512 752s-114.4-43.5-126.5-103.3l-5.2-24.7H232V136h560v752zM320 341h384c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8H320c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8zm0 160h384c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8H320c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8z"}}]},name:"container",theme:"outlined"},vt=function(i,a){return x.createElement(H,B({},i,{ref:a,icon:It}))},yt=x.forwardRef(vt),bt={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M396 512a112 112 0 10224 0 112 112 0 10-224 0zm546.2-25.8C847.4 286.5 704.1 186 512 186c-192.2 0-335.4 100.5-430.2 300.3a60.3 60.3 0 000 51.5C176.6 737.5 319.9 838 512 838c192.2 0 335.4-100.5 430.2-300.3 7.7-16.2 7.7-35 0-51.5zM508 688c-97.2 0-176-78.8-176-176s78.8-176 176-176 176 78.8 176 176-78.8 176-176 176z"}}]},name:"eye",theme:"filled"},Dt=function(i,a){return x.createElement(H,B({},i,{ref:a,icon:bt}))},Ct=x.forwardRef(Dt);function At(){const[e,i]=x.useState(""),[a,r]=x.useState(7),[t,n]=x.useState(!1),[o,l]=x.useState(!1),[c,d]=x.useState(""),{isLoading:h,isError:u,data:g}=St(e,a,o),p=v=>{n(!1),l(!1),i(v.trim())},j=v=>{l(!1),r(v)},A=()=>{const v=G(e,"YYYY-MM-DD",!0).isValid();n(v),l(v)},E=x.useMemo(()=>{if(!g||Object.keys(g).length===0)return{};if(!c)return g;const v=c;if(!Object.values(g).every(b=>b==null?void 0:b[v]))return g;const R={};return Object.values(g).forEach(b=>{const f=b==null?void 0:b[v],D=f==null?void 0:f.number;R[D]&&console.error(`Duplicate entry for game ${v} with number ${D}`),R[D]=re(f,["number","language","text"])}),R},[g,c]);return s.jsxs("div",{children:[s.jsx(P.Title,{level:2,children:"Data Archive"}),s.jsxs(y,{align:"center",className:"mb-6",justify:"space-between",children:[s.jsxs(y,{align:"center",gap:12,children:[s.jsxs(Y.Compact,{children:[s.jsx(ce,{onChange:v=>p(v.target.value),placeholder:"YYYY-MM-DD",value:e}),s.jsx(Ve,{max:100,min:1,onChange:v=>j(v??1),value:a}),s.jsx(V,{disabled:!e||!G(e,"YYYY-MM-DD",!0).isValid(),onClick:A,type:"primary",children:"Load"})]}),e&&s.jsxs("span",{children:[s.jsx($,{children:e}),a>1&&s.jsxs(s.Fragment,{children:["to"," ",s.jsx($,{children:G(e).add(a-1,"days").format("YYYY-MM-DD")})]})]}),s.jsx("span",{children:s.jsx($,{color:h?"blue":u?"red":t?"green":"gray",children:h?"Loading...":u?"Error":t?"Valid":"Ready"})})]}),s.jsxs(y,{align:"center",gap:12,children:[s.jsx(Et,{}),s.jsx(Qe,{allowClear:!0,onChange:v=>d(v),options:[{value:"",label:"All games"},{value:"aqui-o",label:"Aqui Ã“"},{value:"arte-ruim",label:"Arte Ruim"},{value:"artista",label:"Artista"},{value:"comunicacao-alienigena",label:"ComunicaÃ§Ã£o AlienÃ­gena"},{value:"controle-de-estoque",label:"Controle de Estoque"},{value:"filmaco",label:"FilmaÃ§o"},{value:"palavreado",label:"Palavreado"},{value:"portais-magicos",label:"Portais MÃ¡gicos"},{value:"quartetos",label:"Quartetos"},{value:"ta-na-cara",label:"TÃ¡ na Cara"},{value:"teoria-de-conjuntos",label:"Teoria de Conjuntos"}],placeholder:"Filter by game",style:{width:200}})]})]}),s.jsx(xe,{collapsed:1,src:E,theme:"twilight"})]})}const St=(e,i,a)=>{const r=x.useMemo(()=>{if(!a||!G(e,"YYYY-MM-DD",!0).isValid())return[];const c=[],d=G(e);for(let h=0;h<i;h++){const u=d.clone().add(h,"days").format("YYYY-MM-DD");c.push({queryKey:["firebase","diario",u],queryFn:qe("diario",u),enabled:!0})}return c},[e,i,a]),t=Ue({queries:r}),n=t.some(c=>c.isLoading),o=t.some(c=>c.isError),l=x.useMemo(()=>n||o?{}:t.reduce((c,d,h)=>{if(d.data&&Object.keys(d.data).length>0){const u=G(e).add(h,"days").format("YYYY-MM-DD");c[u]=d.data}return c},{}),[t,e,n,o]);return{isLoading:n,isError:o,data:l,results:t}};function Et(){const e=Ie({mutationFn:async()=>{const i="2024-01-01",a="2024-04-30";try{const r=G(i),t=G(a);for(let n=0;n<=t.diff(r,"days");n++){const o=r.clone().add(n,"days").format("YYYY-MM-DD"),l=ae(ie,"diario",o);await Te(l)}}catch(r){throw new Error(r)}},onError:i=>{console.error("Error deleting documents:",i)},onSuccess:()=>{console.log(" Documents deleted successfully")}});return s.jsx(V,{danger:!0,disabled:!0,loading:e.isPending,onClick:()=>e.mutate(),children:"Delete secured documents"})}function N({children:e}){return s.jsx(Y,{direction:"vertical",style:{maxWidth:120},children:e})}function T({children:e}){return s.jsxs($,{color:"cyan",children:["#",e]})}function C({label:e,children:i}){return s.jsxs(P.Text,{children:[s.jsxs("strong",{children:[e,":"]})," ",i]})}function L({children:e,entry:i}){return s.jsx(Le,{content:e,title:s.jsxs(y,{justify:"space-between",children:[s.jsx(P.Text,{children:"Sneak Peek"}),s.jsx(ye,{content:JSON.stringify(i)})]}),trigger:"click",children:s.jsx(V,{icon:s.jsx(Ct,{})})})}const Se=[{title:"Id",dataIndex:"id",key:"id",fixed:"left"},{title:"Arte Ruim",dataIndex:"arte-ruim",key:"arte-ruim",render:e=>{if(!e)return s.jsx(S,{message:"No entry",type:"error"});const{number:i,cardId:a,text:r,drawings:t}=e;return s.jsxs(N,{children:[s.jsx(T,{children:i}),s.jsx(C,{label:"CardId",children:a}),s.jsx(C,{label:"Drawings",children:t.length}),s.jsx(L,{entry:e,children:s.jsxs(y,{gap:6,vertical:!0,children:[s.jsxs("div",{children:['"',r.split("").map((n,o)=>o<2||n===" "?n:"â¹").join(""),'"']}),s.jsx(Y,{wrap:!0,children:t.map(n=>s.jsx(Ye,{className:"canvas",drawing:n,height:75,width:75},n))})]})})]})}},{title:"Aqui O",dataIndex:"aqui-o",key:"aqui-o",render:e=>{if(!e)return s.jsx(S,{message:"No entry",type:"error"});const{number:i,setId:a,title:r,itemsIds:t}=e;return s.jsxs(N,{children:[s.jsx(T,{children:i}),s.jsx(C,{label:"SetId",children:a}),s.jsx(C,{label:"Title",children:r.pt}),s.jsx(C,{label:"Items",children:t.length}),s.jsx(L,{entry:e,children:s.jsx(y,{gap:6,style:{maxWidth:500},wrap:!0,children:t.map(n=>s.jsx(F,{id:n,width:48},n))})})]})}},{title:"AlienÃ­gena",dataIndex:"comunicacao-alienigena",key:"comunicacao-alienigena",render:e=>{if(!e)return s.jsx(S,{message:"No entry",type:"error"});const{number:i,itemsIds:a,attributes:r}=e;return s.jsxs(N,{children:[s.jsx(T,{children:i}),s.jsx(C,{label:"Items",children:a.length}),s.jsx(L,{entry:e,children:s.jsxs(y,{gap:6,style:{maxWidth:"300px"},vertical:!0,children:[s.jsx(Y,{wrap:!0,children:r.map(t=>s.jsx(He,{id:`sign-${t.spriteId}`,width:48},t.spriteId))}),s.jsx(Y,{wrap:!0,children:a.map(t=>s.jsx(F,{id:t,width:48},t))})]})})]})}},{title:"Conjuntos",dataIndex:"teoria-de-conjuntos",key:"teoria-de-conjuntos",render:e=>{if(!e)return s.jsx(S,{message:"No entry",type:"error"});const{number:i,rule1:a,intersectingThing:r,rule2:t,title:n,things:o}=e;return s.jsxs(N,{children:[s.jsx(T,{children:i}),s.jsx(C,{label:"Title",children:n}),s.jsx(L,{entry:e,children:s.jsxs(y,{gap:6,vertical:!0,children:[s.jsxs(y,{gap:6,children:[s.jsx(F,{id:a.thing.id,width:48}),s.jsx(F,{id:r.id,width:48}),s.jsx(F,{id:t.thing.id,width:48})]}),s.jsx(y,{gap:6,children:o.map(l=>s.jsx(F,{id:l.id,width:35},l.id))})]})})]})}},{title:"Estoque",dataIndex:"controle-de-estoque",key:"controle-de-estoque",render:e=>{if(!e)return s.jsx(S,{message:"No entry",type:"error"});const{number:i,title:a,goods:r}=e;return s.jsxs(N,{children:[s.jsx(T,{children:i}),s.jsx(C,{label:"Title",children:a}),s.jsx(C,{label:"Goods",children:r.length}),s.jsx(L,{entry:e,children:s.jsx(y,{gap:6,style:{maxWidth:245},wrap:!0,children:r.map(t=>s.jsx(Be,{id:t,width:48},t))})})]})}},{title:"Espionagem",dataIndex:"espionagem",key:"espionagem",render:e=>{if(!e)return s.jsx(S,{message:"No entry",type:"error"});const{number:i,statements:a,additionalStatements:r,suspects:t,culpritId:n}=e;return s.jsxs(N,{children:[s.jsx(T,{children:i}),s.jsx(C,{label:"Suspects",children:t.length}),s.jsx(C,{label:"Culprit",children:n}),s.jsx(C,{label:"Statements",children:a.length}),s.jsx(L,{entry:e,children:s.jsxs(y,{gap:6,vertical:!0,children:[s.jsx(Y,{style:{maxHeight:200,overflowY:"auto"},wrap:!0,children:t.map(o=>s.jsx(We,{id:o.id,width:48},o.id))}),a.slice(0,3).map(o=>s.jsx(S,{banner:!0,message:o.text,showIcon:!0,type:"info"},o.key)),r.map(o=>s.jsx(S,{banner:!0,message:o.text,showIcon:!0,type:"warning"},o.key))]})})]})}},{title:"FilmaÃ§o",dataIndex:"filmaco",key:"filmaco",render:e=>{if(!e)return s.jsx(S,{message:"No entry",type:"error"});const{number:i,setId:a,title:r,year:t}=e;return s.jsxs(N,{children:[s.jsx(T,{children:i}),s.jsx(C,{label:"SetId",children:a}),s.jsx(L,{entry:e,children:s.jsxs(y,{gap:6,vertical:!0,children:[s.jsxs("span",{children:["Year: ",t]}),s.jsxs("span",{children:["Title:"," ",r.split("").map((n,o)=>o<1||n===" "?n:"â¹").join("")]})]})})]})}},{title:"Organiku",dataIndex:"organiku",key:"organiku",render:e=>{if(!e)return s.jsx(S,{message:"No entry",type:"error"});const{number:i,setId:a,title:r,grid:t,defaultRevealedIndexes:n}=e;return s.jsxs(N,{children:[s.jsx(T,{children:i}),s.jsx(C,{label:"SetId",children:a}),s.jsx(C,{label:"Title",children:r}),s.jsx(L,{entry:e,children:s.jsx("div",{className:"grid",style:{gridTemplateColumns:`repeat(${(t==null?void 0:t.length)%5===0?5:6}, 1fr)`,gap:"8px"},children:(t??[]).map((o,l)=>s.jsx("div",{className:"grid-item",children:s.jsx(F,{className:n.includes(l)?"red-border":"",id:n.includes(l)&&o||"0",width:48})},`${o}-${l}`))})})]})}},{title:"Palavreado",dataIndex:"palavreado",key:"palavreado",render:e=>{if(!e)return s.jsx(S,{message:"No entry",type:"error"});const{number:i,letters:a,keyword:r,words:t}=e;return s.jsxs(N,{children:[s.jsx(T,{children:i}),s.jsx(C,{label:"Letters",children:a.length}),s.jsx(C,{label:"Keyword",children:r}),s.jsx(L,{entry:e,children:s.jsx(Y,{direction:"vertical",children:t.map((n,o)=>s.jsx("span",{children:n.split("").map((l,c)=>c===o||l===" "?l:"â¹").join("")},`${i}-${n}`))})})]})}},{title:"Portais",dataIndex:"portais-magicos",key:"portais-magicos",render:e=>{if(!e)return s.jsx(S,{message:"No entry",type:"error"});const{number:i,setId:a,corridors:r}=e;return s.jsxs(N,{children:[s.jsx(T,{children:i}),s.jsx(C,{label:"SetId",children:m.truncate(a,{length:9})}),s.jsx(L,{entry:e,children:s.jsx(y,{gap:6,vertical:!0,children:r.map(t=>s.jsxs(y,{gap:6,vertical:!0,children:[s.jsxs("span",{children:["Passcode: ",t.passcode," (",t.goal,")"]}),s.jsx(y,{children:t.imagesIds.map(n=>s.jsx(ne,{id:n,width:48},n))})]},t.passcode))})})]})}},{title:"Quartetos",dataIndex:"quartetos",key:"quartetos",render:e=>{if(!e)return s.jsx(S,{message:"No entry",type:"error"});const{number:i,setId:a,sets:r}=e;return s.jsxs(N,{children:[s.jsx(T,{children:i}),s.jsx(C,{label:"SetId",children:m.truncate(a,{length:9})}),s.jsx(L,{entry:e,children:s.jsx(y,{gap:6,children:r.map(t=>s.jsx(y,{gap:6,vertical:!0,children:t.itemsIds.map(n=>s.jsx(F,{id:n,width:48},n))},t.id))})})]})}},{title:"PicaÃ§o",dataIndex:"artista",key:"artista",render:e=>{if(!e)return s.jsx(S,{message:"No entry",type:"error"});const{number:i,cards:a}=e;return s.jsxs(N,{children:[s.jsx(T,{children:i}),s.jsx(C,{label:"Cards",children:a.length}),s.jsx(L,{entry:e,children:s.jsx(y,{gap:6,style:{maxHeight:500,overflowY:"auto"},vertical:!0,children:a.map((r,t)=>s.jsx("span",{children:r.text},`${r.id}-${t}`))})})]})}},{title:"TÃ¡ Na Cara",dataIndex:"ta-na-cara",key:"ta-na-cara",render:e=>{if(!e)return s.jsx(S,{message:"No entry",type:"error"});const{number:i,suspectsIds:a,testimonies:r}=e;return s.jsxs(N,{children:[s.jsx(T,{children:i}),s.jsx(C,{label:"Suspects",children:a==null?void 0:a.length}),s.jsx(C,{label:"Questions",children:r.length}),s.jsx(L,{entry:e,children:s.jsxs(y,{vertical:!0,children:[s.jsx(Y,{direction:"vertical",style:{maxHeight:100,overflowY:"auto"},children:r.map(t=>{var n;return s.jsxs(y,{vertical:!0,children:[s.jsx("span",{children:t.question}),s.jsx(y,{children:(n=t.suspectsIds)==null?void 0:n.map(o=>s.jsx(ne,{id:o,width:48},o))})]},t.testimonyId)})}),s.jsx(Y,{style:{maxHeight:200,maxWidth:"500px",overflowY:"auto"},wrap:!0,children:a==null?void 0:a.map(t=>s.jsx(ne,{id:t,width:48},t))})]})})]})}}];function wt(){const[e,i]=x.useState(""),[a,r]=x.useState(!1),{isLoading:t,data:n,dataUpdatedAt:o}=Pe("diario",e,{enabled:!!e&&a}),l=x.useMemo(()=>n?[re(n,["number"])]:[],[n]),c=g=>{r(!1),i(g.trim())},d=()=>{r(G(e,"YYYY-MM-DD",!0).isValid())},h=()=>{const g=G(e).subtract(1,"days").format("YYYY-MM-DD");i(g)},u=()=>{const g=G(e).add(1,"days").format("YYYY-MM-DD");i(g)};return x.useEffect(()=>{!t&&n&&console.log(re(n))},[o]),s.jsxs("div",{children:[s.jsx(P.Title,{level:2,children:"Data Verification"}),s.jsx(y,{align:"center",className:"mb-6",justify:"space-between",children:s.jsxs(y,{align:"center",gap:12,children:[s.jsxs(Y.Compact,{children:[s.jsx(ce,{onChange:g=>c(g.target.value),placeholder:"YYYY-MM-DD"}),s.jsx(V,{onClick:d,type:"primary",children:"Load"})]}),e&&s.jsxs(y,{align:"center",gap:6,children:[s.jsx(V,{icon:s.jsx(Xe,{}),onClick:h}),s.jsx("span",{children:s.jsx($,{children:e})}),s.jsx(V,{disabled:e===ze(),icon:s.jsx(et,{}),onClick:u})]}),s.jsx("span",{children:s.jsx($,{color:t?"blue":a?"green":"red",children:t?"Loading...":a?"Valid":"Invalid"})}),s.jsx(de,{disabled:!n,path:`/diario/${e}`})]})}),s.jsx(Ce,{columns:Se,dataSource:l,loading:t,scroll:{x:"max-content"}}),s.jsx(ke,{}),s.jsxs(y,{align:"center",className:"mb-4",justify:"space-between",wrap:!0,children:[s.jsx(ye,{className:"mb-4",content:JSON.stringify(l[0],null,2),disabled:!n,shape:"default",children:"Copy to Clipboard"}),s.jsx(Ot,{data:n})]}),s.jsx(xe,{src:l[0]??{},theme:"twilight"})]})}const fe=(e,i)=>{if(!e||!i||i.length<2)return[];const a=[],r=i.toLowerCase(),t=(n,o=[])=>{n&&typeof n=="object"&&Object.entries(n).forEach(([l,c])=>{l.toLowerCase().includes(r)&&a.push([...o,l].join(".")),typeof c=="string"&&c.toLowerCase().includes(r)&&a.push([...o,l].join(".")),typeof c=="object"&&c!==null&&t(c,[...o,l])})};return t(e),a};function Ot({data:e}){const[i,a]=x.useState([]),r=o=>{if(n(o),o.trim().length>1){const l=fe(e??{},o.trim());a(l)}else a([])},[t,n]=x.useState("");return x.useEffect(()=>{if(e&&t.trim().length>1){const o=fe(e,t.trim());a(o)}else a([])},[e]),s.jsxs(y,{gap:8,vertical:!0,children:[s.jsx(ce.Search,{allowClear:!0,onChange:o=>r(o.target.value),onSearch:r,placeholder:"Search in data...",style:{width:250}}),i.length>0&&s.jsxs("div",{children:[s.jsxs(P.Text,{children:["Found ",i.length," matches:"]}),s.jsx("ul",{style:{maxHeight:"200px",overflow:"auto",margin:"4px 0"},children:i.map((o,l)=>s.jsx("li",{children:s.jsx(P.Text,{code:!0,copyable:!0,children:o})},l))})]})]})}const Nt=(...e)=>{me.state["aqui-o"]&&console.log(...e)},Tt=e=>{me.state["aqui-o"]&&console.count(e)},Lt=(...e)=>{me.state["aqui-o"]&&console.error(...e)},kt=(e,i,a,r)=>{const[t]=U(I.AQUI_O,r),n=M("items",e),o=M("daily-disc-sets",e);return{entries:x.useMemo(()=>!e||!o.isSuccess||!t||!n.isSuccess?{}:Mt(a,t,o.data,n.data),[e,o.dataUpdatedAt,n.dataUpdatedAt,t,a]),isLoading:n.isLoading||o.isLoading}},Mt=(e,i,a,r)=>{Tt("Creating Aqui Ã“...");const t=m.shuffle(Object.values(a).filter(d=>d.itemsIds.filter(Boolean).length>=20)),n=t.filter(d=>!i.used.includes(d.id));n.length<e&&(Nt("ðŸ”† Not enough aqui-o sets left, shuffling..."),K("aqui-o","Not enough aqui-o sets left"),n.push(...m.shuffle(t)));const o=Object.values(r).filter(d=>d!=null&&d.nsfw?!1:m.intersection(d.decks??[],["alien","dream","thing"]).length>0);let l=i.latestDate;const c={};for(let d=0;d<e;d++){const h=n[d];h||Lt("No aqui-o sets left");const u=q(l),g=W(u);l=u,g?c[u]={id:u,type:"aqui-o",number:i.latestNumber+d+1,setId:"special",title:{pt:"Especial Fim de Semana",en:"Weekend Special"},itemsIds:["0",...m.sampleSize(o,45).map(p=>p.id)]}:c[u]={id:u,type:"aqui-o",number:i.latestNumber+d+1,setId:h.id,title:h.title,itemsIds:["0",...m.sampleSize(h.itemsIds,20)]}}return c},Rt=(e,i,a,r)=>{const[t]=U(I.ARTE_RUIM,r),n=je(e,i);return{entries:x.useMemo(()=>!e||n.isLoading||!t?[]:Gt(a,t,n,i),[e,n.dataUpdatedAt,i,t,a]),isLoading:n.isLoading}},Gt=(e,i,a,r)=>{console.count("Creating Arte Ruim...");const t=Object.values(a.drawings).filter(c=>!(i.used.includes(c.id)||c.drawings.length<3)).map(c=>({id:c.id,type:"arte-ruim",language:r??"pt",cardId:c.id,text:c.text,drawings:c.drawings.map(d=>d.drawing),number:0,dataIds:c.drawings.map(d=>d.id)})),n=m.sampleSize(m.shuffle(t),e);let o=i.latestDate;return n.map((c,d)=>{const h=q(o);return o=h,{...c,id:h,number:i.latestNumber+d+1}})},Ut=(e,i,a,r,t)=>{const[n]=U(I.ARTISTA,r),[o]=U(I.ARTE_RUIM,r),l=M(`arte-ruim-cards-${i}`,e),c=je(e,i);return{entries:x.useMemo(()=>{if(!e||!l.isSuccess||!c.hasResponseData||!n)return{};const h=t.map(u=>u.cardId);return Yt(a,n,o,l.data,h,c.drawings)},[e,l.dataUpdatedAt,o,n,a,t,c.dataUpdatedAt,c.hasResponseData]),isLoading:l.isLoading||c.isLoading}},Yt=(e,i,a,r,t,n)=>{console.count("Creating Artista...");let o=i.latestDate;const l={};for(let c=0;c<e;c++){const d=q(o),h=Object.keys(r??{}).filter(g=>{var p,j;return!a.used.includes(g)&&!t.includes(g)&&((j=(p=n==null?void 0:n[g])==null?void 0:p.drawings)==null?void 0:j.length)<3}),u=m.sampleSize(h,20).map(g=>r[g]);o=d,l[d]={id:d,type:"artista",number:i.latestNumber+c+1,cards:u}}return l},qt=(e,i,a,r)=>{const[t]=U(I.COMUNICACAO_ALIENIGENA,r),n=M("items",e),o=M("items-attributes",e),l=M("items-attribute-values",e);return{entries:x.useMemo(()=>!e||!t||!o.isSuccess||!l.isSuccess||!n.isSuccess?{}:Pt(a,t,o.data,l.data,n.data),[e,a,t,t,o.dataUpdatedAt,l.dataUpdatedAt,n.dataUpdatedAt]),isLoading:n.isLoading||o.isLoading||l.isLoading}},Pt=(e,i,a,r,t)=>{console.count("Creating Comunicacao Alienigena...");let n=i.latestDate;const o=m.values(a),l=m.values(r).filter(u=>{var g;return u.complete&&((g=t==null?void 0:t[u.id])==null?void 0:g.nsfw)!==!0}),c={};let d=0;for(;m.keys(c).length<e+5&&d<Je;){const u=_t(o,l);if(u.valid&&!c[u.setId]&&!i.used.includes(u.setId)&&(c[u.setId]=u),m.keys(c).length>=e)break;d+=1}console.log(`ðŸ”† Generating this batch took ${d} tries`),d>=100&&K("comunicacao-alienigena","Not enough valid comunicacao alienigena games (over 100 attempts)");const h={};return Object.values(c).forEach((u,g)=>{const p=q(n);n=p;let j=m.shuffle(u.itemsIds);W(p)?j=m.shuffle([...j,...m.sampleSize(u.additionalItems,3)].filter(Boolean)):Ze(p)||(j=m.shuffle([...j,...m.sampleSize(u.additionalItems,1)].filter(Boolean))),h[p]={id:p,number:i.latestNumber+g+1,type:"comunicacao-alienigena",setId:u.setId,attributes:u.attributes,requests:u.requests,solution:u.solution,itemsIds:j}}),h},_t=(e,i)=>{const a=m.shuffle(i),r=m.shuffle(_e(50,0)),t=m.sampleSize(e,3).map(f=>({...f,spriteId:`${r.pop()}`})),n=[],o=[],l=[],c=[],d=[],h=[],u=[],g=[];a.forEach(f=>{const D=[_.DETERMINISTIC,_.RELATED],Q=f.attributes[t[0].id]===_.DETERMINISTIC,X=D.includes(f.attributes[t[0].id]),z=f.attributes[t[0].id]===_.UNRELATED,Oe=f.attributes[t[1].id]===_.DETERMINISTIC,ee=D.includes(f.attributes[t[1].id]),J=f.attributes[t[1].id]===_.UNRELATED,Ne=f.attributes[t[2].id]===_.DETERMINISTIC,te=D.includes(f.attributes[t[2].id]),Z=f.attributes[t[2].id]===_.UNRELATED;if(z&&J&&Z)return g.push(f.id);Q&&J&&Z&&n.push(f.id),z&&Oe&&Z&&o.push(f.id),z&&J&&Ne&&l.push(f.id),X&&ee&&Z&&c.push(f.id),X&&J&&te&&d.push(f.id),z&&ee&&te&&h.push(f.id),X&&ee&&te&&u.push(f.id)});const p=t.map(f=>({id:f.id,name:f.name.pt,description:f.description.pt,spriteId:f.spriteId,itemsIds:[]}));p[0].itemsIds=m.sampleSize(n,n.length>3?3:Math.max(n.length-1,1)),p[1].itemsIds=m.sampleSize(o,o.length>3?3:Math.max(n.length-1,1)),p[2].itemsIds=m.sampleSize(l,l.length>3?3:Math.max(n.length-1,1));const j=[];p.forEach(f=>{j.push(...f.itemsIds)});const A=[];c.length>0&&A.push({spritesIds:[t[0].spriteId,t[1].spriteId],itemId:m.sample(c)??""}),d.length>0&&A.push({spritesIds:[t[0].spriteId,t[2].spriteId],itemId:m.sample(d)??""}),h.length>0&&A.push({spritesIds:[t[1].spriteId,t[2].spriteId],itemId:m.sample(h)??""}),u.length>0&&A.push({spritesIds:t.map(f=>f.spriteId),itemId:m.sample(u)??""});const E=[];n.length>0&&E.push({spritesIds:[t[0].spriteId],itemId:n.filter(f=>!j.includes(f))[0]}),o.length>0&&E.push({spritesIds:[t[1].spriteId],itemId:o.filter(f=>!j.includes(f))[0]}),l.length>0&&E.push({spritesIds:[t[2].spriteId],itemId:l.filter(f=>!j.includes(f))[0]});let v=m.sampleSize(A,4);v.length<3&&v.push(...m.sampleSize(E,4-v.length)),v.length<4&&console.log("ðŸ”† Not enough requests for an alien communication, marking it as invalid"),v=m.shuffle(v);const R=v.map(f=>f.itemId),b={setId:p.map(f=>f.id).sort().join("-"),attributes:p,requests:v,solution:R.join("-"),itemsIds:R,additionalItems:g.filter(Boolean),valid:!1};return b.valid=[b.attributes.length===3,b.requests.length===4,b.itemsIds.length===4,b.attributes.every(f=>f.itemsIds.length>0),b.requests.every(f=>f.itemId)].every(Boolean),b},Ft=(e,i,a,r)=>{const[t]=U(I.CONTROLE_DE_ESTOQUE,r);return{entries:x.useMemo(()=>!e||!t?{}:Vt(a,t),[e,a,t]),isLoading:!1}},Vt=(e,i)=>{console.count("Creating Controle de Estoque...");let a=i.latestDate;const r={};for(let t=0;t<e;t++){const n=q(a);a=n,r[n]=Wt(n,i.latestNumber+t+1)}return r},$t=256,Qt=16,Ht=4,Bt=1,Wt=(e,i)=>{const[a,r,t]=e.split("-").map(Number),o=new Date(a,r-1,t).getDay(),l=["Domingo","Segunda-feira","TerÃ§a-feira","Quarta-feira","Quinta-feira","Sexta-feira","SÃ¡bado"][o],c={id:e,number:i,type:"controle-de-estoque",language:"pt",title:l,goods:[],orders:[]},d=m.sampleSize(Array($t).fill("").map((u,g)=>`good-${g+1}`),Qt+Bt),h=d.pop();if(c.goods=d,c.orders=m.sampleSize(c.goods,Ht),!h)throw new Error("No out of stock good");return c.orders.push(h),c.orders=m.shuffle(c.orders),c},Kt=(e,i,a,r)=>{const[t]=U(I.FILMACO,r),n=M("daily-movie-sets",e);return{entries:x.useMemo(()=>!e||!n.isSuccess||!t?{}:(Object.values(n.data).filter(c=>c.itemsIds.length>0&&!t.used.includes(c.id)).length<=a&&K("filmaco","Not enough unused films"),zt(a,t,n.data)),[e,n.dataUpdatedAt,t,a]),isLoading:n.isLoading}},zt=(e,i,a)=>{console.count("Creating FilmaÃ§o...");const r=m.shuffle(Object.values(a).filter(c=>c.itemsIds.filter(Boolean).length>0)),t=m.shuffle(r.filter(c=>!i.used.includes(c.id)));t.length<e&&t.push(...m.shuffle(r));const n=m.shuffle(Object.values(a).filter(c=>c.itemsIds.length>0&&i.used.includes(c.id)));let o=i.latestDate;const l={};for(let c=0;c<e;c++){const d=q(o),h=W(d),u=h?Jt(n):t[c];if(!u){K("filmaco","No filmaÃ§o sets left");break}o=d,l[d]={id:d,type:"filmaco",number:i.latestNumber+c+1,setId:u.id,title:u.title,itemsIds:u.itemsIds,year:u.year},h&&(l[d].isDoubleFeature=!0)}return l},Jt=e=>{var r;let i=[];for(;i.length<2&&e.length>0;){const t=e.pop();t&&m.intersection(t.itemsIds,((r=i==null?void 0:i[0])==null?void 0:r.itemsIds)||[]).length===0&&i.push(t)}return i=m.orderBy(i,t=>t.year,"asc"),{id:`df-${i.map(t=>t.id).join("-")}`,title:`${i.map(t=>t.title).join(" Ã— ")}`,itemsIds:m.shuffle(ve(i.flatMap(t=>t.itemsIds))),year:i.map(t=>t.year).join(" Ã— ")}},Zt=(e,i,a,r)=>{const[t]=U(I.ORGANIKU,r),n=M("items-groups",e);return{entries:x.useMemo(()=>!e||n.isLoading||!t?{}:Xt(a,t,i,n.data),[e,i,t,a,n.dataUpdatedAt]),isLoading:n.isLoading}},Xt=(e,i,a,r)=>{console.count("Creating Organiku...");const t=m.shuffle(Object.values(r).filter(l=>l.itemsIds.length>6&&i.used.includes(l.id)===!1));t.length<e&&K("organiku","Not enough organiku groups left");let n=i.latestDate;const o={};for(let l=0;l<e;l++){const c=q(n);n=c;const d=W(c),h=t[l],u=m.sampleSize(h.itemsIds,d?6:5),g=ts(u),p=es(g,u,1);o[c]={id:c,number:i.latestNumber+l+1,setId:h.id,type:"organiku",title:m.capitalize(h.name[a]),grid:g,defaultRevealedIndexes:p,itemsIds:u}}return o};function es(e,i,a){const r=new Set,t={};e.forEach((n,o)=>{t[n]||(t[n]=[]),t[n].push(o)});for(const n of i){const o=t[n]??[],c=o.length%2===0?2:1,d=m.shuffle(o);for(let h=0;h<c&&h<d.length;h++)r.add(d[h])}for(let n=0;n<a;n++){const o=i[n%i.length],l=(t[o]??[]).filter(d=>!r.has(d)),c=m.shuffle(l);for(let d=0;d<2&&d<c.length;d++)r.add(c[d])}return Array.from(r)}function ts(e){const i=e.length,a=[];a.push(m.shuffle(e));function r(n,o){for(let l=0;l<i;l++)for(let c=0;c<o;c++)if(a[c][l]===n[l])return!1;return!0}function t(n){if(n===i)return!0;const o=Ee(e);for(;o.length>0;){const l=o.splice(Math.floor(Math.random()*o.length),1)[0];if(r(l,n)){if(a.push(l),t(n+1))return!0;a.pop()}}return!1}return t(1),a.flat()}function Ee(e){if(e.length<=1)return[e.slice()];const i=[];for(let a=0;a<e.length;a++){const r=[...e.slice(0,a),...e.slice(a+1)];for(const t of Ee(r))i.push([e[a],...t])}return i}const ss=(e,i,a,r)=>{const[t]=U(I.PALAVREADO,r),n=oe(4,i,e),o=oe(5,i,e);return{entries:x.useMemo(()=>!e||!n.data||!n.data.length||!o.data||!o.data.length||!t?{}:ns(a,t,n.data,o.data),[e,n.dataUpdatedAt,o.dataUpdatedAt,t,a]),isLoading:n.isLoading||o.isLoading}},ns=(e,i,a,r)=>{console.count("Creating Palavreado...");let t=i.latestDate;const n=[],o={};for(let l=0;l<e;l++){const c=q(t),d=W(c),h=d?5:4;t=c,o[c]={id:c,type:"palavreado",number:i.latestNumber+l+1,...as(d?r:a,[...Object.values(o).map(u=>u.keyword),...i.used],n,h)}}return o},as=(e,i,a,r=4,t)=>{let n=m.shuffle(m.difference(e,a,i));const o=t||(n.pop()??""),l=[];for(let c=0;c<r;c++){const d=is(e,o,l,c);l.push(d)}return a.push(o,...l),{keyword:o,words:l,letters:rs(l,o.length)}},is=(e,i,a,r)=>{const t=m.uniq([...m.flatMap(a.map(l=>l.split(""))),...i.split("")]),n=m.shuffle(e.filter(l=>l[r]===i[r]&&!a.includes(l)));return m.sortBy(n,l=>m.intersection(l.split(""),t).length)[0]},rs=(e,i)=>{const a=m.flatMap(e.map(o=>o.split(""))),r=i===4?[0,5,10,15]:[0,6,12,18,24],t=m.shuffle(a.filter((o,l)=>!r.includes(l))),n=[];for(let o=0;o<a.length;o++)r.includes(o)?n.push(a[o]):n.push(t.shift()??"");return n},os=(e,i,a,r)=>{const[t]=U(I.PORTAIS_MAGICOS,r),n=M("daily-passcode-sets",e),o=oe(3,i,e);return{entries:x.useMemo(()=>{if(!e||!n.isSuccess||!o.isSuccess||!t)return{};const c=o.data.reduce((d,h)=>(h.split("").forEach(u=>{d[u]||(d[u]=[]),d[u].push(h)}),d),{" ":["  "],"-":[" - "]});return ls(a,t,n.data,c)},[e,a,n.dataUpdatedAt,o.isSuccess,o.dataUpdatedAt,t]),isLoading:n.isLoading||o.isLoading}},ls=(e,i,a,r)=>{console.count("Creating Portais MÃ¡gicos...");let t=i.latestDate;const n=i.used,o={};let l=m.shuffle(Object.values(a).filter(d=>d.imageCardsIds.length>0));const c={};for(let d=0;d<e;d++){const h=q(t),u=[];let g=[...l];const p=[];for(;p.length<3;){const j=g.pop();if(!j)throw new Error("Not enough sets available");const A=m.sample(j.passcode.filter(b=>b.length<=12&&!n.includes(b)))||"";if(!A)continue;const E=p.length+1;u.push(j.id),o[j.id]=!0;const v=A.split("").map(b=>m.sample(r[b])||` ${b} `),R=m.sampleSize(j.imageCardsIds,E);p.push({passcode:A,imagesIds:R,words:v,goal:cs(A,v)}),g=g.filter(b=>!o[b.id]&&b.imageCardsIds.length>E)}t=h,c[h]={id:h,type:"portais-magicos",setId:u.join(ue),number:i.latestNumber+d+1,corridors:p.reverse(),goal:p.reduce((j,A)=>j+A.goal,0)},l=l.filter(j=>!o[j.id])}return c};function cs(e,i){if(e.length!==i.length)throw new Error("Secret word length must match the number of 3-letter words");let a=0;for(let r=0;r<e.length;r++){const t=e[r].toUpperCase(),n=i[r].toUpperCase();let o=-1;for(let c=0;c<3;c++)if(n[c]===t){o=c;break}if(o===-1)throw new Error(`Target letter '${t}' not found in word '${n}' at position ${r}`);let l=0;o===0?l=2:o===1?l=0:o===2&&(l=1),a+=l}return a}const ds=(e,i,a,r)=>{const[t]=U(I.TA_NA_CARA,r),n=M("suspects",e),o=M(`testimony-questions-${i}`,e),l=M("testimony-answers",e);return{entries:x.useMemo(()=>{if(!e||!n.isSuccess||!o.isSuccess||!t||!l.isSuccess)return{};const d=gs(o.data,l.data,n.data),h=Object.keys(n.data).map(u=>be(u,"gb"));return ms(a,t,h,o.data,d)},[e,n.dataUpdatedAt,o.dataUpdatedAt,l.dataUpdatedAt,t,a]),isLoading:n.isLoading||o.isLoading}},us=15,we=7,ms=(e,i,a,r,t)=>{console.count("Creating TÃ¡ Na Cara...");let n=0,o=i.latestDate;const l={};for(let c=0;c<e;c++){const d=q(o);o=d;const h=[];for(let p=0;p<us;p++){n>=t.length&&(n=0);const j=t[n];h.push(hs(j,r[j.testimonyId])),n+=1}const u=Fe(h.flatMap(p=>p.suspectsIds||[]),!0),g=m.shuffle(a.filter(p=>!u[p])).slice(0,we);l[d]={id:d,type:"ta-na-cara",number:i.latestNumber+c+1,suspectsIds:g,testimonies:h}}return l},hs=(e,i)=>{const a=[...m.shuffle(e.counts[3]),...m.shuffle(e.counts[2]),...e.counts[1],...e.counts[0],...e.counts[5]].slice(0,we).map(r=>be(r,"gb"));return{testimonyId:i.id,question:i.question,nsfw:!!i.nsfw,suspectsIds:a}},ps=e=>e.reduce((i,a)=>{const r=a.split(ue),t=r[0],n=Number(r[1]);if(t.startsWith("us")){const o=t.split("-"),l=`${o[0]}-${o[2]}`;return l.includes("undefined")||(i[l]=n||0),i}return i[t]=n||0,i},{}),fs=(e,i)=>{const a=ps(e);return i.forEach(r=>{var t;r.testimonies.forEach(n=>{a[n.testimonyId]===void 0&&(a[n.testimonyId]=0),a[n.testimonyId]+=1}),(t=r.suspectsIds)==null||t.forEach(n=>{const o=n.split("-"),l=`${o[0]}-${o[2]}`;a[l]===void 0&&(a[l]=0),a[l]+=1})}),Object.entries(a).map(([r,t])=>`${r}${ue}${t}`)},gs=(e,i,a)=>{const r={};return Object.keys(e).forEach(n=>{r[n]===void 0&&(r[n]={0:[],1:[],2:[],3:[],4:[],5:[]});const o=i[n]||{};Object.keys(a).forEach(l=>{const c=o[l]||[],d=it(c);d>=5?r[n][5].push(l):r[n][d].push(l)})}),m.orderBy(Object.keys(r).map(n=>({testimonyId:n,counts:r[n]})),[n=>n.counts[3].length,n=>n.counts[2].length,n=>n.counts[1].length,n=>n.counts[0].length],["desc"])};function xs(e,i,a){const r=De.DAILY[i??"pt"],t=Ae(r,{enabled:e});x.useEffect(()=>{st()},[a,i]);const n=e&&t.isSuccess,o=M("items",n),l=kt(n,i,a,t.data??{}),c=Rt(n,i,a,t.data??{}),d=qt(n,i,a,t.data??{}),h=Ft(n,i,a,t.data??{}),u=Kt(n,i,a,t.data??{}),g=ss(n,i,a,t.data??{}),p=nt(n,i,a,t.data??{}),j=lt(n,i,a,t.data??{}),A=os(n,i,a,t.data??{}),E=Zt(n,i,a,t.data??{}),v=rt(n,i,a,t.data??{}),R=Ut(n,i,a,t.data??{},c.entries),b=ds(n,i,a,t.data??{}),f=x.useMemo(()=>c.entries.length===0?[]:(console.count("Bundling entries..."),c.entries.map(D=>{const Q={id:D.id,"arte-ruim":D,"aqui-o":l.entries[D.id],"comunicacao-alienigena":d.entries[D.id],"controle-de-estoque":h.entries[D.id],espionagem:v.entries[D.id],filmaco:u.entries[D.id],organiku:E.entries[D.id],palavreado:g.entries[D.id],"portais-magicos":A.entries[D.id],quartetos:p.entries[D.id],"teoria-de-conjuntos":j.entries[D.id],artista:R.entries[D.id],"ta-na-cara":b.entries[D.id],dictionary:{}};return Q.dictionary=js(Q,o.data),Q})),[c.entries,l.entries,d.entries,h.entries,u.entries,E.entries,g.entries,A.entries,p.entries,j.entries,R.entries,b.entries,v.entries,o.data]);return{isLoading:t.isLoading||l.isLoading||c.isLoading||d.isLoading||h.isLoading||u.isLoading||g.isLoading||A.isLoading||p.isLoading||j.isLoading||R.isLoading||b.isLoading||v.isLoading||E.isLoading||o.isLoading,entries:f}}const js=(e,i)=>{const a={};return e["aqui-o"].itemsIds.forEach(r=>{const t=i[r];t&&(a[r]=t.name.pt)}),e["comunicacao-alienigena"].itemsIds.forEach(r=>{const t=i[r];t&&(a[r]=t.name.pt)}),e["comunicacao-alienigena"].attributes.forEach(r=>{r.itemsIds.forEach(t=>{const n=i[t];n&&(a[t]=n.name.pt)})}),e.filmaco.itemsIds.forEach(r=>{const t=i[r];t&&(a[r]=t.name.pt)}),e.quartetos.grid.forEach(r=>{const t=i[r];t&&(a[r]=t.name.pt)}),e.organiku.itemsIds.forEach(r=>{const t=i[r];t&&(a[r]=t.name.pt)}),a};function Is(e){const{notification:i}=Me.useApp(),a=Re(),r=De.DAILY[e??"pt"],[t,n]=x.useState(!1),o=Ae(r,{enabled:!!r}),l=Ie({mutationFn:async c=>{const d=c.map(p=>{const j=ae(ie,`${r}/${p.id}`);return he(j,p)}),h=ae(ie,`${r}/history`),u=o.data;if(!u)throw new Error("No previous history");const g={...u,[I.AQUI_O]:k(I.AQUI_O,u,c,p=>p.setId),[I.ARTE_RUIM]:k(I.ARTE_RUIM,u,c,p=>p.cardId),[I.ARTISTA]:k(I.ARTISTA,u,c,null),[I.COMUNICACAO_ALIENIGENA]:k(I.COMUNICACAO_ALIENIGENA,u,c,p=>p.setId),[I.CONTROLE_DE_ESTOQUE]:k(I.CONTROLE_DE_ESTOQUE,u,c,null),[I.FILMACO]:k(I.FILMACO,u,c,p=>p.setId),[I.PALAVREADO]:k(I.PALAVREADO,u,c,p=>p.keyword),[I.PORTAIS_MAGICOS]:k(I.PORTAIS_MAGICOS,u,c,p=>p.corridors.map(j=>j.passcode)),[I.TA_NA_CARA]:k(I.TA_NA_CARA,u,c,null,fs),[I.QUARTETOS]:k(I.QUARTETOS,u,c,p=>p.sets.map(j=>j.id)),[I.TEORIA_DE_CONJUNTOS]:k(I.TEORIA_DE_CONJUNTOS,u,c,p=>[p.intersectingThing.id,p.setId]),[I.ORGANIKU]:k(I.ORGANIKU,u,c,p=>p.setId),[I.ESPIONAGEM]:k(I.ESPIONAGEM,u,c,p=>p.culpritId)};return he(h,g),Promise.all(d)},onSuccess:()=>{i.info({message:"Data saved",placement:"bottomLeft"}),a.invalidateQueries({queryKey:[r,"history"]}),n(!1)},onError:()=>{i.error({message:"Error saving data",placement:"bottomLeft"})}});return{isDirty:t,setIsDirty:n,save:l.mutateAsync,isPending:l.isPending}}const k=(e,i,a,r,t)=>{var o;const n=JSON.parse(((o=i[e])==null?void 0:o.used)??"[]");return t?{latestDate:a[a.length-1].id,latestNumber:a[a.length-1][e].number,used:JSON.stringify(t(n,a.map(l=>l[e])))}:r===null?{latestDate:a[a.length-1].id,latestNumber:a[a.length-1][e].number,used:"[]"}:{latestDate:a[a.length-1].id,latestNumber:a[a.length-1][e].number,used:JSON.stringify(ve([...n,...a.map(l=>l[e]).map(r)]).flat())}},vs="pt";function ys(){const[e,i]=x.useState(""),[a,r]=x.useState(3),[t,n]=x.useState(7),[o,l]=x.useState(Date.now());return s.jsxs("div",{children:[s.jsx(P.Title,{level:2,children:"Data Population"}),s.jsxs(y,{gap:12,children:[s.jsx(se,{label:"Language",onChange:i,options:[vs],placeholder:"Select a language",value:e}),s.jsx(se,{label:"Minimum Drawings",onChange:r,options:[2,3,4],placeholder:"Select a number",value:a}),s.jsx(se,{label:"Batch Size",onChange:n,options:[3,7,14,21,28],placeholder:"Select a number",value:t}),s.jsx(V,{icon:s.jsx(ft,{}),onClick:()=>{l(Date.now())}}),s.jsx(de,{className:"ml-2",path:"diario/history"})]}),s.jsx(bs,{batchSize:t,language:e},o)]})}function bs({language:e,batchSize:i}){const a=e,r=xs(!!a,a,i),t=at();x.useEffect(()=>{m.isEmpty(t)||console.log(t)},[t]);const{save:n,isPending:o}=Is(a??"pt");return s.jsxs(tt,{error:null,hasResponseData:!r.isLoading,isLoading:r.isLoading,children:[s.jsxs(y,{align:"center",justify:"space-between",children:[s.jsxs(P.Title,{level:4,children:["Total: ",r.entries.length]}),s.jsx(V,{disabled:(r.entries??[]).length===0,icon:s.jsx(ct,{}),loading:o,onClick:()=>n(r.entries),size:"large",type:"primary",children:"Save"})]}),Object.values(t).map(l=>s.jsx(S,{banner:!0,message:l,showIcon:!0,type:"warning"},l)),s.jsx(Ce,{columns:Se,dataSource:r.entries??[],scroll:{x:"max-content"}})]})}function Ds(){const{queryParams:e}=ge();return e.get("display")==="archive"?s.jsx(At,{}):e.get("display")==="check"?s.jsx(wt,{}):s.jsx(ys,{})}function Cs(){const{queryParams:e,addParams:i}=ge();return s.jsxs(s.Fragment,{children:[s.jsx(le,{children:s.jsx($e,{label:"Display",onChange:a=>i({display:a}),options:[{title:"Population",icon:s.jsx(jt,{}),value:"population"},{title:"Check",icon:s.jsx(mt,{}),value:"check"},{title:"Archive",icon:s.jsx(yt,{}),value:"archive"}],value:e.get("display")??"population"})}),s.jsx(le,{children:s.jsx(de,{label:"History",path:"/diario/history"})}),s.jsx(As,{})]})}function As(){const e=ot();return s.jsxs(le,{children:[s.jsx(P.Title,{level:5,children:"Debuggers"}),s.jsx("div",{children:s.jsx(O,{checked:e["aqui-o"],disabled:!0,onChange:()=>w("aqui-o"),children:"Aqui o"})}),s.jsx("div",{children:s.jsx(O,{checked:e["arte-ruim"],disabled:!0,onChange:()=>w("arte-ruim"),children:"Arte Ruim"})}),s.jsx("div",{children:s.jsx(O,{checked:e.artista,disabled:!0,onChange:()=>w("artista"),children:"Artista"})}),s.jsx("div",{children:s.jsx(O,{checked:e["comunicacao-alienigena"],disabled:!0,onChange:()=>w("comunicacao-alienigena"),children:"Com. AlienÃ­gena"})}),s.jsx("div",{children:s.jsx(O,{checked:e["controle-de-estoque"],disabled:!0,onChange:()=>w("controle-de-estoque"),children:"Controle de Estoque"})}),s.jsx("div",{children:s.jsx(O,{checked:e.espionagem,disabled:!0,onChange:()=>w("espionagem"),children:"Espionagem"})}),s.jsx("div",{children:s.jsx(O,{checked:e.filmaco,disabled:!0,onChange:()=>w("filmaco"),children:"Filmaco"})}),s.jsx("div",{children:s.jsx(O,{checked:e.organiku,disabled:!0,onChange:()=>w("organiku"),children:"Organiku"})}),s.jsx("div",{children:s.jsx(O,{checked:e.palavreado,disabled:!0,onChange:()=>w("palavreado"),children:"Palavreado"})}),s.jsx("div",{children:s.jsx(O,{checked:e["portais-magicos"],disabled:!0,onChange:()=>w("portais-magicos"),children:"Portais MÃ¡gicos"})}),s.jsx("div",{children:s.jsx(O,{checked:e.quartetos,disabled:!0,onChange:()=>w("quartetos"),children:"Quartetos"})}),s.jsx("div",{children:s.jsx(O,{checked:e["ta-na-cara"],disabled:!0,onChange:()=>w("ta-na-cara"),children:"TÃ¡ na Cara"})}),s.jsx("div",{children:s.jsx(O,{checked:e["teoria-de-conjuntos"],disabled:!0,onChange:()=>w("teoria-de-conjuntos"),children:"Teoria de Conjuntos"})})]})}function jn(){return s.jsx(Ge,{title:"Daily Setup",children:s.jsxs(pe,{hasSider:!0,children:[s.jsx(Ke,{children:s.jsx(Cs,{})}),s.jsx(pe.Content,{className:"content",children:s.jsx(Ds,{})})]})})}export{jn as default};
