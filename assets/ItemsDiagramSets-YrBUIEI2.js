import{r as v,a4 as Q,R as A,a9 as X,aa as B,a6 as Oe,a7 as K,a8 as Re,aq as qe,a5 as He,ac as Je,C as Qe,f as de,i as Xe,m as Ye,k as F,ar as Ze,n as et,as as tt,at as nt,o as at,p as rt,am as st,h as ye,au as ot,av as lt,A as be,j as n,D as W,T as P,B as Y,O as he,$ as it,E as dt,P as ct,L as je}from"./index-B-0Zi9dv.js";import{D as De}from"./DataLoadingWrapper-CknT-EYG.js";import{F as ut}from"./FilterEntries-C8wRYMK6.js";import{S as mt}from"./SiderContent-D--PIAJF.js";import{D as ft}from"./DownloadButton-DvBQCSj9.js";import{S as pt}from"./SaveButton-CtQZ611A.js";import{u as ge}from"./useQueryParams-DKlNNCrc.js";import{u as ce}from"./useTDResource-DQ2O15Oh.js";import{l as Z,c as oe,P as ht}from"./useBaseUrl-C1hK2Zof.js";import{a as gt,w as ue}from"./index-BGu6COLF.js";import{v as G,s as Fe,a as Ce,b as Se,S as _e,c as Ie}from"./daily-teoria-de-conjuntos-BfZ1O6VN.js";import{F as ee}from"./index-BCV-x-Pg.js";import{R as xt}from"./ClusterOutlined-DF694QVb.js";import{R as vt}from"./TableOutlined-CmInIy1K.js";import{R as yt}from"./RobotOutlined-C0rG5Ynr.js";import{I as Ve}from"./Item-BrOHfA5m.js";import{F as M}from"./index-CzNgOZrN.js";import{M as bt}from"./index-CAm8fRhL.js";import{I as te}from"./index-CDZWjACv.js";import{R as q}from"./index-Do6yvp-e.js";import{A as jt}from"./index-BeVSZUHT.js";import{S as me}from"./index-B6_6TWFK.js";import{T as H}from"./TransparentButton-f7p_w2hT.js";import{S as R}from"./index-VZg0lInF.js";import{R as Le}from"./index-B1-Yd1J5.js";import{u as ze}from"./useTablePagination-BBFbRQYv.js";import{T as L}from"./index-BC5DJJD_.js";import{F as Be}from"./Table-CWuFiCEn.js";import{u as Ct}from"./useResourceFirestoreData-BtYnk2q8.js";import"./index-cWv_beRK.js";import"./index-CU3voUOl.js";import"./moment-C5S46NFB.js";import"./SaveOutlined-C47doOKl.js";import"./constants-CFIVBgkP.js";import"./useParsedHistory-CSllp-Q9.js";import"./gapSize-U1swVQyS.js";import"./Input-Bmf2F6YG.js";import"./throttleByAnimationFrame-CJEP8Tv6.js";import"./index-357w2Ebe.js";import"./scrollTo-DDzNabTo.js";import"./Pagination-hwClhzsN.js";import"./extendsObject-keMuGWqj.js";import"./useGetFirestoreDoc-DgsZKSwj.js";import"./useUpdateFirestoreDoc-CZEW8j-C.js";import"./useMutation-C7eUXYBb.js";function $e(e){var t=v.useRef();t.current=e;var r=v.useCallback(function(){for(var a,o=arguments.length,u=new Array(o),m=0;m<o;m++)u[m]=arguments[m];return(a=t.current)===null||a===void 0?void 0:a.call.apply(a,[t].concat(u))},[]);return r}function St(){return!!(typeof window<"u"&&window.document&&window.document.createElement)}var we=St()?v.useLayoutEffect:v.useEffect,It=function(t,r){var a=v.useRef(!0);we(function(){return t(a.current)},r),we(function(){return a.current=!1,function(){a.current=!0}},[])},Te=function(t,r){It(function(a){if(!a)return t()},r)};function Pe(e){var t=v.useRef(!1),r=v.useState(e),a=Q(r,2),o=a[0],u=a[1];v.useEffect(function(){return t.current=!1,function(){t.current=!0}},[]);function m(d,f){f&&t.current||u(d)}return[o,m]}function le(e){return e!==void 0}function $t(e,t){var r=t||{},a=r.defaultValue,o=r.value,u=r.onChange,m=r.postState,d=Pe(function(){return le(o)?o:le(a)?typeof a=="function"?a():a:typeof e=="function"?e():e}),f=Q(d,2),p=f[0],j=f[1],s=o!==void 0?o:p,g=m?m(s):s,i=$e(u),l=Pe([s]),x=Q(l,2),b=x[0],$=x[1];Te(function(){var y=b[0];p!==y&&i(p,y)},[b]),Te(function(){le(o)||j(o)},[o]);var C=$e(function(y,I){j(y,I),$([s],I)});return[g,C]}var fe={},wt=function(t){};function Tt(e,t){}function Pt(e,t){}function Nt(){fe={}}function Ke(e,t,r){!t&&!fe[r]&&(e(!1,r),fe[r]=!0)}function ae(e,t){Ke(Tt,e,t)}function At(e,t){Ke(Pt,e,t)}ae.preMessage=wt;ae.resetWarned=Nt;ae.noteOnce=At;var ie={exports:{}},w={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ne;function kt(){if(Ne)return w;Ne=1;var e=typeof Symbol=="function"&&Symbol.for,t=e?Symbol.for("react.element"):60103,r=e?Symbol.for("react.portal"):60106,a=e?Symbol.for("react.fragment"):60107,o=e?Symbol.for("react.strict_mode"):60108,u=e?Symbol.for("react.profiler"):60114,m=e?Symbol.for("react.provider"):60109,d=e?Symbol.for("react.context"):60110,f=e?Symbol.for("react.async_mode"):60111,p=e?Symbol.for("react.concurrent_mode"):60111,j=e?Symbol.for("react.forward_ref"):60112,s=e?Symbol.for("react.suspense"):60113,g=e?Symbol.for("react.suspense_list"):60120,i=e?Symbol.for("react.memo"):60115,l=e?Symbol.for("react.lazy"):60116,x=e?Symbol.for("react.block"):60121,b=e?Symbol.for("react.fundamental"):60117,$=e?Symbol.for("react.responder"):60118,C=e?Symbol.for("react.scope"):60119;function y(c){if(typeof c=="object"&&c!==null){var T=c.$$typeof;switch(T){case t:switch(c=c.type,c){case f:case p:case a:case u:case o:case s:return c;default:switch(c=c&&c.$$typeof,c){case d:case j:case l:case i:case m:return c;default:return T}}case r:return T}}}function I(c){return y(c)===p}return w.AsyncMode=f,w.ConcurrentMode=p,w.ContextConsumer=d,w.ContextProvider=m,w.Element=t,w.ForwardRef=j,w.Fragment=a,w.Lazy=l,w.Memo=i,w.Portal=r,w.Profiler=u,w.StrictMode=o,w.Suspense=s,w.isAsyncMode=function(c){return I(c)||y(c)===f},w.isConcurrentMode=I,w.isContextConsumer=function(c){return y(c)===d},w.isContextProvider=function(c){return y(c)===m},w.isElement=function(c){return typeof c=="object"&&c!==null&&c.$$typeof===t},w.isForwardRef=function(c){return y(c)===j},w.isFragment=function(c){return y(c)===a},w.isLazy=function(c){return y(c)===l},w.isMemo=function(c){return y(c)===i},w.isPortal=function(c){return y(c)===r},w.isProfiler=function(c){return y(c)===u},w.isStrictMode=function(c){return y(c)===o},w.isSuspense=function(c){return y(c)===s},w.isValidElementType=function(c){return typeof c=="string"||typeof c=="function"||c===a||c===p||c===u||c===o||c===s||c===g||typeof c=="object"&&c!==null&&(c.$$typeof===l||c.$$typeof===i||c.$$typeof===m||c.$$typeof===d||c.$$typeof===j||c.$$typeof===b||c.$$typeof===$||c.$$typeof===C||c.$$typeof===x)},w.typeOf=y,w}var Ae;function Et(){return Ae||(Ae=1,ie.exports=kt()),ie.exports}var Mt=Et();function pe(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=[];return A.Children.forEach(e,function(a){a==null&&!t.keepEmpty||(Array.isArray(a)?r=r.concat(pe(a)):Mt.isFragment(a)&&a.props?r=r.concat(pe(a.props.children,t)):r.push(a))}),r}var ke={ENTER:13},We=A.forwardRef(function(e,t){var r=e.prefixCls,a=e.forceRender,o=e.className,u=e.style,m=e.children,d=e.isActive,f=e.role,p=e.classNames,j=e.styles,s=A.useState(d||a),g=Q(s,2),i=g[0],l=g[1];return A.useEffect(function(){(a||d)&&l(!0)},[a,d]),i?A.createElement("div",{ref:t,className:X("".concat(r,"-content"),B(B({},"".concat(r,"-content-active"),d),"".concat(r,"-content-inactive"),!d),o),style:u,role:f},A.createElement("div",{className:X("".concat(r,"-content-box"),p==null?void 0:p.body),style:j==null?void 0:j.body},m)):null});We.displayName="PanelContent";var Ot=["showArrow","headerClass","isActive","onItemClick","forceRender","className","classNames","styles","prefixCls","collapsible","accordion","panelKey","extra","header","expandIcon","openMotion","destroyInactivePanel","children"],Ge=A.forwardRef(function(e,t){var r=e.showArrow,a=r===void 0?!0:r,o=e.headerClass,u=e.isActive,m=e.onItemClick,d=e.forceRender,f=e.className,p=e.classNames,j=p===void 0?{}:p,s=e.styles,g=s===void 0?{}:s,i=e.prefixCls,l=e.collapsible,x=e.accordion,b=e.panelKey,$=e.extra,C=e.header,y=e.expandIcon,I=e.openMotion,c=e.destroyInactivePanel,T=e.children,E=Oe(e,Ot),N=l==="disabled",h=$!=null&&typeof $!="boolean",S=B(B(B({onClick:function(){m==null||m(b)},onKeyDown:function(_){(_.key==="Enter"||_.keyCode===ke.ENTER||_.which===ke.ENTER)&&(m==null||m(b))},role:x?"tab":"button"},"aria-expanded",u),"aria-disabled",N),"tabIndex",N?-1:0),k=typeof y=="function"?y(e):A.createElement("i",{className:"arrow"}),U=k&&A.createElement("div",K({className:"".concat(i,"-expand-icon")},["header","icon"].includes(l)?S:{}),k),O=X("".concat(i,"-item"),B(B({},"".concat(i,"-item-active"),u),"".concat(i,"-item-disabled"),N),f),D=X(o,"".concat(i,"-header"),B({},"".concat(i,"-collapsible-").concat(l),!!l),j.header),V=Re({className:D,style:g.header},["header","icon"].includes(l)?{}:S);return A.createElement("div",K({},E,{ref:t,className:O}),A.createElement("div",V,a&&U,A.createElement("span",K({className:"".concat(i,"-header-text")},l==="header"?S:{}),C),h&&A.createElement("div",{className:"".concat(i,"-extra")},$)),A.createElement(qe,K({visible:u,leavedClassName:"".concat(i,"-content-hidden")},I,{forceRender:d,removeOnLeave:c}),function(z,_){var re=z.className,se=z.style;return A.createElement(We,{ref:_,prefixCls:i,className:re,classNames:j,style:se,styles:g,isActive:u,forceRender:d,role:x?"tabpanel":void 0},T)}))}),Rt=["children","label","key","collapsible","onItemClick","destroyInactivePanel"],Dt=function(t,r){var a=r.prefixCls,o=r.accordion,u=r.collapsible,m=r.destroyInactivePanel,d=r.onItemClick,f=r.activeKey,p=r.openMotion,j=r.expandIcon;return t.map(function(s,g){var i=s.children,l=s.label,x=s.key,b=s.collapsible,$=s.onItemClick,C=s.destroyInactivePanel,y=Oe(s,Rt),I=String(x??g),c=b??u,T=C??m,E=function(S){c!=="disabled"&&(d(S),$==null||$(S))},N=!1;return o?N=f[0]===I:N=f.indexOf(I)>-1,A.createElement(Ge,K({},y,{prefixCls:a,key:I,panelKey:I,isActive:N,accordion:o,openMotion:p,expandIcon:j,header:l,collapsible:c,onItemClick:E,destroyInactivePanel:T}),i)})},Ft=function(t,r,a){if(!t)return null;var o=a.prefixCls,u=a.accordion,m=a.collapsible,d=a.destroyInactivePanel,f=a.onItemClick,p=a.activeKey,j=a.openMotion,s=a.expandIcon,g=t.key||String(r),i=t.props,l=i.header,x=i.headerClass,b=i.destroyInactivePanel,$=i.collapsible,C=i.onItemClick,y=!1;u?y=p[0]===g:y=p.indexOf(g)>-1;var I=$??m,c=function(N){I!=="disabled"&&(f(N),C==null||C(N))},T={key:g,panelKey:g,header:l,headerClass:x,isActive:y,prefixCls:o,destroyInactivePanel:b??d,openMotion:j,accordion:u,children:t.props.children,onItemClick:c,expandIcon:s,collapsible:I};return typeof t.type=="string"?t:(Object.keys(T).forEach(function(E){typeof T[E]>"u"&&delete T[E]}),A.cloneElement(t,T))};function _t(e,t,r){return Array.isArray(e)?Dt(e,r):pe(t).map(function(a,o){return Ft(a,o,r)})}var Vt=`accept acceptCharset accessKey action allowFullScreen allowTransparency
    alt async autoComplete autoFocus autoPlay capture cellPadding cellSpacing challenge
    charSet checked classID className colSpan cols content contentEditable contextMenu
    controls coords crossOrigin data dateTime default defer dir disabled download draggable
    encType form formAction formEncType formMethod formNoValidate formTarget frameBorder
    headers height hidden high href hrefLang htmlFor httpEquiv icon id inputMode integrity
    is keyParams keyType kind label lang list loop low manifest marginHeight marginWidth max maxLength media
    mediaGroup method min minLength multiple muted name noValidate nonce open
    optimum pattern placeholder poster preload radioGroup readOnly rel required
    reversed role rowSpan rows sandbox scope scoped scrolling seamless selected
    shape size sizes span spellCheck src srcDoc srcLang srcSet start step style
    summary tabIndex target title type useMap value width wmode wrap`,Lt=`onCopy onCut onPaste onCompositionEnd onCompositionStart onCompositionUpdate onKeyDown
    onKeyPress onKeyUp onFocus onBlur onChange onInput onSubmit onClick onContextMenu onDoubleClick
    onDrag onDragEnd onDragEnter onDragExit onDragLeave onDragOver onDragStart onDrop onMouseDown
    onMouseEnter onMouseLeave onMouseMove onMouseOut onMouseOver onMouseUp onSelect onTouchCancel
    onTouchEnd onTouchMove onTouchStart onScroll onWheel onAbort onCanPlay onCanPlayThrough
    onDurationChange onEmptied onEncrypted onEnded onError onLoadedData onLoadedMetadata
    onLoadStart onPause onPlay onPlaying onProgress onRateChange onSeeked onSeeking onStalled onSuspend onTimeUpdate onVolumeChange onWaiting onLoad onError`,zt="".concat(Vt," ").concat(Lt).split(/[\s\n]+/),Bt="aria-",Kt="data-";function Ee(e,t){return e.indexOf(t)===0}function Wt(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r;t===!1?r={aria:!0,data:!0,attr:!0}:t===!0?r={aria:!0}:r=Re({},t);var a={};return Object.keys(e).forEach(function(o){(r.aria&&(o==="role"||Ee(o,Bt))||r.data&&Ee(o,Kt)||r.attr&&zt.includes(o))&&(a[o]=e[o])}),a}function Gt(e){var t=e;if(!Array.isArray(t)){var r=He(t);t=r==="number"||r==="string"?[t]:[]}return t.map(function(a){return String(a)})}var Ut=A.forwardRef(function(e,t){var r=e.prefixCls,a=r===void 0?"rc-collapse":r,o=e.destroyInactivePanel,u=o===void 0?!1:o,m=e.style,d=e.accordion,f=e.className,p=e.children,j=e.collapsible,s=e.openMotion,g=e.expandIcon,i=e.activeKey,l=e.defaultActiveKey,x=e.onChange,b=e.items,$=X(a,f),C=$t([],{value:i,onChange:function(h){return x==null?void 0:x(h)},defaultValue:l,postState:Gt}),y=Q(C,2),I=y[0],c=y[1],T=function(h){return c(function(){if(d)return I[0]===h?[]:[h];var S=I.indexOf(h),k=S>-1;return k?I.filter(function(U){return U!==h}):[].concat(Je(I),[h])})};ae(!p,"[rc-collapse] `children` will be removed in next major version. Please use `items` instead.");var E=_t(b,p,{prefixCls:a,accordion:d,openMotion:s,expandIcon:g,collapsible:j,destroyInactivePanel:u,onItemClick:T,activeKey:I});return A.createElement("div",K({ref:t,className:$,style:m,role:d?"tablist":void 0},Wt(e,{aria:!0,data:!0})),E)});const xe=Object.assign(Ut,{Panel:Ge});xe.Panel;const qt=v.forwardRef((e,t)=>{const{getPrefixCls:r}=v.useContext(Qe),{prefixCls:a,className:o,showArrow:u=!0}=e,m=r("collapse",a),d=de({[`${m}-no-arrow`]:!u},o);return v.createElement(xe.Panel,Object.assign({ref:t},e,{prefixCls:m,className:d}))}),Ht=e=>{const{componentCls:t,contentBg:r,padding:a,headerBg:o,headerPadding:u,collapseHeaderPaddingSM:m,collapseHeaderPaddingLG:d,collapsePanelBorderRadius:f,lineWidth:p,lineType:j,colorBorder:s,colorText:g,colorTextHeading:i,colorTextDisabled:l,fontSizeLG:x,lineHeight:b,lineHeightLG:$,marginSM:C,paddingSM:y,paddingLG:I,paddingXS:c,motionDurationSlow:T,fontSizeIcon:E,contentPadding:N,fontHeight:h,fontHeightLG:S}=e,k=`${F(p)} ${j} ${s}`;return{[t]:Object.assign(Object.assign({},et(e)),{backgroundColor:o,border:k,borderRadius:f,"&-rtl":{direction:"rtl"},[`& > ${t}-item`]:{borderBottom:k,"&:first-child":{[`
            &,
            & > ${t}-header`]:{borderRadius:`${F(f)} ${F(f)} 0 0`}},"&:last-child":{[`
            &,
            & > ${t}-header`]:{borderRadius:`0 0 ${F(f)} ${F(f)}`}},[`> ${t}-header`]:Object.assign(Object.assign({position:"relative",display:"flex",flexWrap:"nowrap",alignItems:"flex-start",padding:u,color:i,lineHeight:b,cursor:"pointer",transition:`all ${T}, visibility 0s`},tt(e)),{[`> ${t}-header-text`]:{flex:"auto"},[`${t}-expand-icon`]:{height:h,display:"flex",alignItems:"center",paddingInlineEnd:C},[`${t}-arrow`]:Object.assign(Object.assign({},nt()),{fontSize:E,transition:`transform ${T}`,svg:{transition:`transform ${T}`}}),[`${t}-header-text`]:{marginInlineEnd:"auto"}}),[`${t}-collapsible-header`]:{cursor:"default",[`${t}-header-text`]:{flex:"none",cursor:"pointer"}},[`${t}-collapsible-icon`]:{cursor:"unset",[`${t}-expand-icon`]:{cursor:"pointer"}}},[`${t}-content`]:{color:g,backgroundColor:r,borderTop:k,[`& > ${t}-content-box`]:{padding:N},"&-hidden":{display:"none"}},"&-small":{[`> ${t}-item`]:{[`> ${t}-header`]:{padding:m,paddingInlineStart:c,[`> ${t}-expand-icon`]:{marginInlineStart:e.calc(y).sub(c).equal()}},[`> ${t}-content > ${t}-content-box`]:{padding:y}}},"&-large":{[`> ${t}-item`]:{fontSize:x,lineHeight:$,[`> ${t}-header`]:{padding:d,paddingInlineStart:a,[`> ${t}-expand-icon`]:{height:S,marginInlineStart:e.calc(I).sub(a).equal()}},[`> ${t}-content > ${t}-content-box`]:{padding:I}}},[`${t}-item:last-child`]:{borderBottom:0,[`> ${t}-content`]:{borderRadius:`0 0 ${F(f)} ${F(f)}`}},[`& ${t}-item-disabled > ${t}-header`]:{"\n          &,\n          & > .arrow\n        ":{color:l,cursor:"not-allowed"}},[`&${t}-icon-position-end`]:{[`& > ${t}-item`]:{[`> ${t}-header`]:{[`${t}-expand-icon`]:{order:1,paddingInlineEnd:0,paddingInlineStart:C}}}}})}},Jt=e=>{const{componentCls:t}=e,r=`> ${t}-item > ${t}-header ${t}-arrow`;return{[`${t}-rtl`]:{[r]:{transform:"rotate(180deg)"}}}},Qt=e=>{const{componentCls:t,headerBg:r,paddingXXS:a,colorBorder:o}=e;return{[`${t}-borderless`]:{backgroundColor:r,border:0,[`> ${t}-item`]:{borderBottom:`1px solid ${o}`},[`
        > ${t}-item:last-child,
        > ${t}-item:last-child ${t}-header
      `]:{borderRadius:0},[`> ${t}-item:last-child`]:{borderBottom:0},[`> ${t}-item > ${t}-content`]:{backgroundColor:"transparent",borderTop:0},[`> ${t}-item > ${t}-content > ${t}-content-box`]:{paddingTop:a}}}},Xt=e=>{const{componentCls:t,paddingSM:r}=e;return{[`${t}-ghost`]:{backgroundColor:"transparent",border:0,[`> ${t}-item`]:{borderBottom:0,[`> ${t}-content`]:{backgroundColor:"transparent",border:0,[`> ${t}-content-box`]:{paddingBlock:r}}}}}},Yt=e=>({headerPadding:`${e.paddingSM}px ${e.padding}px`,headerBg:e.colorFillAlter,contentPadding:`${e.padding}px 16px`,contentBg:e.colorBgContainer}),Zt=Xe("Collapse",e=>{const t=Ye(e,{collapseHeaderPaddingSM:`${F(e.paddingXS)} ${F(e.paddingSM)}`,collapseHeaderPaddingLG:`${F(e.padding)} ${F(e.paddingLG)}`,collapsePanelBorderRadius:e.borderRadiusLG});return[Ht(t),Qt(t),Xt(t),Jt(t),Ze(t)]},Yt),en=v.forwardRef((e,t)=>{const{getPrefixCls:r,direction:a,expandIcon:o,className:u,style:m}=at("collapse"),{prefixCls:d,className:f,rootClassName:p,style:j,bordered:s=!0,ghost:g,size:i,expandIconPosition:l="start",children:x,expandIcon:b}=e,$=rt(O=>{var D;return(D=i??O)!==null&&D!==void 0?D:"middle"}),C=r("collapse",d),y=r(),[I,c,T]=Zt(C),E=v.useMemo(()=>l==="left"?"start":l==="right"?"end":l,[l]),N=b??o,h=v.useCallback(function(){let O=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const D=typeof N=="function"?N(O):v.createElement(st,{rotate:O.isActive?a==="rtl"?-90:90:void 0,"aria-label":O.isActive?"expanded":"collapsed"});return ye(D,()=>{var V;return{className:de((V=D==null?void 0:D.props)===null||V===void 0?void 0:V.className,`${C}-arrow`)}})},[N,C]),S=de(`${C}-icon-position-${E}`,{[`${C}-borderless`]:!s,[`${C}-rtl`]:a==="rtl",[`${C}-ghost`]:!!g,[`${C}-${$}`]:$!=="middle"},u,f,p,c,T),k=Object.assign(Object.assign({},ot(y)),{motionAppear:!1,leavedClassName:`${C}-content-hidden`}),U=v.useMemo(()=>x?lt(x).map((O,D)=>{var V,z;const _=O.props;if(_!=null&&_.disabled){const re=(V=O.key)!==null&&V!==void 0?V:String(D),se=Object.assign(Object.assign({},be(O.props,["disabled"])),{key:re,collapsible:(z=_.collapsible)!==null&&z!==void 0?z:"disabled"});return ye(O,se)}return O}):null,[x]);return I(v.createElement(xe,Object.assign({ref:t,openMotion:k},be(e,["rootClassName"]),{expandIcon:h,prefixCls:C,className:S,style:Object.assign(Object.assign({},m),j)}),U))}),tn=Object.assign(en,{Panel:qt});function nn({data:e,save:t,isDirty:r,isSaving:a,entriesToUpdate:o,hasFirestoreData:u}){const{addParams:m,queryParams:d}=ge(),f=ce("daily-diagram-rules");return n.jsxs(mt,{children:[n.jsxs(ee,{gap:12,vertical:!0,children:[n.jsx(pt,{dirt:JSON.stringify(o),isDirty:r,isSaving:a,onSave:t}),n.jsx(ft,{block:!0,data:()=>an(e,f.data??{}),disabled:r,fileName:"daily-diagram-items.json",hasNewData:u})]}),n.jsx(W,{}),n.jsx(ut,{label:"Display",onChange:p=>m({display:p,page:1},{page:1}),options:[{title:"By Rule",icon:n.jsx(xt,{}),value:"rule"},{title:"By Thing",icon:n.jsx(vt,{}),value:"thing"},{title:"Simulator",icon:n.jsx(yt,{}),value:"simulator"}],value:d.get("display")??"rule"}),n.jsx(W,{}),n.jsx(P.Paragraph,{className:"my-6",type:"secondary",children:"v2.0.1"})]})}function an(e,t){console.log("Preparing file for download...");const r=Z.cloneDeep(e);return Object.values(r).forEach(a=>{const o=Object.values(t).filter(d=>d.updatedAt>a.updatedAt),u=o.filter(d=>d.method==="auto");u.length>0&&(console.log(`Performing ${u.length} auto updates for ${a.name}`),a.rules=a.rules.filter(d=>!u.map(f=>f.id).includes(d)),u.forEach(d=>{G[d.id](a.name)&&a.rules.push(d.id)})),o.some(d=>d.method!=="auto")||(console.log("Auto updating"),a.updatedAt=Date.now())}),gt(r)}function ve({isModalOpen:e,onSaveThing:t,onCancel:r,thing:a,rules:o,width:u,itemAliases:m,subtitle:d,okButtonText:f,onGiveAnotherThing:p}){const j=v.useMemo(()=>Z.orderBy(Object.values(o),[h=>{const S=["manual","dependency","auto"].indexOf(h.method);return S===-1?Number.POSITIVE_INFINITY:S},h=>{const S=["grammar","comparison","order","count","contains","ends"].indexOf(h.type);return S===-1?Number.POSITIVE_INFINITY:S},h=>h.title.slice(0,7),h=>Number(h.id.split("-")[1])]),[o]),[s]=M.useForm(),g=M.useWatch([],s),i=!g||Object.values(g??{}).some(h=>h===void 0),l=M.useWatch("name",s);v.useEffect(()=>{if(!l||a.name&&a.syllables&&l===a.name)return;const h={syllables:Fe(l),stressedSyllable:a.stressedSyllable??l.includes(" ")?-1:0};Object.keys(o).forEach(S=>{G[S]?h[S]=G[S](l):h[S]=a.rules.length>0?a.rules.includes(S):void 0}),s.setFieldsValue(h)},[l]);const x=M.useWatch("syllables",s),b=s.getFieldValue("ddr-51-pt");v.useEffect(()=>{b&&(s.setFieldsValue({stressedSyllable:void 0}),s.setFieldsValue({"ddr-43-pt":!1}),s.setFieldsValue({"ddr-44-pt":!1}),s.setFieldsValue({"ddr-45-pt":!1}),s.setFieldsValue({"ddr-46-pt":!1})),b===void 0&&s.setFieldsValue({"ddr-51-pt":!1})},[b]),v.useEffect(()=>{if(x){const h=Object.keys(o).reduce((S,k)=>(Ce[k]&&(S[k]=Ce[k](l,x,b)),S),{});s.setFieldsValue({...h,stressedSyllable:x===a.syllables?a.stressedSyllable:a.stressedSyllable??l.includes(" ")?-1:void 0})}},[l,x,b]);const $=M.useWatch("stressedSyllable",s);v.useEffect(()=>{if(!b&&$!==void 0){const h=Object.keys(o).reduce((S,k)=>(Se[k]&&(S[k]=Se[k](l,x,$)),S),{});s.setFieldsValue({...h})}},[$]);const C=s.getFieldValue("ddr-1-pt"),y=s.getFieldValue("ddr-2-pt"),I=s.getFieldValue("ddr-50-pt");v.useEffect(()=>{C===!0&&(s.setFieldsValue({"ddr-2-pt":!1}),s.setFieldsValue({"ddr-50-pt":!1}))},[C]),v.useEffect(()=>{y===!0&&(s.setFieldsValue({"ddr-1-pt":!1}),s.setFieldsValue({"ddr-50-pt":!1}))},[y]),v.useEffect(()=>{I===!0&&(s.setFieldsValue({"ddr-1-pt":!1}),s.setFieldsValue({"ddr-2-pt":!1}))},[I]);const c=s.getFieldValue("ddr-3-pt");v.useEffect(()=>{c===!0&&s.setFieldsValue({"ddr-4-pt":!1})},[c]);const T=s.getFieldValue("ddr-4-pt");v.useEffect(()=>{T===!0&&s.setFieldsValue({"ddr-3-pt":!1})},[T]),v.useEffect(()=>{(l==null?void 0:l.includes("-"))&&s.setFieldsValue({"ddr-5-pt":!0})},[l]);const E=h=>{const S=sn(h);t(S)},N=v.useMemo(()=>(x??"").split(_e),[x]);return n.jsx(bt,{maskClosable:!1,okButtonProps:{disabled:i,htmlType:"submit",size:"large"},okText:f??"Add Item",onCancel:r,onOk:s.submit,open:e,title:n.jsxs(n.Fragment,{children:["Edit ",a.name," ",d&&n.jsx("small",{children:d})]}),width:u,children:n.jsxs(M,{autoComplete:"off",form:s,initialValues:rn(a,o),labelWrap:!0,layout:"vertical",name:`new-item-${a.itemId}`,onFinish:E,size:"small",children:[n.jsxs("div",{className:"diagram-container",children:[n.jsx("div",{children:n.jsx(Ve,{id:a.itemId,width:50})}),n.jsx(M.Item,{label:"Name",name:"name",children:n.jsx(te,{})}),n.jsx(M.Item,{label:"Item",name:"itemId",children:n.jsx(te,{readOnly:!0})}),n.jsx(M.Item,{label:"Syllables",name:"syllables",children:n.jsx(te,{})}),n.jsx(M.Item,{label:"Stressed Syllable",name:"stressedSyllable",children:n.jsx(q.Group,{buttonStyle:"solid",optionType:"button",children:N.map((h,S)=>n.jsx(q,{value:N.length-S-1,children:h},S))})}),n.jsx(M.Item,{label:"Updated At",name:"updatedAt",children:n.jsx(te,{readOnly:!0,value:new Date(a.updatedAt).toLocaleString()})}),(m||p)&&n.jsxs("div",{children:[p&&n.jsx(Y,{className:"mt-2",onClick:p,size:"small",type:"dashed",children:"Give me another thing"}),m&&n.jsxs("span",{children:["Options: ",m==null?void 0:m.join(", ")]})]}),n.jsx("div",{children:n.jsx(jt,{offsetTop:50,children:n.jsx(ee,{align:"center",justify:"center",children:n.jsx(Y,{disabled:i,htmlType:"submit",size:"large",type:"primary",children:f??"Add Item"})})})})]}),n.jsx("div",{className:"diagram-container",children:j.map(h=>h.method==="auto"&&G[h.id]?n.jsx(M.Item,{className:oe(a.updatedAt<h.updatedAt&&"diagram-container__outdated-rule"),label:h.title,name:h.id,valuePropName:"checked",children:n.jsx(me,{checkedChildren:"✅",disabled:!0,unCheckedChildren:"❌"})},h.id):h.method==="dependency"?n.jsx(M.Item,{className:oe(a.updatedAt<h.updatedAt&&"diagram-container__outdated-rule"),label:h.title,name:h.id,valuePropName:"checked",children:n.jsx(me,{checkedChildren:"✅",disabled:!0,unCheckedChildren:"❌"})},h.id):n.jsx(M.Item,{className:oe(a.updatedAt<h.updatedAt&&"diagram-container__outdated-rule"),label:h.title,name:h.id,children:n.jsxs(q.Group,{buttonStyle:"solid",optionType:"button",children:[n.jsx(q,{value:!0,children:"✅"}),n.jsx(q,{value:!1,children:"❌"})]})},h.id))})]})})}const rn=(e,t)=>{let r=!1;return{name:e.name,itemId:e.itemId,syllables:e.syllables??Fe(e.name),stressedSyllable:e.stressedSyllable??0,...Object.keys(t).reduce((a,o)=>{if(e.updatedAt<t[o].updatedAt)if(G[o]){const u=G[o](e.name);u&&e.rules.includes(o)&&(r=!0),a[o]=u}else a[o]=void 0;else a[o]=e.rules.includes(o);return a},{}),updatedAt:r?Date.now():e.updatedAt}},sn=e=>{const{itemId:t,name:r,syllables:a,stressedSyllable:o,...u}=e;return{itemId:t,name:r,updatedAt:Date.now(),syllables:a,stressedSyllable:o,rules:Object.keys(u).filter(m=>u[m]===!0)}};function J({itemId:e,name:t,width:r=50}){return n.jsxs(ee,{align:"center",vertical:!0,children:[n.jsx(Ve,{id:e,width:r}),n.jsx(P.Text,{code:!0,children:t},e)]})}function ne({thing:e,width:t=50,onActivateThing:r}){return n.jsx(H,{onClick:()=>r(e),children:n.jsx(J,{itemId:e.itemId,name:e.name,width:t})})}function on({game:e}){const[t]=v.useState([{id:e.rule1.thing.id,name:e.rule1.thing.name,rule:1}]),[r]=v.useState([{id:e.rule2.thing.id,name:e.rule2.thing.name,rule:2}]),[a]=v.useState([{id:e.intersectingThing.id,name:e.intersectingThing.name,rule:0}]),[o]=v.useState(e.things.slice(0,4)),[u,m]=v.useState(e.things[0]);return n.jsxs(R,{align:"center",direction:"vertical",children:[n.jsx(P.Title,{level:4,children:"Game Sample"}),n.jsxs(P.Title,{level:5,children:['"',e.title,'"']}),n.jsx(Le,{count:e.level,disabled:!0,value:e.level}),n.jsx(P.Paragraph,{style:{maxWidth:"500px"},children:"O círculo amarelo tem uma regra gramatical secreta e o circulo vermelho tem outra regra gramatical secreta. O quadrado do meio representa a interseção entre a regra amarela e a regra vermelha."}),n.jsx(R,{children:n.jsx(ln,{intersectionChildren:n.jsx(H,{style:{width:"100%",height:"100%"},children:a.map((d,f,p)=>n.jsx(J,{itemId:d.id,name:d.name,width:f===p.length-1?80:60},d.id))}),leftCircleChildren:n.jsx(H,{style:{width:"100%",height:"100%"},children:t.map((d,f,p)=>n.jsx(J,{itemId:d.id,name:d.name,width:f===p.length-1?80:60},d.id))}),rightCircleChildren:n.jsx(H,{style:{width:"100%",height:"100%"},children:r.map((d,f,p)=>n.jsx(J,{itemId:d.id,name:d.name,width:f===p.length-1?80:60},d.id))}),width:600})}),n.jsx(P.Text,{children:"Coloque os objetos nos círculos corretos:"}),n.jsx(R,{className:"space--center",children:o.map(d=>n.jsx(H,{onClick:()=>m(d),style:d.id===(u==null?void 0:u.id)?{outline:"3px solid hotPink"}:{},children:n.jsx(J,{itemId:d.id,name:d.name},d.id)},d.id))}),n.jsx(tn,{items:[{key:"1",label:"Resposta",children:n.jsxs(R,{direction:"vertical",children:[n.jsx(P.Text,{strong:!0,children:"Regra Amarela"}),n.jsx("ul",{children:n.jsx("li",{children:n.jsx(P.Text,{children:e.rule1.text})})}),n.jsx(P.Text,{strong:!0,children:"Regra Vermelha"}),n.jsx("ul",{children:n.jsx("li",{children:n.jsx(P.Text,{children:e.rule2.text})})})]})}]}),n.jsx("div",{style:{height:"200px"}})]})}function ln({leftCircleChildren:e,rightCircleChildren:t,intersectionChildren:r,...a}){return n.jsxs("svg",{viewBox:"0 0 760 500",xmlns:"http://www.w3.org/2000/svg",...a,children:[n.jsx("path",{d:"M252.78 3.5c-136.42 0-247 110.59-247 247s110.59 247 247 247 247-110.59 247-247-110.59-247-247-247zm.99 483.07C123.39 486.57 17.7 380.88 17.7 250.5S123.39 14.43 253.77 14.43 489.84 120.12 489.84 250.5 384.15 486.57 253.77 486.57z",fill:"#fbb03b",stroke:"#000",strokeMiterlimit:"10",strokeWidth:"5"}),n.jsx("path",{d:"M508.22 3.5c-136.41 0-247 110.59-247 247s110.59 247 247 247 247-110.59 247-247-110.58-247-247-247zm.99 483.07c-130.38 0-236.07-105.69-236.07-236.07S378.84 14.43 509.22 14.43 745.29 120.12 745.29 250.5 639.6 486.57 509.22 486.57z",fill:"#f15a24",stroke:"#000",strokeMiterlimit:"10",strokeWidth:"5"}),n.jsx("path",{d:"M487.34 250.5c0-62.39-24.29-121.04-68.41-165.16a235.9 235.9 0 00-37.43-30.47 235.35 235.35 0 00-37.43 30.47c-44.12 44.11-68.41 102.77-68.41 165.16s24.29 121.04 68.41 165.16a235.9 235.9 0 0037.43 30.47 235.35 235.35 0 0037.43-30.47c44.12-44.11 68.41-102.77 68.41-165.16z",fill:"#535353"}),n.jsx("path",{d:"M258.72 250.5c0-66.64 25.95-129.3 73.08-176.42a253.125 253.125 0 0134.1-28.57c-33.98-18.65-72.29-28.57-112.13-28.57-62.39 0-121.04 24.29-165.16 68.41C44.5 129.46 20.2 188.11 20.2 250.5s24.29 121.04 68.41 165.16c44.11 44.12 102.77 68.41 165.16 68.41 39.84 0 78.15-9.92 112.13-28.57a252.507 252.507 0 01-34.1-28.57c-47.12-47.12-73.08-109.78-73.08-176.42zM674.37 85.34C630.25 41.22 571.6 16.93 509.21 16.93c-40.27 0-78.98 10.14-113.24 29.18 11.74 8.26 22.86 17.6 33.22 27.96 47.12 47.12 73.08 109.78 73.08 176.42s-25.95 129.3-73.08 176.42a252.312 252.312 0 01-33.22 27.96c34.25 19.04 72.96 29.18 113.24 29.18 62.39 0 121.04-24.29 165.16-68.41 44.12-44.11 68.41-102.77 68.41-165.16s-24.29-121.04-68.41-165.16z",fill:"#535353"}),n.jsx("foreignObject",{height:"450",width:"250",x:"30",y:"25",children:n.jsx("div",{className:"venn-diagram__circle-content-left",children:e})}),n.jsx("foreignObject",{height:"450",width:"250",x:"480",y:"25",children:n.jsx("div",{className:"venn-diagram__circle-content-right",children:t})}),n.jsx("foreignObject",{height:"370",width:"182",x:"290",y:"65",children:n.jsx("div",{className:"venn-diagram__circle-content-intersection",children:r})})]})}function dn({things:e,rules:t}){const[r]=he(),[a,o]=v.useState(null),u=()=>{o(Object.values(Ie(1,{latestDate:"2023/01/01",latestNumber:0,used:[]},t,e))[0])},m=()=>{let d=null;try{d=Ie(25,{latestDate:"2023/01/01",latestNumber:0,used:[]},t,e),console.log(d)}catch(f){console.error(f)}};return n.jsxs(R,{direction:"vertical",ref:r,children:[n.jsx(P.Title,{level:5,children:"Game Simulator"}),n.jsx(Y,{onClick:u,size:"large",children:"Simulate"}),n.jsx(Y,{onClick:m,size:"large",children:"Generate Demos (log)"}),a&&n.jsx(on,{game:a},JSON.stringify(a))]})}function cn({children:e,things:t,rules:r,addEntryToUpdate:a}){const o=v.useMemo(()=>Object.values(t).filter(f=>{if(f.syllables&&f.syllables.split(_e).join("")!==f.name.replace(/\s/g,""))return console.log("❗️ Name and syllables do not match",f.name,f.syllables),!0;const p=Object.values(r).filter(s=>s.updatedAt>f.updatedAt);return p.filter(s=>s.method==="auto").length>0&&console.log("❗️ Thing has auto updates that will be performed automatically upon downloading the JSON"),p.some(s=>s.method!=="auto")}),[t,r]),[u,m]=v.useState(null);v.useEffect(()=>{const f=async p=>{console.log("Found things that need to update..."),m(null),await ue(250),o.length>0&&m(o[0])};console.count("Checking for things that need to update..."),o.length>0&&f(o[0])},[o]);const d=f=>{a(f.itemId,f)};return n.jsxs(n.Fragment,{children:[u&&n.jsx(ve,{isModalOpen:u!==null,okButtonText:"Update",onCancel:()=>m(null),onSaveThing:d,rules:r,subtitle:`(${o.length} left to update)`,thing:u,width:"90vw"}),e]})}function Ue({addEntryToUpdate:e,availableThings:t,rules:r,width:a}){const{notification:o}=it.useApp(),[u,m]=v.useState(null),[d,f]=v.useState({}),p=()=>{const i=Z.sample(t.filter(l=>!d[l.id]));i?(f(l=>({...l,[i.id]:!0})),m({itemId:i.id,name:un(i),updatedAt:Date.now(),syllables:"",stressedSyllable:0,rules:[]})):m(null)},j=v.useMemo(()=>{if(!u)return[];const i=t.find(l=>l.id===u.itemId);return[i==null?void 0:i.name.pt,...(i==null?void 0:i.aliasesPt)??[]].filter(Boolean)},[u,t]),s=async i=>{u&&((!i.name||!i.itemId)&&o.error({message:"Name and Item ID are required"}),e(i.itemId,i),console.log("COMPLETED SAVE"),m(null),await ue(250),p())},g=async()=>{m(null),await ue(100),p()};return n.jsxs(n.Fragment,{children:[n.jsx(Y,{onClick:p,size:"large",children:"Classify New Item"}),!!u&&n.jsx(ve,{isModalOpen:u!==null,itemAliases:j,onCancel:()=>m(null),onGiveAnotherThing:g,onSaveThing:s,rules:r,thing:u,width:a*.9})]})}const un=e=>e.name.pt.split(" ").length===1?e.name.pt:e.aliasesPt?e.aliasesPt.find(t=>t.split(" ").length===1)??e.name.pt:e.name.pt;function mn({things:e,addEntryToUpdate:t,availableThings:r,rules:a,setActiveThing:o}){const[u,{width:m}]=he(),d=v.useMemo(()=>Object.values(e),[e]),f=ze({total:d.length,showQuickJumper:!0}),p=[{title:"ItemId",dataIndex:"itemId",key:"itemId",sorter:(s,g)=>Number(s.itemId)-Number(g.itemId),render:s=>n.jsx(L,{children:s})},{title:"Name",dataIndex:"name",key:"name",sorter:(s,g)=>s.name.localeCompare(g.name),render:s=>n.jsx(P.Text,{children:s})},{title:"Sprite",dataIndex:"itemId",key:"sprite",render:s=>n.jsx(ne,{onActivateThing:o,thing:e[s]},`i-${s}`)},{title:"Rules",dataIndex:"rules",key:"rules",render:(s,g)=>n.jsx(R,{wrap:!0,children:s.map(i=>n.jsx(dt,{title:a[i].title,children:n.jsx(L,{color:a[i].updatedAt>g.updatedAt?"red":void 0,children:i})},i))})},{title:"Count",dataIndex:"rules",key:"count",sorter:(s,g)=>s.rules.length-g.rules.length,render:s=>s.length}],j=v.useMemo(()=>{const s={};return Object.values(e).forEach(g=>{s[g.name]||(s[g.name]=[]),s[g.name].push(g.itemId)}),Object.values(s).filter(g=>g.length>1)},[e]);return n.jsxs(R,{direction:"vertical",ref:u,children:[n.jsxs(P.Title,{level:5,children:["Rules By Items ",n.jsx(W,{type:"vertical"})," Added: ",n.jsx(L,{children:Object.keys(e).length})," Available to add ",n.jsx(L,{children:r.length})]}),n.jsx(Ue,{addEntryToUpdate:t,availableThings:r,rules:a,width:m}),n.jsx(W,{}),n.jsx(Be,{columns:p,dataSource:d,pagination:f,rowKey:"itemId"}),n.jsx(W,{}),n.jsx(P.Title,{level:5,children:"Duplicated Things"}),n.jsxs(R,{wrap:!0,children:[j.length===0&&n.jsx(P.Text,{children:"No duplicated things"}),j.map(s=>n.jsxs(ee,{align:"center",children:[n.jsx(L,{color:"red",children:s.length}),s.map(g=>n.jsx(ne,{onActivateThing:o,thing:e[g]},`i-${g}`))]},s[0]))]})]})}function fn({things:e,addEntryToUpdate:t,availableThings:r,rules:a,thingsByRules:o,setActiveThing:u,containerWidth:m}){const{is:d,addParam:f}=ge(),p=v.useMemo(()=>Object.values(a).map(i=>({...i,thingsCount:o[i.id].length})),[a,o]),j=ze({total:p.length,showQuickJumper:!0}),s=v.useMemo(()=>{const i=Object.values(o).map(l=>l.length);return{maxThings:Math.max(...i),minThings:Math.min(...i),averageThings:Math.round(Object.values(o).reduce((l,x)=>l+x.length,0)/Object.keys(o).length)}},[o]),g=[{title:"Id",dataIndex:"id",key:"id",sorter:(i,l)=>Number(i.id.split("-")[1])-Number(l.id.split("-")[1]),render:i=>n.jsx(P.Text,{children:i})},{title:"Rule",dataIndex:"title",key:"title",sorter:(i,l)=>i.title.localeCompare(l.title),render:i=>n.jsx(P.Text,{children:i})},{title:"Type",dataIndex:"type",key:"type",sorter:(i,l)=>i.type.localeCompare(l.type)},{title:"Method",dataIndex:"method",key:"method",sorter:(i,l)=>i.method.localeCompare(l.method)},{title:"Things",dataIndex:"thingsCount",key:"thingsCount",render:(i,l)=>n.jsxs(R,{size:"small",children:[n.jsx(L,{children:i}),d("showThings")?n.jsxs(R,{size:"small",wrap:!0,children:[o[l.id].slice(0,20).map(x=>n.jsx(ne,{onActivateThing:u,thing:e[x]},`${l.id}-${x}`)),o[l.id].length>20&&n.jsxs(P.Text,{children:["+",i-20," more"]})]}):n.jsxs(R,{size:"small",wrap:!0,children:[o[l.id].slice(0,5).map(x=>n.jsx(ne,{onActivateThing:u,thing:e[x]},`${l.id}-${x}`)),o[l.id].length>5&&n.jsxs(P.Text,{children:["+",i-5," more"]})]})]}),sorter:(i,l)=>i.thingsCount-l.thingsCount},{title:"Level",dataIndex:"level",key:"level",sorter:(i,l)=>i.level-l.level,render:i=>n.jsx(Le,{count:3,disabled:!0,value:i})}];return n.jsxs(R,{direction:"vertical",children:[n.jsxs(P.Title,{level:4,children:["Things By Rule (Added: ",Object.keys(e).length," | ",r.length,")"," "]}),n.jsxs(R,{split:n.jsx(W,{type:"vertical"}),wrap:!0,children:[n.jsx(Ue,{addEntryToUpdate:t,availableThings:r,rules:a,width:m}),n.jsxs(P.Text,{strong:!0,children:["Average Things: ",n.jsx(L,{children:s.averageThings})]}),n.jsxs(P.Text,{strong:!0,children:["Max Things: ",n.jsx(L,{children:s.maxThings})]}),n.jsxs(P.Text,{strong:!0,children:["Min Things: ",n.jsx(L,{children:s.minThings})]}),n.jsx(me,{checked:d("showThings"),checkedChildren:"Hide things",onChange:i=>f("showThings",i),unCheckedChildren:"Show things"})]}),n.jsx(Be,{columns:g,dataSource:p,pagination:j})]})}const Me=e=>{const t=e.filter(r=>r.split(" ").length===1);return t.length>0?t[0]:""};function pn({data:e,addEntryToUpdate:t}){const[r,{width:a}]=he(),o=ce("items"),u=ce("daily-diagram-rules"),m=v.useMemo(()=>Object.values(o.data??{}).filter(l=>{var b,$,C,y,I,c;if(e&&e[l.id]!==void 0||l.nsfw)return!1;const x=l.name.pt.split(" ").length===1;return!!((b=l.decks)!=null&&b.includes("thing")||($=l.decks)!=null&&$.includes("alien")&&x||(C=l.decks)!=null&&C.includes("manufactured")&&x||(y=l.decks)!=null&&y.includes("alien")&&l.aliasesPt&&Me(l.aliasesPt)||(I=l.decks)!=null&&I.includes("manufactured")&&l.aliasesPt&&Me(l.aliasesPt)||(c=l.decks)!=null&&c.includes("meta")&&x)}),[e,o.data]),d=v.useMemo(()=>u.data??{},[u.data]),f=v.useMemo(()=>{const l=Object.values(d).reduce((x,b)=>(x[b.id]=[],x),{});return Z.orderBy(Object.values(e),["updatedAt"],["desc"]).forEach(x=>{x.rules.forEach(b=>{l[b].push(x.itemId)})}),l},[e,d]),{is:p,queryParams:j}=ge(),[s,g]=v.useState(null);if(o.isLoading||u.isLoading)return n.jsx(P.Text,{children:"Loading..."});const i=l=>{t(l.itemId,l)};return n.jsx(De,{hasResponseData:o.hasResponseData||u.hasResponseData,isLoading:o.isLoading||u.isLoading,children:n.jsx("div",{ref:r,children:n.jsxs(cn,{addEntryToUpdate:t,rules:d,things:e,children:[s&&n.jsx(ve,{isModalOpen:s!==null,okButtonText:"Update",onCancel:()=>g(null),onSaveThing:l=>{i(l),g(null)},rules:d,thing:s,width:a}),(p("display","rule")||!j.has("display"))&&n.jsx(fn,{addEntryToUpdate:t,availableThings:m,containerWidth:a,rules:d,setActiveThing:g,things:e,thingsByRules:f}),p("display","thing")&&n.jsx(mn,{addEntryToUpdate:t,availableThings:m,rules:d,setActiveThing:g,things:e,thingsByRules:f}),p("display","simulator")&&n.jsx(dn,{addEntryToUpdate:t,availableThings:m,rules:d,things:e})]})})})}function oa(){const e=Ct({tdrResourceName:"daily-diagram-items",firestoreDataCollectionName:"diagramItems",serialize:!0});return n.jsx(ct,{subtitle:"Diagram Sets",title:"Items",children:n.jsxs(je,{hasSider:!0,children:[n.jsx(ht,{children:n.jsx(nn,{...e})}),n.jsx(je.Content,{className:"content",children:n.jsx(De,{error:e.error,hasResponseData:!Z.isEmpty(e.data),isLoading:e.isLoading||e.isSaving,children:n.jsx(ee,{gap:24,vertical:!0,children:n.jsx(pn,{...e})})})})]})})}export{oa as ItemsDiagramSets,oa as default};
