import{r as h,d as L,_ as N,a3 as O,j as s,I as P,a4 as k,ae as D,bi as M,F as $,c as A,P as B,L as I}from"./index-Mpn7fKLo.js";import{u as b,R as q,I as G}from"./RelationshipsStats-Cz0ZMQF2.js";import{T as W}from"./TransparentButton-B9EWthMs.js";import{I as U}from"./IdTag-DDX4Ggeo.js";import{D as Z}from"./DataLoadingWrapper-DJ85WKe8.js";import{l as y,P as J}from"./useBaseUrl-CX18PvAw.js";import{I as Q}from"./ImageCard-CaSgcmZb.js";import{R as V}from"./RelationshipCountTag-CI-XL5Ho.js";import{C as H}from"./index-BPMnUpzg.js";import{F as m,R as K}from"./ExpandOutlined-D5d9qzdn.js";import{R as X}from"./Item-Cz8Li8m1.js";import{R as Y}from"./SyncOutlined-CPRwQRHp.js";import{b as T,a as C}from"./FilterEntries-CscBbHYS.js";import{R as ss}from"./ResponseState-DS0k9oIf.js";import{D as es}from"./DownloadButton-WLo36Aa7.js";import{S as ts}from"./SaveButton-GeS8HZ2o.js";import{S as R}from"./SiderContent-CA_Mx0qK.js";import{T as as,g as rs,C as os}from"./constants-Bvs7f2Uv.js";import"./hooks-Da4iPDng.js";import"./useMutation-BmIwR3V_.js";import"./useQueryParams-i-yD5Lix.js";import"./index-D29QDRdy.js";import"./clsx-B-dksMZM.js";import"./useCopyToClipboardFunction-HFoZG3l7.js";import"./index-Dkpz02iF.js";import"./index-Byj-VsnV.js";import"./PlusOutlined-B4Zll0NG.js";import"./VerticalAlignTopOutlined-MWPJ-q-b.js";import"./scrollTo-DFvfQX28.js";import"./throttleByAnimationFrame-kJTShJOk.js";import"./FileTextOutlined-CeMb98pg.js";import"./index-0aqywvkc.js";import"./index-p6w2fwio.js";import"./index-BAyL2y2L.js";import"./index-DGNTcQev.js";import"./index-C8_OtA8I.js";import"./index-De3Jpewb.js";import"./moment-BYTvHWBW.js";import"./SaveOutlined-BE8lHBEG.js";var is={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M752 100c-61.8 0-112 50.2-112 112 0 47.7 29.9 88.5 72 104.6v27.6L512 601.4 312 344.2v-27.6c42.1-16.1 72-56.9 72-104.6 0-61.8-50.2-112-112-112s-112 50.2-112 112c0 50.6 33.8 93.5 80 107.3v34.4c0 9.7 3.3 19.3 9.3 27L476 672.3v33.6c-44.2 15-76 56.9-76 106.1 0 61.8 50.2 112 112 112s112-50.2 112-112c0-49.2-31.8-91-76-106.1v-33.6l226.7-291.6c6-7.7 9.3-17.3 9.3-27v-34.4c46.2-13.8 80-56.7 80-107.3 0-61.8-50.2-112-112-112zM224 212a48.01 48.01 0 0196 0 48.01 48.01 0 01-96 0zm336 600a48.01 48.01 0 01-96 0 48.01 48.01 0 0196 0zm192-552a48.01 48.01 0 010-96 48.01 48.01 0 010 96z"}}]},name:"fork",theme:"outlined"},ns=function(a,e){return h.createElement(L,N({},a,{ref:e,icon:is}))},ls=h.forwardRef(ns);function cs(){const{query:{isDirty:i,isSaving:a,...e},randomGroups:{cardIds:r,cards:l,onSelect:c,selection:n,relate:u,nextSet:x,deselectAll:g,cycles:j},showIds:f,cardSize:d}=b(),p=h.useRef(null),[S,{width:t}]=O(),[_,w]=h.useMemo(()=>{const o=Math.floor(t/d)+1,v=Math.floor(t/o);return[o,v]},[d,t]),z=()=>{x(),p.current?.scrollIntoView({behavior:"smooth"})};return s.jsx(Z,{error:e.error,hasResponseData:!y.isEmpty(e.data),isLoading:e.isLoading,children:s.jsx("div",{className:"my-6",ref:S,children:s.jsxs(H,{className:"image-card-categorizer-card",extra:s.jsxs(k,{title:"Total cycles",children:[s.jsx(D,{})," ",j]}),ref:p,title:"Card Relationship Matching",children:[s.jsx(P.PreviewGroup,{children:s.jsx("div",{className:"image-cards-group",style:{gridTemplateColumns:`repeat(${Math.max(_,1)}, 1fr)`},children:r.map((o,v)=>{const E=n.includes(o),F=l[v];return s.jsx("div",{className:"image-card-card__image",children:s.jsxs(W,{active:E,activeClass:"image-cards-group__button--active",className:"image-cards-group__button",onClick:()=>c(o),children:[s.jsx(Q,{cardId:o,cardWidth:w-24,preview:!1}),s.jsxs("div",{children:[f&&s.jsx(U,{children:o}),s.jsx(V,{card:F})]})]})},o)})})}),s.jsx(ms,{deselectAll:g,isDirty:i,isSaving:a,onNextSet:z,relate:u,selection:n})]})})})}const ms=({isSaving:i,isDirty:a,selection:e,relate:r,deselectAll:l,onNextSet:c})=>{if(i)return s.jsx(m,{icon:s.jsx(M,{})});const n=()=>{e.length<2||r()};return s.jsxs(s.Fragment,{children:[a&&s.jsx(m,{icon:s.jsx(X,{}),style:{right:234},type:"primary"}),s.jsx(m,{icon:s.jsx(K,{}),onClick:l,style:{right:164}}),s.jsx(m,{badge:{count:e.length,size:"small"},icon:s.jsx(ls,{}),onClick:n,style:{right:94},type:e.length<2?"default":"primary"}),s.jsx(m,{icon:s.jsx(Y,{}),onClick:c,style:{right:24}})]})};function ds(){const{query:{isDirty:i,isSaving:a,save:e,data:r,isLoading:l,isError:c},randomGroups:{filters:n},showIds:u,setShowIds:x,tagThreshold:g,setTagThreshold:j,sampleSize:f,setSampleSize:d,cardSize:p,setCardSize:S}=b();return s.jsxs(J,{children:[s.jsx(R,{children:s.jsxs($,{gap:6,vertical:!0,children:[s.jsx(ts,{dirt:JSON.stringify(r),isDirty:i,isSaving:a,onSave:()=>e({})}),s.jsx(es,{block:!0,data:r,disabled:y.isEmpty(r),fileName:"imageCardsRelationships.json",loading:a})]})}),s.jsx(ss,{hasResponseData:!y.isEmpty(r),isDirty:i,isError:c,isLoading:l||a}),s.jsxs(R,{children:[s.jsx(T,{label:"Use Cycles",onChange:()=>n.toggleUseCycles(),value:n.useCycles}),s.jsx(T,{label:"Show Ids",onChange:t=>x(t),value:u}),s.jsxs(A,{layout:"vertical",children:[s.jsx(C,{label:"Tag Count",onChange:t=>j(t),options:as,value:g}),s.jsx(C,{label:"Sample Size",onChange:t=>d(t),options:rs,value:f}),s.jsx(C,{label:"Card Size",onChange:t=>S(t),options:os,value:p})]})]}),s.jsx(R,{children:s.jsx(q,{})})]})}function Ks(){return s.jsx(B,{subtitle:"Relationships",title:"Image Cards",children:s.jsx(G,{children:s.jsxs(I,{hasSider:!0,children:[s.jsx(ds,{}),s.jsx(I.Content,{className:"content",children:s.jsx(cs,{})})]})})})}export{Ks as default};
