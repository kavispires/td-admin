import{r as w,a as _,_ as Y,j as e,T as I,B as T,aj as je,ae as be,y as F,D as le,ai as ye,P as we,L as ee}from"./index-CV5hjF2H.js";import{D as ve}from"./DataLoadingWrapper-D6wwjvvd.js";import{l as v,c as ue,P as Se}from"./useBaseUrl-CItAHPWR.js";import{u as D}from"./useQueryParams-cM31lt2G.js";import{R as ke,c as Oe,u as Ce}from"./useTestimoniesResource-lgKgxURN.js";import{u as Ee,D as Te,a as Ie,g as Me}from"./constants-BfFiJ1FC.js";import{u as L}from"./useTDResource-BVBx1Oc0.js";import{I as $}from"./ImageCard-BNzI4Lfj.js";import{g as G}from"./utils-BiUm93SD.js";import{F as S}from"./index-BOonA3TQ.js";import{T as De,S as Re,F as Ne}from"./FilterEntries-BpAe5I0L.js";import{B as te,D as Pe}from"./DownloadButton-scwKn8FE.js";import{S as B}from"./index-BfUCaA8R.js";import{u as de}from"./useTableExpandableRows-CdxyB_U1.js";import{u as he}from"./useTablePagination-Dj6lsSY0.js";import{P as se}from"./progress-DKmksSIB.js";import{S as z}from"./index-BtWIBeLj.js";import{F as X}from"./Table-CLE5pmAW.js";import{u as Ae}from"./useCardWidth-2fIByncH.js";import{C as me}from"./index-CJj1g9XQ.js";import{P as ne}from"./index-_hnOZAOl.js";import{R as Fe}from"./FireFilled-DUNRLAaA.js";import{S as q}from"./SiderContent-bWX69VCv.js";import{F as re}from"./FirestoreConsoleLink-CFnvMulx.js";import{S as Be}from"./SaveButton-CeArpt98.js";import{g as ze}from"./useGetFirestoreDoc-D_K7_8eg.js";import{e as $e,a as He,d as Le}from"./index-BUn6CWf5.js";import{u as fe}from"./useWindowSize-CM5FjbSp.js";import{M as ge}from"./index-CNa_MlLd.js";import{R as qe}from"./TableOutlined-BDp0HOq5.js";import"./useResourceFirestoreData-Cnp-I4h_.js";import"./useUpdateFirestoreDoc-l26lO0Hb.js";import"./useMutation-Bu1yxTvU.js";import"./moment-C5S46NFB.js";import"./gapSize-U1swVQyS.js";import"./index-Lhx_REqa.js";import"./index-Dz30J_fv.js";import"./index-Cj1SPcxT.js";import"./index-B0WGJQn4.js";import"./scrollTo-C6tgJLqr.js";import"./Pagination-BwykR5Ds.js";import"./extendsObject-keMuGWqj.js";import"./Input-C81xMCBV.js";import"./SaveOutlined-BTsE2_41.js";import"./constants-C-yjMxTw.js";import"./Item-BGyEFcQV.js";var Ue={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M594.3 601.5a111.8 111.8 0 0029.1-75.5c0-61.9-49.9-112-111.4-112s-111.4 50.1-111.4 112c0 29.1 11 55.5 29.1 75.5a158.09 158.09 0 00-74.6 126.1 8 8 0 008 8.4H407c4.2 0 7.6-3.3 7.9-7.5 3.8-50.6 46-90.5 97.2-90.5s93.4 40 97.2 90.5c.3 4.2 3.7 7.5 7.9 7.5H661a8 8 0 008-8.4c-2.8-53.3-32-99.7-74.7-126.1zM512 578c-28.5 0-51.7-23.3-51.7-52s23.2-52 51.7-52 51.7 23.3 51.7 52-23.2 52-51.7 52zm416-354H768v-56c0-4.4-3.6-8-8-8h-56c-4.4 0-8 3.6-8 8v56H548v-56c0-4.4-3.6-8-8-8h-56c-4.4 0-8 3.6-8 8v56H328v-56c0-4.4-3.6-8-8-8h-56c-4.4 0-8 3.6-8 8v56H96c-17.7 0-32 14.3-32 32v576c0 17.7 14.3 32 32 32h832c17.7 0 32-14.3 32-32V256c0-17.7-14.3-32-32-32zm-40 568H136V296h120v56c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8v-56h148v56c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8v-56h148v56c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8v-56h120v496z"}}]},name:"contacts",theme:"outlined"},Ge={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M300 328a60 60 0 10120 0 60 60 0 10-120 0zM852 64H172c-17.7 0-32 14.3-32 32v660c0 17.7 14.3 32 32 32h680c17.7 0 32-14.3 32-32V96c0-17.7-14.3-32-32-32zm-32 660H204V128h616v596zM604 328a60 60 0 10120 0 60 60 0 10-120 0zm250.2 556H169.8c-16.5 0-29.8 14.3-29.8 32v36c0 4.4 3.3 8 7.4 8h729.1c4.1 0 7.4-3.6 7.4-8v-36c.1-17.7-13.2-32-29.7-32zM664 508H360c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h304c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8z"}}]},name:"robot",theme:"outlined"},Ve={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M868 160h-92v-40c0-4.4-3.6-8-8-8H256c-4.4 0-8 3.6-8 8v40h-92a44 44 0 00-44 44v148c0 81.7 60 149.6 138.2 162C265.6 630.2 359 721.8 476 734.5v105.2H280c-17.7 0-32 14.3-32 32V904c0 4.4 3.6 8 8 8h512c4.4 0 8-3.6 8-8v-32.3c0-17.7-14.3-32-32-32H548V734.5C665 721.8 758.4 630.2 773.8 514 852 501.6 912 433.7 912 352V204a44 44 0 00-44-44zM248 439.6c-37.1-11.9-64-46.7-64-87.6V232h64v207.6zM840 352c0 41-26.9 75.8-64 87.6V232h64v120z"}}]},name:"trophy",theme:"filled"};function Qe(){var s=w.useRef(!0);return s.current?(s.current=!1,!0):s.current}function We(s,t){return typeof s=="function"?s.length?s(t):s():s}function pe(s,t,o){if(t===void 0&&(t=10),t<1)throw new Error("Capacity has to be greater than 1, got '"+t+"'");var l=Qe(),u=w.useState(s),m=u[0],h=u[1],i=w.useRef([]),n=w.useRef(0);l&&(i.current.length?(i.current[i.current.length-1]!==s&&i.current.push(s),i.current.length>t&&(i.current=i.current.slice(i.current.length-t))):i.current.push(s),n.current=i.current.length&&i.current.length-1);var f=w.useCallback(function(a){h(function(c){return a=We(a,c),a!==c&&(n.current<i.current.length-1&&(i.current=i.current.slice(0,n.current+1)),n.current=i.current.push(a)-1,i.current.length>t&&(i.current=i.current.slice(i.current.length-t))),a})},[m,t]),d=w.useMemo(function(){return{history:i.current,position:n.current,capacity:t,back:function(a){a===void 0&&(a=1),n.current&&h(function(){return n.current-=Math.min(a,n.current),i.current[n.current]})},forward:function(a){a===void 0&&(a=1),n.current!==i.current.length-1&&h(function(){return n.current=Math.min(n.current+a,i.current.length-1),i.current[n.current]})},go:function(a){a!==n.current&&h(function(){return n.current=a<0?Math.max(i.current.length+a,0):Math.min(i.current.length-1,a),i.current[n.current]})}}},[m]);return[m,f,d]}var _e=function(t,o){return w.createElement(_,Y({},t,{ref:o,icon:Ue}))},Ye=w.forwardRef(_e),Xe=function(t,o){return w.createElement(_,Y({},t,{ref:o,icon:Ge}))},Je=w.forwardRef(Xe),Ke=function(t,o){return w.createElement(_,Y({},t,{ref:o,icon:Ve}))},oe=w.forwardRef(Ke);const J=(s,t,o)=>{const{reliabilityThreshold:l=4,projectionThreshold:u=55}={},h=`us-gb-${s.split("-")[1]}`,i=v.isEmpty(t[s])?[]:t[s];let n=0,f=0;i.forEach(E=>{E===3&&(n+=3),E===-3&&(f+=3),E===4&&(n+=4),E===-4&&(f+=4)});const d=i.filter(E=>![-4,-3,3,4].includes(E)),a=d.length+n+f,c=Math.max(a,5),g=i.filter(E=>E===1).length+n,b=Math.round(g/c*100),x=i.filter(E=>E===0).length+f,p=Math.round(x/c*100),y=Math.round((c-g-x)/c*100),k=d.length+n+f>=5,O=a>3,C=a>l,R=C?b>p?"üëç":"üëé":null,N=O?b>=u?"üëç":p>=u?"üëé":null:null;return{suspectCardId:s,imageId:h,enoughData:O,reliable:C,total:c,yesCount:g,yesPercentage:b,noCount:x,noPercentage:p,blankPercentage:y,complete:k,values:i,resolution:R,projection:N}};function Ze(s){const t=s.filter(u=>![0,1].includes(u)),o=s.filter(u=>[0,1].includes(u)),l={0:0,1:0};return o.forEach(u=>{if(l[u]===void 0)throw Error(`what is this value? ${u}`);l[u]+=1}),Object.entries(l).forEach(([u,m])=>{if(m>0){const h=Math.floor(m/4),i=m%4;for(let n=0;n<h;n++)t.push(u==="0"?-4:4);if(i>0){const n=Array.from({length:i},()=>u==="0"?0:1);t.push(...n)}}}),t.sort((u,m)=>u-m)}const Q=9,et=(s,t,o,l)=>{const[u]=Ee(Te.ESPIONAGEM,l),m=L("suspects",s),h=L(`testimony-questions-${t}`,s),i=L("testimony-answers",s),n=L("crime-reasons",s),f=w.useMemo(()=>nt(i.data),[i.data]),d=w.useMemo(()=>rt(m.data),[m.data]);return{entries:w.useMemo(()=>!u||!m.isSuccess||!h.isSuccess||!i.isSuccess||!n.isSuccess?{}:tt(o,u,m.data,h.data,f,d,n.data),[s,u,m,h,i,o,f,d,n]),isLoading:m.isLoading||h.isLoading||i.isLoading}},tt=(s,t,o,l,u,m,h)=>{console.count("Creating Espionagem...");let i=t.latestDate;const n=[],f={};for(let d=0;d<s;d++){const a=Ie(i);i=a;let c=null,r=0;for(;!c&&r<100;){r++;const g=st(o,l,u,m,n,h);if(at(g.statements)){c=g,console.log(`Generated valid game for ${a} after ${r} attempts`);break}}if(!c)throw new Error(`Failed to generate valid game for ${a} after 100 attempts`);n.push(c.culpritId),f[a]={id:a,type:"espionagem",number:t.latestNumber+d+1,...c}}return f};function st(s,t,o,l,u,m){let h=[];const i=[],n={},f=v.sample(Object.keys(o));if(!f)throw new Error("No selected testimony ID found");const d=Object.keys(o[f]).filter(C=>!u.includes(C)),a=d.length>0?d:Object.keys(o[f]),c=v.sample(a);if(!c)throw new Error("No selected culprit ID found");const r=v.sampleSize(Object.keys(o[f]).filter(C=>C!==c),Q-1);for(h.push(...r);h.length<8;){const C=v.sampleSize(Object.keys(s).filter(R=>!h.includes(R)&&R!==c),Q-h.length-1);h.push(...C)}const g={};Object.keys(l).forEach(C=>{if(l[C][c]===void 0){const R=Object.keys(l[C]).filter(N=>h.includes(N));if(R.length>0){const N={};R.forEach(E=>{h.includes(E)&&(N[E]=!0)}),g[C]=N}}});const b=t[f];i.push(ot(c,h,b,o[f])),A(n,i[0].excludes);const j=V(c,h,g);i.push(j),A(n,j.excludes),h=v.shuffle([...h,c]);const x=V(c,h,g,[j],"worst");i.push(x),A(n,x.excludes);const p=V(c,h,g,[j,x],"worst");i.push(p),A(n,p.excludes);const y=it(c,h,i);i.push(y),A(n,y.excludes);const k=[i[0],i[1],i[2],i[4],i[3]],O=lt(s[c],m);return{isNsfw:b.nsfw??!1,culpritId:c,statements:k,suspects:h.map(C=>s[C]),reason:O.title,setId:`${c}::${O.id}::${k[0].key}`,level:ut(k)}}const nt=s=>{const t={};console.log("‚öôÔ∏è Calculating suspect answers...");for(const o of Object.keys(s)){const l=s[o];for(const u of Object.keys(l)){const{resolution:m,projection:h}=J(u,l);if(!m&&!h){console.log("‚ÅâÔ∏è Ignoring testimony with no resolution or projection");continue}if(t[o]===void 0&&(t[o]={}),m){t[o][u]=m==="üëç";continue}if(h){t[o][u]=h==="üëç";continue}console.log("‚ÅâÔ∏è Ignoring testimony with not enough values")}}return Object.keys(t).forEach(o=>{v.isEmpty(t[o])&&delete t[o]}),Object.keys(t).forEach(o=>{Object.keys(t[o]).length<3&&(console.log("‚ÅâÔ∏è Removing testimonies with less than 3 answers"),delete t[o])}),Object.keys(t).forEach(o=>{v.uniq(Object.values(t[o])).length===1&&(console.log("‚ÅâÔ∏è Removing testimonies with the same answer"),delete t[o])}),t},rt=s=>{const t={};for(const l of Object.keys(s)){const{gender:u,ethnicity:m,age:h,build:i,height:n,features:f}=s[l];if(!i){console.log("‚ÅâÔ∏è Ignoring suspect with missing build",l);continue}if(!n){console.log("‚ÅâÔ∏è Ignoring suspect with missing height",l);continue}if(!f||f.length===0){console.log("‚ÅâÔ∏è Ignoring suspect with missing features",l);continue}t[u]===void 0&&(t[u]={}),t[u][l]=!0,t[m]===void 0&&(t[m]={}),t[m][l]=!0,t[h]===void 0&&(t[h]={}),t[h][l]=!0,t[i]===void 0&&(t[i]={}),t[i][l]=!0,t[n]===void 0&&(t[n]={}),t[n][l]=!0,f.forEach(d=>{t[d]===void 0&&(t[d]={}),t[d][l]=!0})}return t.young=v.cloneDeep(t["18-21"]),t.adult=v.cloneDeep({...t["21-30"],...t["30-40"],...t["40-50"]}),t.senior=v.cloneDeep({...t["50-60"],...t["60-70"],...t["70-80"],...t["80-90"]}),["18-21","21-30","30-40","40-50","50-60","60-70","70-80","80-90","average","medium","mixed","adult","tall"].forEach(l=>{delete t[l]}),t},A=(s,t)=>{t.forEach(o=>{s[o]===void 0&&(s[o]=0),s[o]++})},ot=(s,t,o,l)=>{const u=l[s],m=t.filter(n=>l[n]!==void 0&&l[n]!==u),h=o.answer.charAt(0).toLowerCase()+o.answer.slice(1),i={key:`testimony.${o.id}`,text:`O(a) suspeito(a) ${u?"":"n√£o "}${h}`,excludes:m};return i.text.includes("n√£o j√°")&&(i.text=i.text.replace("n√£o j√°","nunca")),i},U={row1:{indexes:[0,1,2],text:"na primeira linha"},row2:{indexes:[3,4,5],text:"na segunda linha"},row3:{indexes:[6,7,8],text:"na terceira linha"},column1:{indexes:[0,3,6],text:"na primeira coluna"},column2:{indexes:[1,4,7],text:"na segunda coluna"},column3:{indexes:[2,5,8],text:"na terceira coluna"},corners:{indexes:[0,2,6,8],text:"nos cantos"}},it=(s,t,o)=>{const l=t.indexOf(s),u=o.slice(0,3),m={};for(const a of Object.keys(U)){const{indexes:c}=U[a];c.includes(l)||(m[a]=c.reduce((r,g)=>{const b=t[g],j=u.filter(x=>x.excludes.includes(b)).length;return j>0?r+j:r},0))}const h=Object.entries(m).reduce((a,[c,r])=>(a[r]||(a[r]=[]),a[r].push(c),a),{}),i=Math.min(...Object.keys(m).map(a=>m[a])),n=h[i.toString()],f=v.sample(n)||Object.keys(m)[0],d=U[f].indexes.map(a=>t[a]);return{key:`not.grid.${f}`,text:`O(a) suspeito(a) n√£o est√° ${U[f].text}`,excludes:d}},V=(s,t,o,l=[],u="best")=>{const m=v.difference(t,[s]),h=l.filter(g=>g.key.startsWith("not.feature.")).map(g=>g.key.replace("not.feature.","")),i=new Set(l.flatMap(g=>g.excludes)),n=Object.keys(o).filter(g=>Object.keys(o[g]).length<=6&&!h.includes(g)).sort((g,b)=>Object.keys(o[b]).length-Object.keys(o[g]).length);let f,d=[],a=0;const c=500;for(;a<c;){a++;const g=u==="best"?n[0]:v.sample(n.slice(2,5))??n[2];if(!g)break;const b=m.filter(x=>o[g][x]);if(b.some(x=>!i.has(x))||a===c){f=g,d=b;break}n.splice(n.indexOf(g),1)}if(!f)throw Error(`No suitable feature found for ${u} selection after ${c} attempts`);console.log(`Selected feature after ${a} attempts: ${f}`);const r=ct[f];return r||console.warn(`Feature ${f} not found in translations`),{key:`not.feature.${f}`,text:`O(a) suspeito(a) n√£o ${r||f}`,excludes:d}},ct={male:"√© homem",female:"√© mulher",black:"√© negro(a)",white:"√© branco(a)",asian:"√© asi√°tico(a)",latino:"√© latino(a)",thin:"√© magrelo(a)",fat:"√© gordo(a)",large:"√© gordo(a)",tall:"√© alto(a)",short:"√© baixinho(a)",young:"√© jovem",adult:"√© adulto(a)",senior:"√© idoso(a)",average:"√© m√©dio(a)",medium:"√© m√©dio(a)",mixed:"√© mesti√ßo(a)",hat:"est√° usando um chap√©u",tie:"est√° usando uma gravata",glasses:"est√° usando √≥culos",brownHair:"tem cabelo castanho",shortHair:"tem cabelo curto",beard:"tem barba",caucasian:"√© caucasiano(a)",scarf:"est√° usando um cachecol",blondeHair:"tem cabelo loiro",longHair:"tem cabelo longo",greyHair:"tem cabelo grisalho",bald:"√© careca",mustache:"tem bigode",goatee:"tem cavanhaque",muscular:"√© sarado(a)",blackHair:"tem cabelo preto",hoodie:"est√° usando um moletom",earrings:"est√° usando brincos",lipstick:"est√° usando batom",necklace:"est√° usando um colar",mediumHair:"tem cabelo m√©dio","middle-eastern":"√© do Oriente M√©dio",headscarf:"est√° usando um len√ßo na cabe√ßa",redHair:"tem cabelo ruivo",piercings:"tem piercings",coloredHair:"tem cabelo colorido",indian:"√© indiano(a)","native-american":"√© nativo-americano(a)",noAccessories:"n√£o est√° usando acess√≥rios"},at=s=>{const t=s.slice(0,3);return t.reduce((u,m)=>u+m.excludes.length,0)<10?!1:new Set(t.flatMap(u=>u.excludes)).size===Q-1},lt=(s,t)=>{const o=[];Object.values(t).forEach(u=>{var m;u.feature==="general"&&o.push(u),(m=s.features)!=null&&m.includes(u.feature)&&o.push(u)});const l=v.sample(o);return l||{id:"unknown",title:{pt:"Motivo desconhecido",en:"Unknown reason"},feature:"general"}},ut=s=>{const t=s.slice(0,3),o=[],l={1:4,2:3,3:3,4:2,5:2,6:1,7:0,8:0};t.forEach(m=>{const h=m.excludes.length;l[h]!==void 0&&o.push(l[h])});const u=Math.round(o.reduce((m,h)=>m+h,0)/o.length);return Math.min(Math.max(u,1),3)};function dt(){const[s,t]=w.useState({batchSize:1,history:{}}),o=w.useRef(1),{entries:l}=et(!0,"pt",s.batchSize,s.history);return e.jsxs(S,{vertical:!0,gap:12,className:"p-4",children:[e.jsxs(S,{justify:"space-between",align:"center",children:[e.jsx(I.Title,{level:4,className:"my-0",children:"Espionagem Simulator"}),e.jsxs(S,{gap:6,children:[e.jsx(De,{min:1,max:7,defaultValue:1,onChange:u=>{o.current=u??1}}),e.jsx(T,{type:"primary",onClick:()=>t({batchSize:o.current,history:{}}),children:"Re-run Simulation"})]})]}),e.jsx(ht,{entries:l})]})}function ht({entries:s}){const[t,o]=w.useState(!1),l=Me(),u=s[l],m=w.useMemo(()=>u?u.statements.slice(0,3).reduce((h,i)=>{const{excludes:n}=i;return n.forEach(f=>{h[f]?h[f]++:h[f]=1}),h},{}):{},[u]);return e.jsxs("div",{className:"full-width grid grid-2",children:[e.jsx(ke,{src:s??{},theme:"twilight",collapsed:3}),u&&e.jsxs(S,{gap:18,className:"p-4",children:[e.jsx("div",{children:e.jsx("div",{style:{width:`${105*3}px`,display:"grid",gap:"6px",gridTemplateColumns:"repeat(3, 1fr)"},children:u.suspects.map(h=>e.jsxs(te.Ribbon,{text:t?m[h.id]:null,color:"cyan",children:[e.jsx($,{id:G(h.id,"gb"),width:96,className:ue(t&&h.id===u.culpritId&&"red-border")},h.id),e.jsxs(S,{gap:6,align:"center",children:[e.jsx(B,{checkedChildren:"üö´",size:"small"})," ",h.id]})]},h.id))})}),e.jsxs("div",{children:[e.jsx("div",{children:e.jsx(B,{checkedChildren:"Show Culprit",unCheckedChildren:"Hide Culprit",checked:t,onChange:o})}),u.statements.map((h,i)=>e.jsx(I.Paragraph,{children:e.jsx(te,{count:h.excludes.length,color:"cyan",children:e.jsx(je,{message:h.text,banner:!0,type:i<3?"info":"error"},h.key)})},h.key))]})]})]})}function xe({suspect:s,values:t,resolution:o,projection:l,yesPercentage:u,noPercentage:m,complete:h,enoughData:i,testimonyId:n,addEntryToUpdate:f,answers:d,barWidth:a,showName:c}){const r=x=>{const p={...d};p[x]=[...p[x]||[],3],f(n,p)},g=x=>{const p={...d};p[x]=[...p[x]||[],-3],f(n,p)},b=x=>{var k;const p={...d},y=(k=p[x])==null?void 0:k.findIndex(O=>O===3);y!==-1&&y!==void 0&&(p[x]=[...p[x].slice(0,y),...p[x].slice(y+1)]),f(n,p)},j=x=>{var k;const p={...d},y=(k=p[x])==null?void 0:k.findIndex(O=>O===-3);y!==-1&&y!==void 0&&(p[x]=[...p[x].slice(0,y),...p[x].slice(y+1)]),f(n,p)};return e.jsxs(be,{trigger:"click",title:`Add strong fit/unfit answer to ${s.name.pt}`,content:e.jsxs(S,{vertical:!0,gap:4,children:[e.jsx(I.Text,{type:"secondary",children:t.join(", ")}),e.jsxs(T,{icon:"üëç",block:!0,onClick:()=>r(s.id),children:[" ","Add strong fit"]}),e.jsxs(T,{icon:"üëé",block:!0,onClick:()=>g(s.id),children:[" ","Add strong unfit"]}),e.jsxs(z.Compact,{children:[e.jsx(T,{icon:"‚ùå",size:"small",block:!0,onClick:()=>b(s.id),children:"fit"}),e.jsx(T,{icon:"‚ùå",size:"small",block:!0,onClick:()=>j(s.id),children:"unfit"})]})]}),children:[c&&e.jsxs("div",{children:[e.jsx(F,{title:s.id,children:s.name.pt})," ",h&&e.jsx(F,{title:"Complete: It has 5 or more answers",children:e.jsx(oe,{style:{color:"gold"}})})]}),e.jsxs(S,{align:"flex-start",gap:12,children:[e.jsx(F,{title:`Values: ${t.join(", ")} : ${o||(l?`${l}*`:"")}`,children:i?e.jsx(se,{percent:m+u,size:[a,20],status:"exception",success:{percent:u},showInfo:!1}):e.jsx(se,{percent:m+u,size:[a,10],status:"exception",success:{percent:u},showInfo:!1})}),!c&&h&&e.jsx(F,{title:"Complete: It has 5 or more answers",children:e.jsx(oe,{style:{color:"gold"}})})]})]})}function mt({suspect:s,answersPerQuestion:t={},questions:o,addEntryToUpdate:l,allAnswers:u}){const{queryParams:m}=D({sortSuspectsBy:"answers"}),h=m.get("sortSuspectsBy")??"answers",i=w.useMemo(()=>{const f=Object.values(o).map(d=>{const a=t[d.id]??{},{enoughData:c,reliable:r,yesPercentage:g,noPercentage:b,blankPercentage:j,values:x,total:p,resolution:y,projection:k,complete:O}=J(s.id,{[s.id]:a});return{id:d.id,question:d,enoughData:c,reliable:r,yesPercentage:g,noPercentage:b,blankPercentage:j,values:x,total:p,resolution:y,projection:k,complete:O}});return h==="answers"?v.orderBy(f,["reliable","enoughData","yesPercentage",d=>d.values.length],["desc","desc","desc","desc"]):v.orderBy(f,d=>Number(d.id.split("-")[1]),["asc"])},[t,o,s.id,h]),n=[{key:"id",title:"Id",dataIndex:"id"},{key:"question",title:"Question",dataIndex:"question",render:f=>f.question},{key:"answer",title:"Answer",dataIndex:"id",sorter:(f,d)=>f.total-d.total,render:f=>{const d=i.find(a=>a.id===f);return d?e.jsx(S,{gap:8,wrap:"nowrap",children:e.jsx(xe,{values:d.values,resolution:d.resolution,projection:d.projection,yesPercentage:d.yesPercentage,noPercentage:d.noPercentage,complete:d.complete,enoughData:d.enoughData,suspect:s,testimonyId:d.question.id,answers:u[d.question.id]||{},addEntryToUpdate:l,barWidth:120})}):""}}];return e.jsx(z,{wrap:!0,size:"large",children:e.jsx(X,{rowKey:"id",columns:n,dataSource:i,bordered:!0})})}function ft({isLoading:s,isSuccess:t,questions:o,data:l,suspects:u,addEntryToUpdate:m}){const{queryParams:h,addParam:i}=D(),n=w.useMemo(()=>Object.keys(l).reduce((r,g)=>{const b=l[g]??{};return Object.keys(b).forEach(j=>{r[j]||(r[j]={}),r[j][g]=b[j]}),r},{}),[l]),f=w.useMemo(()=>v.orderBy(Object.values(u).map(r=>({...r,answers:n[r.id]})),r=>Number(r.id.split("-")[1]),"asc"),[u,n]),d=he({total:f.length,showQuickJumper:!0}),a=[{title:"Id",dataIndex:"id",key:"id",sorter:(r,g)=>Number(r.id.split("-")[1])-Number(g.id.split("-")[1])},{title:"Picture",dataIndex:"id",render:r=>e.jsx($,{id:G(r,"gb"),width:48})},{title:"Name",dataIndex:"name",key:"name",sorter:(r,g)=>r.name.pt.localeCompare(g.name.pt),render:r=>e.jsxs(S,{vertical:!0,children:[e.jsx(I.Text,{children:r.pt}),e.jsx(I.Text,{type:"secondary",children:r.en})]})},{title:"Questions Answered",dataIndex:"answers",key:"answers",sorter:(r,g)=>Object.keys(r.answers??{}).length-Object.keys(g.answers??{}).length,render:r=>r?Object.values(r).length:""}],c=de({maxExpandedRows:1,expandedRowRender:r=>e.jsx(mt,{suspect:r,answersPerQuestion:n[r.id],questions:o,addEntryToUpdate:m,allAnswers:l}),rowExpandable:()=>t});return e.jsxs(S,{gap:12,className:"full-width py-4",vertical:!0,children:[e.jsxs(S,{justify:"space-between",align:"center",children:[e.jsx(I.Title,{level:4,className:"my-0",children:"Testimonies by Suspect"}),e.jsx(B,{checked:h.get("sortSuspectsBy")==="answers",onChange:r=>i("sortSuspectsBy",r?"answers":"id"),checkedChildren:"Sort by Answers",unCheckedChildren:"Sort by Id"})]}),e.jsx(X,{columns:a,dataSource:f,pagination:d,rowKey:"id",expandable:c,loading:s,bordered:!0,className:"full-width"})]})}function gt({answers:s,suspects:t,addEntryToUpdate:o,testimonyId:l}){const[u,m]=Ae(12),{queryParams:h,is:i}=D({sortSuspectsBy:"answers"}),n=i("enableBatch"),f=h.get("sortSuspectsBy")??"answers",d=w.useMemo(()=>{const r=Object.keys(t).map(g=>J(g,s));return f==="answers"?v.orderBy(r,["reliable","enoughData",g=>g.values.length,"yesPercentage","noPercentage",g=>Number(g.suspectCardId.split("-")[1])],["desc","desc","desc","desc","desc","asc"]):v.orderBy(r,g=>Number(g.suspectCardId.split("-")[1]),["asc"])},[s,t,f]),[a,c]=w.useState([]);return e.jsxs(z,{direction:"vertical",children:[e.jsx(pt,{selection:a,setSelection:c,suspects:t,addEntryToUpdate:o,list:d,testimonyId:l,answers:s}),e.jsx(z,{wrap:!0,ref:m,size:"large",children:d.map(r=>e.jsxs(S,{vertical:!0,gap:6,className:ue({"selection-outline":n&&a.includes(r.suspectCardId)}),children:[e.jsx($,{id:r.imageId,width:u,className:r.values.length>1?void 0:"grayscale"}),e.jsxs(S,{gap:4,children:[n&&e.jsx(me,{disabled:r.complete,checked:a.includes(r.suspectCardId),onChange:g=>{const b=g.target.checked;c(j=>b?[...j,r.suspectCardId]:j.filter(x=>x!==r.suspectCardId))}}),e.jsx(xe,{values:r.values,resolution:r.resolution,projection:r.projection,yesPercentage:r.yesPercentage,noPercentage:r.noPercentage,complete:r.complete,enoughData:r.enoughData,suspect:t[r.suspectCardId],testimonyId:l,answers:s,addEntryToUpdate:o,barWidth:u,showName:!0})]})]},r.suspectCardId))})]})}function pt({testimonyId:s,selection:t,setSelection:o,suspects:l,addEntryToUpdate:u,list:m,answers:h}){const[i,n]=w.useState([]),{addParam:f,removeParam:d,is:a}=D({sortSuspectsBy:"answers"}),c=a("enableBatch"),r=j=>{n(x=>x.includes(j)?x.filter(p=>p!==j):[...x,j])},g=w.useMemo(()=>v.keyBy(m,"suspectCardId"),[m]);w.useEffect(()=>{if(i.length===0&&t.length>0){o([]);return}if(!i.length)return;const x=(t.length>0?t:Object.values(g).filter(p=>!p.complete&&!p.values.includes(3)&&!p.values.includes(-3)).map(p=>p.suspectCardId)).filter(p=>{const y=l[p],k=[y.gender,y.ethnicity,y.build,y.height];return y.age==="18-21"&&k.push("young"),(y.age==="21-30"||y.age==="30-40")&&k.push("adult"),y.age==="40-50"&&k.push("parent"),(y.age==="50-60"||y.age==="60-70"||y.age==="70-80"||y.age==="80-90")&&k.push("senior"),i.every(O=>k.includes(O))});o(x)},[i]);const b=j=>{const x=v.cloneDeep(h);t.forEach(p=>{x[p]=[...x[p]||[],j]}),u(s,x),n([])};return e.jsxs(S,{align:"center",gap:6,justify:"space-between",className:"mb-4",children:[e.jsxs(S,{gap:3,children:[e.jsx(I.Text,{className:"nowrap buceta",style:{minWidth:"5ch"},children:"Batch"}),e.jsx(B,{value:c,checkedChildren:"On",unCheckedChildren:"Off",onChange:j=>{j?f("enableBatch",!0):d("enableBatch")}})]}),c&&e.jsxs(e.Fragment,{children:[e.jsxs(I.Text,{className:"nowrap mr-2",children:["Selected ",t.length]}),e.jsxs(S,{gap:6,wrap:!0,align:"center",justify:"center",children:[e.jsx(M,{filter:"male",activeFilters:i,updateActiveFilter:r}),e.jsx(M,{filter:"female",activeFilters:i,updateActiveFilter:r}),e.jsx(M,{filter:"young",activeFilters:i,updateActiveFilter:r}),e.jsx(M,{filter:"adult",activeFilters:i,updateActiveFilter:r}),e.jsx(M,{filter:"parent",activeFilters:i,updateActiveFilter:r}),e.jsx(M,{filter:"senior",activeFilters:i,updateActiveFilter:r}),e.jsx(M,{filter:"thin",activeFilters:i,updateActiveFilter:r}),e.jsx(M,{filter:"muscular",activeFilters:i,updateActiveFilter:r}),e.jsx(M,{filter:"large",activeFilters:i,updateActiveFilter:r}),e.jsx(M,{filter:"asian",activeFilters:i,updateActiveFilter:r}),e.jsx(M,{filter:"black",activeFilters:i,updateActiveFilter:r}),e.jsx(M,{filter:"caucasian",activeFilters:i,updateActiveFilter:r}),e.jsx(M,{filter:"latino",activeFilters:i,updateActiveFilter:r})]}),e.jsxs(S,{align:"center",gap:6,children:[e.jsx(T,{onClick:()=>n([]),danger:!0,size:"small",children:"Clear"}),e.jsx(ne,{title:"Apply +3 to selected suspects?",onConfirm:()=>b(3),children:e.jsx(T,{disabled:t.length===0,size:"small",type:"primary",className:"ml-10",children:"Apply +3"})}),e.jsx(le,{type:"vertical"}),e.jsx(ne,{title:"Apply -3 to selected suspects?",onConfirm:()=>b(-3),children:e.jsx(T,{disabled:t.length===0,size:"small",type:"primary",children:"Apply -3"})})]})]})]})}function M({filter:s,activeFilters:t,updateActiveFilter:o}){return e.jsxs(e.Fragment,{children:[e.jsxs("span",{children:[e.jsx(me,{checked:t.includes(s),onClick:()=>o(s)})," ",v.capitalize(s)]}),e.jsx(le,{type:"vertical"})]})}function xt({data:s,questions:t,suspects:o,isLoading:l,isSuccess:u,addEntryToUpdate:m}){const{queryParams:h,addParam:i}=D(),n=w.useMemo(()=>v.orderBy(Object.values(t).map(c=>({...c,answersCount:Object.values(s[c.id]??{}).length})),c=>Number(c.id.split("-")[1]),"asc"),[t]),f=he({total:n.length,showQuickJumper:!0}),d=[{title:"Id",dataIndex:"id",key:"id",sorter:(c,r)=>Number(c.id.split("-")[1])-Number(r.id.split("-")[1])},{title:"Question",dataIndex:"question",key:"question",sorter:(c,r)=>c.question.localeCompare(r.question)},{title:"NSFW",dataIndex:"nsfw",key:"nsfw",render:c=>c?e.jsx(Fe,{style:{color:"hotPink"}}):"",sorter:(c,r)=>Number(c.nsfw)-Number(r.nsfw)},{title:"Answers",dataIndex:"answersCount",key:"answersCount",sorter:(c,r)=>c.answersCount-r.answersCount}],a=de({maxExpandedRows:1,expandedRowRender:c=>e.jsx(gt,{testimonyId:c.id,answers:s[c.id]??{},suspects:o,addEntryToUpdate:m}),rowExpandable:()=>u});return e.jsxs(S,{gap:12,className:"full-width py-4",vertical:!0,children:[e.jsxs(S,{justify:"space-between",align:"center",children:[e.jsx(I.Title,{level:4,className:"my-0",children:"Suspects by Testimony"}),e.jsx(B,{checked:h.get("sortSuspectsBy")==="answers",onChange:c=>i("sortSuspectsBy",c?"answers":"id"),checkedChildren:"Sort by Answers",unCheckedChildren:"Sort by Id"})]}),e.jsx(X,{columns:d,dataSource:n,pagination:f,rowKey:"id",expandable:a,loading:l,bordered:!0,className:"full-width"})]})}function jt(s){const{queryParams:t,is:o}=D();return e.jsxs(e.Fragment,{children:[(o("display","questions")||!t.get("display"))&&e.jsx(xt,{...s}),o("display","suspects")&&e.jsx(ft,{...s}),o("display","simulator")&&e.jsx(dt,{})]})}const bt="Left",yt="Right",wt="Up",vt="Down",P={delta:10,preventScrollOnSwipe:!1,rotationAngle:0,trackMouse:!1,trackTouch:!0,swipeDuration:1/0,touchEventOptions:{passive:!0}},W={first:!0,initial:[0,0],start:0,swiping:!1,xy:[0,0]},ie="mousemove",ce="mouseup",St="touchend",kt="touchmove",Ot="touchstart";function Ct(s,t,o,l){return s>t?o>0?yt:bt:l>0?vt:wt}function ae(s,t){if(t===0)return s;const o=Math.PI/180*t,l=s[0]*Math.cos(o)+s[1]*Math.sin(o),u=s[1]*Math.cos(o)-s[0]*Math.sin(o);return[l,u]}function Et(s,t){const o=d=>{const a="touches"in d;a&&d.touches.length>1||s((c,r)=>{r.trackMouse&&!a&&(document.addEventListener(ie,l),document.addEventListener(ce,h));const{clientX:g,clientY:b}=a?d.touches[0]:d,j=ae([g,b],r.rotationAngle);return r.onTouchStartOrOnMouseDown&&r.onTouchStartOrOnMouseDown({event:d}),Object.assign(Object.assign(Object.assign({},c),W),{initial:j.slice(),xy:j,start:d.timeStamp||0})})},l=d=>{s((a,c)=>{const r="touches"in d;if(r&&d.touches.length>1)return a;if(d.timeStamp-a.start>c.swipeDuration)return a.swiping?Object.assign(Object.assign({},a),{swiping:!1}):a;const{clientX:g,clientY:b}=r?d.touches[0]:d,[j,x]=ae([g,b],c.rotationAngle),p=j-a.xy[0],y=x-a.xy[1],k=Math.abs(p),O=Math.abs(y),C=(d.timeStamp||0)-a.start,R=Math.sqrt(k*k+O*O)/(C||1),N=[p/(C||1),y/(C||1)],E=Ct(k,O,p,y),K=typeof c.delta=="number"?c.delta:c.delta[E.toLowerCase()]||P.delta;if(k<K&&O<K&&!a.swiping)return a;const H={absX:k,absY:O,deltaX:p,deltaY:y,dir:E,event:d,first:a.first,initial:a.initial,velocity:R,vxvy:N};H.first&&c.onSwipeStart&&c.onSwipeStart(H),c.onSwiping&&c.onSwiping(H);let Z=!1;return(c.onSwiping||c.onSwiped||c[`onSwiped${E}`])&&(Z=!0),Z&&c.preventScrollOnSwipe&&c.trackTouch&&d.cancelable&&d.preventDefault(),Object.assign(Object.assign({},a),{first:!1,eventData:H,swiping:!0})})},u=d=>{s((a,c)=>{let r;if(a.swiping&&a.eventData){if(d.timeStamp-a.start<c.swipeDuration){r=Object.assign(Object.assign({},a.eventData),{event:d}),c.onSwiped&&c.onSwiped(r);const g=c[`onSwiped${r.dir}`];g&&g(r)}}else c.onTap&&c.onTap({event:d});return c.onTouchEndOrOnMouseUp&&c.onTouchEndOrOnMouseUp({event:d}),Object.assign(Object.assign(Object.assign({},a),W),{eventData:r})})},m=()=>{document.removeEventListener(ie,l),document.removeEventListener(ce,h)},h=d=>{m(),u(d)},i=(d,a)=>{let c=()=>{};if(d&&d.addEventListener){const r=Object.assign(Object.assign({},P.touchEventOptions),a.touchEventOptions),g=[[Ot,o,r],[kt,l,Object.assign(Object.assign({},r),a.preventScrollOnSwipe?{passive:!1}:{})],[St,u,r]];g.forEach(([b,j,x])=>d.addEventListener(b,j,x)),c=()=>g.forEach(([b,j])=>d.removeEventListener(b,j))}return c},f={ref:d=>{d!==null&&s((a,c)=>{if(a.el===d)return a;const r={};return a.el&&a.el!==d&&a.cleanUpTouch&&(a.cleanUpTouch(),r.cleanUpTouch=void 0),c.trackTouch&&d&&(r.cleanUpTouch=i(d,c)),Object.assign(Object.assign(Object.assign({},a),{el:d}),r)})}};return t.trackMouse&&(f.onMouseDown=o),[f,i]}function Tt(s,t,o,l){return!t.trackTouch||!s.el?(s.cleanUpTouch&&s.cleanUpTouch(),Object.assign(Object.assign({},s),{cleanUpTouch:void 0})):s.cleanUpTouch?t.preventScrollOnSwipe!==o.preventScrollOnSwipe||t.touchEventOptions.passive!==o.touchEventOptions.passive?(s.cleanUpTouch(),Object.assign(Object.assign({},s),{cleanUpTouch:l(s.el,t)})):s:Object.assign(Object.assign({},s),{cleanUpTouch:l(s.el,t)})}function It(s){const{trackMouse:t}=s,o=w.useRef(Object.assign({},W)),l=w.useRef(Object.assign({},P)),u=w.useRef(Object.assign({},l.current));u.current=Object.assign({},l.current),l.current=Object.assign(Object.assign({},P),s);let m;for(m in P)l.current[m]===void 0&&(l.current[m]=P[m]);const[h,i]=w.useMemo(()=>Et(n=>o.current=n(o.current,l.current),{trackMouse:t}),[t]);return o.current=Tt(o.current,l.current,u.current,i),h}function Mt(s){const{addParam:t}=D();return e.jsxs(S,{vertical:!0,gap:8,children:[e.jsx(T,{onClick:()=>t("testify","single"),block:!0,children:"Testify Drawer"}),e.jsx(T,{onClick:()=>t("testify","group"),block:!0,children:"Testify Group"}),e.jsx(Dt,{...s}),e.jsx(Rt,{...s})]})}function Dt({suspects:s,questions:t,answers:o,addEntryToUpdate:l}){var x;const{width:u,height:m}=fe(),{is:h,removeParam:i}=D(),[n,f,d]=pe(),a=It({onSwipedLeft:()=>alert("Swiped Left"),onSwipedRight:()=>alert("Swiped Right"),onSwipedUp:()=>alert("Swiped Up"),preventScrollOnSwipe:!0,trackTouch:!0,trackMouse:!0}),c=()=>{f({suspectId:v.sample(Object.keys(s))||null,testimonyId:v.sample(Object.keys(t))||null})},r=()=>{c()},g=()=>{if(n!=null&&n.suspectId&&(n!=null&&n.testimonyId)){const p=v.cloneDeep(o[(n==null?void 0:n.testimonyId)??""]??{});p[n.suspectId]=[...p[n.suspectId]||[],1],l(n.testimonyId??"",p),c()}},b=()=>{if(n!=null&&n.suspectId&&(n!=null&&n.testimonyId)){const p=v.cloneDeep(o[(n==null?void 0:n.testimonyId)??""]??{});p[n.suspectId]=[...p[n.suspectId]||[],0],l(n.testimonyId??"",p),c()}},j=!!(n!=null&&n.suspectId)&&!!(n!=null&&n.testimonyId);return e.jsx(ge,{title:e.jsx(I,{children:"Does this person do this??"}),open:h("testify","single"),onCancel:()=>i("testify"),maskClosable:!1,width:u-64,footer:null,children:e.jsxs("div",{...a,children:[j&&e.jsxs(S,{vertical:!0,gap:8,className:"mb-8",justify:"center",align:"center",children:[e.jsx($,{id:G(n.suspectId??"","gb"),width:Math.max(m/4,128)}),e.jsx(I.Title,{level:5,className:"text-center",children:(x=t[n.testimonyId??""])==null?void 0:x.question})]}),e.jsxs(z.Compact,{block:!0,size:"large",className:"mb-8",children:[e.jsx(T,{block:!0,icon:"üëé",disabled:!j,style:{height:64},onClick:b,children:"No"}),e.jsx(T,{block:!0,onClick:r,style:{height:64},children:"Skip"}),e.jsx(T,{block:!0,icon:"üëç",iconPosition:"end",disabled:!j,style:{height:64},onClick:g,children:"Yes"})]})]})})}function Rt({suspects:s,questions:t,answers:o,addEntryToUpdate:l}){var g;const{width:u,height:m}=fe(),{is:h,removeParam:i}=D(),[n,f,d]=pe(),a=()=>{var j;const b=(j=v.sampleSize(Object.keys(s),6))==null?void 0:j.reduce((x,p)=>(x[p]=null,x),{});f({suspectsIds:b,testimonyId:v.sample(Object.keys(t))||null})};ye(()=>a());const c=()=>{const b=Object.entries((n==null?void 0:n.suspectsIds)??{}).reduce((j,[x,p])=>(p!==null&&(j[x]=[p]),j),{});if(n!=null&&n.testimonyId&&Object.keys(b).length>0){const j=v.cloneDeep(o[n.testimonyId]??{});Object.entries(b).forEach(([x,p])=>{j[x]=[...j[x]||[],...p]}),l(n.testimonyId,j)}else console.log("No testimonyId or no judged suspects found, likely skipped");a()},r=!!(n!=null&&n.suspectsIds)&&!!(n!=null&&n.testimonyId);return e.jsx(ge,{title:e.jsx(I,{children:"Do these people do this??"}),open:h("testify","group"),onCancel:()=>i("testify"),maskClosable:!1,width:u-64,footer:null,children:e.jsxs("div",{children:[r&&e.jsxs(S,{vertical:!0,gap:8,className:"mb-8",justify:"center",align:"center",children:[e.jsx(I.Title,{level:4,className:"text-center",children:(g=t[n.testimonyId??""])==null?void 0:g.question}),e.jsx(S,{wrap:"wrap",justify:"center",gap:8,children:Object.keys(n.suspectsIds).map(b=>{var j,x;return e.jsxs(S,{justify:"center",align:"center",vertical:!0,children:[e.jsx(I.Text,{className:"text-center",children:((x=(j=s[b])==null?void 0:j.name)==null?void 0:x.pt)||"Unknown"}),e.jsx($,{id:G(b,"gb"),width:Math.min(Math.max(m/3,128),128)},b),e.jsx(Re,{shape:"round",size:"large",value:n.suspectsIds[b],onChange:p=>f(y=>y&&{...y,suspectsIds:{...y.suspectsIds,[b]:p}}),options:[{value:0,icon:"üëé"},{value:null,icon:"‚ôæ"},{value:1,icon:"üëç"}]})]},b)})})]}),e.jsx(S,{justify:"flex-end",children:e.jsx(T,{onClick:c,size:"large",children:"Next Set"})})]})})}function Nt({suspects:s,questions:t,data:o,hasNewData:l,isDirty:u,save:m,isSaving:h,entriesToUpdate:i,addEntryToUpdate:n}){const{queryParams:f,addParams:d}=D(),a=w.useMemo(()=>{const c={};return Object.values(o).forEach(r=>{Object.keys(r).forEach(g=>{r[g]&&(c[g]||(c[g]=0),Oe(r[g])>=5&&(c[g]+=1))})}),{queriedTestimoniesCount:Object.keys(o).length,suspectsCount:Object.keys(c).length,reliableSuspectsCount:Object.values(c).filter(r=>r>=5).length}},[o]);return e.jsxs(e.Fragment,{children:[e.jsx(q,{children:e.jsxs(S,{vertical:!0,gap:12,children:[e.jsx(Be,{isDirty:u,onSave:m,isSaving:h,dirt:JSON.stringify(i)}),e.jsx(Pe,{data:async()=>await Pt(o),fileName:"testimony-answers.json",disabled:u,hasNewData:l,block:!0}),e.jsx(re,{path:"data/testimonies",className:"text-center",label:"Firestore Data"}),e.jsx(re,{path:"tdr/testimonies",className:"text-center",label:"Firestore TDR"})]})}),e.jsx(q,{children:e.jsx(Ne,{label:"Display",value:f.get("display")??"questions",onChange:c=>d({display:c,page:1},{page:1}),options:[{title:"Questions",icon:e.jsx(qe,{}),value:"questions"},{title:"Suspects",icon:e.jsx(Ye,{}),value:"suspects"},{title:"Simulator",icon:e.jsx(Je,{}),value:"simulator"}]})}),e.jsx(q,{children:e.jsxs("div",{style:{fontSize:"0.85em"},children:[e.jsx("strong",{children:"Legend"}),e.jsxs("ul",{children:[e.jsx("li",{children:"Reliability: At least 5 votes"}),e.jsx("li",{children:"Large Bars: There's enough data (at least 3)"}),e.jsx("li",{children:"Small blue bar: in progress negative"})]})]})}),e.jsxs(q,{children:[e.jsxs("div",{style:{fontSize:"0.85em"},children:[e.jsx("strong",{children:"Counts"}),e.jsxs("ul",{children:[e.jsxs("li",{children:["Testimonies: ",a.queriedTestimoniesCount]}),e.jsxs("li",{children:["Suspects: ",a.suspectsCount]}),e.jsx("li",{children:e.jsxs(F,{title:"A reliable suspect is one that has at least 5 complete testimonies.",children:["Reliable suspects: ",a.reliableSuspectsCount]})})]})]}),e.jsx(Mt,{suspects:s,questions:t,answers:o,addEntryToUpdate:n})]})]})}async function Pt(s){console.log("Preparing file for download...x");const t=await ze("data","testimonies")(),o=$e(t);console.log("Parsed data from Firestore:",o);const l=v.cloneDeep(s);return Object.keys(l).forEach(u=>{const m=l[u],h=o[u]||{};Object.keys(m).forEach(i=>{const n=h[i]||[],f=Ze([...m[i],...n]);m[i]=f})}),He(Le(l))}function Es(){const s=Ce();return e.jsx(we,{title:"Testimonies",subtitle:"Suspect Testimony Rates",children:e.jsxs(ee,{hasSider:!0,children:[e.jsx(Se,{children:e.jsx(Nt,{...s})}),e.jsx(ee.Content,{className:"content",children:e.jsx(ve,{isLoading:s.isLoading,error:s.error,hasResponseData:!v.isEmpty(s.data),children:e.jsx(jt,{...s})})})]})})}export{Es as TestimoniesPage,Es as default};
