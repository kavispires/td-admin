import{r as x,a as $,_ as Q,j as n,T as V,B as _,a2 as se,a4 as ne,aT as we,at as S,ao as Oe,D as Ne,a1 as Te,a0 as Le,a3 as ce,P as Me,L as de}from"./index-B2IufO9d.js";import{u as pe}from"./useQueryParams-VqzV2bcM.js";import{R as he}from"./main-SPLBb4Wq.js";import{a as Re,C as ke,u as fe}from"./useArteRuimDrawings-BM7UEc7A.js";import{u as ge}from"./useMutation-CkGQIDSr.js";import{g as Ge,u as Ue}from"./useGetFirestoreDoc-jzQcL3mM.js";import{h as R}from"./moment-C5S46NFB.js";import{a as ae,m as Ye,r as xe,k as Pe}from"./index-DYbc2yc2.js";import{F as v}from"./index-eN_YjmO0.js";import{S as G}from"./index-BLdWx9a_.js";import{I as ie}from"./index-C-QvqMpR.js";import{T as _e,a as ee,F as Ve}from"./FilterEntries-CE--5qSd.js";import{T as q}from"./index-CvojYiF0.js";import{S as qe}from"./index-B7k7fINJ.js";import{F as oe}from"./FirestoreConsoleLink-DH7HBbY1.js";import{C as je}from"./CopyToClipboardButton-DxKMly8v.js";import{I as te}from"./ImageCard-BfJJolCP.js";import{f as Fe,W as $e,d as Y,g as le}from"./constants-D-ibECRI.js";import{I as P}from"./Item-CrTB72Il.js";import{S as Qe,g as Ie}from"./SuspectImageCard-Cr9WjOVJ.js";import{l as m,P as He}from"./useBaseUrl-Df4Xj3M9.js";import{g as Be,u as k,D as I,a as U,c as H,A as We,b as Ke,L as ye}from"./useParsedHistory-BLAYCUDo.js";import{R as ze,a as Je}from"./Pagination-9MrbEQqq.js";import{F as ve}from"./Table-C7k__y5r.js";import{D as Ze}from"./DataLoadingWrapper-Te6tcY9j.js";import{u as L}from"./useTDResource-BRz6Jgmi.js";import{a as B,c as Xe,u as et,b as tt}from"./daily-quartetos-McJxFiEZ.js";import{c as st,u as nt}from"./useTestimoniesResource-DcHEqh_j.js";import{u as re}from"./useLoadWordLibrary-5LXhmvLK.js";import{u as at}from"./daily-teoria-de-conjuntos-C_DkITW4.js";import{u as De}from"./useDailyHistoryQuery-Nm_FMax8.js";import{R as rt}from"./SaveOutlined-BnCMkMIP.js";import{S as ue}from"./SiderContent--y26S5J7.js";import"./gapSize-U1swVQyS.js";import"./Input-DZDlQFp6.js";import"./index-BFp_qQ_m.js";import"./index-CzBdkirf.js";import"./index-Bj41O2Wl.js";import"./index-BZKIKlfR.js";import"./useCopyToClipboardFunction-BXltBBgx.js";import"./index-CHU5UCpw.js";import"./index-DxGPxIRU.js";import"./scrollTo-CViIWZ5G.js";import"./useResourceFirestoreData-Ct9dRA7e.js";import"./useUpdateFirestoreDoc-PVwR-GEv.js";var it={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M880 184H712v-64c0-4.4-3.6-8-8-8h-56c-4.4 0-8 3.6-8 8v64H384v-64c0-4.4-3.6-8-8-8h-56c-4.4 0-8 3.6-8 8v64H144c-17.7 0-32 14.3-32 32v664c0 17.7 14.3 32 32 32h736c17.7 0 32-14.3 32-32V216c0-17.7-14.3-32-32-32zm-40 656H184V460h656v380zM184 392V256h128v48c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8v-48h256v48c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8v-48h128v136H184z"}}]},name:"calendar",theme:"outlined"},ot=function(r,a){return x.createElement($,Q({},r,{ref:a,icon:it}))},lt=x.forwardRef(ot),ct={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M811.4 368.9C765.6 248 648.9 162 512.2 162S258.8 247.9 213 368.8C126.9 391.5 63.5 470.2 64 563.6 64.6 668 145.6 752.9 247.6 762c4.7.4 8.7-3.3 8.7-8v-60.4c0-4-3-7.4-7-7.9-27-3.4-52.5-15.2-72.1-34.5-24-23.5-37.2-55.1-37.2-88.6 0-28 9.1-54.4 26.2-76.4 16.7-21.4 40.2-36.9 66.1-43.7l37.9-10 13.9-36.7c8.6-22.8 20.6-44.2 35.7-63.5 14.9-19.2 32.6-36 52.4-50 41.1-28.9 89.5-44.2 140-44.2s98.9 15.3 140 44.3c19.9 14 37.5 30.8 52.4 50 15.1 19.3 27.1 40.7 35.7 63.5l13.8 36.6 37.8 10c54.2 14.4 92.1 63.7 92.1 120 0 33.6-13.2 65.1-37.2 88.6-19.5 19.2-44.9 31.1-71.9 34.5-4 .5-6.9 3.9-6.9 7.9V754c0 4.7 4.1 8.4 8.8 8 101.7-9.2 182.5-94 183.2-198.2.6-93.4-62.7-172.1-148.6-194.9z"}},{tag:"path",attrs:{d:"M376.9 656.4c1.8-33.5 15.7-64.7 39.5-88.6 25.4-25.5 60-39.8 96-39.8 36.2 0 70.3 14.1 96 39.8 1.4 1.4 2.7 2.8 4.1 4.3l-25 19.6a8 8 0 003 14.1l98.2 24c5 1.2 9.9-2.6 9.9-7.7l.5-101.3c0-6.7-7.6-10.5-12.9-6.3L663 532.7c-36.6-42-90.4-68.6-150.5-68.6-107.4 0-195 85.1-199.4 191.7-.2 4.5 3.4 8.3 8 8.3H369c4.2-.1 7.7-3.4 7.9-7.7zM703 664h-47.9c-4.2 0-7.7 3.3-8 7.6-1.8 33.5-15.7 64.7-39.5 88.6-25.4 25.5-60 39.8-96 39.8-36.2 0-70.3-14.1-96-39.8-1.4-1.4-2.7-2.8-4.1-4.3l25-19.6a8 8 0 00-3-14.1l-98.2-24c-5-1.2-9.9 2.6-9.9 7.7l-.4 101.4c0 6.7 7.6 10.5 12.9 6.3l23.2-18.2c36.6 42 90.4 68.6 150.5 68.6 107.4 0 195-85.1 199.4-191.7.2-4.5-3.4-8.3-8-8.3z"}}]},name:"cloud-sync",theme:"outlined"},dt=function(r,a){return x.createElement($,Q({},r,{ref:a,icon:ct}))},ut=x.forwardRef(dt),mt={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M518.3 459a8 8 0 00-12.6 0l-112 141.7a7.98 7.98 0 006.3 12.9h73.9V856c0 4.4 3.6 8 8 8h60c4.4 0 8-3.6 8-8V613.7H624c6.7 0 10.4-7.7 6.3-12.9L518.3 459z"}},{tag:"path",attrs:{d:"M811.4 366.7C765.6 245.9 648.9 160 512.2 160S258.8 245.8 213 366.6C127.3 389.1 64 467.2 64 560c0 110.5 89.5 200 199.9 200H304c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8h-40.1c-33.7 0-65.4-13.4-89-37.7-23.5-24.2-36-56.8-34.9-90.6.9-26.4 9.9-51.2 26.2-72.1 16.7-21.3 40.1-36.8 66.1-43.7l37.9-9.9 13.9-36.6c8.6-22.8 20.6-44.1 35.7-63.4a245.6 245.6 0 0152.4-49.9c41.1-28.9 89.5-44.2 140-44.2s98.9 15.3 140 44.2c19.9 14 37.5 30.8 52.4 49.9 15.1 19.3 27.1 40.7 35.7 63.4l13.8 36.5 37.8 10C846.1 454.5 884 503.8 884 560c0 33.1-12.9 64.3-36.3 87.7a123.07 123.07 0 01-87.6 36.3H720c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h40.1C870.5 760 960 670.5 960 560c0-92.7-63.1-170.7-148.6-193.3z"}}]},name:"cloud-upload",theme:"outlined"},pt=function(r,a){return x.createElement($,Q({},r,{ref:a,icon:mt}))},ht=x.forwardRef(pt),ft={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M832 64H192c-17.7 0-32 14.3-32 32v832c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V96c0-17.7-14.3-32-32-32zm-40 824H232V687h97.9c11.6 32.8 32 62.3 59.1 84.7 34.5 28.5 78.2 44.3 123 44.3s88.5-15.7 123-44.3c27.1-22.4 47.5-51.9 59.1-84.7H792v-63H643.6l-5.2 24.7C626.4 708.5 573.2 752 512 752s-114.4-43.5-126.5-103.3l-5.2-24.7H232V136h560v752zM320 341h384c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8H320c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8zm0 160h384c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8H320c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8z"}}]},name:"container",theme:"outlined"},gt=function(r,a){return x.createElement($,Q({},r,{ref:a,icon:ft}))},xt=x.forwardRef(gt),jt={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M396 512a112 112 0 10224 0 112 112 0 10-224 0zm546.2-25.8C847.4 286.5 704.1 186 512 186c-192.2 0-335.4 100.5-430.2 300.3a60.3 60.3 0 000 51.5C176.6 737.5 319.9 838 512 838c192.2 0 335.4-100.5 430.2-300.3 7.7-16.2 7.7-35 0-51.5zM508 688c-97.2 0-176-78.8-176-176s78.8-176 176-176 176 78.8 176 176-78.8 176-176 176z"}}]},name:"eye",theme:"filled"},It=function(r,a){return x.createElement($,Q({},r,{ref:a,icon:jt}))},yt=x.forwardRef(It);function vt(){const[t,r]=x.useState(""),[a,i]=x.useState(7),[e,s]=x.useState(!1),[o,l]=x.useState(!1),[c,d]=x.useState(""),{isLoading:p,isError:u,data:g}=Dt(t,a,o),h=y=>{s(!1),l(!1),r(y.trim())},j=y=>{l(!1),i(y)},C=()=>{const y=R(t,"YYYY-MM-DD",!0).isValid();s(y),l(y)},E=x.useMemo(()=>{if(!g||Object.keys(g).length===0)return{};if(!c)return g;const y=c;if(!Object.values(g).every(D=>D==null?void 0:D[y]))return g;const M={};return Object.values(g).forEach(D=>{const f=D==null?void 0:D[y],b=f==null?void 0:f.number;M[b]&&console.error(`Duplicate entry for game ${y} with number ${b}`),M[b]=ae(f,["number","language","text"])}),M},[g,c]);return n.jsxs("div",{children:[n.jsx(V.Title,{level:2,children:"Data Archive"}),n.jsxs(v,{align:"center",className:"mb-6",justify:"space-between",children:[n.jsxs(v,{align:"center",gap:12,children:[n.jsxs(G.Compact,{children:[n.jsx(ie,{onChange:y=>h(y.target.value),placeholder:"YYYY-MM-DD",value:t}),n.jsx(_e,{max:100,min:1,onChange:y=>j(y??1),value:a}),n.jsx(_,{disabled:!t||!R(t,"YYYY-MM-DD",!0).isValid(),onClick:C,type:"primary",children:"Load"})]}),t&&n.jsxs("span",{children:[n.jsx(q,{children:t}),a>1&&n.jsxs(n.Fragment,{children:["to"," ",n.jsx(q,{children:R(t).add(a-1,"days").format("YYYY-MM-DD")})]})]}),n.jsx("span",{children:n.jsx(q,{color:p?"blue":u?"red":e?"green":"gray",children:p?"Loading...":u?"Error":e?"Valid":"Ready"})})]}),n.jsxs(v,{align:"center",gap:12,children:[n.jsx(bt,{}),n.jsx(qe,{allowClear:!0,onChange:y=>d(y),options:[{value:"",label:"All games"},{value:"aqui-o",label:"Aqui Ã“"},{value:"arte-ruim",label:"Arte Ruim"},{value:"artista",label:"Artista"},{value:"comunicacao-alienigena",label:"ComunicaÃ§Ã£o AlienÃ­gena"},{value:"controle-de-estoque",label:"Controle de Estoque"},{value:"filmaco",label:"FilmaÃ§o"},{value:"palavreado",label:"Palavreado"},{value:"portais-magicos",label:"Portais MÃ¡gicos"},{value:"quartetos",label:"Quartetos"},{value:"ta-na-cara",label:"TÃ¡ na Cara"},{value:"teoria-de-conjuntos",label:"Teoria de Conjuntos"}],placeholder:"Filter by game",style:{width:200}})]})]}),n.jsx(he,{collapsed:1,src:E,theme:"twilight"})]})}const Dt=(t,r,a)=>{const i=x.useMemo(()=>{if(!a||!R(t,"YYYY-MM-DD",!0).isValid())return[];const c=[],d=R(t);for(let p=0;p<r;p++){const u=d.clone().add(p,"days").format("YYYY-MM-DD");c.push({queryKey:["firebase","diario",u],queryFn:Ge("diario",u),enabled:!0})}return c},[t,r,a]),e=Re({queries:i}),s=e.some(c=>c.isLoading),o=e.some(c=>c.isError),l=x.useMemo(()=>s||o?{}:e.reduce((c,d,p)=>{if(d.data&&Object.keys(d.data).length>0){const u=R(t).add(p,"days").format("YYYY-MM-DD");c[u]=d.data}return c},{}),[e,t,s,o]);return{isLoading:s,isError:o,data:l,results:e}};function bt(){const t=ge({mutationFn:async()=>{const r="2024-01-01",a="2024-04-30";try{const i=R(r),e=R(a);for(let s=0;s<=e.diff(i,"days");s++){const o=i.clone().add(s,"days").format("YYYY-MM-DD"),l=se(ne,"diario",o);await we(l)}}catch(i){throw new Error(i)}},onError:r=>{console.error("Error deleting documents:",r)},onSuccess:()=>{console.log(" Documents deleted successfully")}});return n.jsx(_,{danger:!0,disabled:!0,loading:t.isPending,onClick:()=>t.mutate(),children:"Delete secured documents"})}function w({children:t}){return n.jsx(G,{direction:"vertical",style:{maxWidth:120},children:t})}function O({children:t}){return n.jsxs(q,{color:"cyan",children:["#",t]})}function A({label:t,children:r}){return n.jsxs(V.Text,{children:[n.jsxs("strong",{children:[t,":"]})," ",r]})}function N({children:t,entry:r}){return n.jsx(Oe,{content:t,title:n.jsxs(v,{justify:"space-between",children:[n.jsx(V.Text,{children:"Sneak Peek"}),n.jsx(je,{content:JSON.stringify(r)})]}),trigger:"click",children:n.jsx(_,{icon:n.jsx(yt,{})})})}const be=[{title:"Id",dataIndex:"id",key:"id",fixed:"left"},{title:"Arte Ruim",dataIndex:"arte-ruim",key:"arte-ruim",render:t=>{if(!t)return n.jsx(S,{message:"No entry",type:"error"});const{number:r,cardId:a,text:i,drawings:e}=t;return n.jsxs(w,{children:[n.jsx(O,{children:r}),n.jsx(A,{label:"CardId",children:a}),n.jsx(A,{label:"Drawings",children:e.length}),n.jsx(N,{entry:t,children:n.jsxs(v,{gap:6,vertical:!0,children:[n.jsxs("div",{children:['"',i.split("").map((s,o)=>o<2||s===" "?s:"â¹").join(""),'"']}),n.jsx(G,{wrap:!0,children:e.map(s=>n.jsx(ke,{className:"canvas",drawing:s,height:75,width:75},s))})]})})]})}},{title:"Aqui O",dataIndex:"aqui-o",key:"aqui-o",render:t=>{if(!t)return n.jsx(S,{message:"No entry",type:"error"});const{number:r,setId:a,title:i,itemsIds:e}=t;return n.jsxs(w,{children:[n.jsx(O,{children:r}),n.jsx(A,{label:"SetId",children:a}),n.jsx(A,{label:"Title",children:i.pt}),n.jsx(A,{label:"Items",children:e.length}),n.jsx(N,{entry:t,children:n.jsx(v,{gap:6,style:{maxWidth:500},wrap:!0,children:e.map(s=>n.jsx(P,{id:s,width:48},s))})})]})}},{title:"AlienÃ­gena",dataIndex:"comunicacao-alienigena",key:"comunicacao-alienigena",render:t=>{if(!t)return n.jsx(S,{message:"No entry",type:"error"});const{number:r,itemsIds:a,attributes:i}=t;return n.jsxs(w,{children:[n.jsx(O,{children:r}),n.jsx(A,{label:"Items",children:a.length}),n.jsx(N,{entry:t,children:n.jsxs(v,{gap:6,style:{maxWidth:"300px"},vertical:!0,children:[n.jsx(G,{wrap:!0,children:i.map(e=>n.jsx(Fe,{id:`sign-${e.spriteId}`,width:48},e.spriteId))}),n.jsx(G,{wrap:!0,children:a.map(e=>n.jsx(P,{id:e,width:48},e))})]})})]})}},{title:"Conjuntos",dataIndex:"teoria-de-conjuntos",key:"teoria-de-conjuntos",render:t=>{if(!t)return n.jsx(S,{message:"No entry",type:"error"});const{number:r,rule1:a,intersectingThing:i,rule2:e,title:s,things:o}=t;return n.jsxs(w,{children:[n.jsx(O,{children:r}),n.jsx(A,{label:"Title",children:s}),n.jsx(N,{entry:t,children:n.jsxs(v,{gap:6,vertical:!0,children:[n.jsxs(v,{gap:6,children:[n.jsx(P,{id:a.thing.id,width:48}),n.jsx(P,{id:i.id,width:48}),n.jsx(P,{id:e.thing.id,width:48})]}),n.jsx(v,{gap:6,children:o.map(l=>n.jsx(P,{id:l.id,width:35},l.id))})]})})]})}},{title:"Estoque",dataIndex:"controle-de-estoque",key:"controle-de-estoque",render:t=>{if(!t)return n.jsx(S,{message:"No entry",type:"error"});const{number:r,title:a,goods:i}=t;return n.jsxs(w,{children:[n.jsx(O,{children:r}),n.jsx(A,{label:"Title",children:a}),n.jsx(A,{label:"Goods",children:i.length}),n.jsx(N,{entry:t,children:n.jsx(v,{gap:6,style:{maxWidth:245},wrap:!0,children:i.map(e=>n.jsx($e,{id:e,width:48},e))})})]})}},{title:"Espionagem",dataIndex:"espionagem",key:"espionagem",render:t=>{if(!t)return n.jsx(S,{message:"No entry",type:"error"});const{number:r,statements:a,additionalStatements:i,suspects:e,culpritId:s}=t;return n.jsxs(w,{children:[n.jsx(O,{children:r}),n.jsx(A,{label:"Suspects",children:e.length}),n.jsx(A,{label:"Culprit",children:s}),n.jsx(A,{label:"Statements",children:a.length}),n.jsx(N,{entry:t,children:n.jsxs(v,{gap:6,vertical:!0,children:[n.jsx(G,{style:{maxHeight:200,overflowY:"auto"},wrap:!0,children:e.map(o=>n.jsx(Qe,{id:o.id,width:48},o.id))}),a.slice(0,3).map(o=>n.jsx(S,{banner:!0,message:o.text,showIcon:!0,type:"info"},o.key)),i.map(o=>n.jsx(S,{banner:!0,message:o.text,showIcon:!0,type:"warning"},o.key))]})})]})}},{title:"FilmaÃ§o",dataIndex:"filmaco",key:"filmaco",render:t=>{if(!t)return n.jsx(S,{message:"No entry",type:"error"});const{number:r,setId:a,title:i,year:e}=t;return n.jsxs(w,{children:[n.jsx(O,{children:r}),n.jsx(A,{label:"SetId",children:a}),n.jsx(N,{entry:t,children:n.jsxs(v,{gap:6,vertical:!0,children:[n.jsxs("span",{children:["Year: ",e]}),n.jsxs("span",{children:["Title:"," ",i.split("").map((s,o)=>o<1||s===" "?s:"â¹").join("")]})]})})]})}},{title:"Organiku",dataIndex:"organiku",key:"organiku",render:t=>{if(!t)return n.jsx(S,{message:"No entry",type:"error"});const{number:r,setId:a,title:i,grid:e,defaultRevealedIndexes:s}=t;return n.jsxs(w,{children:[n.jsx(O,{children:r}),n.jsx(A,{label:"SetId",children:a}),n.jsx(A,{label:"Title",children:i}),n.jsx(N,{entry:t,children:n.jsx("div",{className:"grid",style:{gridTemplateColumns:`repeat(${(e==null?void 0:e.length)%5===0?5:6}, 1fr)`,gap:"8px"},children:(e??[]).map((o,l)=>n.jsx("div",{className:"grid-item",children:n.jsx(P,{className:s.includes(l)?"red-border":"",id:s.includes(l)&&o||"0",width:48})},`${o}-${l}`))})})]})}},{title:"Palavreado",dataIndex:"palavreado",key:"palavreado",render:t=>{if(!t)return n.jsx(S,{message:"No entry",type:"error"});const{number:r,letters:a,keyword:i,words:e}=t;return n.jsxs(w,{children:[n.jsx(O,{children:r}),n.jsx(A,{label:"Letters",children:a.length}),n.jsx(A,{label:"Keyword",children:i}),n.jsx(N,{entry:t,children:n.jsx(G,{direction:"vertical",children:e.map((s,o)=>n.jsx("span",{children:s.split("").map((l,c)=>c===o||l===" "?l:"â¹").join("")},`${r}-${s}`))})})]})}},{title:"Portais",dataIndex:"portais-magicos",key:"portais-magicos",render:t=>{if(!t)return n.jsx(S,{message:"No entry",type:"error"});const{number:r,setId:a,corridors:i}=t;return n.jsxs(w,{children:[n.jsx(O,{children:r}),n.jsx(A,{label:"SetId",children:m.truncate(a,{length:9})}),n.jsx(N,{entry:t,children:n.jsx(v,{gap:6,vertical:!0,children:i.map(e=>n.jsxs(v,{gap:6,vertical:!0,children:[n.jsxs("span",{children:["Passcode: ",e.passcode," (",e.goal,")"]}),n.jsx(v,{children:e.imagesIds.map(s=>n.jsx(te,{id:s,width:48},s))})]},e.passcode))})})]})}},{title:"Quartetos",dataIndex:"quartetos",key:"quartetos",render:t=>{if(!t)return n.jsx(S,{message:"No entry",type:"error"});const{number:r,setId:a,sets:i}=t;return n.jsxs(w,{children:[n.jsx(O,{children:r}),n.jsx(A,{label:"SetId",children:m.truncate(a,{length:9})}),n.jsx(N,{entry:t,children:n.jsx(v,{gap:6,children:i.map(e=>n.jsx(v,{gap:6,vertical:!0,children:e.itemsIds.map(s=>n.jsx(P,{id:s,width:48},s))},e.id))})})]})}},{title:"PicaÃ§o",dataIndex:"artista",key:"artista",render:t=>{if(!t)return n.jsx(S,{message:"No entry",type:"error"});const{number:r,cards:a}=t;return n.jsxs(w,{children:[n.jsx(O,{children:r}),n.jsx(A,{label:"Cards",children:a.length}),n.jsx(N,{entry:t,children:n.jsx(v,{gap:6,style:{maxHeight:500,overflowY:"auto"},vertical:!0,children:a.map((i,e)=>n.jsx("span",{children:i.text},`${i.id}-${e}`))})})]})}},{title:"TÃ¡ Na Cara",dataIndex:"ta-na-cara",key:"ta-na-cara",render:t=>{if(!t)return n.jsx(S,{message:"No entry",type:"error"});const{number:r,suspectsIds:a,testimonies:i}=t;return n.jsxs(w,{children:[n.jsx(O,{children:r}),n.jsx(A,{label:"Suspects",children:a==null?void 0:a.length}),n.jsx(A,{label:"Questions",children:i.length}),n.jsx(N,{entry:t,children:n.jsxs(v,{vertical:!0,children:[n.jsx(G,{direction:"vertical",style:{maxHeight:100,overflowY:"auto"},children:i.map(e=>{var s;return n.jsxs(v,{vertical:!0,children:[n.jsx("span",{children:e.question}),n.jsx(v,{children:(s=e.suspectsIds)==null?void 0:s.map(o=>n.jsx(te,{id:o,width:48},o))})]},e.testimonyId)})}),n.jsx(G,{style:{maxHeight:200,maxWidth:"500px",overflowY:"auto"},wrap:!0,children:a==null?void 0:a.map(e=>n.jsx(te,{id:e,width:48},e))})]})})]})}}];function At(){const[t,r]=x.useState(""),[a,i]=x.useState(!1),{isLoading:e,data:s,dataUpdatedAt:o}=Ue("diario",t,{enabled:!!t&&a}),l=x.useMemo(()=>s?[ae(s,["number"])]:[],[s]),c=g=>{i(!1),r(g.trim())},d=()=>{i(R(t,"YYYY-MM-DD",!0).isValid())},p=()=>{const g=R(t).subtract(1,"days").format("YYYY-MM-DD");r(g)},u=()=>{const g=R(t).add(1,"days").format("YYYY-MM-DD");r(g)};return x.useEffect(()=>{!e&&s&&console.log(ae(s))},[o]),n.jsxs("div",{children:[n.jsx(V.Title,{level:2,children:"Data Verification"}),n.jsx(v,{align:"center",className:"mb-6",justify:"space-between",children:n.jsxs(v,{align:"center",gap:12,children:[n.jsxs(G.Compact,{children:[n.jsx(ie,{onChange:g=>c(g.target.value),placeholder:"YYYY-MM-DD"}),n.jsx(_,{onClick:d,type:"primary",children:"Load"})]}),t&&n.jsxs(v,{align:"center",gap:6,children:[n.jsx(_,{icon:n.jsx(ze,{}),onClick:p}),n.jsx("span",{children:n.jsx(q,{children:t})}),n.jsx(_,{disabled:t===Be(),icon:n.jsx(Je,{}),onClick:u})]}),n.jsx("span",{children:n.jsx(q,{color:e?"blue":a?"green":"red",children:e?"Loading...":a?"Valid":"Invalid"})}),n.jsx(oe,{disabled:!s,path:`/diario/${t}`})]})}),n.jsx(ve,{columns:be,dataSource:l,loading:e,scroll:{x:"max-content"}}),n.jsx(Ne,{}),n.jsxs(v,{align:"center",className:"mb-4",justify:"space-between",wrap:!0,children:[n.jsx(je,{className:"mb-4",content:JSON.stringify(l[0],null,2),disabled:!s,shape:"default",children:"Copy to Clipboard"}),n.jsx(Ct,{data:s})]}),n.jsx(he,{src:l[0]??{},theme:"twilight"})]})}const me=(t,r)=>{if(!t||!r||r.length<2)return[];const a=[],i=r.toLowerCase(),e=(s,o=[])=>{s&&typeof s=="object"&&Object.entries(s).forEach(([l,c])=>{l.toLowerCase().includes(i)&&a.push([...o,l].join(".")),typeof c=="string"&&c.toLowerCase().includes(i)&&a.push([...o,l].join(".")),typeof c=="object"&&c!==null&&e(c,[...o,l])})};return e(t),a};function Ct({data:t}){const[r,a]=x.useState([]),i=o=>{if(s(o),o.trim().length>1){const l=me(t??{},o.trim());a(l)}else a([])},[e,s]=x.useState("");return x.useEffect(()=>{if(t&&e.trim().length>1){const o=me(t,e.trim());a(o)}else a([])},[t]),n.jsxs(v,{gap:8,vertical:!0,children:[n.jsx(ie.Search,{allowClear:!0,onChange:o=>i(o.target.value),onSearch:i,placeholder:"Search in data...",style:{width:250}}),r.length>0&&n.jsxs("div",{children:[n.jsxs(V.Text,{children:["Found ",r.length," matches:"]}),n.jsx("ul",{style:{maxHeight:"200px",overflow:"auto",margin:"4px 0"},children:r.map((o,l)=>n.jsx("li",{children:n.jsx(V.Text,{code:!0,copyable:!0,children:o})},l))})]})]})}const St=(t,r,a,i)=>{const[e]=k(I.AQUI_O,i),s=L("items",t),o=L("daily-disc-sets",t);return{entries:x.useMemo(()=>!t||!o.isSuccess||!e||!s.isSuccess?{}:Et(a,e,o.data,s.data),[t,o.dataUpdatedAt,s.dataUpdatedAt,e,a]),isLoading:s.isLoading||o.isLoading}},Et=(t,r,a,i)=>{console.count("Creating Aqui Ã“...");const e=m.shuffle(Object.values(a).filter(d=>d.itemsIds.filter(Boolean).length>=20)),s=e.filter(d=>!r.used.includes(d.id));s.length<t&&(console.log("ðŸ”† Not enough aqui-o sets left, shuffling..."),B("aqui-o","Not enough aqui-o sets left"),s.push(...m.shuffle(e)));const o=Object.values(i).filter(d=>d!=null&&d.nsfw?!1:m.intersection(d.decks??[],["alien","dream","thing"]).length>0);let l=r.latestDate;const c={};for(let d=0;d<t;d++){const p=s[d];p||console.error("No aqui-o sets left");const u=U(l),g=H(u);l=u,g?c[u]={id:u,type:"aqui-o",number:r.latestNumber+d+1,setId:"special",title:{pt:"Especial Fim de Semana",en:"Weekend Special"},itemsIds:["0",...m.sampleSize(o,45).map(h=>h.id)]}:c[u]={id:u,type:"aqui-o",number:r.latestNumber+d+1,setId:p.id,title:p.title,itemsIds:["0",...m.sampleSize(p.itemsIds,20)]}}return c},wt=(t,r,a,i)=>{const[e]=k(I.ARTE_RUIM,i),s=fe(t,r);return{entries:x.useMemo(()=>!t||s.isLoading||!e?[]:Ot(a,e,s,r),[t,s.dataUpdatedAt,r,e,a]),isLoading:s.isLoading}},Ot=(t,r,a,i)=>{console.count("Creating Arte Ruim...");const e=Object.values(a.drawings).filter(c=>!(r.used.includes(c.id)||c.drawings.length<3)).map(c=>({id:c.id,type:"arte-ruim",language:i??"pt",cardId:c.id,text:c.text,drawings:c.drawings.map(d=>d.drawing),number:0,dataIds:c.drawings.map(d=>d.id)})),s=m.sampleSize(m.shuffle(e),t);let o=r.latestDate;return s.map((c,d)=>{const p=U(o);return o=p,{...c,id:p,number:r.latestNumber+d+1}})},Nt=(t,r,a,i,e)=>{const[s]=k(I.ARTISTA,i),[o]=k(I.ARTE_RUIM,i),l=L(`arte-ruim-cards-${r}`,t),c=fe(t,r);return{entries:x.useMemo(()=>{if(!t||!l.isSuccess||!c.hasResponseData||!s)return{};const p=e.map(u=>u.cardId);return Tt(a,s,o,l.data,p,c.drawings)},[t,l.dataUpdatedAt,o,s,a,e,c.dataUpdatedAt,c.hasResponseData]),isLoading:l.isLoading||c.isLoading}},Tt=(t,r,a,i,e,s)=>{console.count("Creating Artista...");let o=r.latestDate;const l={};for(let c=0;c<t;c++){const d=U(o),p=Object.keys(i??{}).filter(g=>{var h,j;return!a.used.includes(g)&&!e.includes(g)&&((j=(h=s==null?void 0:s[g])==null?void 0:h.drawings)==null?void 0:j.length)<3}),u=m.sampleSize(p,20).map(g=>i[g]);o=d,l[d]={id:d,type:"artista",number:r.latestNumber+c+1,cards:u}}return l},Lt=(t,r,a,i)=>{const[e]=k(I.COMUNICACAO_ALIENIGENA,i),s=L("items",t),o=L("items-attributes",t),l=L("items-attribute-values",t);return{entries:x.useMemo(()=>!t||!e||!o.isSuccess||!l.isSuccess||!s.isSuccess?{}:Mt(a,e,o.data,l.data,s.data),[t,a,e,e,o.dataUpdatedAt,l.dataUpdatedAt,s.dataUpdatedAt]),isLoading:s.isLoading||o.isLoading||l.isLoading}},Mt=(t,r,a,i,e)=>{console.count("Creating Comunicacao Alienigena...");let s=r.latestDate;const o=m.values(a),l=m.values(i).filter(u=>{var g;return u.complete&&((g=e==null?void 0:e[u.id])==null?void 0:g.nsfw)!==!0}),c={};let d=0;for(;m.keys(c).length<t+5&&d<We;){const u=Rt(o,l);if(u.valid&&!c[u.setId]&&!r.used.includes(u.setId)&&(c[u.setId]=u),m.keys(c).length>=t)break;d+=1}console.log(`ðŸ”† Generating this batch took ${d} tries`),d>=100&&B("comunicacao-alienigena","Not enough valid comunicacao alienigena games (over 100 attempts)");const p={};return Object.values(c).forEach((u,g)=>{const h=U(s);s=h;let j=m.shuffle(u.itemsIds);H(h)?j=m.shuffle([...j,...m.sampleSize(u.additionalItems,3)].filter(Boolean)):Ke(h)||(j=m.shuffle([...j,...m.sampleSize(u.additionalItems,1)].filter(Boolean))),p[h]={id:h,number:r.latestNumber+g+1,type:"comunicacao-alienigena",setId:u.setId,attributes:u.attributes,requests:u.requests,solution:u.solution,itemsIds:j}}),p},Rt=(t,r)=>{const a=m.shuffle(r),i=m.shuffle(Ye(50,0)),e=m.sampleSize(t,3).map(f=>({...f,spriteId:`${i.pop()}`})),s=[],o=[],l=[],c=[],d=[],p=[],u=[],g=[];a.forEach(f=>{const b=[Y.DETERMINISTIC,Y.RELATED],F=f.attributes[e[0].id]===Y.DETERMINISTIC,J=b.includes(f.attributes[e[0].id]),W=f.attributes[e[0].id]===Y.UNRELATED,Se=f.attributes[e[1].id]===Y.DETERMINISTIC,Z=b.includes(f.attributes[e[1].id]),K=f.attributes[e[1].id]===Y.UNRELATED,Ee=f.attributes[e[2].id]===Y.DETERMINISTIC,X=b.includes(f.attributes[e[2].id]),z=f.attributes[e[2].id]===Y.UNRELATED;if(W&&K&&z)return g.push(f.id);F&&K&&z&&s.push(f.id),W&&Se&&z&&o.push(f.id),W&&K&&Ee&&l.push(f.id),J&&Z&&z&&c.push(f.id),J&&K&&X&&d.push(f.id),W&&Z&&X&&p.push(f.id),J&&Z&&X&&u.push(f.id)});const h=e.map(f=>({id:f.id,name:f.name.pt,description:f.description.pt,spriteId:f.spriteId,itemsIds:[]}));h[0].itemsIds=m.sampleSize(s,s.length>3?3:Math.max(s.length-1,1)),h[1].itemsIds=m.sampleSize(o,o.length>3?3:Math.max(s.length-1,1)),h[2].itemsIds=m.sampleSize(l,l.length>3?3:Math.max(s.length-1,1));const j=[];h.forEach(f=>{j.push(...f.itemsIds)});const C=[];c.length>0&&C.push({spritesIds:[e[0].spriteId,e[1].spriteId],itemId:m.sample(c)??""}),d.length>0&&C.push({spritesIds:[e[0].spriteId,e[2].spriteId],itemId:m.sample(d)??""}),p.length>0&&C.push({spritesIds:[e[1].spriteId,e[2].spriteId],itemId:m.sample(p)??""}),u.length>0&&C.push({spritesIds:e.map(f=>f.spriteId),itemId:m.sample(u)??""});const E=[];s.length>0&&E.push({spritesIds:[e[0].spriteId],itemId:s.filter(f=>!j.includes(f))[0]}),o.length>0&&E.push({spritesIds:[e[1].spriteId],itemId:o.filter(f=>!j.includes(f))[0]}),l.length>0&&E.push({spritesIds:[e[2].spriteId],itemId:l.filter(f=>!j.includes(f))[0]});let y=m.sampleSize(C,4);y.length<3&&y.push(...m.sampleSize(E,4-y.length)),y.length<4&&console.log("ðŸ”† Not enough requests for an alien communication, marking it as invalid"),y=m.shuffle(y);const M=y.map(f=>f.itemId),D={setId:h.map(f=>f.id).sort().join("-"),attributes:h,requests:y,solution:M.join("-"),itemsIds:M,additionalItems:g.filter(Boolean),valid:!1};return D.valid=[D.attributes.length===3,D.requests.length===4,D.itemsIds.length===4,D.attributes.every(f=>f.itemsIds.length>0),D.requests.every(f=>f.itemId)].every(Boolean),D},kt=(t,r,a,i)=>{const[e]=k(I.CONTROLE_DE_ESTOQUE,i);return{entries:x.useMemo(()=>!t||!e?{}:Gt(a,e),[t,a,e]),isLoading:!1}},Gt=(t,r)=>{console.count("Creating Controle de Estoque...");let a=r.latestDate;const i={};for(let e=0;e<t;e++){const s=U(a);a=s,i[s]=Vt(s,r.latestNumber+e+1)}return i},Ut=256,Yt=16,Pt=4,_t=1,Vt=(t,r)=>{const[a,i,e]=t.split("-").map(Number),o=new Date(a,i-1,e).getDay(),l=["Domingo","Segunda-feira","TerÃ§a-feira","Quarta-feira","Quinta-feira","Sexta-feira","SÃ¡bado"][o],c={id:t,number:r,type:"controle-de-estoque",language:"pt",title:l,goods:[],orders:[]},d=m.sampleSize(Array(Ut).fill("").map((u,g)=>`good-${g+1}`),Yt+_t),p=d.pop();if(c.goods=d,c.orders=m.sampleSize(c.goods,Pt),!p)throw new Error("No out of stock good");return c.orders.push(p),c.orders=m.shuffle(c.orders),c},qt=(t,r,a,i)=>{const[e]=k(I.FILMACO,i),s=L("daily-movie-sets",t);return{entries:x.useMemo(()=>!t||!s.isSuccess||!e?{}:(Object.values(s.data).filter(c=>c.itemsIds.length>0&&!e.used.includes(c.id)).length<=a&&B("filmaco","Not enough unused films"),Ft(a,e,s.data)),[t,s.dataUpdatedAt,e,a]),isLoading:s.isLoading}},Ft=(t,r,a)=>{console.count("Creating FilmaÃ§o...");const i=m.shuffle(Object.values(a).filter(c=>c.itemsIds.filter(Boolean).length>0)),e=m.shuffle(i.filter(c=>!r.used.includes(c.id)));e.length<t&&e.push(...m.shuffle(i));const s=m.shuffle(Object.values(a).filter(c=>c.itemsIds.length>0&&r.used.includes(c.id)));let o=r.latestDate;const l={};for(let c=0;c<t;c++){const d=U(o),p=H(d),u=p?$t(s):e[c];if(!u){B("filmaco","No filmaÃ§o sets left");break}o=d,l[d]={id:d,type:"filmaco",number:r.latestNumber+c+1,setId:u.id,title:u.title,itemsIds:u.itemsIds,year:u.year},p&&(l[d].isDoubleFeature=!0)}return l},$t=t=>{var i;let r=[];for(;r.length<2&&t.length>0;){const e=t.pop();e&&m.intersection(e.itemsIds,((i=r==null?void 0:r[0])==null?void 0:i.itemsIds)||[]).length===0&&r.push(e)}return r=m.orderBy(r,e=>e.year,"asc"),{id:`df-${r.map(e=>e.id).join("-")}`,title:`${r.map(e=>e.title).join(" Ã— ")}`,itemsIds:m.shuffle(xe(r.flatMap(e=>e.itemsIds))),year:r.map(e=>e.year).join(" Ã— ")}},Qt=(t,r,a,i)=>{const[e]=k(I.ORGANIKU,i),s=L("items-groups",t);return{entries:x.useMemo(()=>!t||s.isLoading||!e?{}:Ht(a,e,r,s.data),[t,r,e,a,s.dataUpdatedAt]),isLoading:s.isLoading}},Ht=(t,r,a,i)=>{console.count("Creating Organiku...");const e=m.shuffle(Object.values(i).filter(l=>l.itemsIds.length>6&&r.used.includes(l.id)===!1));e.length<t&&B("organiku","Not enough organiku groups left");let s=r.latestDate;const o={};for(let l=0;l<t;l++){const c=U(s);s=c;const d=H(c),p=e[l],u=m.sampleSize(p.itemsIds,d?6:5),g=Wt(u),h=Bt(g,u,1);o[c]={id:c,number:r.latestNumber+l+1,setId:p.id,type:"organiku",title:m.capitalize(p.name[a]),grid:g,defaultRevealedIndexes:h,itemsIds:u}}return o};function Bt(t,r,a){const i=new Set,e={};t.forEach((s,o)=>{e[s]||(e[s]=[]),e[s].push(o)});for(const s of r){const o=e[s]??[],c=o.length%2===0?2:1,d=m.shuffle(o);for(let p=0;p<c&&p<d.length;p++)i.add(d[p])}for(let s=0;s<a;s++){const o=r[s%r.length],l=(e[o]??[]).filter(d=>!i.has(d)),c=m.shuffle(l);for(let d=0;d<2&&d<c.length;d++)i.add(c[d])}return Array.from(i)}function Wt(t){const r=t.length,a=[];a.push(m.shuffle(t));function i(s,o){for(let l=0;l<r;l++)for(let c=0;c<o;c++)if(a[c][l]===s[l])return!1;return!0}function e(s){if(s===r)return!0;const o=Ae(t);for(;o.length>0;){const l=o.splice(Math.floor(Math.random()*o.length),1)[0];if(i(l,s)){if(a.push(l),e(s+1))return!0;a.pop()}}return!1}return e(1),a.flat()}function Ae(t){if(t.length<=1)return[t.slice()];const r=[];for(let a=0;a<t.length;a++){const i=[...t.slice(0,a),...t.slice(a+1)];for(const e of Ae(i))r.push([t[a],...e])}return r}const Kt=(t,r,a,i)=>{const[e]=k(I.PALAVREADO,i),s=re(4,r,t),o=re(5,r,t);return{entries:x.useMemo(()=>!t||!s.data||!s.data.length||!o.data||!o.data.length||!e?{}:zt(a,e,s.data,o.data),[t,s.dataUpdatedAt,o.dataUpdatedAt,e,a]),isLoading:s.isLoading||o.isLoading}},zt=(t,r,a,i)=>{console.count("Creating Palavreado...");let e=r.latestDate;const s=[],o={};for(let l=0;l<t;l++){const c=U(e),d=H(c),p=d?5:4;e=c,o[c]={id:c,type:"palavreado",number:r.latestNumber+l+1,...Jt(d?i:a,[...Object.values(o).map(u=>u.keyword),...r.used],s,p)}}return o},Jt=(t,r,a,i=4,e)=>{let s=m.shuffle(m.difference(t,a,r));const o=e||(s.pop()??""),l=[];for(let c=0;c<i;c++){const d=Zt(t,o,l,c);l.push(d)}return a.push(o,...l),{keyword:o,words:l,letters:Xt(l,o.length)}},Zt=(t,r,a,i)=>{const e=m.uniq([...m.flatMap(a.map(l=>l.split(""))),...r.split("")]),s=m.shuffle(t.filter(l=>l[i]===r[i]&&!a.includes(l)));return m.sortBy(s,l=>m.intersection(l.split(""),e).length)[0]},Xt=(t,r)=>{const a=m.flatMap(t.map(o=>o.split(""))),i=r===4?[0,5,10,15]:[0,6,12,18,24],e=m.shuffle(a.filter((o,l)=>!i.includes(l))),s=[];for(let o=0;o<a.length;o++)i.includes(o)?s.push(a[o]):s.push(e.shift()??"");return s},es=(t,r,a,i)=>{const[e]=k(I.PORTAIS_MAGICOS,i),s=L("daily-passcode-sets",t),o=re(3,r,t);return{entries:x.useMemo(()=>{if(!t||!s.isSuccess||!o.isSuccess||!e)return{};const c=o.data.reduce((d,p)=>(p.split("").forEach(u=>{d[u]||(d[u]=[]),d[u].push(p)}),d),{" ":["  "],"-":[" - "]});return ts(a,e,s.data,c)},[t,a,s.dataUpdatedAt,o.isSuccess,o.dataUpdatedAt,e]),isLoading:s.isLoading||o.isLoading}},ts=(t,r,a,i)=>{console.count("Creating Portais MÃ¡gicos...");let e=r.latestDate;const s=r.used,o={};let l=m.shuffle(Object.values(a).filter(d=>d.imageCardsIds.length>0));const c={};for(let d=0;d<t;d++){const p=U(e),u=[];let g=[...l];const h=[];for(;h.length<3;){const j=g.pop();if(!j)throw new Error("Not enough sets available");const C=m.sample(j.passcode.filter(D=>D.length<=12&&!s.includes(D)))||"";if(!C)continue;const E=h.length+1;u.push(j.id),o[j.id]=!0;const y=C.split("").map(D=>m.sample(i[D])||` ${D} `),M=m.sampleSize(j.imageCardsIds,E);h.push({passcode:C,imagesIds:M,words:y,goal:ss(C,y)}),g=g.filter(D=>!o[D.id]&&D.imageCardsIds.length>E)}e=p,c[p]={id:p,type:"portais-magicos",setId:u.join(le),number:r.latestNumber+d+1,corridors:h.reverse(),goal:h.reduce((j,C)=>j+C.goal,0)},l=l.filter(j=>!o[j.id])}return c};function ss(t,r){if(t.length!==r.length)throw new Error("Secret word length must match the number of 3-letter words");let a=0;for(let i=0;i<t.length;i++){const e=t[i].toUpperCase(),s=r[i].toUpperCase();let o=-1;for(let c=0;c<3;c++)if(s[c]===e){o=c;break}if(o===-1)throw new Error(`Target letter '${e}' not found in word '${s}' at position ${i}`);let l=0;o===0?l=2:o===1?l=0:o===2&&(l=1),a+=l}return a}const ns=(t,r,a,i)=>{const[e]=k(I.TA_NA_CARA,i),s=L("suspects",t),o=L(`testimony-questions-${r}`,t),l=L("testimony-answers",t);return{entries:x.useMemo(()=>{if(!t||!s.isSuccess||!o.isSuccess||!e||!l.isSuccess)return{};const d=cs(o.data,l.data,s.data),p=Object.keys(s.data).map(u=>Ie(u,"gb"));return rs(a,e,p,o.data,d)},[t,s.dataUpdatedAt,o.dataUpdatedAt,l.dataUpdatedAt,e,a]),isLoading:s.isLoading||o.isLoading}},as=15,Ce=7,rs=(t,r,a,i,e)=>{console.count("Creating TÃ¡ Na Cara...");let s=0,o=r.latestDate;const l={};for(let c=0;c<t;c++){const d=U(o);o=d;const p=[];for(let h=0;h<as;h++){s>=e.length&&(s=0);const j=e[s];p.push(is(j,i[j.testimonyId])),s+=1}const u=Pe(p.flatMap(h=>h.suspectsIds||[]),!0),g=m.shuffle(a.filter(h=>!u[h])).slice(0,Ce);l[d]={id:d,type:"ta-na-cara",number:r.latestNumber+c+1,suspectsIds:g,testimonies:p}}return l},is=(t,r)=>{const a=[...m.shuffle(t.counts[3]),...m.shuffle(t.counts[2]),...t.counts[1],...t.counts[0],...t.counts[5]].slice(0,Ce).map(i=>Ie(i,"gb"));return{testimonyId:r.id,question:r.question,nsfw:!!r.nsfw,suspectsIds:a}},os=t=>t.reduce((r,a)=>{const i=a.split(le),e=i[0],s=Number(i[1]);if(e.startsWith("us")){const o=e.split("-"),l=`${o[0]}-${o[2]}`;return l.includes("undefined")||(r[l]=s||0),r}return r[e]=s||0,r},{}),ls=(t,r)=>{const a=os(t);return r.forEach(i=>{var e;i.testimonies.forEach(s=>{a[s.testimonyId]===void 0&&(a[s.testimonyId]=0),a[s.testimonyId]+=1}),(e=i.suspectsIds)==null||e.forEach(s=>{const o=s.split("-"),l=`${o[0]}-${o[2]}`;a[l]===void 0&&(a[l]=0),a[l]+=1})}),Object.entries(a).map(([i,e])=>`${i}${le}${e}`)},cs=(t,r,a)=>{const i={};return Object.keys(t).forEach(s=>{i[s]===void 0&&(i[s]={0:[],1:[],2:[],3:[],4:[],5:[]});const o=r[s]||{};Object.keys(a).forEach(l=>{const c=o[l]||[],d=st(c);d>=5?i[s][5].push(l):i[s][d].push(l)})}),m.orderBy(Object.keys(i).map(s=>({testimonyId:s,counts:i[s]})),[s=>s.counts[3].length,s=>s.counts[2].length,s=>s.counts[1].length,s=>s.counts[0].length],["desc"])};function ds(t,r,a){const i=ye.DAILY[r??"pt"],e=De(i,{enabled:t});x.useEffect(()=>{Xe()},[a,r]);const s=t&&e.isSuccess,o=L("items",s),l=St(s,r,a,e.data??{}),c=wt(s,r,a,e.data??{}),d=Lt(s,r,a,e.data??{}),p=kt(s,r,a,e.data??{}),u=qt(s,r,a,e.data??{}),g=Kt(s,r,a,e.data??{}),h=et(s,r,a,e.data??{}),j=at(s,r,a,e.data??{}),C=es(s,r,a,e.data??{}),E=Qt(s,r,a,e.data??{}),y=nt(s,r,a,e.data??{}),M=Nt(s,r,a,e.data??{},c.entries),D=ns(s,r,a,e.data??{}),f=x.useMemo(()=>c.entries.length===0?[]:(console.count("Bundling entries..."),c.entries.map(b=>{const F={id:b.id,"arte-ruim":b,"aqui-o":l.entries[b.id],"comunicacao-alienigena":d.entries[b.id],"controle-de-estoque":p.entries[b.id],espionagem:y.entries[b.id],filmaco:u.entries[b.id],organiku:E.entries[b.id],palavreado:g.entries[b.id],"portais-magicos":C.entries[b.id],quartetos:h.entries[b.id],"teoria-de-conjuntos":j.entries[b.id],artista:M.entries[b.id],"ta-na-cara":D.entries[b.id],dictionary:{}};return F.dictionary=us(F,o.data),F})),[c.entries,l.entries,d.entries,p.entries,u.entries,E.entries,g.entries,C.entries,h.entries,j.entries,M.entries,D.entries,y.entries,o.data]);return{isLoading:e.isLoading||l.isLoading||c.isLoading||d.isLoading||p.isLoading||u.isLoading||g.isLoading||C.isLoading||h.isLoading||j.isLoading||M.isLoading||D.isLoading||y.isLoading||E.isLoading||o.isLoading,entries:f}}const us=(t,r)=>{const a={};return t["aqui-o"].itemsIds.forEach(i=>{const e=r[i];e&&(a[i]=e.name.pt)}),t["comunicacao-alienigena"].itemsIds.forEach(i=>{const e=r[i];e&&(a[i]=e.name.pt)}),t["comunicacao-alienigena"].attributes.forEach(i=>{i.itemsIds.forEach(e=>{const s=r[e];s&&(a[e]=s.name.pt)})}),t.filmaco.itemsIds.forEach(i=>{const e=r[i];e&&(a[i]=e.name.pt)}),t.quartetos.grid.forEach(i=>{const e=r[i];e&&(a[i]=e.name.pt)}),t.organiku.itemsIds.forEach(i=>{const e=r[i];e&&(a[i]=e.name.pt)}),a};function ms(t){const{notification:r}=Te.useApp(),a=Le(),i=ye.DAILY[t??"pt"],[e,s]=x.useState(!1),o=De(i,{enabled:!!i}),l=ge({mutationFn:async c=>{const d=c.map(h=>{const j=se(ne,`${i}/${h.id}`);return ce(j,h)}),p=se(ne,`${i}/history`),u=o.data;if(!u)throw new Error("No previous history");const g={...u,[I.AQUI_O]:T(I.AQUI_O,u,c,h=>h.setId),[I.ARTE_RUIM]:T(I.ARTE_RUIM,u,c,h=>h.cardId),[I.ARTISTA]:T(I.ARTISTA,u,c,null),[I.COMUNICACAO_ALIENIGENA]:T(I.COMUNICACAO_ALIENIGENA,u,c,h=>h.setId),[I.CONTROLE_DE_ESTOQUE]:T(I.CONTROLE_DE_ESTOQUE,u,c,null),[I.FILMACO]:T(I.FILMACO,u,c,h=>h.setId),[I.PALAVREADO]:T(I.PALAVREADO,u,c,h=>h.keyword),[I.PORTAIS_MAGICOS]:T(I.PORTAIS_MAGICOS,u,c,h=>h.corridors.map(j=>j.passcode)),[I.TA_NA_CARA]:T(I.TA_NA_CARA,u,c,null,ls),[I.QUARTETOS]:T(I.QUARTETOS,u,c,h=>h.sets.map(j=>j.id)),[I.TEORIA_DE_CONJUNTOS]:T(I.TEORIA_DE_CONJUNTOS,u,c,h=>[h.intersectingThing.id,h.setId]),[I.ORGANIKU]:T(I.ORGANIKU,u,c,h=>h.setId),[I.ESPIONAGEM]:T(I.ESPIONAGEM,u,c,h=>h.culpritId)};return ce(p,g),Promise.all(d)},onSuccess:()=>{r.info({message:"Data saved",placement:"bottomLeft"}),a.invalidateQueries({queryKey:[i,"history"]}),s(!1)},onError:()=>{r.error({message:"Error saving data",placement:"bottomLeft"})}});return{isDirty:e,setIsDirty:s,save:l.mutateAsync,isPending:l.isPending}}const T=(t,r,a,i,e)=>{var o;const s=JSON.parse(((o=r[t])==null?void 0:o.used)??"[]");return e?{latestDate:a[a.length-1].id,latestNumber:a[a.length-1][t].number,used:JSON.stringify(e(s,a.map(l=>l[t])))}:i===null?{latestDate:a[a.length-1].id,latestNumber:a[a.length-1][t].number,used:"[]"}:{latestDate:a[a.length-1].id,latestNumber:a[a.length-1][t].number,used:JSON.stringify(xe([...s,...a.map(l=>l[t]).map(i)]).flat())}},ps="pt";function hs(){const[t,r]=x.useState(""),[a,i]=x.useState(3),[e,s]=x.useState(7),[o,l]=x.useState(Date.now());return n.jsxs("div",{children:[n.jsx(V.Title,{level:2,children:"Data Population"}),n.jsxs(v,{gap:12,children:[n.jsx(ee,{label:"Language",onChange:r,options:[ps],placeholder:"Select a language",value:t}),n.jsx(ee,{label:"Minimum Drawings",onChange:i,options:[2,3,4],placeholder:"Select a number",value:a}),n.jsx(ee,{label:"Batch Size",onChange:s,options:[3,7,14,21,28],placeholder:"Select a number",value:e}),n.jsx(_,{icon:n.jsx(ut,{}),onClick:()=>{l(Date.now())}}),n.jsx(oe,{className:"ml-2",path:"diario/history"})]}),n.jsx(fs,{batchSize:e,language:t},o)]})}function fs({language:t,batchSize:r}){const a=t,i=ds(!!a,a,r),e=tt();x.useEffect(()=>{m.isEmpty(e)||console.log(e)},[e]);const{save:s,isPending:o}=ms(a??"pt");return n.jsxs(Ze,{error:null,hasResponseData:!i.isLoading,isLoading:i.isLoading,children:[n.jsxs(v,{align:"center",justify:"space-between",children:[n.jsxs(V.Title,{level:4,children:["Total: ",i.entries.length]}),n.jsx(_,{disabled:(i.entries??[]).length===0,icon:n.jsx(rt,{}),loading:o,onClick:()=>s(i.entries),size:"large",type:"primary",children:"Save"})]}),Object.values(e).map(l=>n.jsx(S,{banner:!0,message:l,showIcon:!0,type:"warning"},l)),n.jsx(ve,{columns:be,dataSource:i.entries??[],scroll:{x:"max-content"}})]})}function gs(){const{queryParams:t}=pe();return t.get("display")==="archive"?n.jsx(vt,{}):t.get("display")==="check"?n.jsx(At,{}):n.jsx(hs,{})}function xs(){const{queryParams:t,addParams:r}=pe();return n.jsxs(n.Fragment,{children:[n.jsx(ue,{children:n.jsx(Ve,{label:"Display",onChange:a=>r({display:a}),options:[{title:"Population",icon:n.jsx(ht,{}),value:"population"},{title:"Check",icon:n.jsx(lt,{}),value:"check"},{title:"Archive",icon:n.jsx(xt,{}),value:"archive"}],value:t.get("display")??"population"})}),n.jsx(ue,{children:n.jsx(oe,{label:"History",path:"/diario/history"})})]})}function dn(){return n.jsx(Me,{title:"Daily Setup",children:n.jsxs(de,{hasSider:!0,children:[n.jsx(He,{children:n.jsx(xs,{})}),n.jsx(de.Content,{className:"content",children:n.jsx(gs,{})})]})})}export{dn as default};
