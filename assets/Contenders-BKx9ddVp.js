import{j as e,ag as k,r as y,T as c,D as b,P as w,L as C}from"./index-BLpG_3dc.js";import{u as F,D as S}from"./DataFilters-495hMERd.js";import{u as L,P as N}from"./useGridPagination-BXg3wQhc.js";import{l as m}from"./useBaseUrl-Z8UUKQRH.js";import{L as x,D as v,N as P}from"./EditableFields-F7rcN49g.js";import{L as d}from"./LanguageFlag-BQ1Xvc_0.js";import{I as T}from"./ImageCard-uIDEsSSw.js";import{r as O,a as R,d as I}from"./index-BSGMqsez.js";import{P as D}from"./constants-C7m4kwy2.js";import{C as j}from"./index-sK7w6uj9.js";import{F as n}from"./index-C6ycO1rA.js";import{S as B}from"./index-Bop_RWDL.js";import{R as W}from"./index-Btk51C0l.js";import{R as M}from"./EditOutlined-BSHQAMK4.js";import{D as A}from"./DownloadButton-ov5kmDez.js";import{S as G}from"./SaveButton-BQwu57_q.js";import{S as f}from"./SiderContent-C8pkahXp.js";import{D as _}from"./DataLoadingWrapper-DLiuAs32.js";import{P as z}from"./PageSider-De9kC7SI.js";import{u as H}from"./useResourceFirestoreData-BO8XKfMe.js";import"./useQueryParams-ocZrol2E.js";import"./FilterEntries-CMQi29db.js";import"./index-DCbKhhF5.js";import"./index-DaoSKbYZ.js";import"./index-Co6Wlshl.js";import"./Pagination-DAWB2JZ9.js";import"./index-C3-g4HeD.js";import"./gapSize-U1swVQyS.js";import"./useCopyToClipboardFunction-Ycyr8oCV.js";import"./index-Bcjzw9Ry.js";import"./Input-CfP8Bjl1.js";import"./FireFilled-5to0p_jP.js";import"./IdcardOutlined-CHllRWI2.js";import"./Item-C2s7nmsd.js";import"./index-j_km3PGm.js";import"./PlusOutlined-ByZyTB3m.js";import"./index-DojfTyfT.js";import"./moment-C5S46NFB.js";import"./SaveOutlined-D2KSpTKJ.js";import"./useGetFirestoreDoc-DKduTKnD.js";import"./useTDResource-CEfvLK3O.js";import"./useUpdateFirestoreDoc-ByeRwp47.js";import"./useMutation-B5N67HGd.js";const h=[{value:"base",label:"Base"},{value:"anime",label:"Anime"},{value:"art",label:"Art"},{value:"cartoon",label:"Cartoon"},{value:"characters",label:"Characters"},{value:"comics",label:"Comics"},{value:"games",label:"Games"},{value:"history",label:"History"},{value:"internet",label:"Internet"},{value:"literature",label:"Literature"},{value:"movies",label:"Movies"},{value:"music",label:"Music"},{value:"mythology",label:"Mythology"},{value:"pop-culture",label:"Pop Culture"},{value:"random",label:"Random"},{value:"sports",label:"Sports"},{value:"television",label:"Television"},{value:"special-td",label:"Special TD"},{value:"special-td-bg",label:"Special TD BG"}],K=(s,l)=>{if(!s||s.length===0)return"warning";if(s.filter(r=>!h.some(t=>t.value===r)).length>0||l&&s.includes("base"))return"error"};function J({contender:s,addEntryToUpdate:l}){const a=(i,u,o)=>{l(s.id,m.merge({[u]:{en:"",pt:""}},s,{[u]:{[o]:i}}))},r=i=>{l(s.id,m.merge(s,{nsfw:i}))},t=i=>{l(s.id,{...s,decks:O(i).sort()})};return e.jsxs(j,{hoverable:!0,"style-":{width:240,maxWidth:240},cover:e.jsx(T,{id:s.id,width:240}),children:[e.jsx(j.Meta,{title:s.id,description:e.jsxs(n,{vertical:!0,children:[e.jsx(x,{children:"Name"}),e.jsx(v,{value:s.name,language:"en",onChange:i=>a(i.target.value,"name","en")}),e.jsx(v,{value:s.name,language:"pt",onChange:i=>a(i.target.value,"name","pt")}),e.jsx(x,{children:"Description"}),e.jsx(v,{value:s.description??D,language:"en",onChange:i=>a(i.target.value,"description","en")}),e.jsx(v,{value:s.description??D,language:"pt",onChange:i=>a(i.target.value,"description","pt")}),e.jsx(x,{children:"Decks"}),e.jsx(B,{mode:"multiple",defaultValue:s.decks??[],size:"small",options:h,onChange:i=>t(i),style:{maxWidth:"calc(100vw / 9)"},status:K(s.decks,s.exclusivity)}),e.jsxs(n,{align:"center",children:[e.jsx(x,{children:"NSFW"})," ",e.jsx(P,{value:s.nsfw,size:"small",onChange:i=>r(i)})]}),e.jsxs(n,{align:"center",gap:8,children:[e.jsx(x,{children:"Exclusivity"})," ",e.jsx(U,{contender:s,addEntryToUpdate:l})]})]})}),e.jsx(j.Meta,{})]})}function U({contender:s,addEntryToUpdate:l}){const a=i=>{l(s.id,m.merge(s,{exclusivity:i}))},r=[{value:"en",label:e.jsx(d,{language:"en",style:{width:24}})},{value:"pt",label:e.jsx(d,{language:"pt",style:{width:24}})},{value:"none",label:"None"}],t=e.jsx(n,{gap:8,children:e.jsx(W.Group,{options:r,onChange:i=>a(i.target.value),value:s==null?void 0:s.exclusivity})});return e.jsxs(n,{gap:8,children:[(s==null?void 0:s.exclusivity)==="en"&&e.jsx(d,{language:"en",style:{width:24}}),(s==null?void 0:s.exclusivity)==="pt"&&e.jsx(d,{language:"pt",style:{width:24}}),!(s!=null&&s.exclusivity)&&"None",e.jsx(k,{title:"Change exclusivity?",content:t,trigger:"click",children:e.jsx(M,{})})]})}function Y({data:s,addEntryToUpdate:l}){const a=F(s),{page:r,pagination:t}=L({data:a,resetter:"",defaultPageSize:32});return y.useEffect(()=>V(s),[s]),e.jsx(e.Fragment,{children:e.jsxs(e.Fragment,{children:[e.jsxs(c.Title,{level:2,children:["Listing - Contenders (",a.length," | ",Object.values(s??{}).length,")"]}),e.jsx(N,{pagination:t,className:"full-width",children:e.jsx(n,{gap:16,wrap:"wrap",children:r.map(i=>e.jsx(J,{contender:i,addEntryToUpdate:l},i.id))})})]})})}const Q=["random","cartoon","comics","pop-culture","movies","television"],V=s=>{const l=Object.values(m.cloneDeep(s)).reduce((r,t)=>{if(t.decks.includes("base"))return r.base.push(t),t.decks=["base"],r;if(t.exclusivity==="pt")return r;const i=t.decks.filter(o=>o!=="base");i.length>1&&console.log("Multiple decks",t.name.en,t.decks);const u=i.find(o=>Q.includes(o))||i[0];return r[u]||(r[u]=[]),t.decks=[u],r[u].push(t),r},{base:[]});Object.keys(l).forEach(r=>{console.log(r,l[r].length),console.log(l[r].map(t=>{var i;return{id:t.id,name:t.name.en,description:((i=t.description)==null?void 0:i.en)??"",deck:t.decks[0]}})),console.log("-----------------")});const a=[];Object.keys(l).forEach(r=>{a.push(...l[r].map(t=>{var i;return{id:t.id,name:t.name.en,description:((i=t.description)==null?void 0:i.en)??"",deck:t.decks[0]}}))}),console.log(a)};function q({data:s,isDirty:l,save:a,isSaving:r,entriesToUpdate:t,hasFirestoreData:i}){return e.jsxs(e.Fragment,{children:[e.jsx(f,{children:e.jsxs(n,{vertical:!0,gap:12,children:[e.jsx(G,{isDirty:l,onSave:a,isSaving:r,dirt:JSON.stringify(t)}),e.jsx(A,{data:()=>X(s),fileName:"contenders.json",disabled:l,hasNewData:i,block:!0})]})}),e.jsx(f,{children:e.jsx(S,{data:s,ignoreKeys:["description"]})}),e.jsx(f,{children:e.jsx(Z,{data:s})})]})}function X(s){console.log("Preparing file for download...");const l=m.cloneDeep(s);return Object.values(l).forEach(a=>{const r=a.exclusivity;(a.exclusivity===void 0||r==="none")&&(a.exclusivity=void 0)}),R(I(l))}function Z({data:s}){const l=y.useMemo(()=>{let a=0,r=0,t=0;const i=Object.values(s).reduce((o,p)=>((p.decks??[]).forEach((g,$,E)=>{(g==="base"||!E.includes("base"))&&(o[g]=o[g]?o[g]+1:1)}),p.exclusivity==="en"&&a++,p.exclusivity==="pt"&&r++,p.exclusivity||t++,o),{}),u=Object.keys(i).filter(o=>!h.some(p=>p.value===o));return{deckCounts:i,invalidDecks:u,englishExclusivity:a,portugueseExclusivity:r,bothExclusivity:t}},[s]);return e.jsxs(n,{vertical:!0,gap:8,children:[e.jsx(c.Text,{strong:!0,children:"Deck Counts"}),e.jsx(n,{vertical:!0,gap:8,style:{maxHeight:"300px",overflowY:"auto"},children:h.map(a=>e.jsxs(c.Text,{children:[a.label,": ",l.deckCounts[a.value]??0]},a.value))}),e.jsx(b,{className:"my-2"}),e.jsx(c.Text,{strong:!0,children:"Invalid Decks"}),e.jsx(n,{vertical:!0,gap:8,style:{maxHeight:"300px",overflowY:"auto"},children:l.invalidDecks.map(a=>e.jsx(c.Text,{children:a},a))}),e.jsx(b,{className:"my-2"}),e.jsx(c.Text,{strong:!0,children:"Exclusivity"}),e.jsxs(n,{vertical:!0,gap:8,children:[e.jsxs(c.Text,{children:["English: ",l.englishExclusivity]}),e.jsxs(c.Text,{children:["Portuguese: ",l.portugueseExclusivity]}),e.jsxs(c.Text,{children:["Both: ",l.bothExclusivity]})]})]})}function He(){const s=H({tdrResourceName:"contenders",firestoreDataCollectionName:"contenders",serialize:!0});return e.jsx(w,{title:"Contenders",subtitle:"Characters, Celebrities, Personalities",children:e.jsxs(C,{hasSider:!0,children:[e.jsx(z,{children:e.jsx(q,{...s})}),e.jsx(C.Content,{className:"content",children:e.jsx(_,{isLoading:s.isLoading,error:s.error,hasResponseData:!m.isEmpty(s.data),children:e.jsx(Y,{...s})})})]})})}export{He as Contenders,He as default};
