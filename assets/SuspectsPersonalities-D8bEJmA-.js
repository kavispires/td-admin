import{r as T,j as e,F as x,T as y,I as D,A as R,a4 as E,d3 as N,D as w,cg as z,P as O,L as C}from"./index-oEEOm1Q1.js";import{D as M}from"./DataLoadingWrapper-D4C5HzPz.js";import{l as b,P as F}from"./useBaseUrl-BnHXsPne.js";import{S as Q}from"./SuspectImageCard-VBVQI-uF.js";import{S as Z}from"./index-CGghHHqJ.js";import{a as k}from"./utils-DJiLWCUx.js";import{u as g}from"./useTDResource-BASeopuo.js";import"./ImageCard-Cu2BwdIC.js";import"./useQueryParams-8P1IU5jw.js";function B({data:s}){const l=T.useMemo(()=>b.orderBy(Object.values(s.suspects),[r=>Number(r.id.split("-")[1])],["asc"]),[s.suspects]);return e.jsxs(e.Fragment,{children:[e.jsx(x,{align:"center",justify:"space-between",children:e.jsx(y.Title,{level:2,children:"IDK"})}),e.jsx(Z,{style:{position:"sticky",top:0,background:"black",zIndex:1,width:"100%"},children:"Filters and Sorters come here"}),e.jsx(D.PreviewGroup,{children:e.jsx(x,{gap:16,style:{marginBottom:16},wrap:!0,children:l.map(r=>{const{zodiacSign:a,ascendantSign:n,mbtiType:m,notEnoughData:f}=s.personalities[r.id]||{};return e.jsxs(x,{vertical:!0,children:[e.jsx(Q,{cardId:r.id,cardWidth:120,className:"suspect__image"}),e.jsxs(y.Text,{children:[b.truncate(r.name.pt,{length:10})," (",r.age,")"]}),f?e.jsx(R,{message:"N/A",type:"warning"}):e.jsxs(e.Fragment,{children:[e.jsx(E,{title:s.zodiacCrossReference[a||"N/A"]?.description||"",children:e.jsx(y.Text,{type:I?.[a]?void 0:"danger",children:I?.[a]||"N/A"})}),e.jsx(E,{title:s.zodiacCrossReference[n||"N/A"]?.description||"",children:e.jsxs(y.Text,{type:"secondary",children:[e.jsx(N,{style:{transform:"scaleX(-1)"}})," ",I?.[n]||"N/A"]})}),e.jsx(w,{className:"my-1"}),e.jsx(y.Text,{type:m.includes("X")?"danger":void 0,children:m||"N/A"})]})]},r.id)})})})]})}const I={aries:"Ãries â™ˆ",touro:"Touro â™‰",gemeos:"GÃªmeos â™Š",cancer:"CÃ¢ncer â™‹",leao:"LeÃ£o â™Œ",virgem:"Virgem â™",libra:"Libra â™Ž",escorpiao:"EscorpiÃ£o â™",sagitario:"SagitÃ¡rio â™",capricornio:"CapricÃ³rnio â™‘",aquario:"AquÃ¡rio â™’",peixes:"Peixes â™“"};function q(){const s=g("suspects"),l=g("testimony-questions-pt"),r=g("testimony-answers"),a=g("suspect-testimony-crossreference-zodiac-pt"),n=g("suspect-testimony-crossreference-mbti-pt"),m=T.useMemo(()=>!s.data||!l.data||!r.data||!a.data||!n.data?{}:G(s.data,l.data,r.data,a.data,n.data),[s.data,l.data,r.data,a.data,n.data]),{unusedZodiacTestimonyIds:f,unusedMbtiTestimonyIds:h}=T.useMemo(()=>{const o=Object.values(a.data??{}).reduce((i,c)=>(c.relatedTestimonyIds.forEach(p=>{i[p]=!0}),c.unrelatedTestimonyIds.forEach(p=>{i[p]=!0}),i),{}),u=Object.values(n.data??{}).reduce((i,c)=>(c.relatedTestimonyIds.forEach(p=>{i[p]=!0}),c.unrelatedTestimonyIds.forEach(p=>{i[p]=!0}),i),{});return{unusedZodiacTestimonyIds:Object.keys(o).sort(),unusedMbtiTestimonyIds:Object.keys(u).sort()}},[a.data,n.data]);return{error:s.error||l.error||r.error||a.error||n.error,isLoading:s.isLoading||l.isLoading||r.isLoading||a.isLoading||n.isLoading,data:{suspects:s.data,testimonies:l.data,testimonyAnswers:r.data,zodiacCrossReference:a.data,mbtiCrossReference:n.data,personalities:m,unusedZodiacTestimonyIds:f,unusedMbtiTestimonyIds:h}}}const G=(s,l,r,a,n)=>{const m={},f={};for(const o in s)for(const u in l){const i=r[u]??{},c=k(o,u,i);c.resolution==="ðŸ‘"||c.projection==="ðŸ‘"?(m[o]=m[o]||{},m[o][u]=!0):(c.resolution==="ðŸ‘Ž"||c.projection==="ðŸ‘Ž")&&(f[o]=f[o]||{},f[o][u]=!0)}const h={};for(const o in s){const u={},i={};for(const t of Object.values(a))u[t.id]=0,t.relatedTestimonyIds.forEach(d=>{m[o]?.[d]&&(u[t.id]+=1)}),t.unrelatedTestimonyIds.forEach(d=>{f[o]?.[d]&&(u[t.id]+=1)});const c=Object.entries(u).sort((t,d)=>d[1]-t[1]),p=c.filter(([,t])=>t>3),S=p[0]?.[0]||"",L=p[1]?.[0]||c.filter(([t])=>t!==S)[0]?.[0]||"";for(const t of Object.values(n))i[t.id]=0,t.relatedTestimonyIds.forEach(d=>{m[o]?.[d]&&(i[t.id]+=1)}),t.unrelatedTestimonyIds.forEach(d=>{f[o]?.[d]&&(i[t.id]+=1)});const P=[["E","I"],["S","N"],["T","F"],["J","P"]];let j="";for(const[t,d]of P){const A=i[t]||0,v=i[d]||0;Math.abs(A-v)<1?j+="X":A>v?j+=t:j+=d}h[o]={suspectId:o,zodiacSign:S,ascendantSign:L,mbtiType:j}}return h};function $(){z("Suspect Personalities");const s=q();return e.jsx(O,{subtitle:"Dive deep into the suspect personalities based on their testimonies",title:"Suspect Personalities",children:e.jsxs(C,{hasSider:!0,children:[e.jsx(F,{children:"-"}),e.jsx(C.Content,{className:"content",children:e.jsx(M,{error:s.error,hasResponseData:!b.isEmpty(s.data),isLoading:s.isLoading,children:e.jsx(B,{...s})})})]})})}export{$ as SuspectsPersonalities,$ as default};
