import{r as v,bV as q,aV as z,cO as V,dl as k,w as o,cY as j,m as P,cN as G}from"./index-CTf-mCqX.js";const{ESC:J,TAB:Q}=z;function U({visible:e,triggerRef:s,onVisibleChange:t,autoFocus:n,overlayRef:c}){const r=v.useRef(!1),l=()=>{e&&(s.current?.focus?.(),t?.(!1))},i=()=>c.current?.focus?(c.current.focus(),r.current=!0,!0):!1,p=d=>{switch(d.keyCode){case J:l();break;case Q:{let m=!1;r.current||(m=i()),m?d.preventDefault():l();break}}};v.useEffect(()=>e?(window.addEventListener("keydown",p),n&&q(i,3),()=>{window.removeEventListener("keydown",p),r.current=!1}):()=>{r.current=!1},[e])}const Z=v.forwardRef((e,s)=>{const{overlay:t,arrow:n,prefixCls:c}=e,r=v.useMemo(()=>{let i;return typeof t=="function"?i=t():i=t,i},[t]),l=V(s,k(r));return o.createElement(o.Fragment,null,n&&o.createElement("div",{className:`${c}-arrow`}),o.cloneElement(r,{ref:j(r)?l:void 0}))}),f={adjustX:1,adjustY:1},u=[0,0],ee={topLeft:{points:["bl","tl"],overflow:f,offset:[0,-4],targetOffset:u},top:{points:["bc","tc"],overflow:f,offset:[0,-4],targetOffset:u},topRight:{points:["br","tr"],overflow:f,offset:[0,-4],targetOffset:u},bottomLeft:{points:["tl","bl"],overflow:f,offset:[0,4],targetOffset:u},bottom:{points:["tc","bc"],overflow:f,offset:[0,4],targetOffset:u},bottomRight:{points:["tr","br"],overflow:f,offset:[0,4],targetOffset:u}};function y(){return y=Object.assign?Object.assign.bind():function(e){for(var s=1;s<arguments.length;s++){var t=arguments[s];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e},y.apply(this,arguments)}const ne=o.forwardRef((e,s)=>{const{arrow:t=!1,prefixCls:n="rc-dropdown",transitionName:c,animation:r,align:l,placement:i="bottomLeft",placements:p=ee,getPopupContainer:d,showAction:m,hideAction:L,overlayClassName:T,overlayStyle:$,visible:D,trigger:C=["hover"],autoFocus:S,overlay:R,children:g,onVisibleChange:W,...F}=e,[H,O]=o.useState(),w="visible"in e?D:H,K=r?`${n}-${r}`:c,E=o.useRef(null),N=o.useRef(null),M=o.useRef(null);o.useImperativeHandle(s,()=>E.current);const x=a=>{O(a),W?.(a)};U({visible:w,triggerRef:M,onVisibleChange:x,autoFocus:S,overlayRef:N});const Y=a=>{const{onOverlayClick:h}=e;O(!1),h&&h(a)},A=()=>o.createElement(Z,{ref:N,overlay:R,prefixCls:n,arrow:t}),B=()=>typeof R=="function"?A:A(),I=()=>{const{minOverlayWidthMatchTrigger:a,alignPoint:h}=e;return"minOverlayWidthMatchTrigger"in e?a:!h},X=()=>{const{openClassName:a}=e;return a!==void 0?a:`${n}-open`},_=o.cloneElement(g,{className:P(g.props?.className,w&&X()),ref:j(g)?V(M,k(g)):void 0});let b=L;return!b&&C.indexOf("contextMenu")!==-1&&(b=["click"]),o.createElement(G,y({builtinPlacements:p},F,{prefixCls:n,ref:E,popupClassName:P(T,{[`${n}-show-arrow`]:t}),popupStyle:$,action:C,showAction:m,hideAction:b,popupPlacement:i,popupAlign:l,popupMotion:{motionName:K},popupVisible:w,stretch:I()?"minWidth":"",popup:B(),onOpenChange:x,onPopupClick:Y,getPopupContainer:d}),_)});export{ne as D};
