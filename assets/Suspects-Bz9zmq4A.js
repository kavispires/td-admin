import{r as b,a as O,_ as L,j as e,T as j,I as E,B as R,D as T,P as A,L as w}from"./index-T4G7ifK2.js";import{D as z}from"./DataLoadingWrapper-Dc0rtgoC.js";import{l as v,P as M}from"./useBaseUrl-BKb__I8D.js";import{I as P}from"./ImageCard-CS6gHRbg.js";import{u as W}from"./useCardWidth-B_m5Zr4-.js";import{u as H}from"./useQueryParams-DEP4HWhT.js";import{s as I,a as $}from"./index-CehV9pmg.js";import{D as k}from"./EditableFields-BmzsQ0ph.js";import{g as F}from"./utils-Dijd9GnP.js";import{u as N}from"./useDebounce-BmbQ_1Zu.js";import{D}from"./index-BsiFAnUg.js";import{F as S}from"./index-BwMVuZVX.js";import{S as C}from"./index-Bi-Wptpy.js";import{I as y}from"./index-MC5robMc.js";import{R as _}from"./index-oeTmRUXt.js";import{S as q}from"./index-C0ToUoaP.js";import{S as Y}from"./index-DDiloPUx.js";import{T as J}from"./index-DgNq-UGv.js";import{R as Q,a as V}from"./WomanOutlined-DmYlwci_.js";import{R as K,a as X}from"./ColumnWidthOutlined-C4eCwPEE.js";import{a as B,b as Z}from"./FilterEntries-D0BJuND2.js";import{S as U}from"./SiderContent-BN1V-0kb.js";import{D as ee}from"./DownloadButton-Bn3U-xH1.js";import{F as se}from"./FirestoreConsoleLink-Df8YSiKg.js";import{S as ae}from"./SaveButton-Bw7SgGgG.js";import{u as ie}from"./useResourceFirestoreData-DBOtFTF9.js";import"./constants-B7QZIsVd.js";import"./Item-BBWv2__U.js";import"./useCopyToClipboardFunction-BECPwXqY.js";import"./LanguageFlag-CVjjORJu.js";import"./FireFilled-BRyCaMOs.js";import"./IdcardOutlined-p3alrmPu.js";import"./gapSize-U1swVQyS.js";import"./Input-SP-NgBC9.js";import"./index-BFX4Z3U_.js";import"./index-5lShEq1F.js";import"./moment-C5S46NFB.js";import"./SaveOutlined-KAGt9_wb.js";import"./useGetFirestoreDoc-mGA1BUdE.js";import"./useTDResource-CftQXT9X.js";import"./useUpdateFirestoreDoc-C1Tk7K96.js";import"./useMutation-UnIKUghO.js";var le={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M880 836H144c-17.7 0-32 14.3-32 32v36c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-36c0-17.7-14.3-32-32-32zm-622.3-84c2 0 4-.2 6-.5L431.9 722c2-.4 3.9-1.3 5.3-2.8l423.9-423.9a9.96 9.96 0 000-14.1L694.9 114.9c-1.9-1.9-4.4-2.9-7.1-2.9s-5.2 1-7.1 2.9L256.8 538.8c-1.5 1.5-2.4 3.3-2.8 5.3l-29.5 168.2a33.5 33.5 0 009.4 29.8c6.6 6.4 14.9 9.9 23.8 9.9z"}}]},name:"edit",theme:"filled"},te=function(t,n){return b.createElement(O,L({},t,{ref:n,icon:le}))},re=b.forwardRef(te);const ne=["18-21","21-30","30-40","40-50","50-60","50-70"].map(a=>({label:a,value:a})),oe=[{label:"Male",value:"male"},{label:"Female",value:"female"},{label:"Non-binary",value:"non-binary"},{label:"Other",value:"other"}],ce=[{label:"Caucasian",value:"caucasian"},{label:"Black",value:"black"},{label:"Asian",value:"asian"},{label:"Latino",value:"latino"},{label:"Indigenous",value:"indigenous"},{label:"Indian",value:"indian"},{label:"Middle Eastern",value:"middle-eastern"},{label:"Mixed",value:"mixed"},{label:"Other",value:"other"}];function de({data:a,addEntryToUpdate:t}){const{removeParam:n,queryParams:o}=H(),d=o.get("suspectId"),c=o.get("version")??"gb",s=a[d??""],[m,p]=b.useState((s==null?void 0:s.name.pt)||""),[i,l]=b.useState((s==null?void 0:s.name.en)||""),[h,u]=b.useState((s==null?void 0:s.note)||"");return b.useEffect(()=>{s&&(p(s.name.pt),l(s.name.en),u(s.note||""))},[s==null?void 0:s.id]),N(()=>{s&&m!==s.name.pt&&t(s.id,{...s,name:{...s.name,pt:m}})},1e3,[m]),N(()=>{s&&i!==s.name.en&&t(s.id,{...s,name:{...s.name,en:i}})},1e3,[i]),N(()=>{s&&h!==s.note&&t(s.id,{...s,note:h})},1e3,[h]),s?e.jsx(D,{title:s.name.pt,placement:"right",onClose:()=>n("suspectId"),open:!!s,width:400,children:e.jsxs("div",{className:"suspect__drawer",children:[e.jsxs("div",{className:"grid",style:{gridTemplateColumns:"1fr 1.25fr"},children:[e.jsx(P,{id:F(s.id,c),width:100}),e.jsxs(S,{vertical:!0,gap:4,children:[e.jsx(k,{value:s.name,language:"pt",onChange:r=>{t(s.id,{...s,name:{...s.name,pt:r.target.value}})}}),e.jsx(k,{value:s.name,language:"en",onChange:r=>{t(s.id,{...s,name:{...s.name,en:r.target.value}})}}),e.jsx("div",{children:e.jsx(C,{placeholder:"Select Age",value:s.age,size:"small",onChange:r=>{t(s.id,{...s,age:r})},options:ne,style:{width:80}})}),e.jsx("div",{children:e.jsx(C,{value:s.gender,size:"small",onChange:r=>{t(s.id,{...s,gender:r})},options:oe,style:{width:120}})}),e.jsx("div",{children:e.jsx(C,{value:s.ethnicity,size:"small",onChange:r=>{t(s.id,{...s,ethnicity:r})},options:ce,style:{width:150}})}),e.jsx("div",{children:e.jsx(y,{value:s.note,size:"small",onChange:r=>{t(s.id,{...s,note:r.target.value})}})})]})]}),e.jsxs("div",{className:"grid grid-2",children:[e.jsxs(S,{vertical:!0,children:[e.jsx(j.Text,{strong:!0,children:"Build"}),e.jsx(_.Group,{size:"small",value:s.build,onChange:r=>{t(s.id,{...s,build:r.target.value})},options:me,style:{display:"flex",flexDirection:"column",gap:3}})]}),e.jsxs(S,{vertical:!0,children:[e.jsx(j.Text,{strong:!0,children:"Height"}),e.jsx(_.Group,{size:"small",value:s.height,onChange:r=>{t(s.id,{...s,height:r.target.value})},options:he,style:{display:"flex",flexDirection:"column",gap:3}})]})]}),e.jsx(ue,{suspect:s,addEntryToUpdate:t})]})}):null}function ue({suspect:a,addEntryToUpdate:t}){const n=a.features??[],o=d=>{const c=n.includes(d)?n.filter(s=>s!==d):[...n,d];t(a.id,{...a,features:c})};return e.jsx("div",{className:"grid grid-2",children:G.map(d=>e.jsxs("div",{className:"my-4",children:[e.jsx(j.Text,{strong:!0,children:d.title}),d.features.map(c=>e.jsxs(S,{className:"my-2",gap:4,children:[e.jsx(q,{size:"small",checked:n.includes(c.id),onChange:()=>o(c.id)})," ",c.label]},c.id))]},d.title))})}const me=["thin","average","muscular","large"],he=["short","medium","tall"],G=[{title:"Hair Length",features:[{id:"shortHair",label:"Short Hair"},{id:"longHair",label:"Long Hair"},{id:"mediumHair",label:"Medium Hair"},{id:"bald",label:"Bald"}]},{title:"Hair Color",features:[{id:"blackHair",label:"Black Hair"},{id:"brownHair",label:"Brown Hair"},{id:"blondeHair",label:"Blonde Hair"},{id:"redHair",label:"Red Hair"},{id:"greyHair",label:"Grey Hair"},{id:"coloredHair",label:"Colored Hair"}]},{title:"Face",features:[{id:"beard",label:"Beard"},{id:"mustache",label:"Mustache"},{id:"goatee",label:"Goatee"},{id:"lipstick",label:"Lipstick"}]},{title:"Accessories",features:[{id:"noAccessories",label:"No Accessories"},{id:"glasses",label:"Glasses"},{id:"piercings",label:"Piercings"},{id:"earrings",label:"Earrings"},{id:"necklace",label:"Necklace"},{id:"hat",label:"Hat"},{id:"scarf",label:"Scarf"},{id:"hoodie",label:"Hoodie"},{id:"tie",label:"Tie"},{id:"headscarf",label:"Headscarf/Bandana"}]}];function ge({data:a,addEntryToUpdate:t}){const{addParam:n,queryParams:o}=H(),d=o.get("version")??"gb",c=o.get("sortBy")??"id",s=Number(o.get("cardsPerRow"))||8,[m,p]=W(s),i=b.useMemo(()=>v.orderBy(Object.values(a),l=>c==="id"?Number(l.id.split("-").at(-1)):c==="name.pt"?I(l.name.pt).toLowerCase():c==="name.en"?I(l.name.en).toLowerCase():l[c]??l.id,["asc"]),[a,c]);return e.jsxs(e.Fragment,{children:[e.jsxs(j.Title,{level:2,children:["Deck ",d," (",i.length,")"]}),e.jsx(E.PreviewGroup,{children:e.jsx(Y,{ref:p,wrap:!0,className:"my-2",children:i.map(l=>{var h,u;return e.jsxs("div",{className:"suspect",style:{width:`${m}px`},children:[e.jsx(P,{id:F(l.id,d),width:m,className:"suspect__image"}),e.jsxs("div",{className:"suspect__name",children:[e.jsx("div",{children:e.jsx(J,{children:l.id})}),e.jsxs("div",{children:["ðŸ‡§ðŸ‡· ",l.name.pt]}),e.jsxs("div",{children:["ðŸ‡ºðŸ‡¸ ",l.name.en]}),e.jsxs("div",{className:"suspect__info",style:pe(l),children:[e.jsxs("div",{children:[e.jsxs("div",{children:[l.gender==="male"?e.jsx(Q,{}):e.jsx(V,{})," ",l.age]}),e.jsx("div",{children:e.jsx("em",{children:l.ethnicity})})]}),e.jsxs("div",{className:"uppercase",children:[e.jsx(K,{}),e.jsx("br",{}),l.build.charAt(0)]}),e.jsxs("div",{className:"uppercase",children:[e.jsx(X,{}),e.jsx("br",{}),l.height.charAt(0)]}),e.jsxs("div",{children:[((h=l==null?void 0:l.features)==null?void 0:h.length)??0," features"]})]}),e.jsx(R,{size:"small",block:!0,onClick:()=>n("suspectId",l.id),danger:!(l!=null&&l.features)||((u=l==null?void 0:l.features)==null?void 0:u.length)<2,children:e.jsx(re,{})})]})]},l.id)})},d)}),e.jsx(de,{data:a,addEntryToUpdate:t})]})}const pe=a=>!a.build||!a.height||a.build.length===1||a.height.length===1?{borderColor:"red"}:{};function f(a,t){return v.orderBy(Object.entries(a).map(([n,o])=>({key:n,label:v.capitalize(n),value:o,percentage:Math.round(o/t*100)})),["percentage"],["desc"])}function xe({data:a}){const[t,n]=b.useState(!1);return e.jsxs(e.Fragment,{children:[e.jsx(R,{onClick:()=>n(!0),block:!0,children:"See Stats"}),t&&e.jsx(je,{data:a,open:t,onClose:()=>n(!1)})]})}function je({data:a,open:t,onClose:n}){const{ages:o,ethnicities:d,genders:c,builds:s,heights:m}=b.useMemo(()=>{const i={},l={},h={},u={},r={};Object.values(a).forEach(g=>{i[g.age]=(i[g.age]??0)+1,l[g.ethnicity]=(l[g.ethnicity]??0)+1,h[g.gender]=(h[g.gender]??0)+1,u[g.build||"?"]=(u[g.build||"?"]??0)+1,r[g.height||"?"]=(r[g.height||"?"]??0)+1});const x=Object.keys(a).length;return{ages:f(i,x),ethnicities:f(l,x),genders:f(h,x),builds:f(u,x),heights:f(r,x)}},[a]),p=b.useMemo(()=>{const i={};Object.values(a).forEach(u=>{var r;(r=u.features)==null||r.forEach(x=>{i[x]=(i[x]??0)+1})});const l=Object.keys(a).length,h=G.reduce((u,r)=>{const x=r.features.map(g=>g.id);return u.push(...x),u},[]);return v.orderBy(f(i,l),u=>h.findIndex(r=>r===u.key),["asc"])},[a]);return e.jsxs(D,{title:"Suspects Statistics",placement:"right",onClose:n,open:t,width:400,children:[e.jsx(j.Text,{strong:!0,children:"Ethnicity"}),e.jsx("ul",{className:"statistic__list",children:d.map(i=>e.jsxs("li",{children:[e.jsx("strong",{children:i.label})," - ",i.percentage,"%"]},i.key))}),e.jsx(j.Text,{strong:!0,children:"Gender"}),e.jsx("ul",{className:"statistic__list",children:c.map(i=>e.jsxs("li",{children:[e.jsx("strong",{children:i.label})," - ",i.percentage,"%"]},i.key))}),e.jsx(j.Text,{strong:!0,children:"Age"}),e.jsx("ul",{className:"statistic__list",children:o.map(i=>e.jsxs("li",{children:[e.jsx("strong",{children:i.label})," - ",i.percentage,"%"]},i.key))}),e.jsx(j.Text,{strong:!0,children:"Build"}),e.jsx("ul",{className:"statistic__list",children:s.map(i=>e.jsxs("li",{children:[e.jsx("strong",{children:i.label})," - ",i.percentage,"%"]},i.key))}),e.jsx(j.Text,{strong:!0,children:"Height"}),e.jsx("ul",{className:"statistic__list",children:m.map(i=>e.jsxs("li",{children:[e.jsx("strong",{children:i.label})," - ",i.percentage,"%"]},i.key))}),e.jsx(j.Text,{strong:!0,children:"Features"}),e.jsx("ul",{className:"statistic__list",children:p.map(i=>e.jsxs("li",{children:[e.jsx("strong",{children:i.label})," - ",i.percentage,"% (",i.value,")"]},i.key))})]})}const be=[{value:"ct",label:"Cartoon"},{value:"gb",label:"Ghibli"},{value:"ai",label:"AI"},{value:"md",label:"Models"},{value:"wc",label:"Wacky"}],fe=[{value:"id",label:"Id"},{value:"name.pt",label:"Name (PT)"},{value:"name.en",label:"Name (EN)"},{value:"ethnicity",label:"Ethnicity"},{value:"gender",label:"Gender"},{value:"age",label:"Age"},{value:"height",label:"Height"},{value:"build",label:"Build"}];function ve({data:a,save:t,isDirty:n,isSaving:o,entriesToUpdate:d,hasFirestoreData:c}){const{addParam:s,queryParams:m}=H();return e.jsxs(U,{children:[e.jsxs(S,{vertical:!0,gap:12,children:[e.jsx(ae,{isDirty:n,onSave:t,isSaving:o,dirt:JSON.stringify(d)}),e.jsx(ee,{data:()=>Se(a),fileName:"suspects.json",disabled:n,hasNewData:c,block:!0}),e.jsx(se,{path:"tdr/suspects",className:"text-center"})]}),e.jsx(T,{}),e.jsx(B,{label:"Version",value:m.get("version")??"gb",onChange:p=>s("version",p),options:be}),e.jsx(Z,{label:"Cards Per Row",value:Number(m.get("cardsPerRow")??"8"),onChange:p=>s("cardsPerRow",p),min:2,max:12}),e.jsx(B,{label:"Sort By",value:m.get("sortBy")??"id",onChange:p=>s("sortBy",p),options:fe}),e.jsx(xe,{data:a})]})}function Se(a){const t=v.cloneDeep(a);for(const n in t){const o=t[n];o.name.pt.endsWith(".")&&(o.name.pt=o.name.pt.slice(0,-1).trim()),o.name.en.endsWith(".")&&(o.name.en=o.name.en.slice(0,-1).trim())}return $(t,["gender","ethnicity","age","height","build","features"])}function ds(){const a=ie({tdrResourceName:"suspects",firestoreDataCollectionName:"suspects",serialize:!0});return e.jsx(A,{title:"Suspects",subtitle:"Information",children:e.jsxs(w,{hasSider:!0,children:[e.jsx(M,{children:e.jsx(ve,{...a})}),e.jsx(w.Content,{className:"content",children:e.jsx(z,{isLoading:a.isLoading,error:a.error,hasResponseData:!v.isEmpty(a.data),children:e.jsx(ge,{...a})})})]})})}export{ds as default};
