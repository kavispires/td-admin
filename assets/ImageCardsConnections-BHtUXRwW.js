import{r as x,a as b,J as P,j as t,I as L,B as z,P as E,L as C}from"./index-BHrRQ1uq.js";import{D}from"./DataLoadingWrapper-DKkg9HZe.js";import{l as j}from"./lodash-f0m46xYx.js";import{I as F}from"./ImageCard-DDGT4T7O.js";import{u as R,R as O,I as M}from"./RelationshipsStats-N0HvvlPG.js";import{F as N}from"./Table-CGPLlxUi.js";import{F as k}from"./index-CjtWJUFP.js";import{S as w}from"./index-Co7aD7RO.js";import{T as B}from"./index-Db_5R2-z.js";import{c as T,a as v}from"./FilterEntries-BiZjj4NT.js";import{R as _}from"./ResponseState-fIQi1M-X.js";import{D as q}from"./DownloadButton-DRTPYwYl.js";import{P as G}from"./useBaseUrl--32bgvsR.js";import{S}from"./SiderContent-Dj_cqrIg.js";import{c as W,C as $}from"./constants-B_q3c2xJ.js";import"./hooks-BKTQnF0K.js";import"./index-Rk2ZCQ0l.js";import"./useMutation-Cs1gCno8.js";import"./useQueryParams-Cr8fZCN0.js";import"./index-BHuPI7uO.js";import"./index-CkYVgnOz.js";import"./index-DL-QmAap.js";import"./index-BESd2kFy.js";import"./index-Cm-andhV.js";import"./scrollTo-CnYqteaX.js";import"./Pagination-DPx5Huu7.js";import"./extendsObject-keMuGWqj.js";import"./Input-cdsOURLH.js";import"./gapSize-U1swVQyS.js";import"./index-7mXcI-6s.js";import"./Item-DXicAdtS.js";var A={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm154.7 454.5l-246 178c-5.3 3.8-12.7 0-12.7-6.5v-46.9c0-10.2 4.9-19.9 13.2-25.9L566.6 512 421.2 406.8c-8.3-6-13.2-15.6-13.2-25.9V334c0-6.5 7.4-10.3 12.7-6.5l246 178c4.4 3.2 4.4 9.8 0 13z"}}]},name:"right-circle",theme:"filled"};function I(){return I=Object.assign?Object.assign.bind():function(n){for(var r=1;r<arguments.length;r++){var s=arguments[r];for(var l in s)Object.prototype.hasOwnProperty.call(s,l)&&(n[l]=s[l])}return n},I.apply(this,arguments)}const Z=(n,r)=>x.createElement(b,I({},n,{ref:r,icon:A})),J=x.forwardRef(Z);function V(){const{query:{isDirty:n,isSaving:r,save:s,stats:l,data:h,...a},randomGroups:{cardIds:e},showIds:d,cardSize:c}=R(),[o,{width:p}]=P(),[,g]=x.useMemo(()=>{const i=Math.floor(p/c)+1,u=Math.floor(p/i);return[i,u]},[c,p]),m=[{title:"Length",dataIndex:"length",key:"length"},{title:"Relationships",dataIndex:"relationships",key:"relationship",render:(i,u)=>t.jsx(L.PreviewGroup,{children:t.jsx(k,{wrap:"wrap",gap:2,children:i.map(f=>t.jsxs(w,{children:[t.jsxs(w,{direction:"vertical",children:[t.jsx(F,{id:f,width:g}),d&&t.jsx(B,{children:f})]}),i[i.length-1]!==f&&t.jsx(J,{})]},`${u.origin}-${f}`))})})}],y=x.useMemo(()=>j.orderBy(e.map(i=>{const u=H(i,h,"longest",10);return{key:i,origin:i,length:u.length,relationships:u}}),["length"],["desc"]),[e,h]);return t.jsx(D,{isLoading:a.isLoading,error:a.error,hasResponseData:!0,children:t.jsx("div",{ref:o,className:"my-6",children:t.jsx(N,{dataSource:y,columns:m})})})}const H=j.memoize((n,r,s,l)=>{const h=new Set,a=[];let e=[],d=0;for(a.push({currentId:n,path:[],depth:0});a.length>0&&d<100;){d++;const{currentId:c,path:o,depth:p}=a.pop()??{currentId:"",path:[],depth:0};if(h.add(c),o.push(c),s==="longest"&&o.length>e.length&&(e=[...o]),s==="shortest"&&(e.length===0||o.length<e.length)&&(e=[...o]),s==="any"&&e.length===0&&(e=[...o]),!(p>=l))for(const g of r[c]||[])h.has(g)||a.push({currentId:g,path:[...o],depth:p+1})}return e});function K(){const{query:{isDirty:n,isSaving:r,data:s,isLoading:l,isError:h},showIds:a,setShowIds:e,sampleSize:d,setSampleSize:c,cardSize:o,setCardSize:p,randomGroups:{nextSet:g}}=R();return t.jsxs(G,{children:[t.jsx(_,{isLoading:l||r,isDirty:n,isError:h,hasResponseData:!j.isEmpty(s)}),t.jsxs(S,{children:[t.jsx(T,{label:"Show Ids",value:a,onChange:m=>e(m)}),t.jsx(v,{onChange:m=>c(m),value:d,options:W,label:"Sample Size"}),t.jsx(v,{onChange:m=>p(m),value:o,options:$,label:"Card Size"}),t.jsx(z,{onClick:g,block:!0,type:"primary",children:"New Random Sample"})]}),t.jsx(S,{children:t.jsx(O,{})}),t.jsx(S,{children:t.jsx(q,{data:s,fileName:"imageCardsRelationships.json",loading:r,disabled:j.isEmpty(s),block:!0})})]})}function Pt(){return t.jsx(E,{title:"Image Cards",subtitle:"Connections",children:t.jsx(M,{children:t.jsxs(C,{hasSider:!0,children:[t.jsx(K,{}),t.jsx(C.Content,{className:"content",children:t.jsx(V,{})})]})})})}export{Pt as default};
