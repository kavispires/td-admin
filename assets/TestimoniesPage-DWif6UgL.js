import{aA as be,r as v,d as L,_ as $,j as e,F as S,T as O,B as C,A as X,h as we,a4 as F,D as G,b as W,aB as ce,R as ve,a2 as ae,aC as Se,P as Ce,L as Z}from"./index-DS1ivUKl.js";import{D as ke}from"./DataLoadingWrapper-D0kZen2e.js";import{l as T,c as le,P as Oe}from"./useBaseUrl-Dtc237x-.js";import{u as N}from"./useQueryParams-C4ld1yVa.js";import{R as Te}from"./main-D60Vsxrf.js";import{u as Ie,R as Re}from"./daily-espionagem-DLwT0vDm.js";import{g as Ne}from"./useParsedHistory-DwBlUIYq.js";import{S as q}from"./SuspectImageCard-C1Pw-pOA.js";import{u as Y}from"./useTDResource-FMei0BaR.js";import{T as ue,S as De,F as Pe}from"./FilterEntries-BH6rTU5G.js";import{B as Q,D as de}from"./DownloadButton-DSUlqZ8B.js";import{S as D}from"./index-tTAXUxAi.js";import{u as he}from"./useTableExpandableRows-C6aYIjPt.js";import{u as me}from"./useTablePagination-CSMXUdtG.js";import{P as ee}from"./progress-D8gM07kW.js";import{S as P}from"./index-CsVi_JXz.js";import{a as pe,c as fe,n as Me}from"./utils-JIBu7BYk.js";import{F as K}from"./Table-D2N6HiJJ.js";import{u as Ee}from"./useCardWidth-Chhwp1-j.js";import{C as je}from"./index-Bt4KH6Ul.js";import{P as te}from"./index-BkLRNpbd.js";import{F as z,R as Fe}from"./ExpandOutlined-7XDjZa-Y.js";import{S as H}from"./SiderContent-BMu-46Kz.js";import{F as Ae,a as Be}from"./FirestoreConsoleLink-Da8VD0Et.js";import{S as ze}from"./SaveButton-DKXe5G67.js";import{S as Le}from"./SuspectsStyleVariantSelector-D7hGbUhz.js";import{g as $e}from"./useGetFirestoreDoc-CKlWy8X1.js";import{j as qe,a as Ve,i as He}from"./index-jHRjb98a.js";import{u as xe}from"./useWindowSize-BjprKfZk.js";import{R as Qe}from"./TableOutlined-6GiZ1R5i.js";import{R as Ue}from"./RobotOutlined-KZMN_fV1.js";import{u as We}from"./useResourceFirestoreData-BuYtrZEL.js";import"./moment-C5S46NFB.js";import"./ImageCard-BdcJJwGg.js";import"./index-Dmez0dR5.js";import"./index-CqMvr226.js";import"./index-BD6ZCjPB.js";import"./scrollTo-DA_KzeKe.js";import"./Pagination-mWZn-0pL.js";import"./VerticalAlignTopOutlined-CrbEsUe7.js";import"./throttleByAnimationFrame-BI_t0HyT.js";import"./FileTextOutlined-CEbTTOZM.js";import"./useMutation-lfyQutYx.js";import"./SaveOutlined-BAI77UKw.js";import"./constants-B83rpArh.js";import"./Item-Dbh73dpn.js";import"./useUpdateFirestoreDoc-DzIYrdOz.js";function Ye(t,o){return typeof t=="function"?t.length?t(o):t():t}function ge(t,o,r){if(o===void 0&&(o=10),o<1)throw new Error("Capacity has to be greater than 1, got '"+o+"'");var a=be(),m=v.useState(t),j=m[0],h=m[1],u=v.useRef([]),s=v.useRef(0);a&&(u.current.length?(u.current[u.current.length-1]!==t&&u.current.push(t),u.current.length>o&&(u.current=u.current.slice(u.current.length-o))):u.current.push(t),s.current=u.current.length&&u.current.length-1);var x=v.useCallback(function(c){h(function(p){return c=Ye(c,p),c!==p&&(s.current<u.current.length-1&&(u.current=u.current.slice(0,s.current+1)),s.current=u.current.push(c)-1,u.current.length>o&&(u.current=u.current.slice(u.current.length-o))),c})},[j,o]),d=v.useMemo(function(){return{history:u.current,position:s.current,capacity:o,back:function(c){c===void 0&&(c=1),s.current&&h(function(){return s.current-=Math.min(c,s.current),u.current[s.current]})},forward:function(c){c===void 0&&(c=1),s.current!==u.current.length-1&&h(function(){return s.current=Math.min(s.current+c,u.current.length-1),u.current[s.current]})},go:function(c){c!==s.current&&h(function(){return s.current=c<0?Math.max(u.current.length+c,0):Math.min(u.current.length-1,c),u.current[s.current]})}}},[j]);return[j,x,d]}var _e={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M864 144H560c-8.8 0-16 7.2-16 16v304c0 8.8 7.2 16 16 16h304c8.8 0 16-7.2 16-16V160c0-8.8-7.2-16-16-16zm0 400H560c-8.8 0-16 7.2-16 16v304c0 8.8 7.2 16 16 16h304c8.8 0 16-7.2 16-16V560c0-8.8-7.2-16-16-16zM464 144H160c-8.8 0-16 7.2-16 16v304c0 8.8 7.2 16 16 16h304c8.8 0 16-7.2 16-16V160c0-8.8-7.2-16-16-16zm0 400H160c-8.8 0-16 7.2-16 16v304c0 8.8 7.2 16 16 16h304c8.8 0 16-7.2 16-16V560c0-8.8-7.2-16-16-16z"}}]},name:"appstore",theme:"filled"},Ge=function(o,r){return v.createElement(L,$({},o,{ref:r,icon:_e}))},Ke=v.forwardRef(Ge),Je={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 624c93.9 0 170-75.2 170-168V232c0-92.8-76.1-168-170-168s-170 75.2-170 168v224c0 92.8 76.1 168 170 168zm330-170c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8 0 140.3-113.7 254-254 254S258 594.3 258 454c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8 0 168.7 126.6 307.9 290 327.6V884H326.7c-13.7 0-24.7 14.3-24.7 32v36c0 4.4 2.8 8 6.2 8h407.6c3.4 0 6.2-3.6 6.2-8v-36c0-17.7-11-32-24.7-32H548V782.1c165.3-18 294-158 294-328.1z"}}]},name:"audio",theme:"filled"},Xe=function(o,r){return v.createElement(L,$({},o,{ref:r,icon:Je}))},Ze=v.forwardRef(Xe),et={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M594.3 601.5a111.8 111.8 0 0029.1-75.5c0-61.9-49.9-112-111.4-112s-111.4 50.1-111.4 112c0 29.1 11 55.5 29.1 75.5a158.09 158.09 0 00-74.6 126.1 8 8 0 008 8.4H407c4.2 0 7.6-3.3 7.9-7.5 3.8-50.6 46-90.5 97.2-90.5s93.4 40 97.2 90.5c.3 4.2 3.7 7.5 7.9 7.5H661a8 8 0 008-8.4c-2.8-53.3-32-99.7-74.7-126.1zM512 578c-28.5 0-51.7-23.3-51.7-52s23.2-52 51.7-52 51.7 23.3 51.7 52-23.2 52-51.7 52zm416-354H768v-56c0-4.4-3.6-8-8-8h-56c-4.4 0-8 3.6-8 8v56H548v-56c0-4.4-3.6-8-8-8h-56c-4.4 0-8 3.6-8 8v56H328v-56c0-4.4-3.6-8-8-8h-56c-4.4 0-8 3.6-8 8v56H96c-17.7 0-32 14.3-32 32v576c0 17.7 14.3 32 32 32h832c17.7 0 32-14.3 32-32V256c0-17.7-14.3-32-32-32zm-40 568H136V296h120v56c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8v-56h148v56c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8v-56h148v56c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8v-56h120v496z"}}]},name:"contacts",theme:"outlined"},tt=function(o,r){return v.createElement(L,$({},o,{ref:r,icon:et}))},st=v.forwardRef(tt),nt={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M870 126H663.8c-17.4 0-32.9 11.9-37 29.3C614.3 208.1 567 246 512 246s-102.3-37.9-114.8-90.7a37.93 37.93 0 00-37-29.3H154a44 44 0 00-44 44v252a44 44 0 0044 44h75v388a44 44 0 0044 44h478a44 44 0 0044-44V466h75a44 44 0 0044-44V170a44 44 0 00-44-44z"}}]},name:"skin",theme:"filled"},rt=function(o,r){return v.createElement(L,$({},o,{ref:r,icon:nt}))},it=v.forwardRef(rt),ot={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M868 160h-92v-40c0-4.4-3.6-8-8-8H256c-4.4 0-8 3.6-8 8v40h-92a44 44 0 00-44 44v148c0 81.7 60 149.6 138.2 162C265.6 630.2 359 721.8 476 734.5v105.2H280c-17.7 0-32 14.3-32 32V904c0 4.4 3.6 8 8 8h512c4.4 0 8-3.6 8-8v-32.3c0-17.7-14.3-32-32-32H548V734.5C665 721.8 758.4 630.2 773.8 514 852 501.6 912 433.7 912 352V204a44 44 0 00-44-44zM248 439.6c-37.1-11.9-64-46.7-64-87.6V232h64v207.6zM840 352c0 41-26.9 75.8-64 87.6V232h64v120z"}}]},name:"trophy",theme:"filled"},ct=function(o,r){return v.createElement(L,$({},o,{ref:r,icon:ot}))},se=v.forwardRef(ct);function at(){const[t,o]=v.useState({batchSize:1,history:{}}),r=v.useRef(1),{entries:a}=Ie(!0,"pt",t.batchSize,t.history),m=Y("suspects",!T.isEmpty(a));return console.log(ut(a,m.data??{})),e.jsxs(S,{className:"p-4",gap:12,vertical:!0,children:[e.jsxs(S,{align:"center",justify:"space-between",children:[e.jsx(O.Title,{className:"my-0",level:4,children:"Espionagem Simulator"}),e.jsxs(S,{gap:6,children:[e.jsx(ue,{defaultValue:1,max:100,min:1,onChange:j=>{r.current=j??1}}),e.jsx(C,{onClick:()=>o({batchSize:r.current,history:{}}),type:"primary",children:"Re-run Simulation"})]})]}),e.jsx(lt,{entries:a})]})}function lt({entries:t}){const[o,r]=v.useState(!1),a=Ne(),m=t[a],j=v.useMemo(()=>m?m.statements.reduce((h,u)=>{const{excludes:s}=u;return s.forEach(x=>{h[x]?h[x]++:h[x]=1}),h},{}):{},[m]);return e.jsxs("div",{className:"full-width grid",style:{gridTemplateColumns:"2fr 3fr"},children:[e.jsx(Te,{collapsed:3,src:t??{},theme:"twilight"}),e.jsx("div",{children:m&&e.jsxs(S,{className:"p-4",gap:18,children:[e.jsx("div",{children:e.jsx("div",{style:{width:`${105*4}px`,display:"grid",gap:"6px",gridTemplateColumns:"repeat(4, 1fr)"},children:m.suspects.map(h=>e.jsxs(Q.Ribbon,{color:"cyan",text:o?j[h.id]:null,children:[e.jsx(q,{cardId:h.id,cardWidth:96,className:le(o&&h.id===m.culpritId&&"red-border")},h.id),e.jsxs(S,{align:"center",gap:6,children:[e.jsx(D,{checkedChildren:"ðŸš«",size:"small"})," ",h.id]})]},h.id))})}),e.jsxs("div",{children:[e.jsx("div",{children:e.jsx(D,{checked:o,checkedChildren:"Show Culprit",onChange:r,unCheckedChildren:"Hide Culprit"})}),m.statements.map(h=>e.jsx(O.Paragraph,{children:e.jsx(Q,{color:"cyan",count:h.excludes.length,children:e.jsx(X,{banner:!0,icon:ne(h.type),message:h.text,type:"info"},h.key)})},h.key)),m.additionalStatements.map(h=>e.jsx(O.Paragraph,{children:e.jsx(Q,{color:"cyan",count:h.excludes.length,children:e.jsx(X,{banner:!0,icon:ne(h.type),message:h.text,type:"warning"},h.key)})},h.key))]})]})})]})}const ne=t=>{switch(t){case"testimony":return e.jsx(Ze,{});case"feature":return e.jsx(it,{});case"grid":return e.jsx(Ke,{});default:return"â“"}},ut=(t,o)=>{const r=Object.values(t).reduce((a,m)=>(m.suspects.forEach(j=>{a[j.id]=(a[j.id]||0)+1,j.id===m.culpritId&&(a[`${j.id}_culprit`]=(a[`${j.id}_culprit`]||0)+1)}),a),{});return Object.values(o).forEach(a=>{r[a.id]||(r[a.id]=0),r[`${a.id}_culprit`]||(r[`${a.id}_culprit`]=0)}),r};function ye({suspect:t,values:o,resolution:r,projection:a,yesPercentage:m,noPercentage:j,complete:h,enoughData:u,testimonyId:s,addEntryToUpdate:x,answers:d,barWidth:c,showName:p}){const g=(n,l)=>{const y={...d};y[n]=[...y[n]||[],l],x(s,y)},i=(n,l)=>{const y={...d},w=y[n]?.indexOf(l);w!==-1&&w!==void 0&&(y[n]=[...y[n].slice(0,w),...y[n].slice(w+1)]),x(s,y)};return e.jsxs(we,{content:e.jsxs(S,{align:"center",vertical:!0,children:[e.jsx(O.Text,{type:"secondary",children:o.join(", ")}),e.jsxs(P.Compact,{children:[e.jsx(C,{icon:"+",onClick:()=>g(t.id,1)}),e.jsx(C,{block:!0,icon:"ðŸ‘",onClick:()=>g(t.id,4),children:"Fit"}),e.jsx(C,{icon:"âŒ",onClick:()=>i(t.id,4)}),e.jsx(C,{block:!0,icon:"ðŸ‘Ž",onClick:()=>g(t.id,-4),children:"Unfit"}),e.jsx(C,{icon:"âŒ",onClick:()=>i(t.id,-4)})]}),e.jsx(G,{className:"my-1"}),e.jsxs(P.Compact,{children:[e.jsx(C,{icon:"-",onClick:()=>g(t.id,-1)}),e.jsx(C,{block:!0,icon:"â¬†ï¸",onClick:()=>g(t.id,32),children:"Sure"}),e.jsx(C,{icon:"âœ–ï¸",onClick:()=>i(t.id,32)}),e.jsx(C,{block:!0,icon:"â¬‡ï¸",onClick:()=>g(t.id,-32),children:"Sure"}),e.jsx(C,{icon:"âœ–ï¸",onClick:()=>i(t.id,-32)})]})]}),title:`Add strong fit/unfit answer to ${t.name.pt}`,trigger:"click",children:[p&&e.jsxs("div",{children:[e.jsx(F,{title:t.id,children:t.name.pt})," ",h&&e.jsx(F,{title:"Complete: It has 5 or more answers",children:e.jsx(se,{style:{color:"gold"}})}),!!r&&r]}),e.jsxs(S,{align:"flex-start",gap:12,children:[e.jsx(F,{title:`Values: ${o.join(", ")} : ${r||(a?`${a}*`:"")}`,children:u?e.jsx(ee,{percent:j+m,showInfo:!1,size:[c,20],status:"exception",success:{percent:m}}):e.jsx(ee,{percent:j+m,showInfo:!1,size:[c,10],status:"exception",success:{percent:m}})}),!p&&h&&e.jsx(F,{title:"Complete: It has 5 or more answers",children:e.jsx(se,{style:{color:"gold"}})})]})]})}function dt({suspect:t,answersPerQuestion:o={},questions:r,addEntryToUpdate:a,allAnswers:m}){const{queryParams:j}=N({sortSuspectsBy:"answers"}),h=j.get("sortSuspectsBy")??"answers",[u,s]=v.useState(""),[x,d]=v.useState(!1),c=v.useMemo(()=>{const n=Object.values(r).map(l=>{const y=o[l.id]??{},{enoughData:w,reliable:b,yesPercentage:f,noPercentage:k,blankPercentage:R,values:M,total:U,resolution:B,projection:V,complete:E}=pe(t.id,l.id,{[t.id]:y});return{id:l.id,question:l,enoughData:w,reliable:b,yesPercentage:f,noPercentage:k,blankPercentage:R,values:M,total:U,resolution:B,projection:V,complete:E}});return h==="answers"?T.orderBy(n,["reliable","enoughData","yesPercentage",l=>l.values.length],["desc","desc","desc","desc"]):T.orderBy(n,l=>Number(l.id.split("-")[1]),["asc"])},[o,r,t.id,h]),p=v.useMemo(()=>ht(t,c),[t,c]),g=[{key:"id",title:"Id",dataIndex:"id",width:"7%"},{key:"question",title:"Question",dataIndex:"question",render:n=>n.question},{key:"answer",title:"Answer",dataIndex:"id",width:"170px",sorter:(n,l)=>n.total-l.total,render:n=>{const l=c.find(y=>y.id===n);return l?e.jsx(S,{gap:8,wrap:"nowrap",children:e.jsx(ye,{addEntryToUpdate:a,answers:m[l.question.id]||{},barWidth:120,complete:l.complete,enoughData:l.enoughData,noPercentage:l.noPercentage,projection:l.projection,resolution:l.resolution,suspect:t,testimonyId:l.question.id,values:l.values,yesPercentage:l.yesPercentage})}):""}},{key:"actions",title:"Actions",dataIndex:"id",width:"auto",render:n=>{const l=c.find(y=>y.id===n);return l?e.jsx(mt,{addEntryToUpdate:a,answers:m[l.question.id]||{},suspect:t,testimonyId:l.question.id}):""}}],i=v.useMemo(()=>{let n=c;return u.trim()&&(n=n.filter(l=>l.question.question.toLowerCase().includes(u.toLowerCase())||l.id.toLowerCase().includes(u.toLowerCase()))),x&&(n=n.filter(l=>l.values.reduce((w,b)=>w+Math.abs(b===0?-1:b),0)<=2)),n},[c,u,x]);return e.jsxs(P,{size:"large",wrap:!0,children:[e.jsxs(S,{className:"full-width",gap:16,vertical:!0,children:[e.jsxs(S,{gap:6,children:[e.jsx(W,{allowClear:!0,onChange:n=>s(n.target.value),placeholder:"Search questions...",prefix:e.jsx(ce,{}),style:{marginBottom:16,width:320},value:u}),e.jsxs(S,{align:"center",gap:8,children:[e.jsx(D,{checked:x,onChange:d}),e.jsx(O.Text,{children:"Show only missing questions"})]})]}),e.jsx(K,{bordered:!0,className:"full-width",columns:g,dataSource:i,rowKey:"id",tableLayout:"fixed"})]}),e.jsxs(S,{gap:8,vertical:!0,children:[e.jsx(O.Title,{level:5,children:"Suspect Description"}),e.jsx(W.TextArea,{className:"full-width",readOnly:!0,rows:7,value:p})]})]})}const ht=(t,o)=>{const r=o.filter(a=>a.resolution||a.projection).map(a=>{const{question:m,resolution:j,projection:h}=a,u=j||h;return`${t.gender==="male"?"ele":"ela"} ${u==="ðŸ‘"?"":"nÃ£o "}${m.answer.toLocaleLowerCase()}`});return`${t.name.pt}: ${r.join(", ")}`};function mt({suspect:t,testimonyId:o,addEntryToUpdate:r,answers:a}){const m=(u,s)=>{const x={...a};x[u]=[...x[u]||[],s],r(o,x)},j=(u,s)=>{const x={...a},d=x[u]?.indexOf(s);d!==-1&&d!==void 0&&(x[u]=[...x[u].slice(0,d),...x[u].slice(d+1)]),r(o,x)},h=v.useMemo(()=>Object.values(a[t.id]||{}).reduce((u,s)=>u+Math.abs(s===0?-1:s),0),[a,t.id]);return e.jsxs(S,{align:"center",gap:6,wrap:"nowrap",children:[e.jsx(Q,{color:h>20?"gold":"grey",count:h,showZero:!0,style:{minWidth:32}}),e.jsxs(P.Compact,{children:[e.jsx(C,{block:!0,icon:"ðŸ‘",onClick:()=>m(t.id,4),children:"FIT"}),e.jsx(C,{icon:"âŒ",onClick:()=>j(t.id,4)}),e.jsx(C,{block:!0,icon:"ðŸ‘Ž",onClick:()=>m(t.id,-4),children:"UNFIT"}),e.jsx(C,{icon:"âŒ",onClick:()=>j(t.id,-4)}),e.jsx(C,{block:!0,icon:"â¬†ï¸",onClick:()=>m(t.id,32),children:"Sure"}),e.jsx(C,{icon:"âœ–ï¸",onClick:()=>j(t.id,32)}),e.jsx(C,{block:!0,icon:"â¬‡ï¸",onClick:()=>m(t.id,-32),children:"Sure"}),e.jsx(C,{icon:"âœ–ï¸",onClick:()=>j(t.id,-32)})]})]})}function pt({isLoading:t,isSuccess:o,questions:r,data:a,suspects:m,addEntryToUpdate:j}){const{queryParams:h,addParam:u}=N(),s=Object.values(r).map(({id:i,question:n})=>({id:i,question:n})),x=v.useMemo(()=>Object.keys(a).reduce((i,n)=>{const l=a[n]??{};return Object.keys(l).forEach(y=>{i[y]||(i[y]={}),i[y][n]=l[y]}),i},{}),[a]),d=v.useMemo(()=>T.orderBy(Object.values(m).map(i=>({...i,answers:x[i.id]})),i=>Number(i.id.split("-")[1]),"asc"),[m,x]),c=me({total:d.length,showQuickJumper:!0}),p=[{title:"Id",dataIndex:"id",key:"id",sorter:(i,n)=>Number(i.id.split("-")[1])-Number(n.id.split("-")[1])},{title:"Picture",dataIndex:"id",render:i=>e.jsx(q,{cardId:i,cardWidth:48})},{title:"Name",dataIndex:"name",key:"name",sorter:(i,n)=>i.name.pt.localeCompare(n.name.pt),render:(i,n)=>e.jsxs(S,{vertical:!0,children:[e.jsx(O.Text,{children:i.pt}),e.jsx(O.Text,{type:"secondary",children:i.en}),e.jsx(O.Text,{italic:!0,type:"secondary",children:e.jsx("small",{children:n.persona.en})})]})},{title:"Questions Answered",dataIndex:"answers",key:"answers",sorter:(i,n)=>Object.keys(i.answers??{}).length-Object.keys(n.answers??{}).length,render:i=>i?Object.values(i).length:""}],g=he({maxExpandedRows:1,expandedRowRender:i=>e.jsx(dt,{addEntryToUpdate:j,allAnswers:a,answersPerQuestion:i.answers,questions:r,suspect:i}),rowExpandable:()=>o});return e.jsxs(S,{className:"full-width py-4",gap:12,vertical:!0,children:[e.jsxs(S,{align:"center",justify:"space-between",children:[e.jsx(O.Title,{className:"my-0",level:4,children:"Testimonies by Suspect"}),e.jsx(de,{data:s,fileName:"newQuestions.json"}),e.jsx(D,{checked:h.get("sortSuspectsBy")==="answers",checkedChildren:"Sort by Answers",onChange:i=>u("sortSuspectsBy",i?"answers":"id"),unCheckedChildren:"Sort by Id"})]}),e.jsx(K,{bordered:!0,className:"full-width",columns:p,dataSource:d,expandable:g,loading:t,pagination:c,rowKey:"id"})]})}function ft({answers:t,suspects:o,addEntryToUpdate:r,testimonyId:a,question:m}){const[j,h]=Ee(12),{queryParams:u,is:s}=N({sortSuspectsBy:"answers"}),x=s("enableBatch"),d=u.get("sortSuspectsBy")??"answers",c=v.useMemo(()=>{const i=Object.keys(o).map(n=>pe(n,a,t));return d==="answers"?T.orderBy(i,["reliable","enoughData",n=>n.values.length,"yesPercentage","noPercentage",n=>Number(n.suspectCardId.split("-")[1])],["desc","desc","desc","desc","desc","asc"]):T.orderBy(i,n=>Number(n.suspectCardId.split("-")[1]),["asc"])},[t,o,a,d]),[p,g]=v.useState([]);return e.jsxs(P,{direction:"vertical",children:[e.jsx(jt,{addEntryToUpdate:r,answers:t,list:c,question:m,selection:p,setSelection:g,suspects:o,testimonyId:a}),e.jsx(P,{ref:h,size:"large",wrap:!0,children:c.map(i=>e.jsxs(S,{className:le({"selection-outline":x&&p.includes(i.suspectCardId)}),gap:6,vertical:!0,children:[e.jsx(q,{cardId:i.imageId,cardWidth:j,className:i.values.length>1||i.enoughData?void 0:"grayscale"}),e.jsxs(S,{gap:4,children:[x&&e.jsx(je,{checked:p.includes(i.suspectCardId),disabled:i.complete,onChange:n=>{const l=n.target.checked;g(y=>l?[...y,i.suspectCardId]:y.filter(w=>w!==i.suspectCardId))}}),e.jsx(ye,{addEntryToUpdate:r,answers:t,barWidth:j,complete:i.complete,enoughData:i.enoughData,noPercentage:i.noPercentage,projection:i.projection,resolution:i.resolution,showName:!0,suspect:o[i.suspectCardId],testimonyId:a,values:i.values,yesPercentage:i.yesPercentage})]})]},i.suspectCardId))})]})}function jt({question:t,testimonyId:o,selection:r,setSelection:a,suspects:m,addEntryToUpdate:j,list:h,answers:u}){const[s,x]=v.useState([]),{addParam:d,removeParam:c,is:p}=N({sortSuspectsBy:"answers"}),g=p("enableBatch"),i=y=>{x(w=>w.includes(y)?w.filter(b=>b!==y):[...w,y])},n=v.useMemo(()=>T.keyBy(h,"suspectCardId"),[h]);v.useEffect(()=>{if(s.length===0&&r.length>0){a([]);return}if(!s.length)return;const y=r.length>0?r:Object.values(n).filter(b=>!b.complete&&!b.values.includes(4)&&!b.values.includes(-4)).map(b=>b.suspectCardId);if(s.includes("empty")){const b=Object.values(n).filter(f=>f.values.length===0).map(f=>f.suspectCardId);a(b);return}if(s.includes("incompletePos")){const b=Object.values(n).filter(f=>!f.complete&&f.yesCount<4&&f.yesCount>0&&f.noCount===0).map(f=>f.suspectCardId);a(b);return}if(s.includes("incompleteNeg")){const b=Object.values(n).filter(f=>!f.complete&&f.noCount<4&&f.noCount>0&&f.yesCount===0).map(f=>f.suspectCardId);a(b);return}const w=y.filter(b=>{const f=m[b],k=[f.gender,f.ethnicity,f.build,f.height];return f.age==="18-21"&&k.push("young"),(f.age==="21-30"||f.age==="30-40")&&k.push("adult"),f.age==="40-50"&&k.push("parent"),(f.age==="50-60"||f.age==="60-70"||f.age==="70-80"||f.age==="80-90")&&k.push("senior"),s.every(R=>k.includes(R))});a(w)},[s]);const l=y=>{const w=T.cloneDeep(u);r.forEach(b=>{w[b]=[...w[b]||[],y]}),j(o,w),x([])};return e.jsxs(e.Fragment,{children:[e.jsxs(S,{align:"center",className:"mb-4",gap:6,justify:"space-between",children:[e.jsxs(S,{gap:3,children:[e.jsx(O.Text,{className:"nowrap",style:{minWidth:"5ch"},children:"Batch"}),e.jsx(D,{checkedChildren:"On",onChange:y=>{y?d("enableBatch",!0):c("enableBatch")},unCheckedChildren:"Off",value:g})]}),g&&e.jsxs(e.Fragment,{children:[e.jsxs(O.Text,{className:"nowrap mr-2",children:["Selected ",r.length.toString().padStart(3,"0")]}),e.jsx(S,{align:"center",className:"boxed",gap:6,justify:"center",wrap:!0,children:e.jsx(I,{activeFilters:s,end:!0,filter:"empty",updateActiveFilter:i})}),e.jsxs(S,{align:"center",className:"boxed",gap:6,justify:"center",wrap:!0,children:[e.jsx(I,{activeFilters:s,end:!0,filter:"incompletePos",label:"Incomplete+",updateActiveFilter:i}),e.jsx(I,{activeFilters:s,end:!0,filter:"incompleteNeg",label:"Incomplete-",updateActiveFilter:i})]}),e.jsxs(S,{align:"center",className:"boxed",gap:6,justify:"center",wrap:!0,children:[e.jsx(I,{activeFilters:s,filter:"male",updateActiveFilter:i}),e.jsx(I,{activeFilters:s,filter:"female",updateActiveFilter:i}),e.jsx(I,{activeFilters:s,filter:"young",updateActiveFilter:i}),e.jsx(I,{activeFilters:s,filter:"adult",updateActiveFilter:i}),e.jsx(I,{activeFilters:s,filter:"parent",updateActiveFilter:i}),e.jsx(I,{activeFilters:s,filter:"senior",updateActiveFilter:i}),e.jsx(I,{activeFilters:s,filter:"thin",updateActiveFilter:i}),e.jsx(I,{activeFilters:s,filter:"muscular",updateActiveFilter:i}),e.jsx(I,{activeFilters:s,filter:"large",updateActiveFilter:i}),e.jsx(I,{activeFilters:s,filter:"asian",updateActiveFilter:i}),e.jsx(I,{activeFilters:s,filter:"black",updateActiveFilter:i}),e.jsx(I,{activeFilters:s,filter:"caucasian",updateActiveFilter:i}),e.jsx(I,{activeFilters:s,end:!0,filter:"latino",updateActiveFilter:i})]}),e.jsxs(S,{align:"center",gap:6,children:[e.jsx(C,{danger:!0,onClick:()=>x([]),size:"small",children:"Clear"}),e.jsx(te,{onConfirm:()=>l(4),title:"Apply +4 to selected suspects?",children:e.jsx(C,{className:"ml-10",disabled:r.length===0,size:"small",type:"primary",children:"Apply +4"})}),e.jsx(G,{type:"vertical"}),e.jsx(te,{onConfirm:()=>l(-4),title:"Apply -4 to selected suspects?",children:e.jsx(C,{disabled:r.length===0,size:"small",type:"primary",children:"Apply -4"})})]})]})]}),r.length>0&&e.jsxs(z.Group,{shape:"square",style:{insetInlineEnd:94},children:[e.jsx(z,{badge:{count:r.length,color:"green",size:"small"},icon:"ðŸ‘",onClick:()=>l(4),tooltip:{title:t,placement:"left"}}),e.jsx(z,{badge:{count:r.length,color:"red",size:"small"},icon:"ðŸ‘Ž",onClick:()=>l(-4),tooltip:{title:t,placement:"left"}}),e.jsx(z,{icon:e.jsx(Fe,{}),onClick:()=>x([]),tooltip:{title:"Clear selection",placement:"left"}}),e.jsx(z.BackTop,{visibilityHeight:0})]})]})}function I({filter:t,activeFilters:o,updateActiveFilter:r,end:a,label:m}){return e.jsxs(e.Fragment,{children:[e.jsxs("span",{children:[e.jsx(je,{checked:o.includes(t),onClick:()=>r(t)})," ",m??T.capitalize(t)]}),!a&&e.jsx(G,{type:"vertical"})]})}function xt({data:t,questions:o,suspects:r,isLoading:a,isSuccess:m,addEntryToUpdate:j}){const{queryParams:h,addParam:u}=N(),[s,x]=v.useState(""),d=v.useMemo(()=>T.orderBy(Object.values(o).map(n=>({...n,answersCount:Object.values(t[n.id]??{}).length})),n=>Number(n.id.split("-")[1]),"asc"),[o]),c=v.useMemo(()=>s.trim()?d.filter(n=>n.question.toLowerCase().includes(s.toLowerCase())||n.id.toLowerCase().includes(s.toLowerCase())):d,[d,s]),p=me({total:c.length,showQuickJumper:!0}),g=[{title:"Id",dataIndex:"id",key:"id",sorter:(n,l)=>Number(n.id.split("-")[1])-Number(l.id.split("-")[1])},{title:"Question",dataIndex:"question",key:"question",sorter:(n,l)=>n.question.localeCompare(l.question)},{title:"NSFW",dataIndex:"nsfw",key:"nsfw",render:n=>n?e.jsx(ve,{style:{color:"hotPink"}}):"",sorter:(n,l)=>Number(n.nsfw)-Number(l.nsfw)},{title:"Answers",dataIndex:"answersCount",key:"answersCount",sorter:(n,l)=>n.answersCount-l.answersCount}],i=he({maxExpandedRows:1,expandedRowRender:n=>e.jsx(ft,{addEntryToUpdate:j,answers:t[n.id]??{},question:n.question,suspects:r,testimonyId:n.id},n.id),rowExpandable:()=>m});return e.jsxs(S,{className:"full-width py-4",gap:12,vertical:!0,children:[e.jsxs(S,{align:"center",justify:"space-between",children:[e.jsx(O.Title,{className:"my-0",level:4,children:"Suspects by Testimony"}),e.jsx(D,{checked:h.get("sortSuspectsBy")==="answers",checkedChildren:"Sort by Answers",onChange:n=>u("sortSuspectsBy",n?"answers":"id"),unCheckedChildren:"Sort by Id"})]}),e.jsxs(S,{gap:6,children:[e.jsx(W,{allowClear:!0,onChange:n=>x(n.target.value),placeholder:"Search questions by text or ID...",prefix:e.jsx(ce,{}),style:{width:320},value:s}),e.jsx(F,{title:"Set random question",children:e.jsx(C,{icon:e.jsx(Re,{}),onClick:()=>x(T.sample(Object.keys(o))??"")})})]}),e.jsx(K,{bordered:!0,className:"full-width",columns:g,dataSource:c,expandable:i,loading:a,pagination:p,rowKey:"id"})]})}function gt(t){const{queryParams:o,is:r}=N();return e.jsxs(e.Fragment,{children:[(r("display","questions")||!o.get("display"))&&e.jsx(xt,{...t}),r("display","suspects")&&e.jsx(pt,{...t}),r("display","simulator")&&e.jsx(at,{})]})}const yt="Left",bt="Right",wt="Up",vt="Down",A={delta:10,preventScrollOnSwipe:!1,rotationAngle:0,trackMouse:!1,trackTouch:!0,swipeDuration:1/0,touchEventOptions:{passive:!0}},_={first:!0,initial:[0,0],start:0,swiping:!1,xy:[0,0]},re="mousemove",ie="mouseup",St="touchend",Ct="touchmove",kt="touchstart";function Ot(t,o,r,a){return t>o?r>0?bt:yt:a>0?vt:wt}function oe(t,o){if(o===0)return t;const r=Math.PI/180*o,a=t[0]*Math.cos(r)+t[1]*Math.sin(r),m=t[1]*Math.cos(r)-t[0]*Math.sin(r);return[a,m]}function Tt(t,o){const r=d=>{const c="touches"in d;c&&d.touches.length>1||t((p,g)=>{g.trackMouse&&!c&&(document.addEventListener(re,a),document.addEventListener(ie,h));const{clientX:i,clientY:n}=c?d.touches[0]:d,l=oe([i,n],g.rotationAngle);return g.onTouchStartOrOnMouseDown&&g.onTouchStartOrOnMouseDown({event:d}),Object.assign(Object.assign(Object.assign({},p),_),{initial:l.slice(),xy:l,start:d.timeStamp||0})})},a=d=>{t((c,p)=>{const g="touches"in d;if(g&&d.touches.length>1)return c;if(d.timeStamp-c.start>p.swipeDuration)return c.swiping?Object.assign(Object.assign({},c),{swiping:!1}):c;const{clientX:i,clientY:n}=g?d.touches[0]:d,[l,y]=oe([i,n],p.rotationAngle),w=l-c.xy[0],b=y-c.xy[1],f=Math.abs(w),k=Math.abs(b),R=(d.timeStamp||0)-c.start,M=Math.sqrt(f*f+k*k)/(R||1),U=[w/(R||1),b/(R||1)],B=Ot(f,k,w,b),V=typeof p.delta=="number"?p.delta:p.delta[B.toLowerCase()]||A.delta;if(f<V&&k<V&&!c.swiping)return c;const E={absX:f,absY:k,deltaX:w,deltaY:b,dir:B,event:d,first:c.first,initial:c.initial,velocity:M,vxvy:U};E.first&&p.onSwipeStart&&p.onSwipeStart(E),p.onSwiping&&p.onSwiping(E);let J=!1;return(p.onSwiping||p.onSwiped||p[`onSwiped${B}`])&&(J=!0),J&&p.preventScrollOnSwipe&&p.trackTouch&&d.cancelable&&d.preventDefault(),Object.assign(Object.assign({},c),{first:!1,eventData:E,swiping:!0})})},m=d=>{t((c,p)=>{let g;if(c.swiping&&c.eventData){if(d.timeStamp-c.start<p.swipeDuration){g=Object.assign(Object.assign({},c.eventData),{event:d}),p.onSwiped&&p.onSwiped(g);const i=p[`onSwiped${g.dir}`];i&&i(g)}}else p.onTap&&p.onTap({event:d});return p.onTouchEndOrOnMouseUp&&p.onTouchEndOrOnMouseUp({event:d}),Object.assign(Object.assign(Object.assign({},c),_),{eventData:g})})},j=()=>{document.removeEventListener(re,a),document.removeEventListener(ie,h)},h=d=>{j(),m(d)},u=(d,c)=>{let p=()=>{};if(d&&d.addEventListener){const g=Object.assign(Object.assign({},A.touchEventOptions),c.touchEventOptions),i=[[kt,r,g],[Ct,a,Object.assign(Object.assign({},g),c.preventScrollOnSwipe?{passive:!1}:{})],[St,m,g]];i.forEach(([n,l,y])=>d.addEventListener(n,l,y)),p=()=>i.forEach(([n,l])=>d.removeEventListener(n,l))}return p},x={ref:d=>{d!==null&&t((c,p)=>{if(c.el===d)return c;const g={};return c.el&&c.el!==d&&c.cleanUpTouch&&(c.cleanUpTouch(),g.cleanUpTouch=void 0),p.trackTouch&&d&&(g.cleanUpTouch=u(d,p)),Object.assign(Object.assign(Object.assign({},c),{el:d}),g)})}};return o.trackMouse&&(x.onMouseDown=r),[x,u]}function It(t,o,r,a){return!o.trackTouch||!t.el?(t.cleanUpTouch&&t.cleanUpTouch(),Object.assign(Object.assign({},t),{cleanUpTouch:void 0})):t.cleanUpTouch?o.preventScrollOnSwipe!==r.preventScrollOnSwipe||o.touchEventOptions.passive!==r.touchEventOptions.passive?(t.cleanUpTouch(),Object.assign(Object.assign({},t),{cleanUpTouch:a(t.el,o)})):t:Object.assign(Object.assign({},t),{cleanUpTouch:a(t.el,o)})}function Rt(t){const{trackMouse:o}=t,r=v.useRef(Object.assign({},_)),a=v.useRef(Object.assign({},A)),m=v.useRef(Object.assign({},a.current));m.current=Object.assign({},a.current),a.current=Object.assign(Object.assign({},A),t);let j;for(j in A)a.current[j]===void 0&&(a.current[j]=A[j]);const[h,u]=v.useMemo(()=>Tt(s=>r.current=s(r.current,a.current),{trackMouse:o}),[o]);return r.current=It(r.current,a.current,m.current,u),h}function Nt(t){const{addParam:o}=N();return e.jsxs(S,{gap:8,vertical:!0,children:[e.jsx(C,{block:!0,onClick:()=>o("testify","single"),children:"Testify Drawer"}),e.jsx(C,{block:!0,onClick:()=>o("testify","group"),children:"Testify Group"}),e.jsx(Dt,{...t}),e.jsx(Pt,{...t})]})}function Dt({suspects:t,questions:o,answers:r,addEntryToUpdate:a}){const{width:m,height:j}=xe(),{is:h,removeParam:u}=N(),[s,x]=ge(),d=Rt({onSwipedLeft:()=>alert("Swiped Left"),onSwipedRight:()=>alert("Swiped Right"),onSwipedUp:()=>alert("Swiped Up"),preventScrollOnSwipe:!0,trackTouch:!0,trackMouse:!0}),c=()=>{x({suspectId:T.sample(Object.keys(t))||null,testimonyId:T.sample(Object.keys(o))||null})},p=()=>{c()},g=()=>{if(s?.suspectId&&s?.testimonyId){const l=T.cloneDeep(r[s?.testimonyId??""]??{});l[s.suspectId]=[...l[s.suspectId]||[],1],a(s.testimonyId??"",l),c()}},i=()=>{if(s?.suspectId&&s?.testimonyId){const l=T.cloneDeep(r[s?.testimonyId??""]??{});l[s.suspectId]=[...l[s.suspectId]||[],-1],a(s.testimonyId??"",l),c()}},n=!!s?.suspectId&&!!s?.testimonyId;return e.jsx(ae,{footer:null,maskClosable:!1,onCancel:()=>u("testify"),open:h("testify","single"),title:e.jsx(O,{children:"Does this person do this??"}),width:m-64,children:e.jsxs("div",{...d,children:[n&&e.jsxs(S,{align:"center",className:"mb-8",gap:8,justify:"center",vertical:!0,children:[e.jsx(q,{cardId:s.suspectId??"",cardWidth:Math.max(j/4,128)}),e.jsx(O.Title,{className:"text-center",level:5,children:o[s.testimonyId??""]?.question})]}),e.jsxs(P.Compact,{block:!0,className:"mb-8",size:"large",children:[e.jsx(C,{block:!0,disabled:!n,icon:"ðŸ‘Ž",onClick:i,style:{height:64},children:"No"}),e.jsx(C,{block:!0,onClick:p,style:{height:64},children:"Skip"}),e.jsx(C,{block:!0,disabled:!n,icon:"ðŸ‘",iconPosition:"end",onClick:g,style:{height:64},children:"Yes"})]})]})})}function Pt({suspects:t,questions:o,answers:r,addEntryToUpdate:a}){const{width:m,height:j}=xe(),{is:h,removeParam:u}=N(),[s,x]=ge(),[d,c]=v.useState(6),[p,g]=v.useState(!0),i=()=>{const w=(p?T.sample(Object.keys(o)):s?.testimonyId)??null,b=T.sampleSize(Object.keys(t).filter(f=>{const k=r[w??""]?.[f]||[];return fe(k)<4}),d).reduce((f,k)=>(f[k]=null,f),{});x({suspectsIds:b,testimonyId:w})};Se(()=>i());const n=()=>{const w=Object.entries(s?.suspectsIds??{}).reduce((b,[f,k])=>(k!==null&&(b[f]=[k]),b),{});if(s?.testimonyId&&Object.keys(w).length>0){const b=T.cloneDeep(r[s.testimonyId]??{});Object.entries(w).forEach(([f,k])=>{b[f]=[...b[f]||[],...k]}),a(s.testimonyId,b)}else console.log("No testimonyId or no judged suspects found, likely skipped");i()},l=!!s?.suspectsIds&&!!s?.testimonyId,y=w=>{x(b=>{if(!b)return b;const f=Object.entries(b.suspectsIds).reduce((k,[R,M])=>(k[R]=M===null?w:M,k),{});return{...b,suspectsIds:f}})};return e.jsx(ae,{footer:null,maskClosable:!1,onCancel:()=>u("testify"),open:h("testify","group"),title:e.jsx(O,{children:"Do these people do this??"}),width:m-64,children:e.jsxs("div",{children:[l&&e.jsxs(S,{align:"center",className:"mb-8",gap:8,justify:"center",vertical:!0,children:[e.jsxs(S,{align:"center",gap:6,justify:"center",children:[e.jsx(O.Text,{children:"Number of Suspects:"}),e.jsx(ue,{onChange:w=>c(w??6),size:"small",value:d}),e.jsx(O.Text,{children:"Random Questions:"}),e.jsx(D,{checked:p,onChange:g,size:"small"})]}),e.jsxs(O.Title,{className:"text-center",level:4,children:[s.testimonyId," - ",o[s.testimonyId??""]?.question]}),e.jsx(S,{gap:8,justify:"center",wrap:"wrap",children:Object.keys(s.suspectsIds).map(w=>e.jsxs(S,{align:"center",justify:"center",vertical:!0,children:[e.jsx(O.Text,{className:"text-center",children:t[w]?.name?.pt||"Unknown"}),e.jsx(q,{cardId:w,cardWidth:Math.min(Math.max(j/3,128),128)},w),e.jsx(De,{onChange:b=>x(f=>f&&{...f,suspectsIds:{...f.suspectsIds,[w]:b}}),options:[{value:-4,icon:"ðŸ‘Ž"},{value:null,icon:"â™¾"},{value:4,icon:"ðŸ‘"}],shape:"round",size:"large",value:s.suspectsIds[w]})]},w))})]}),e.jsxs(S,{align:"center",className:"mt-8",justify:"space-between",children:[e.jsx("span",{}),e.jsxs(S,{gap:8,children:[e.jsx(C,{onClick:()=>y(-4),children:"Set all â™¾ to ðŸ‘Ž"}),e.jsx(C,{onClick:()=>y(4),children:"Set all â™¾ to ðŸ‘"})]}),e.jsx(C,{onClick:n,size:"large",children:"Next Set"})]})]})})}function Mt({suspects:t,questions:o,data:r,hasNewData:a,isDirty:m,save:j,isSaving:h,entriesToUpdate:u,addEntryToUpdate:s}){const{queryParams:x,addParams:d}=N(),c=v.useMemo(()=>{let g=0;const i={};return Object.values(r).forEach(n=>{Object.keys(n).forEach(l=>{if(n[l]){i[l]||(i[l]=0);const y=fe(n[l]);y>=5&&(i[l]+=1),y>=3&&(g+=1)}})}),{absoluteTotal:g,queriedTestimoniesCount:Object.keys(r).length,suspectsCount:Object.keys(i).length,reliableSuspectsCount:Object.values(i).filter(n=>n>=30).length}},[r]),p=c.queriedTestimoniesCount*c.suspectsCount;return e.jsxs(e.Fragment,{children:[e.jsx(H,{children:e.jsxs(S,{gap:12,vertical:!0,children:[e.jsx(ze,{dirt:JSON.stringify(u),isDirty:m,isSaving:h,onSave:j}),e.jsx(de,{block:!0,data:async()=>await Et(r),disabled:m,fileName:"testimony-answers.json",hasNewData:a}),e.jsx(Ae,{label:"FS Data",path:"data/testimonies"}),e.jsx(Be,{docId:"testimonies",label:"FS TDR",path:"tdr",queryKey:["tdr","testimonies"]})]})}),e.jsxs(H,{children:[e.jsx(Pe,{label:"Display",onChange:g=>d({display:g,page:1},{page:1}),options:[{title:"Questions",icon:e.jsx(Qe,{}),value:"questions"},{title:"Suspects",icon:e.jsx(st,{}),value:"suspects"},{title:"Simulator",icon:e.jsx(Ue,{}),value:"simulator"}],value:x.get("display")??"questions"}),e.jsx(Le,{})]}),e.jsx(H,{children:e.jsxs("div",{style:{fontSize:"0.85em"},children:[e.jsx("strong",{children:"Legend"}),e.jsxs("ul",{children:[e.jsx("li",{children:"Reliability: At least 5 votes"}),e.jsx("li",{children:"Large Bars: There's enough data (at least 3)"}),e.jsx("li",{children:"Small blue bar: in progress negative"})]})]})}),e.jsxs(H,{children:[e.jsxs("div",{style:{fontSize:"0.85em"},children:[e.jsx("strong",{children:"Counts"}),e.jsxs("ul",{children:[e.jsxs("li",{children:["Testimonies: ",c.queriedTestimoniesCount]}),e.jsxs("li",{children:["Suspects: ",c.suspectsCount]}),e.jsx("li",{children:e.jsxs(F,{title:"A reliable suspect is one that has at least 5 complete testimonies.",children:["Reliable suspects: ",c.reliableSuspectsCount]})}),e.jsxs("li",{children:["Complete: ",c.absoluteTotal]}),e.jsxs("li",{children:["Total: ",p]}),e.jsxs("li",{children:["Percentage: ",(c.absoluteTotal/p*100).toFixed(1),"%"]})]})]}),e.jsx(Nt,{addEntryToUpdate:s,answers:r,questions:o,suspects:t})]})]})}async function Et(t){console.log("Preparing file for download...x");const o=await $e("data","testimonies")(),r=qe(o);console.log("Parsed data from Firestore:",r);const a=T.cloneDeep(t);return Object.keys(a).forEach(m=>{const j=a[m],h=r[m]||{};Object.keys(j).forEach(u=>{const s=h[u]||[],x=Me([...j[u],...s]);j[u]=x})}),Ve(He(a))}function Ft(){const t=Y("suspects"),o=Y("testimony-questions-pt"),r=We({tdrResourceName:"testimony-answers",firestoreDataCollectionName:"testimonies",serialize:!0});return{...r,isLoading:r.isLoading||o.isLoading||t.isLoading,isSuccess:r.isSuccess&&o.isSuccess&&t.isSuccess,error:r.error||o.error||t.error,questions:o.data,suspects:t.data,hasNewData:r.hasFirestoreData}}function Rs(){const t=Ft();return e.jsx(Ce,{subtitle:"Suspect Testimony Rates",title:"Testimonies",children:e.jsxs(Z,{hasSider:!0,children:[e.jsx(Oe,{children:e.jsx(Mt,{...t})}),e.jsx(Z.Content,{className:"content",children:e.jsx(ke,{error:t.error,hasResponseData:!T.isEmpty(t.data),isLoading:t.isLoading,children:e.jsx(gt,{...t})})})]})})}export{Rs as TestimoniesPage,Rs as default};
