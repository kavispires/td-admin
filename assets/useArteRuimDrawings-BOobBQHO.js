var U=r=>{throw TypeError(r)};var P=(r,e,s)=>e.has(r)||U("Cannot "+s);var u=(r,e,s)=>(P(r,e,"read from private field"),s?s.call(r):e.get(r)),v=(r,e,s)=>e.has(r)?U("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(r):e.set(r,s),b=(r,e,s,t)=>(P(r,e,"write to private field"),t?t.call(r,s):e.set(r,s),s),A=(r,e,s)=>(P(r,e,"access private method"),s);import{aP as J,aQ as q,aR as X,V as Y,r as R,j as $,W as Z,aS as ss}from"./index-BZlgVGyQ.js";import{Q as G,b as es,d as ts,e as rs,f as is,g as ns,n as os,s as _,h as K,w as as,i as us,a as cs}from"./useBaseUrl-DfdTaQhG.js";import{g as V}from"./useGetFirebaseDoc-B_niq1mS.js";import{u as ds}from"./useTDResource-DknGbtCY.js";import{l as W}from"./lodash-C-CNgKU_.js";import{g as fs}from"./constants--noGxxjp.js";function z(r,e){return r.filter(s=>!e.includes(s))}function hs(r,e,s){const t=r.slice(0);return t[e]=s,t}var x,y,S,D,w,E,L,M,k,p,F,N,j,T,B,H,ls=(H=class extends J{constructor(e,s,t){super();v(this,p);v(this,x);v(this,y);v(this,S);v(this,D);v(this,w);v(this,E);v(this,L);v(this,M);v(this,k,[]);b(this,x,e),b(this,D,t),b(this,S,[]),b(this,w,[]),b(this,y,[]),this.setQueries(s)}onSubscribe(){this.listeners.size===1&&u(this,w).forEach(e=>{e.subscribe(s=>{A(this,p,T).call(this,e,s)})})}onUnsubscribe(){this.listeners.size||this.destroy()}destroy(){this.listeners=new Set,u(this,w).forEach(e=>{e.destroy()})}setQueries(e,s,t){b(this,S,e),b(this,D,s),q.batch(()=>{const i=u(this,w),n=A(this,p,j).call(this,u(this,S));b(this,k,n),n.forEach(c=>c.observer.setOptions(c.defaultedQueryOptions,t));const a=n.map(c=>c.observer),d=a.map(c=>c.getCurrentResult()),o=a.some((c,f)=>c!==i[f]);i.length===a.length&&!o||(b(this,w,a),b(this,y,d),this.hasListeners()&&(z(i,a).forEach(c=>{c.destroy()}),z(a,i).forEach(c=>{c.subscribe(f=>{A(this,p,T).call(this,c,f)})}),A(this,p,B).call(this)))})}getCurrentResult(){return u(this,y)}getQueries(){return u(this,w).map(e=>e.getCurrentQuery())}getObservers(){return u(this,w)}getOptimisticResult(e,s){const t=A(this,p,j).call(this,e),i=t.map(n=>n.observer.getOptimisticResult(n.defaultedQueryOptions));return[i,n=>A(this,p,N).call(this,n??i,s),()=>A(this,p,F).call(this,i,t)]}},x=new WeakMap,y=new WeakMap,S=new WeakMap,D=new WeakMap,w=new WeakMap,E=new WeakMap,L=new WeakMap,M=new WeakMap,k=new WeakMap,p=new WeakSet,F=function(e,s){return s.map((t,i)=>{const n=e[i];return t.defaultedQueryOptions.notifyOnChangeProps?n:t.observer.trackResult(n,a=>{s.forEach(d=>{d.observer.trackProp(a)})})})},N=function(e,s){return s?((!u(this,E)||u(this,y)!==u(this,M)||s!==u(this,L))&&(b(this,L,s),b(this,M,u(this,y)),b(this,E,X(u(this,E),s(e)))),u(this,E)):e},j=function(e){const s=new Map(u(this,w).map(i=>[i.options.queryHash,i])),t=[];return e.forEach(i=>{const n=u(this,x).defaultQueryOptions(i),a=s.get(n.queryHash);a?t.push({defaultedQueryOptions:n,observer:a}):t.push({defaultedQueryOptions:n,observer:new G(u(this,x),n)})}),t},T=function(e,s){const t=u(this,w).indexOf(e);t!==-1&&(b(this,y,hs(u(this,y),t,s)),A(this,p,B).call(this))},B=function(){var e;if(this.hasListeners()){const s=u(this,E),t=A(this,p,F).call(this,u(this,y),u(this,k)),i=A(this,p,N).call(this,t,(e=u(this,D))==null?void 0:e.combine);s!==i&&q.batch(()=>{this.listeners.forEach(n=>{n(u(this,y))})})}},H);function ps({queries:r,...e},s){const t=Y(),i=es(),n=ts(),a=R.useMemo(()=>r.map(m=>{const O=t.defaultQueryOptions(m);return O._optimisticResults=i?"isRestoring":"optimistic",O}),[r,t,i]);a.forEach(m=>{rs(m),is(m,n)}),ns(n);const[d]=R.useState(()=>new ls(t,a,e)),[o,c,f]=d.getOptimisticResult(a,e.combine),h=!i&&e.subscribed!==!1;R.useSyncExternalStore(R.useCallback(m=>h?d.subscribe(q.batchCalls(m)):os,[d,h]),()=>d.getCurrentResult(),()=>d.getCurrentResult()),R.useEffect(()=>{d.setQueries(a,e,{listeners:!1})},[a,e,d]);const g=o.some((m,O)=>_(a[O],m))?o.flatMap((m,O)=>{const l=a[O];if(l){const I=new G(t,l);if(_(l,m))return K(l,I,n);as(m,i)&&K(l,I,n)}return[]}):[];if(g.length>0)throw Promise.all(g);const C=o.find((m,O)=>{const l=a[O];return l&&us({result:m,errorResetBoundary:n,throwOnError:l.throwOnError,query:t.getQueryCache().get(l.queryHash),suspense:l.suspense})});if(C!=null&&C.error)throw C.error;return c(f())}const ms=r=>r.map(s=>{let t="";for(let i=0,n=1;n<s.length;i+=2,n+=2)s[i+2]&&s[n+2]&&(t+=`M${s[i]},${s[n]} L${s[i+2]},${s[n+2]}`);return t}),Qs=({drawing:r="",className:e="",width:s=250,height:t,strokeWidth:i="medium",viewBox:n="0 0 500 500"})=>{const a=JSON.parse(r),d=ms(a),o={small:3,medium:5,large:7}[i]??5;return $.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:n,overflow:"hidden",className:e,style:{width:`${s}px`,height:`${t||s}px`},children:[$.jsx("defs",{}),d.map((c,f)=>$.jsx("path",{d:c,fill:"none",stroke:"#000",strokeWidth:o,strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:"10"},`${r}-${f}`))]})};function gs(r,e){var c;const s={pt:"drawingsPT",en:"drawingsEN"},{notification:t}=Z.useApp(),i=cs({queryKey:["data","suffixCounts"],queryFn:V("data","suffixCounts"),enabled:r});R.useEffect(()=>{i.isSuccess&&ss("Loaded data/suffixCounts")},[i.isSuccess]),R.useEffect(()=>{i.isError&&t.error({message:"Error loading data/suffixCounts",placement:"bottomLeft"})},[i.isError]);const n=s[e??"pt"],a=((c=i.data)==null?void 0:c[n])??0,d=`drawings${e==="pt"?"PT":"EN"}`,o=R.useMemo(()=>new Array(a).fill(0).map((f,h)=>({queryKey:["data",`${d}${h+1}`],queryFn:V("data",`${d}${h+1}`),enabled:r&&!!a,onSuccess:()=>{t.info({message:`Data Drawings ${d}${h+1} loaded`,placement:"bottomLeft"})}})),[a,d,r]);return ps({queries:o})}function bs(r){const s=r.split(/::|:;|;;/)[1],t=Number(s);return Number.isNaN(t)&&console.log("ðŸ”† Invalid createdAt",r,t),Number.isNaN(t)?16191612e5:t}function Cs(r,e){const s=gs(r,e),t=ds(`arte-ruim-drawings-${e}`,r),i=s.some(o=>o.isLoading),n=s.every(o=>o.isSuccess),a=R.useMemo(()=>{if(!n)return{};if(!t.isSuccess)return{};const o=t.data??{};return(s??[]).forEach(c=>{const f=c.data??{};Object.entries(f).forEach(([h,Q])=>{const g=Q.cardId??Q.id;if(g!=null&&g.includes("--"))return;if(Q.drawing.trim().length<10){console.log("ðŸ”† Empty drawing",g);return}const C=bs(h),m=Q.playerId??"unknown",l={id:[g,m,C].join(fs),drawing:Q.drawing,artistId:m,createdAt:C};o[g]===void 0?o[g]={id:g,text:Q.text,drawings:[l],updatedAt:l.createdAt}:o[g].drawings.some(I=>I.id===l.id)||(o[g].drawings.push(l),l.createdAt>o[g].updatedAt&&(o[g].updatedAt=l.createdAt))})}),o},[s,n,t.data,t.isSuccess]),d=R.useMemo(()=>Object.values(a).reduce((o,c)=>(c.drawings.forEach(f=>{const h=f.artistId;o[h]===void 0?o[h]={artistId:h,drawingsCount:1,firstDrawingAt:f.createdAt,lastDrawingAt:f.createdAt}:(o[h].drawingsCount+=1,f.createdAt<o[h].firstDrawingAt&&(o[h].firstDrawingAt=f.createdAt),f.createdAt>o[h].lastDrawingAt&&(o[h].lastDrawingAt=f.createdAt))}),o),{}),[a]);return{isLoading:i||t.isLoading,error:t.error,hasResponseData:!W.isEmpty(a),hasFirestoreData:s.some(o=>!W.isEmpty(o.data)),drawings:a,drawingsPerArtist:Object.values(d)}}const xs={"3PkJr":"Flaviane","3c4lY":"Kavis",BPTEL:"Maris","0vuXf":"Marcio",Bm6dr:"Livia",QrfLz:"Stephanie",AlRvI:"Unknown",pK3OY:"Unknown",VF9iG:"Zenaide",WWUvD:"Fernanda",aec7L:"Anonymous",Xsimf:"Carol",fV5ns:"Diego",qQo9N:"Laura",yVAl7:"Rodrigo",O2IQm:"Drica","24qec":"Mariana","5J1Al":"Mateus"};export{xs as A,Qs as C,Cs as u};
