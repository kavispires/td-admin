import{r as f,a as D,j as e,T as g,I as O,B as k,D as T,P as E,L as w}from"./index-B-CB-hmC.js";import{D as G}from"./DataLoadingWrapper-GIYtl44F.js";import{P as L}from"./useBaseUrl-xjSpq_uF.js";import{I}from"./ImageCard-DkMRnVIM.js";import{u as z}from"./useCardWidth-0PhuulUm.js";import{u as N}from"./useQueryParams-B-K0E8XR.js";import{l as v}from"./lodash-Czkt6pVA.js";import{D as R}from"./index-BKZfFrQt.js";import{S}from"./index-06Xp2EXn.js";import{F as P}from"./index-BGd500q_.js";import{S as $}from"./index-4F-tsTm3.js";import{S as M}from"./index-Dpykzcri.js";import{T as A}from"./index-C7MdlUJs.js";import{R as y,a as V}from"./WomanOutlined-LX5TQRmq.js";import{R as W,a as q}from"./ColumnWidthOutlined-D8uOXmfq.js";import{a as H,b as J}from"./FilterEntries-CILsmA30.js";import{S as Q}from"./SiderContent-FZX9emIy.js";import{D as U}from"./DownloadButton-BzY0paAD.js";import{S as Y}from"./SaveButton-C_jpPclL.js";import{a as K}from"./index-lGkeVY1X.js";import{u as X}from"./useResourceFirebaseData-xaMtIUW_.js";import"./gapSize-U1swVQyS.js";import"./index-Bo__JzcK.js";import"./index-kQHTayh-.js";import"./moment-C5S46NFB.js";import"./SaveOutlined-C1T5zzwQ.js";import"./constants-CICODHNU.js";import"./Item-D9agdC9N.js";import"./useGetFirebaseDoc-CmSt-g-E.js";import"./useTDResource-VDQIHIMH.js";import"./useUpdateFirebaseDoc-vKfuE25D.js";import"./useMutation-DpWGO1_H.js";var Z={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M880 836H144c-17.7 0-32 14.3-32 32v36c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-36c0-17.7-14.3-32-32-32zm-622.3-84c2 0 4-.2 6-.5L431.9 722c2-.4 3.9-1.3 5.3-2.8l423.9-423.9a9.96 9.96 0 000-14.1L694.9 114.9c-1.9-1.9-4.4-2.9-7.1-2.9s-5.2 1-7.1 2.9L256.8 538.8c-1.5 1.5-2.4 3.3-2.8 5.3l-29.5 168.2a33.5 33.5 0 009.4 29.8c6.6 6.4 14.9 9.9 23.8 9.9z"}}]},name:"edit",theme:"filled"};function _(){return _=Object.assign?Object.assign.bind():function(s){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var c in r)Object.prototype.hasOwnProperty.call(r,c)&&(s[c]=r[c])}return s},_.apply(this,arguments)}const ee=(s,t)=>f.createElement(D,_({},s,{ref:t,icon:Z})),se=f.forwardRef(ee),C=v.memoize((s,t)=>{const r=s.split("-");return`${r[0]}-${t??"gb"}-${r[1]}`});function ae({data:s,addEntryToUpdate:t}){const{removeParam:r,queryParams:c}=N(),o=c.get("suspectId"),d=c.get("version")??"gb",l=s[o??""];return l?e.jsx(R,{title:l.name.pt,placement:"right",onClose:()=>r("suspectId"),open:!!l,width:400,children:e.jsxs("div",{className:"suspect__drawer",children:[e.jsx("div",{className:"suspect__drawer__image",children:e.jsx(I,{id:C(l.id,d),width:100})}),e.jsxs("div",{className:"suspect__drawer__info",children:[e.jsx(g.Text,{strong:!0,children:"Build:"}),e.jsx(S,{size:"small",defaultValue:l.build,onChange:n=>{t(l.id,{...l,build:n})},placeholder:"Select Build",children:B.map(n=>e.jsx(S.Option,{value:n,children:n},n))}),e.jsx(g.Text,{strong:!0,children:"Height:"}),e.jsx(S,{size:"small",defaultValue:l.height,onChange:n=>{t(l.id,{...l,height:n})},children:B.map(n=>e.jsx(S.Option,{value:n,children:n},n))}),e.jsx(ie,{suspect:l,addEntryToUpdate:t})]})]})}):null}function ie({suspect:s,addEntryToUpdate:t}){const r=s.features??[],c=o=>{const d=r.includes(o)?r.filter(l=>l!==o):[...r,o];t(s.id,{...s,features:d})};return e.jsx("div",{children:F.map(o=>e.jsxs("div",{className:"my-4",children:[e.jsx(g.Text,{strong:!0,children:o.title}),o.features.map(d=>e.jsxs(P,{className:"my-2",gap:4,children:[e.jsx($,{size:"small",checked:r.includes(d.id),onChange:()=>c(d.id)})," ",d.label]},d.id))]},o.title))})}const B=["S","M","L"],F=[{title:"Hair Length",features:[{id:"shortHair",label:"Short Hair"},{id:"longHair",label:"Long Hair"},{id:"bald",label:"Bald"}]},{title:"Hair Color",features:[{id:"blackHair",label:"Black Hair"},{id:"brownHair",label:"Brown Hair"},{id:"blondeHair",label:"Blonde Hair"},{id:"redHair",label:"Red Hair"},{id:"greyHair",label:"Grey Hair"},{id:"coloredHair",label:"Colored Hair"}]},{title:"Face",features:[{id:"beard",label:"Beard"},{id:"mustache",label:"Mustache"},{id:"goatee",label:"Goatee"},{id:"lipstick",label:"Lipstick"}]},{title:"Accessories",features:[{id:"glasses",label:"Glasses"},{id:"piercings",label:"Piercings"},{id:"earrings",label:"Earrings"},{id:"necklace",label:"Necklace"},{id:"hat",label:"Hat"},{id:"scarf",label:"Scarf"},{id:"hoodie",label:"Hoodie"},{id:"tie",label:"Tie"},{id:"headscarf",label:"Headscarf/Bandana"}]}];function re({data:s,addEntryToUpdate:t}){const{addParam:r,queryParams:c}=N(),o=c.get("version")??"ct",d=c.get("sortBy")??"id",l=Number(c.get("cardsPerRow"))||8,[n,x]=z(l),a=f.useMemo(()=>v.orderBy(Object.values(s),i=>d==="id"?Number(i.id.split("-").at(-1)):i[d]??i.id,["asc"]),[s,d]);return e.jsxs(e.Fragment,{children:[e.jsxs(g.Title,{level:2,children:["Deck ",o," (",a.length,")"]}),e.jsx(O.PreviewGroup,{children:e.jsx(M,{ref:x,wrap:!0,className:"my-2",children:a.map(i=>{var j,u;return e.jsxs("div",{className:"suspect",style:{width:`${n}px`},children:[e.jsx(I,{id:C(i.id,o),width:n,className:"suspect__image"}),e.jsxs("div",{className:"suspect__name",children:[e.jsx("div",{children:e.jsx(A,{children:i.id})}),e.jsxs("div",{children:["ðŸ‡§ðŸ‡· ",i.name.pt]}),e.jsxs("div",{children:["ðŸ‡ºðŸ‡¸ ",i.name.en]}),e.jsxs("div",{className:"suspect__info",children:[e.jsxs("div",{children:[e.jsxs("div",{children:[i.gender==="male"?e.jsx(y,{}):e.jsx(V,{})," ",i.age]}),e.jsx("div",{children:e.jsx("em",{children:i.ethnicity})})]}),e.jsxs("div",{children:[e.jsx(W,{}),e.jsx("br",{}),i.build]}),e.jsxs("div",{children:[e.jsx(q,{}),e.jsx("br",{}),i.height]}),e.jsxs("div",{children:[((j=i==null?void 0:i.features)==null?void 0:j.length)??0," features"]})]}),e.jsx(k,{size:"small",block:!0,onClick:()=>r("suspectId",i.id),danger:!(i!=null&&i.features)||((u=i==null?void 0:i.features)==null?void 0:u.length)<2,children:e.jsx(se,{})})]})]},i.id)})},o)}),e.jsx(ae,{data:s,addEntryToUpdate:t})]})}function b(s,t){return v.orderBy(Object.entries(s).map(([r,c])=>({key:r,label:v.capitalize(r),value:c,percentage:Math.round(c/t*100)})),["percentage"],["desc"])}function te({data:s}){const[t,r]=f.useState(!1);return e.jsxs(e.Fragment,{children:[e.jsx(k,{onClick:()=>r(!0),block:!0,children:"See Stats"}),t&&e.jsx(le,{data:s,open:t,onClose:()=>r(!1)})]})}function le({data:s,open:t,onClose:r}){const{ages:c,ethnicities:o,genders:d,builds:l,heights:n}=f.useMemo(()=>{const a={},i={},j={},u={},m={};Object.values(s).forEach(h=>{a[h.age]=(a[h.age]??0)+1,i[h.ethnicity]=(i[h.ethnicity]??0)+1,j[h.gender]=(j[h.gender]??0)+1,u[h.build||"?"]=(u[h.build||"?"]??0)+1,m[h.height||"?"]=(m[h.height||"?"]??0)+1});const p=Object.keys(s).length;return{ages:b(a,p),ethnicities:b(i,p),genders:b(j,p),builds:b(u,p),heights:b(m,p)}},[s]),x=f.useMemo(()=>{const a={};Object.values(s).forEach(u=>{var m;(m=u.features)==null||m.forEach(p=>{a[p]=(a[p]??0)+1})});const i=Object.keys(s).length,j=F.reduce((u,m)=>{const p=m.features.map(h=>h.id);return u.push(...p),u},[]);return v.orderBy(b(a,i),u=>j.findIndex(m=>m===u.key),["asc"])},[s]);return e.jsxs(R,{title:"Suspects Statistics",placement:"right",onClose:r,open:t,width:400,children:[e.jsx(g.Text,{strong:!0,children:"Ethnicity"}),e.jsx("ul",{className:"statistic__list",children:o.map(a=>e.jsxs("li",{children:[e.jsx("strong",{children:a.label})," - ",a.percentage,"%"]},a.key))}),e.jsx(g.Text,{strong:!0,children:"Gender"}),e.jsx("ul",{className:"statistic__list",children:d.map(a=>e.jsxs("li",{children:[e.jsx("strong",{children:a.label})," - ",a.percentage,"%"]},a.key))}),e.jsx(g.Text,{strong:!0,children:"Age"}),e.jsx("ul",{className:"statistic__list",children:c.map(a=>e.jsxs("li",{children:[e.jsx("strong",{children:a.label})," - ",a.percentage,"%"]},a.key))}),e.jsx(g.Text,{strong:!0,children:"Build"}),e.jsx("ul",{className:"statistic__list",children:l.map(a=>e.jsxs("li",{children:[e.jsx("strong",{children:a.label})," - ",a.percentage,"%"]},a.key))}),e.jsx(g.Text,{strong:!0,children:"Height"}),e.jsx("ul",{className:"statistic__list",children:n.map(a=>e.jsxs("li",{children:[e.jsx("strong",{children:a.label})," - ",a.percentage,"%"]},a.key))}),e.jsx(g.Text,{strong:!0,children:"Features"}),e.jsx("ul",{className:"statistic__list",children:x.map(a=>e.jsxs("li",{children:[e.jsx("strong",{children:a.label})," - ",a.percentage,"% (",a.value,")"]},a.key))})]})}const ne=[{value:"ct",label:"Cartoon"},{value:"gb",label:"Ghibli"},{value:"ai",label:"AI"},{value:"md",label:"Models"},{value:"wc",label:"Wacky"}],ce=[{value:"id",label:"Id"},{value:"name.pt",label:"Name (PT)"},{value:"name.en",label:"Name (EN)"},{value:"ethnicity",label:"Ethnicity"},{value:"gender",label:"Gender"},{value:"age",label:"Age"},{value:"height",label:"Height"},{value:"build",label:"Build"}];function oe({data:s,save:t,isDirty:r,isSaving:c,entriesToUpdate:o,hasFirestoreData:d}){const{addParam:l,queryParams:n}=N();return e.jsxs(Q,{children:[e.jsxs(P,{vertical:!0,gap:12,children:[e.jsx(Y,{isDirty:r,onSave:t,isSaving:c,dirt:JSON.stringify(o)}),e.jsx(U,{data:()=>de(s),fileName:"suspects.json",disabled:r,hasNewData:d,block:!0})]}),e.jsx(T,{}),e.jsx(H,{label:"Version",value:n.get("version")??"gb",onChange:x=>l("version",x),options:ne}),e.jsx(J,{label:"Cards Per Row",value:Number(n.get("cardsPerRow")??"8"),onChange:x=>l("cardsPerRow",x),min:2,max:12}),e.jsx(H,{label:"Sort By",value:n.get("sortBy")??"id",onChange:x=>l("sortBy",x),options:ce}),e.jsx(te,{data:s})]})}function de(s){return K(s,["gender","ethnicity","age","height","build","features"])}function ye(){const s=X({tdrResourceName:"suspects",firebaseDataCollectionName:"suspects",serialize:!0});return e.jsx(E,{title:"Suspects",subtitle:"Information",children:e.jsxs(w,{hasSider:!0,children:[e.jsx(L,{children:e.jsx(oe,{...s})}),e.jsx(w.Content,{className:"content",children:e.jsx(G,{isLoading:s.isLoading,error:s.error,hasResponseData:!v.isEmpty(s.data),children:e.jsx(re,{...s})})})]})})}export{ye as default};
