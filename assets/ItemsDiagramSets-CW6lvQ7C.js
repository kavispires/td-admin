import{r as y,Y as X,R as k,a2 as Y,a3 as B,$ as Me,a0 as K,a1 as Oe,an as Ue,Z as qe,a5 as He,C as Qe,c as de,g as Je,m as Xe,d as F,ao as Ye,e as Ze,ap as et,aq as tt,f as nt,h as at,aj as rt,b as ve,ar as st,as as ot,y as be,j as n,D as G,B as U,T,Q as lt,z as it,P as dt,L as je}from"./index-DXe0NKsU.js";import{D as Re}from"./DataLoadingWrapper-BMUHkU-9.js";import{F as ct}from"./FilterEntries-8ZA2M-0j.js";import{S as ut}from"./SiderContent-BizzpyAp.js";import{D as mt}from"./DownloadButton-nV1Vp6mp.js";import{S as ft}from"./SaveButton-Cw7uDWF-.js";import{u as he}from"./useQueryParams-BB0m4ZDO.js";import{u as ce}from"./useTDResource-Bm2ZR31e.js";import{l as Z}from"./lodash-Bc7mGals.js";import{a as pt,w as ue}from"./index-CWkijkUk.js";import{v as W,s as De,a as Ce,b as Se,S as Fe,c as Ie}from"./daily-teoria-de-conjuntos-C6sf8m2k.js";import{F as ee}from"./index-Cn-6dNGh.js";import{R as ht}from"./ClusterOutlined-ckPax1Lf.js";import{R as gt}from"./TableOutlined-CSARWevs.js";import{c as oe,P as xt}from"./useBaseUrl-Dr2gnGsV.js";import{I as _e}from"./Item-B1xaxzrh.js";import{F as M}from"./index-CywTZjU_.js";import{M as yt}from"./index-BggsdaKy.js";import{I as te}from"./index-DwmjLRpU.js";import{R as H}from"./index-BN_TL9kb.js";import{A as vt}from"./index-Bdr3kKIW.js";import{S as me}from"./index-DB9PR9p3.js";import{T as Q}from"./TransparentButton-BPASkAOB.js";import{S as R}from"./index-l1pNpeva.js";import{R as Ve}from"./index-U2N3blzJ.js";import{u as ge}from"./useMeasure-CufE8NJQ.js";import{u as Le}from"./useTablePagination-Bnw1q8mY.js";import{T as L}from"./index-1eaCyCpZ.js";import{F as ze}from"./Table-CWfbJPvq.js";import{u as bt}from"./useResourceFirebaseData-aRQIM0Ql.js";import"./index-ChXZMZkL.js";import"./index-BZS9rDXb.js";import"./moment-C5S46NFB.js";import"./SaveOutlined-BooZ0pum.js";import"./constants-DMa2HerV.js";import"./constants-DiF3Hxcw.js";import"./gapSize-U1swVQyS.js";import"./Input-BjY3wOcJ.js";import"./throttleByAnimationFrame-BbnUQ4PG.js";import"./util-CeAI_f06.js";import"./index-Dhr8lByo.js";import"./scrollTo-pEWCRynY.js";import"./Pagination-DdoKsGBK.js";import"./extendsObject-keMuGWqj.js";import"./useGetFirebaseDoc-ahwYGaLK.js";import"./useUpdateFirebaseDoc-v5WYF7hf.js";import"./useMutation-BxXxI-Rq.js";function $e(e){var t=y.useRef();t.current=e;var s=y.useCallback(function(){for(var a,o=arguments.length,c=new Array(o),m=0;m<o;m++)c[m]=arguments[m];return(a=t.current)===null||a===void 0?void 0:a.call.apply(a,[t].concat(c))},[]);return s}function jt(){return!!(typeof window<"u"&&window.document&&window.document.createElement)}var we=jt()?y.useLayoutEffect:y.useEffect,Ct=function(t,s){var a=y.useRef(!0);we(function(){return t(a.current)},s),we(function(){return a.current=!1,function(){a.current=!0}},[])},Te=function(t,s){Ct(function(a){if(!a)return t()},s)};function Pe(e){var t=y.useRef(!1),s=y.useState(e),a=X(s,2),o=a[0],c=a[1];y.useEffect(function(){return t.current=!1,function(){t.current=!0}},[]);function m(l,f){f&&t.current||c(l)}return[o,m]}function le(e){return e!==void 0}function St(e,t){var s=t||{},a=s.defaultValue,o=s.value,c=s.onChange,m=s.postState,l=Pe(function(){return le(o)?o:le(a)?typeof a=="function"?a():a:typeof e=="function"?e():e}),f=X(l,2),h=f[0],j=f[1],r=o!==void 0?o:h,g=m?m(r):r,u=$e(c),i=Pe([r]),x=X(i,2),b=x[0],I=x[1];Te(function(){var v=b[0];h!==v&&u(h,v)},[b]),Te(function(){le(o)||j(o)},[o]);var C=$e(function(v,w){j(v,w),I([r],w)});return[g,C]}var fe={},It=function(t){};function $t(e,t){}function wt(e,t){}function Tt(){fe={}}function Be(e,t,s){!t&&!fe[s]&&(e(!1,s),fe[s]=!0)}function ae(e,t){Be($t,e,t)}function Pt(e,t){Be(wt,e,t)}ae.preMessage=It;ae.resetWarned=Tt;ae.noteOnce=Pt;var ie={exports:{}},$={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ne;function Nt(){if(Ne)return $;Ne=1;var e=typeof Symbol=="function"&&Symbol.for,t=e?Symbol.for("react.element"):60103,s=e?Symbol.for("react.portal"):60106,a=e?Symbol.for("react.fragment"):60107,o=e?Symbol.for("react.strict_mode"):60108,c=e?Symbol.for("react.profiler"):60114,m=e?Symbol.for("react.provider"):60109,l=e?Symbol.for("react.context"):60110,f=e?Symbol.for("react.async_mode"):60111,h=e?Symbol.for("react.concurrent_mode"):60111,j=e?Symbol.for("react.forward_ref"):60112,r=e?Symbol.for("react.suspense"):60113,g=e?Symbol.for("react.suspense_list"):60120,u=e?Symbol.for("react.memo"):60115,i=e?Symbol.for("react.lazy"):60116,x=e?Symbol.for("react.block"):60121,b=e?Symbol.for("react.fundamental"):60117,I=e?Symbol.for("react.responder"):60118,C=e?Symbol.for("react.scope"):60119;function v(d){if(typeof d=="object"&&d!==null){var P=d.$$typeof;switch(P){case t:switch(d=d.type,d){case f:case h:case a:case c:case o:case r:return d;default:switch(d=d&&d.$$typeof,d){case l:case j:case i:case u:case m:return d;default:return P}}case s:return P}}}function w(d){return v(d)===h}return $.AsyncMode=f,$.ConcurrentMode=h,$.ContextConsumer=l,$.ContextProvider=m,$.Element=t,$.ForwardRef=j,$.Fragment=a,$.Lazy=i,$.Memo=u,$.Portal=s,$.Profiler=c,$.StrictMode=o,$.Suspense=r,$.isAsyncMode=function(d){return w(d)||v(d)===f},$.isConcurrentMode=w,$.isContextConsumer=function(d){return v(d)===l},$.isContextProvider=function(d){return v(d)===m},$.isElement=function(d){return typeof d=="object"&&d!==null&&d.$$typeof===t},$.isForwardRef=function(d){return v(d)===j},$.isFragment=function(d){return v(d)===a},$.isLazy=function(d){return v(d)===i},$.isMemo=function(d){return v(d)===u},$.isPortal=function(d){return v(d)===s},$.isProfiler=function(d){return v(d)===c},$.isStrictMode=function(d){return v(d)===o},$.isSuspense=function(d){return v(d)===r},$.isValidElementType=function(d){return typeof d=="string"||typeof d=="function"||d===a||d===h||d===c||d===o||d===r||d===g||typeof d=="object"&&d!==null&&(d.$$typeof===i||d.$$typeof===u||d.$$typeof===m||d.$$typeof===l||d.$$typeof===j||d.$$typeof===b||d.$$typeof===I||d.$$typeof===C||d.$$typeof===x)},$.typeOf=v,$}var ke;function kt(){return ke||(ke=1,ie.exports=Nt()),ie.exports}var At=kt();function pe(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},s=[];return k.Children.forEach(e,function(a){a==null&&!t.keepEmpty||(Array.isArray(a)?s=s.concat(pe(a)):At.isFragment(a)&&a.props?s=s.concat(pe(a.props.children,t)):s.push(a))}),s}var Ae={ENTER:13},Ke=k.forwardRef(function(e,t){var s=e.prefixCls,a=e.forceRender,o=e.className,c=e.style,m=e.children,l=e.isActive,f=e.role,h=e.classNames,j=e.styles,r=k.useState(l||a),g=X(r,2),u=g[0],i=g[1];return k.useEffect(function(){(a||l)&&i(!0)},[a,l]),u?k.createElement("div",{ref:t,className:Y("".concat(s,"-content"),B(B({},"".concat(s,"-content-active"),l),"".concat(s,"-content-inactive"),!l),o),style:c,role:f},k.createElement("div",{className:Y("".concat(s,"-content-box"),h==null?void 0:h.body),style:j==null?void 0:j.body},m)):null});Ke.displayName="PanelContent";var Et=["showArrow","headerClass","isActive","onItemClick","forceRender","className","classNames","styles","prefixCls","collapsible","accordion","panelKey","extra","header","expandIcon","openMotion","destroyInactivePanel","children"],Ge=k.forwardRef(function(e,t){var s=e.showArrow,a=s===void 0?!0:s,o=e.headerClass,c=e.isActive,m=e.onItemClick,l=e.forceRender,f=e.className,h=e.classNames,j=h===void 0?{}:h,r=e.styles,g=r===void 0?{}:r,u=e.prefixCls,i=e.collapsible,x=e.accordion,b=e.panelKey,I=e.extra,C=e.header,v=e.expandIcon,w=e.openMotion,d=e.destroyInactivePanel,P=e.children,E=Me(e,Et),N=i==="disabled",p=I!=null&&typeof I!="boolean",S=B(B(B({onClick:function(){m==null||m(b)},onKeyDown:function(_){(_.key==="Enter"||_.keyCode===Ae.ENTER||_.which===Ae.ENTER)&&(m==null||m(b))},role:x?"tab":"button"},"aria-expanded",c),"aria-disabled",N),"tabIndex",N?-1:0),A=typeof v=="function"?v(e):k.createElement("i",{className:"arrow"}),q=A&&k.createElement("div",K({className:"".concat(u,"-expand-icon")},["header","icon"].includes(i)?S:{}),A),O=Y("".concat(u,"-item"),B(B({},"".concat(u,"-item-active"),c),"".concat(u,"-item-disabled"),N),f),D=Y(o,"".concat(u,"-header"),B({},"".concat(u,"-collapsible-").concat(i),!!i),j.header),V=Oe({className:D,style:g.header},["header","icon"].includes(i)?{}:S);return k.createElement("div",K({},E,{ref:t,className:O}),k.createElement("div",V,a&&q,k.createElement("span",K({className:"".concat(u,"-header-text")},i==="header"?S:{}),C),p&&k.createElement("div",{className:"".concat(u,"-extra")},I)),k.createElement(Ue,K({visible:c,leavedClassName:"".concat(u,"-content-hidden")},w,{forceRender:l,removeOnLeave:d}),function(z,_){var re=z.className,se=z.style;return k.createElement(Ke,{ref:_,prefixCls:u,className:re,classNames:j,style:se,styles:g,isActive:c,forceRender:l,role:x?"tabpanel":void 0},P)}))}),Mt=["children","label","key","collapsible","onItemClick","destroyInactivePanel"],Ot=function(t,s){var a=s.prefixCls,o=s.accordion,c=s.collapsible,m=s.destroyInactivePanel,l=s.onItemClick,f=s.activeKey,h=s.openMotion,j=s.expandIcon;return t.map(function(r,g){var u=r.children,i=r.label,x=r.key,b=r.collapsible,I=r.onItemClick,C=r.destroyInactivePanel,v=Me(r,Mt),w=String(x??g),d=b??c,P=C??m,E=function(S){d!=="disabled"&&(l(S),I==null||I(S))},N=!1;return o?N=f[0]===w:N=f.indexOf(w)>-1,k.createElement(Ge,K({},v,{prefixCls:a,key:w,panelKey:w,isActive:N,accordion:o,openMotion:h,expandIcon:j,header:i,collapsible:d,onItemClick:E,destroyInactivePanel:P}),u)})},Rt=function(t,s,a){if(!t)return null;var o=a.prefixCls,c=a.accordion,m=a.collapsible,l=a.destroyInactivePanel,f=a.onItemClick,h=a.activeKey,j=a.openMotion,r=a.expandIcon,g=t.key||String(s),u=t.props,i=u.header,x=u.headerClass,b=u.destroyInactivePanel,I=u.collapsible,C=u.onItemClick,v=!1;c?v=h[0]===g:v=h.indexOf(g)>-1;var w=I??m,d=function(N){w!=="disabled"&&(f(N),C==null||C(N))},P={key:g,panelKey:g,header:i,headerClass:x,isActive:v,prefixCls:o,destroyInactivePanel:b??l,openMotion:j,accordion:c,children:t.props.children,onItemClick:d,expandIcon:r,collapsible:w};return typeof t.type=="string"?t:(Object.keys(P).forEach(function(E){typeof P[E]>"u"&&delete P[E]}),k.cloneElement(t,P))};function Dt(e,t,s){return Array.isArray(e)?Ot(e,s):pe(t).map(function(a,o){return Rt(a,o,s)})}var Ft=`accept acceptCharset accessKey action allowFullScreen allowTransparency
    alt async autoComplete autoFocus autoPlay capture cellPadding cellSpacing challenge
    charSet checked classID className colSpan cols content contentEditable contextMenu
    controls coords crossOrigin data dateTime default defer dir disabled download draggable
    encType form formAction formEncType formMethod formNoValidate formTarget frameBorder
    headers height hidden high href hrefLang htmlFor httpEquiv icon id inputMode integrity
    is keyParams keyType kind label lang list loop low manifest marginHeight marginWidth max maxLength media
    mediaGroup method min minLength multiple muted name noValidate nonce open
    optimum pattern placeholder poster preload radioGroup readOnly rel required
    reversed role rowSpan rows sandbox scope scoped scrolling seamless selected
    shape size sizes span spellCheck src srcDoc srcLang srcSet start step style
    summary tabIndex target title type useMap value width wmode wrap`,_t=`onCopy onCut onPaste onCompositionEnd onCompositionStart onCompositionUpdate onKeyDown
    onKeyPress onKeyUp onFocus onBlur onChange onInput onSubmit onClick onContextMenu onDoubleClick
    onDrag onDragEnd onDragEnter onDragExit onDragLeave onDragOver onDragStart onDrop onMouseDown
    onMouseEnter onMouseLeave onMouseMove onMouseOut onMouseOver onMouseUp onSelect onTouchCancel
    onTouchEnd onTouchMove onTouchStart onScroll onWheel onAbort onCanPlay onCanPlayThrough
    onDurationChange onEmptied onEncrypted onEnded onError onLoadedData onLoadedMetadata
    onLoadStart onPause onPlay onPlaying onProgress onRateChange onSeeked onSeeking onStalled onSuspend onTimeUpdate onVolumeChange onWaiting onLoad onError`,Vt="".concat(Ft," ").concat(_t).split(/[\s\n]+/),Lt="aria-",zt="data-";function Ee(e,t){return e.indexOf(t)===0}function Bt(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,s;t===!1?s={aria:!0,data:!0,attr:!0}:t===!0?s={aria:!0}:s=Oe({},t);var a={};return Object.keys(e).forEach(function(o){(s.aria&&(o==="role"||Ee(o,Lt))||s.data&&Ee(o,zt)||s.attr&&Vt.includes(o))&&(a[o]=e[o])}),a}function Kt(e){var t=e;if(!Array.isArray(t)){var s=qe(t);t=s==="number"||s==="string"?[t]:[]}return t.map(function(a){return String(a)})}var Gt=k.forwardRef(function(e,t){var s=e.prefixCls,a=s===void 0?"rc-collapse":s,o=e.destroyInactivePanel,c=o===void 0?!1:o,m=e.style,l=e.accordion,f=e.className,h=e.children,j=e.collapsible,r=e.openMotion,g=e.expandIcon,u=e.activeKey,i=e.defaultActiveKey,x=e.onChange,b=e.items,I=Y(a,f),C=St([],{value:u,onChange:function(p){return x==null?void 0:x(p)},defaultValue:i,postState:Kt}),v=X(C,2),w=v[0],d=v[1],P=function(p){return d(function(){if(l)return w[0]===p?[]:[p];var S=w.indexOf(p),A=S>-1;return A?w.filter(function(q){return q!==p}):[].concat(He(w),[p])})};ae(!h,"[rc-collapse] `children` will be removed in next major version. Please use `items` instead.");var E=Dt(b,h,{prefixCls:a,accordion:l,openMotion:r,expandIcon:g,collapsible:j,destroyInactivePanel:c,onItemClick:P,activeKey:w});return k.createElement("div",K({ref:t,className:I,style:m,role:l?"tablist":void 0},Bt(e,{aria:!0,data:!0})),E)});const xe=Object.assign(Gt,{Panel:Ge});xe.Panel;const Wt=y.forwardRef((e,t)=>{const{getPrefixCls:s}=y.useContext(Qe),{prefixCls:a,className:o,showArrow:c=!0}=e,m=s("collapse",a),l=de({[`${m}-no-arrow`]:!c},o);return y.createElement(xe.Panel,Object.assign({ref:t},e,{prefixCls:m,className:l}))}),Ut=e=>{const{componentCls:t,contentBg:s,padding:a,headerBg:o,headerPadding:c,collapseHeaderPaddingSM:m,collapseHeaderPaddingLG:l,collapsePanelBorderRadius:f,lineWidth:h,lineType:j,colorBorder:r,colorText:g,colorTextHeading:u,colorTextDisabled:i,fontSizeLG:x,lineHeight:b,lineHeightLG:I,marginSM:C,paddingSM:v,paddingLG:w,paddingXS:d,motionDurationSlow:P,fontSizeIcon:E,contentPadding:N,fontHeight:p,fontHeightLG:S}=e,A=`${F(h)} ${j} ${r}`;return{[t]:Object.assign(Object.assign({},Ze(e)),{backgroundColor:o,border:A,borderRadius:f,"&-rtl":{direction:"rtl"},[`& > ${t}-item`]:{borderBottom:A,"&:first-child":{[`
            &,
            & > ${t}-header`]:{borderRadius:`${F(f)} ${F(f)} 0 0`}},"&:last-child":{[`
            &,
            & > ${t}-header`]:{borderRadius:`0 0 ${F(f)} ${F(f)}`}},[`> ${t}-header`]:Object.assign(Object.assign({position:"relative",display:"flex",flexWrap:"nowrap",alignItems:"flex-start",padding:c,color:u,lineHeight:b,cursor:"pointer",transition:`all ${P}, visibility 0s`},et(e)),{[`> ${t}-header-text`]:{flex:"auto"},[`${t}-expand-icon`]:{height:p,display:"flex",alignItems:"center",paddingInlineEnd:C},[`${t}-arrow`]:Object.assign(Object.assign({},tt()),{fontSize:E,transition:`transform ${P}`,svg:{transition:`transform ${P}`}}),[`${t}-header-text`]:{marginInlineEnd:"auto"}}),[`${t}-collapsible-header`]:{cursor:"default",[`${t}-header-text`]:{flex:"none",cursor:"pointer"}},[`${t}-collapsible-icon`]:{cursor:"unset",[`${t}-expand-icon`]:{cursor:"pointer"}}},[`${t}-content`]:{color:g,backgroundColor:s,borderTop:A,[`& > ${t}-content-box`]:{padding:N},"&-hidden":{display:"none"}},"&-small":{[`> ${t}-item`]:{[`> ${t}-header`]:{padding:m,paddingInlineStart:d,[`> ${t}-expand-icon`]:{marginInlineStart:e.calc(v).sub(d).equal()}},[`> ${t}-content > ${t}-content-box`]:{padding:v}}},"&-large":{[`> ${t}-item`]:{fontSize:x,lineHeight:I,[`> ${t}-header`]:{padding:l,paddingInlineStart:a,[`> ${t}-expand-icon`]:{height:S,marginInlineStart:e.calc(w).sub(a).equal()}},[`> ${t}-content > ${t}-content-box`]:{padding:w}}},[`${t}-item:last-child`]:{borderBottom:0,[`> ${t}-content`]:{borderRadius:`0 0 ${F(f)} ${F(f)}`}},[`& ${t}-item-disabled > ${t}-header`]:{"\n          &,\n          & > .arrow\n        ":{color:i,cursor:"not-allowed"}},[`&${t}-icon-position-end`]:{[`& > ${t}-item`]:{[`> ${t}-header`]:{[`${t}-expand-icon`]:{order:1,paddingInlineEnd:0,paddingInlineStart:C}}}}})}},qt=e=>{const{componentCls:t}=e,s=`> ${t}-item > ${t}-header ${t}-arrow`;return{[`${t}-rtl`]:{[s]:{transform:"rotate(180deg)"}}}},Ht=e=>{const{componentCls:t,headerBg:s,paddingXXS:a,colorBorder:o}=e;return{[`${t}-borderless`]:{backgroundColor:s,border:0,[`> ${t}-item`]:{borderBottom:`1px solid ${o}`},[`
        > ${t}-item:last-child,
        > ${t}-item:last-child ${t}-header
      `]:{borderRadius:0},[`> ${t}-item:last-child`]:{borderBottom:0},[`> ${t}-item > ${t}-content`]:{backgroundColor:"transparent",borderTop:0},[`> ${t}-item > ${t}-content > ${t}-content-box`]:{paddingTop:a}}}},Qt=e=>{const{componentCls:t,paddingSM:s}=e;return{[`${t}-ghost`]:{backgroundColor:"transparent",border:0,[`> ${t}-item`]:{borderBottom:0,[`> ${t}-content`]:{backgroundColor:"transparent",border:0,[`> ${t}-content-box`]:{paddingBlock:s}}}}}},Jt=e=>({headerPadding:`${e.paddingSM}px ${e.padding}px`,headerBg:e.colorFillAlter,contentPadding:`${e.padding}px 16px`,contentBg:e.colorBgContainer}),Xt=Je("Collapse",e=>{const t=Xe(e,{collapseHeaderPaddingSM:`${F(e.paddingXS)} ${F(e.paddingSM)}`,collapseHeaderPaddingLG:`${F(e.padding)} ${F(e.paddingLG)}`,collapsePanelBorderRadius:e.borderRadiusLG});return[Ut(t),Ht(t),Qt(t),qt(t),Ye(t)]},Jt),Yt=y.forwardRef((e,t)=>{const{getPrefixCls:s,direction:a,expandIcon:o,className:c,style:m}=nt("collapse"),{prefixCls:l,className:f,rootClassName:h,style:j,bordered:r=!0,ghost:g,size:u,expandIconPosition:i="start",children:x,expandIcon:b}=e,I=at(O=>{var D;return(D=u??O)!==null&&D!==void 0?D:"middle"}),C=s("collapse",l),v=s(),[w,d,P]=Xt(C),E=y.useMemo(()=>i==="left"?"start":i==="right"?"end":i,[i]),N=b??o,p=y.useCallback(function(){let O=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const D=typeof N=="function"?N(O):y.createElement(rt,{rotate:O.isActive?a==="rtl"?-90:90:void 0,"aria-label":O.isActive?"expanded":"collapsed"});return ve(D,()=>{var V;return{className:de((V=D==null?void 0:D.props)===null||V===void 0?void 0:V.className,`${C}-arrow`)}})},[N,C]),S=de(`${C}-icon-position-${E}`,{[`${C}-borderless`]:!r,[`${C}-rtl`]:a==="rtl",[`${C}-ghost`]:!!g,[`${C}-${I}`]:I!=="middle"},c,f,h,d,P),A=Object.assign(Object.assign({},st(v)),{motionAppear:!1,leavedClassName:`${C}-content-hidden`}),q=y.useMemo(()=>x?ot(x).map((O,D)=>{var V,z;const _=O.props;if(_!=null&&_.disabled){const re=(V=O.key)!==null&&V!==void 0?V:String(D),se=Object.assign(Object.assign({},be(O.props,["disabled"])),{key:re,collapsible:(z=_.collapsible)!==null&&z!==void 0?z:"disabled"});return ve(O,se)}return O}):null,[x]);return w(y.createElement(xe,Object.assign({ref:t,openMotion:A},be(e,["rootClassName"]),{expandIcon:p,prefixCls:C,className:S,style:Object.assign(Object.assign({},m),j)}),q))}),Zt=Object.assign(Yt,{Panel:Wt});function en({data:e,save:t,isDirty:s,isSaving:a,entriesToUpdate:o}){const{addParams:c,queryParams:m}=he(),l=ce("daily-diagram-rules");return n.jsxs(ut,{children:[n.jsxs(ee,{vertical:!0,gap:12,children:[n.jsx(ft,{isDirty:s,onSave:t,isSaving:a,dirt:JSON.stringify(o)}),n.jsx(mt,{data:()=>tn(e,l.data??{}),fileName:"daily-diagram-items.json",disabled:s,block:!0})]}),n.jsx(G,{}),n.jsx(ct,{label:"Display",value:m.get("display")??"rule",onChange:f=>c({display:f,page:1},{page:1}),options:[{title:"By Rule",icon:n.jsx(ht,{}),value:"rule"},{title:"By Thing",icon:n.jsx(gt,{}),value:"thing"}]}),n.jsx(G,{}),n.jsx(U,{size:"small",block:!0,onClick:()=>c({display:"simulator"}),children:"Simulator"}),n.jsx(T.Paragraph,{type:"secondary",className:"my-6",children:"v2.0.1"})]})}function tn(e,t){console.log("Preparing file for download...");const s=Z.cloneDeep(e);return Object.values(s).forEach(a=>{const o=Object.values(t).filter(l=>l.updatedAt>a.updatedAt),c=o.filter(l=>l.method==="auto");c.length>0&&(console.log(`Performing ${c.length} auto updates for ${a.name}`),a.rules=a.rules.filter(l=>!c.map(f=>f.id).includes(l)),c.forEach(l=>{W[l.id](a.name)&&a.rules.push(l.id)})),a.rules=a.rules.sort(),o.some(l=>l.method!=="auto")||(console.log("Auto updating"),a.updatedAt=Date.now())}),pt(s)}function ye({isModalOpen:e,onSaveThing:t,onCancel:s,thing:a,rules:o,width:c,itemAliases:m,subtitle:l,okButtonText:f,onGiveAnotherThing:h}){const j=y.useMemo(()=>Z.orderBy(Object.values(o),[p=>{const S=["manual","dependency","auto"].indexOf(p.method);return S===-1?Number.POSITIVE_INFINITY:S},p=>{const S=["grammar","comparison","order","count","contains","ends"].indexOf(p.type);return S===-1?Number.POSITIVE_INFINITY:S},p=>p.title.slice(0,7),p=>Number(p.id.split("-")[1])]),[o]),[r]=M.useForm(),g=M.useWatch([],r),u=!g||Object.values(g??{}).some(p=>p===void 0),i=M.useWatch("name",r);y.useEffect(()=>{if(!i||a.name&&a.syllables&&i===a.name)return;const p={syllables:De(i),stressedSyllable:a.stressedSyllable??i.includes(" ")?-1:0};Object.keys(o).forEach(S=>{W[S]?p[S]=W[S](i):p[S]=a.rules.length>0?a.rules.includes(S):void 0}),r.setFieldsValue(p)},[i]);const x=M.useWatch("syllables",r),b=r.getFieldValue("ddr-51-pt");y.useEffect(()=>{b&&(r.setFieldsValue({stressedSyllable:void 0}),r.setFieldsValue({"ddr-43-pt":!1}),r.setFieldsValue({"ddr-44-pt":!1}),r.setFieldsValue({"ddr-45-pt":!1}),r.setFieldsValue({"ddr-46-pt":!1})),b===void 0&&r.setFieldsValue({"ddr-51-pt":!1})},[b]),y.useEffect(()=>{if(x){const p=Object.keys(o).reduce((S,A)=>(Ce[A]&&(S[A]=Ce[A](i,x,b)),S),{});r.setFieldsValue({...p,stressedSyllable:x===a.syllables?a.stressedSyllable:a.stressedSyllable??i.includes(" ")?-1:void 0})}},[i,x,b]);const I=M.useWatch("stressedSyllable",r);y.useEffect(()=>{if(!b&&I!==void 0){const p=Object.keys(o).reduce((S,A)=>(Se[A]&&(S[A]=Se[A](i,x,I)),S),{});r.setFieldsValue({...p})}},[I]);const C=r.getFieldValue("ddr-1-pt"),v=r.getFieldValue("ddr-2-pt"),w=r.getFieldValue("ddr-50-pt");y.useEffect(()=>{C===!0&&(r.setFieldsValue({"ddr-2-pt":!1}),r.setFieldsValue({"ddr-50-pt":!1}))},[C]),y.useEffect(()=>{v===!0&&(r.setFieldsValue({"ddr-1-pt":!1}),r.setFieldsValue({"ddr-50-pt":!1}))},[v]),y.useEffect(()=>{w===!0&&(r.setFieldsValue({"ddr-1-pt":!1}),r.setFieldsValue({"ddr-2-pt":!1}))},[w]);const d=r.getFieldValue("ddr-3-pt");y.useEffect(()=>{d===!0&&r.setFieldsValue({"ddr-4-pt":!1})},[d]);const P=r.getFieldValue("ddr-4-pt");y.useEffect(()=>{P===!0&&r.setFieldsValue({"ddr-3-pt":!1})},[P]),y.useEffect(()=>{(i==null?void 0:i.includes("-"))&&r.setFieldsValue({"ddr-5-pt":!0})},[i]);const E=p=>{const S=an(p);t(S)},N=y.useMemo(()=>(x??"").split(Fe),[x]);return n.jsx(yt,{width:c,title:n.jsxs(n.Fragment,{children:["Edit ",a.name," ",l&&n.jsx("small",{children:l})]}),open:e,onOk:r.submit,onCancel:s,maskClosable:!1,okButtonProps:{disabled:u,htmlType:"submit",size:"large"},okText:f??"Add Item",children:n.jsxs(M,{form:r,name:`new-item-${a.itemId}`,onFinish:E,autoComplete:"off",initialValues:nn(a,o),layout:"vertical",size:"small",labelWrap:!0,children:[n.jsxs("div",{className:"diagram-container",children:[n.jsx("div",{children:n.jsx(_e,{id:a.itemId,width:50})}),n.jsx(M.Item,{name:"name",label:"Name",children:n.jsx(te,{})}),n.jsx(M.Item,{name:"itemId",label:"Item",children:n.jsx(te,{readOnly:!0})}),n.jsx(M.Item,{name:"syllables",label:"Syllables",children:n.jsx(te,{})}),n.jsx(M.Item,{name:"stressedSyllable",label:"Stressed Syllable",children:n.jsx(H.Group,{optionType:"button",buttonStyle:"solid",children:N.map((p,S)=>n.jsx(H,{value:N.length-S-1,children:p},S))})}),n.jsx(M.Item,{name:"updatedAt",label:"Updated At",children:n.jsx(te,{value:new Date(a.updatedAt).toLocaleString(),readOnly:!0})}),(m||h)&&n.jsxs("div",{children:[m&&n.jsxs("span",{children:["Options: ",m==null?void 0:m.join(", ")]}),h&&n.jsx(U,{size:"small",onClick:h,type:"dashed",className:"mt-2",children:"Give me another thing"})]}),n.jsx("div",{children:n.jsx(vt,{offsetTop:50,children:n.jsx(ee,{justify:"center",align:"center",children:n.jsx(U,{type:"primary",htmlType:"submit",size:"large",disabled:u,children:f??"Add Item"})})})})]}),n.jsx("div",{className:"diagram-container",children:j.map(p=>p.method==="auto"&&W[p.id]?n.jsx(M.Item,{name:p.id,label:p.title,valuePropName:"checked",className:oe(a.updatedAt<p.updatedAt&&"diagram-container__outdated-rule"),children:n.jsx(me,{checkedChildren:"✅",unCheckedChildren:"❌",disabled:!0})},p.id):p.method==="dependency"?n.jsx(M.Item,{name:p.id,label:p.title,valuePropName:"checked",className:oe(a.updatedAt<p.updatedAt&&"diagram-container__outdated-rule"),children:n.jsx(me,{checkedChildren:"✅",unCheckedChildren:"❌",disabled:!0})},p.id):n.jsx(M.Item,{name:p.id,label:p.title,className:oe(a.updatedAt<p.updatedAt&&"diagram-container__outdated-rule"),children:n.jsxs(H.Group,{optionType:"button",buttonStyle:"solid",children:[n.jsx(H,{value:!0,children:"✅"}),n.jsx(H,{value:!1,children:"❌"})]})},p.id))})]})})}const nn=(e,t)=>{let s=!1;return{name:e.name,itemId:e.itemId,syllables:e.syllables??De(e.name),stressedSyllable:e.stressedSyllable??0,...Object.keys(t).reduce((a,o)=>{if(e.updatedAt<t[o].updatedAt)if(W[o]){const c=W[o](e.name);c&&e.rules.includes(o)&&(s=!0),a[o]=c}else a[o]=void 0;else a[o]=e.rules.includes(o);return a},{}),updatedAt:s?Date.now():e.updatedAt}},an=e=>{const{itemId:t,name:s,updatedAt:a,syllables:o,stressedSyllable:c,...m}=e;return{itemId:t,name:s,updatedAt:Date.now(),syllables:o,stressedSyllable:c,rules:Object.keys(m).filter(l=>m[l]===!0)}};function J({itemId:e,name:t,width:s=50}){return n.jsxs(ee,{vertical:!0,align:"center",children:[n.jsx(_e,{id:e,width:s}),n.jsx(T.Text,{code:!0,children:t},e)]})}function ne({thing:e,width:t=50,onActivateThing:s}){return n.jsx(Q,{onClick:()=>s(e),children:n.jsx(J,{itemId:e.itemId,name:e.name,width:t})})}function rn({game:e}){const[t]=y.useState([{id:e.rule1.thing.id,name:e.rule1.thing.name,rule:1}]),[s]=y.useState([{id:e.rule2.thing.id,name:e.rule2.thing.name,rule:2}]),[a]=y.useState([{id:e.intersectingThing.id,name:e.intersectingThing.name,rule:0}]),[o]=y.useState(e.things.slice(0,4)),[c,m]=y.useState(e.things[0]);return n.jsxs(R,{direction:"vertical",align:"center",children:[n.jsx(T.Title,{level:4,children:"Game Sample"}),n.jsxs(T.Title,{level:5,children:['"',e.title,'"']}),n.jsx(Ve,{value:e.level,count:e.level,disabled:!0}),n.jsx(T.Paragraph,{style:{maxWidth:"500px"},children:"O círculo amarelo tem uma regra gramatical secreta e o circulo vermelho tem outra regra gramatical secreta. O quadrado do meio representa a interseção entre a regra amarela e a regra vermelha."}),n.jsx(R,{children:n.jsx(sn,{width:600,leftCircleChildren:n.jsx(Q,{style:{width:"100%",height:"100%"},children:t.map((l,f,h)=>n.jsx(J,{itemId:l.id,name:l.name,width:f===h.length-1?80:60},l.id))}),rightCircleChildren:n.jsx(Q,{style:{width:"100%",height:"100%"},children:s.map((l,f,h)=>n.jsx(J,{itemId:l.id,name:l.name,width:f===h.length-1?80:60},l.id))}),intersectionChildren:n.jsx(Q,{style:{width:"100%",height:"100%"},children:a.map((l,f,h)=>n.jsx(J,{itemId:l.id,name:l.name,width:f===h.length-1?80:60},l.id))})})}),n.jsx(T.Text,{children:"Coloque os objetos nos círculos corretos:"}),n.jsx(R,{className:"space--center",children:o.map(l=>n.jsx(Q,{style:l.id===(c==null?void 0:c.id)?{outline:"3px solid hotPink"}:{},onClick:()=>m(l),children:n.jsx(J,{itemId:l.id,name:l.name},l.id)},l.id))}),n.jsx(Zt,{items:[{key:"1",label:"Resposta",children:n.jsxs(R,{direction:"vertical",children:[n.jsx(T.Text,{strong:!0,children:"Regra Amarela"}),n.jsx("ul",{children:n.jsx("li",{children:n.jsx(T.Text,{children:e.rule1.text})})}),n.jsx(T.Text,{strong:!0,children:"Regra Vermelha"}),n.jsx("ul",{children:n.jsx("li",{children:n.jsx(T.Text,{children:e.rule2.text})})})]})}]}),n.jsx("div",{style:{height:"200px"}})]})}function sn({leftCircleChildren:e,rightCircleChildren:t,intersectionChildren:s,...a}){return n.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 760 500",...a,children:[n.jsx("path",{fill:"#fbb03b",stroke:"#000",strokeMiterlimit:"10",strokeWidth:"5",d:"M252.78 3.5c-136.42 0-247 110.59-247 247s110.59 247 247 247 247-110.59 247-247-110.59-247-247-247zm.99 483.07C123.39 486.57 17.7 380.88 17.7 250.5S123.39 14.43 253.77 14.43 489.84 120.12 489.84 250.5 384.15 486.57 253.77 486.57z"}),n.jsx("path",{fill:"#f15a24",stroke:"#000",strokeMiterlimit:"10",strokeWidth:"5",d:"M508.22 3.5c-136.41 0-247 110.59-247 247s110.59 247 247 247 247-110.59 247-247-110.58-247-247-247zm.99 483.07c-130.38 0-236.07-105.69-236.07-236.07S378.84 14.43 509.22 14.43 745.29 120.12 745.29 250.5 639.6 486.57 509.22 486.57z"}),n.jsx("path",{fill:"#535353",d:"M487.34 250.5c0-62.39-24.29-121.04-68.41-165.16a235.9 235.9 0 00-37.43-30.47 235.35 235.35 0 00-37.43 30.47c-44.12 44.11-68.41 102.77-68.41 165.16s24.29 121.04 68.41 165.16a235.9 235.9 0 0037.43 30.47 235.35 235.35 0 0037.43-30.47c44.12-44.11 68.41-102.77 68.41-165.16z"}),n.jsx("path",{fill:"#535353",d:"M258.72 250.5c0-66.64 25.95-129.3 73.08-176.42a253.125 253.125 0 0134.1-28.57c-33.98-18.65-72.29-28.57-112.13-28.57-62.39 0-121.04 24.29-165.16 68.41C44.5 129.46 20.2 188.11 20.2 250.5s24.29 121.04 68.41 165.16c44.11 44.12 102.77 68.41 165.16 68.41 39.84 0 78.15-9.92 112.13-28.57a252.507 252.507 0 01-34.1-28.57c-47.12-47.12-73.08-109.78-73.08-176.42zM674.37 85.34C630.25 41.22 571.6 16.93 509.21 16.93c-40.27 0-78.98 10.14-113.24 29.18 11.74 8.26 22.86 17.6 33.22 27.96 47.12 47.12 73.08 109.78 73.08 176.42s-25.95 129.3-73.08 176.42a252.312 252.312 0 01-33.22 27.96c34.25 19.04 72.96 29.18 113.24 29.18 62.39 0 121.04-24.29 165.16-68.41 44.12-44.11 68.41-102.77 68.41-165.16s-24.29-121.04-68.41-165.16z"}),n.jsx("foreignObject",{x:"30",y:"25",width:"250",height:"450",children:n.jsx("div",{className:"venn-diagram__circle-content-left",children:e})}),n.jsx("foreignObject",{x:"480",y:"25",width:"250",height:"450",children:n.jsx("div",{className:"venn-diagram__circle-content-right",children:t})}),n.jsx("foreignObject",{x:"290",y:"65",width:"182",height:"370",children:n.jsx("div",{className:"venn-diagram__circle-content-intersection",children:s})})]})}function on({things:e,rules:t}){const[s]=ge(),[a,o]=y.useState(null),c=()=>{o(Object.values(Ie(1,{latestDate:"2023/01/01",latestNumber:0,used:[]},t,e))[0])},m=()=>{let l=null;try{l=Ie(25,{latestDate:"2023/01/01",latestNumber:0,used:[]},t,e),console.log(l)}catch(f){console.error(f)}};return n.jsxs(R,{direction:"vertical",ref:s,children:[n.jsx(T.Title,{level:5,children:"Game Simulator"}),n.jsx(U,{size:"large",onClick:c,children:"Simulate"}),n.jsx(U,{size:"large",onClick:m,children:"Generate Demos (log)"}),a&&n.jsx(rn,{game:a},JSON.stringify(a))]})}function ln({children:e,things:t,rules:s,addEntryToUpdate:a}){const o=y.useMemo(()=>Object.values(t).filter(f=>{if(f.syllables&&f.syllables.split(Fe).join("")!==f.name.replace(/\s/g,""))return console.log("❗️ Name and syllables do not match",f.name,f.syllables),!0;const h=Object.values(s).filter(r=>r.updatedAt>f.updatedAt);return h.filter(r=>r.method==="auto").length>0&&console.log("❗️ Thing has auto updates that will be performed automatically upon downloading the JSON"),h.some(r=>r.method!=="auto")}),[t,s]),[c,m]=y.useState(null);y.useEffect(()=>{const f=async h=>{console.log("Found things that need to update..."),m(null),await ue(250),o.length>0&&m(o[0])};console.count("Checking for things that need to update..."),o.length>0&&f(o[0])},[o]);const l=f=>{a(f.itemId,f)};return n.jsxs(n.Fragment,{children:[c&&n.jsx(ye,{subtitle:`(${o.length} left to update)`,isModalOpen:c!==null,onSaveThing:l,onCancel:()=>m(null),thing:c,rules:s,okButtonText:"Update",width:"90vw"}),e]})}function We({addEntryToUpdate:e,availableThings:t,rules:s,width:a}){const{notification:o}=lt.useApp(),[c,m]=y.useState(null),l=()=>{const r=Z.sample(t);m(r?{itemId:r.id,name:dn(r),updatedAt:Date.now(),syllables:"",stressedSyllable:0,rules:[]}:null)},f=y.useMemo(()=>{if(!c)return[];const r=t.find(g=>g.id===c.itemId);return[r==null?void 0:r.name.pt,...(r==null?void 0:r.aliasesPt)??[]].filter(Boolean)},[c,t]),h=async r=>{c&&((!r.name||!r.itemId)&&o.error({message:"Name and Item ID are required"}),e(r.itemId,r),console.log("COMPLETED SAVE"),m(null),await ue(250),l())},j=async()=>{m(null),await ue(100),l()};return n.jsxs(n.Fragment,{children:[n.jsx(U,{size:"large",onClick:l,children:"Classify New Item"}),!!c&&n.jsx(ye,{isModalOpen:c!==null,onSaveThing:h,onCancel:()=>m(null),thing:c,rules:s,width:a*.9,itemAliases:f,onGiveAnotherThing:j})]})}const dn=e=>e.name.pt.split(" ").length===1?e.name.pt:e.aliasesPt?e.aliasesPt.find(t=>t.split(" ").length===1)??e.name.pt:e.name.pt;function cn({things:e,addEntryToUpdate:t,availableThings:s,rules:a,setActiveThing:o}){const[c,{width:m}]=ge(),l=y.useMemo(()=>Object.values(e),[e]),f=Le({total:l.length,showQuickJumper:!0}),h=[{title:"ItemId",dataIndex:"itemId",key:"itemId",sorter:(r,g)=>Number(r.itemId)-Number(g.itemId),render:r=>n.jsx(L,{children:r})},{title:"Name",dataIndex:"name",key:"name",sorter:(r,g)=>r.name.localeCompare(g.name),render:r=>n.jsx(T.Text,{children:r})},{title:"Sprite",dataIndex:"itemId",key:"sprite",render:r=>n.jsx(ne,{thing:e[r],onActivateThing:o},`i-${r}`)},{title:"Rules",dataIndex:"rules",key:"rules",render:(r,g)=>n.jsx(R,{wrap:!0,children:r.map(u=>n.jsx(it,{title:a[u].title,children:n.jsx(L,{color:a[u].updatedAt>g.updatedAt?"red":void 0,children:u})},u))})},{title:"Count",dataIndex:"rules",key:"count",sorter:(r,g)=>r.rules.length-g.rules.length,render:r=>r.length}],j=y.useMemo(()=>{const r={};return Object.values(e).forEach(g=>{r[g.name]||(r[g.name]=[]),r[g.name].push(g.itemId)}),Object.values(r).filter(g=>g.length>1)},[e]);return n.jsxs(R,{direction:"vertical",ref:c,children:[n.jsxs(T.Title,{level:5,children:["Rules By Items ",n.jsx(G,{type:"vertical"})," Added: ",n.jsx(L,{children:Object.keys(e).length})," Available to add ",n.jsx(L,{children:s.length})]}),n.jsx(We,{addEntryToUpdate:t,availableThings:s,rules:a,width:m}),n.jsx(G,{}),n.jsx(ze,{dataSource:l,columns:h,rowKey:"itemId",pagination:f}),n.jsx(G,{}),n.jsx(T.Title,{level:5,children:"Duplicated Things"}),n.jsxs(R,{wrap:!0,children:[j.length===0&&n.jsx(T.Text,{children:"No duplicated things"}),j.map(r=>n.jsxs(ee,{align:"center",children:[n.jsx(L,{color:"red",children:r.length}),r.map(g=>n.jsx(ne,{thing:e[g],onActivateThing:o},`i-${g}`))]},r[0]))]})]})}function un({things:e,addEntryToUpdate:t,availableThings:s,rules:a,thingsByRules:o,setActiveThing:c,containerWidth:m}){const{is:l,addParam:f}=he(),h=y.useMemo(()=>Object.values(a).map(u=>({...u,thingsCount:o[u.id].length})),[a,o]),j=Le({total:h.length,showQuickJumper:!0}),r=y.useMemo(()=>{const u=Object.values(o).map(i=>i.length);return{maxThings:Math.max(...u),minThings:Math.min(...u),averageThings:Math.round(Object.values(o).reduce((i,x)=>i+x.length,0)/Object.keys(o).length)}},[o]),g=[{title:"Id",dataIndex:"id",key:"id",sorter:(u,i)=>Number(u.id.split("-")[1])-Number(i.id.split("-")[1]),render:u=>n.jsx(T.Text,{children:u})},{title:"Rule",dataIndex:"title",key:"title",sorter:(u,i)=>u.title.localeCompare(i.title),render:u=>n.jsx(T.Text,{children:u})},{title:"Type",dataIndex:"type",key:"type",sorter:(u,i)=>u.type.localeCompare(i.type)},{title:"Method",dataIndex:"method",key:"method",sorter:(u,i)=>u.method.localeCompare(i.method)},{title:"Things",dataIndex:"thingsCount",key:"thingsCount",render:(u,i)=>n.jsxs(R,{size:"small",children:[n.jsx(L,{children:u}),l("showThings")?n.jsxs(R,{size:"small",wrap:!0,children:[o[i.id].slice(0,20).map(x=>n.jsx(ne,{thing:e[x],onActivateThing:c},`${i.id}-${x}`)),o[i.id].length>20&&n.jsxs(T.Text,{children:["+",u-20," more"]})]}):n.jsxs(R,{size:"small",wrap:!0,children:[o[i.id].slice(0,5).map(x=>n.jsx(ne,{thing:e[x],onActivateThing:c},`${i.id}-${x}`)),o[i.id].length>5&&n.jsxs(T.Text,{children:["+",u-5," more"]})]})]}),sorter:(u,i)=>u.thingsCount-i.thingsCount},{title:"Level",dataIndex:"level",key:"level",sorter:(u,i)=>u.level-i.level,render:u=>n.jsx(Ve,{value:u,count:3,disabled:!0})}];return n.jsxs(R,{direction:"vertical",children:[n.jsxs(T.Title,{level:4,children:["Things By Rule (Added: ",Object.keys(e).length," | ",s.length,")"," "]}),n.jsxs(R,{split:n.jsx(G,{type:"vertical"}),wrap:!0,children:[n.jsx(We,{addEntryToUpdate:t,availableThings:s,rules:a,width:m}),n.jsxs(T.Text,{strong:!0,children:["Average Things: ",n.jsx(L,{children:r.averageThings})]}),n.jsxs(T.Text,{strong:!0,children:["Max Things: ",n.jsx(L,{children:r.maxThings})]}),n.jsxs(T.Text,{strong:!0,children:["Min Things: ",n.jsx(L,{children:r.minThings})]}),n.jsx(me,{checked:l("showThings"),onChange:u=>f("showThings",u),checkedChildren:"Hide things",unCheckedChildren:"Show things"})]}),n.jsx(ze,{dataSource:h,columns:g,pagination:j})]})}function mn({data:e,addEntryToUpdate:t}){const[s,{width:a}]=ge(),o=ce("items"),c=ce("daily-diagram-rules"),m=y.useMemo(()=>Object.values(o.data??{}).filter(i=>{var b,I,C;if(e&&e[i.id]!==void 0||i.nsfw)return!1;const x=i.name.pt.split(" ").length===1;return!!((b=i.decks)!=null&&b.includes("thing")||(I=i.decks)!=null&&I.includes("alien")&&x||(C=i.decks)!=null&&C.includes("manufactured")&&x)}),[e,o.data]),l=y.useMemo(()=>c.data??{},[c.data]),f=y.useMemo(()=>{const i=Object.values(l).reduce((x,b)=>(x[b.id]=[],x),{});return Z.orderBy(Object.values(e),["updatedAt"],["desc"]).forEach(x=>{x.rules.forEach(b=>{i[b].push(x.itemId)})}),i},[e,l]),{is:h,queryParams:j}=he(),[r,g]=y.useState(null);if(o.isLoading||c.isLoading)return n.jsx(T.Text,{children:"Loading..."});const u=i=>{t(i.itemId,i)};return n.jsx(Re,{isLoading:o.isLoading||c.isLoading,hasResponseData:o.hasResponseData||c.hasResponseData,children:n.jsx("div",{ref:s,children:n.jsxs(ln,{things:e,rules:l,addEntryToUpdate:t,children:[r&&n.jsx(ye,{isModalOpen:r!==null,onSaveThing:i=>{u(i),g(null)},onCancel:()=>g(null),thing:r,rules:l,okButtonText:"Update",width:a}),(h("display","rule")||!j.has("display"))&&n.jsx(un,{things:e,addEntryToUpdate:t,availableThings:m,rules:l,thingsByRules:f,setActiveThing:g,containerWidth:a}),h("display","thing")&&n.jsx(cn,{things:e,addEntryToUpdate:t,availableThings:m,rules:l,thingsByRules:f,setActiveThing:g}),h("display","simulator")&&n.jsx(on,{things:e,addEntryToUpdate:t,availableThings:m,rules:l})]})})})}function oa(){const e=bt({tdrResourceName:"daily-diagram-items",firebaseDataCollectionName:"diagramItems",serialize:!0});return n.jsx(dt,{title:"Items",subtitle:"Diagram Sets",children:n.jsxs(je,{hasSider:!0,children:[n.jsx(xt,{children:n.jsx(en,{...e})}),n.jsx(je.Content,{className:"content",children:n.jsx(Re,{isLoading:e.isLoading||e.isSaving,error:e.error,hasResponseData:!Z.isEmpty(e.data),children:n.jsx(ee,{vertical:!0,gap:24,children:n.jsx(mn,{...e})})})})]})})}export{oa as ItemsDiagramSets,oa as default};
