import{r as j,a as O,_ as L,j as e,T as b,I as E,B as R,D as T,P as A,L as H}from"./index-BFDRWtHv.js";import{D as z}from"./DataLoadingWrapper-QQAlVTEl.js";import{l as v,P as M}from"./useBaseUrl-ByeKCJr_.js";import{I as P}from"./ImageCard-CK3PBH92.js";import{u as W}from"./useCardWidth-H2OUvNTX.js";import{u as I}from"./useQueryParams-BzyCUS2v.js";import{s as w,a as $}from"./index-IZYxY2DZ.js";import{D as k}from"./EditableFields-BOnm9PA5.js";import{g as F}from"./utils-W0m0iwL6.js";import{u as N}from"./useDebounce-DGT6oRGQ.js";import{D}from"./index-DGjgHp-K.js";import{F as S}from"./index-BW_WXugc.js";import{S as C}from"./index-PrF_5kCp.js";import{I as y}from"./index-CVpJTsmp.js";import{R as _}from"./index-CydRzHA3.js";import{S as q}from"./index-BkBOubIy.js";import{S as Y}from"./index-BozTJ2QA.js";import{T as J}from"./index-Djb5JNZe.js";import{R as Q,a as V}from"./WomanOutlined-XPAPBbFa.js";import{R as K,a as X}from"./ColumnWidthOutlined-LSs4i86i.js";import{a as B,b as Z}from"./FilterEntries-Bb8tr1UA.js";import{S as U}from"./SiderContent-DC5vRzOx.js";import{D as ee}from"./DownloadButton-DFL9asHu.js";import{F as se}from"./FirestoreConsoleLink-BOUHUI6f.js";import{S as ae}from"./SaveButton-CFMegeSt.js";import{u as ie}from"./useResourceFirestoreData-CNKffEHM.js";import"./constants-B6pq8fjY.js";import"./Item-4aagvKpa.js";import"./useCopyToClipboardFunction-w-QDpeXz.js";import"./LanguageFlag-Dee7VqCc.js";import"./FireFilled-C25tH6Gt.js";import"./IdcardOutlined-Bzq_eAIf.js";import"./gapSize-U1swVQyS.js";import"./Input-BRqpx4DJ.js";import"./index-8MB3GqgU.js";import"./index-BWULmf55.js";import"./moment-C5S46NFB.js";import"./SaveOutlined-YGZUPp9b.js";import"./useGetFirestoreDoc-CwYmDqGR.js";import"./useTDResource-9MAM5PRn.js";import"./useUpdateFirestoreDoc-Du252Wxc.js";import"./useMutation-B5wm9cAG.js";var le={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M880 836H144c-17.7 0-32 14.3-32 32v36c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-36c0-17.7-14.3-32-32-32zm-622.3-84c2 0 4-.2 6-.5L431.9 722c2-.4 3.9-1.3 5.3-2.8l423.9-423.9a9.96 9.96 0 000-14.1L694.9 114.9c-1.9-1.9-4.4-2.9-7.1-2.9s-5.2 1-7.1 2.9L256.8 538.8c-1.5 1.5-2.4 3.3-2.8 5.3l-29.5 168.2a33.5 33.5 0 009.4 29.8c6.6 6.4 14.9 9.9 23.8 9.9z"}}]},name:"edit",theme:"filled"},te=function(t,o){return j.createElement(O,L({},t,{ref:o,icon:le}))},re=j.forwardRef(te);const ne=["18-21","21-30","30-40","40-50","50-60","60-70","70-80","80-90"].map(a=>({label:a,value:a})),oe=[{label:"Male",value:"male"},{label:"Female",value:"female"},{label:"Non-binary",value:"non-binary"},{label:"Other",value:"other"}],ce=[{label:"Caucasian",value:"caucasian"},{label:"Black",value:"black"},{label:"Asian",value:"asian"},{label:"Latino",value:"latino"},{label:"Indigenous",value:"indigenous"},{label:"Indian",value:"indian"},{label:"Middle Eastern",value:"middle-eastern"},{label:"Mixed",value:"mixed"},{label:"Other",value:"other"}];function de({data:a,addEntryToUpdate:t}){const{removeParam:o,queryParams:n}=I(),c=n.get("suspectId"),d=n.get("version")??"gb",s=a[c??""],[m,p]=j.useState((s==null?void 0:s.name.pt)||""),[i,l]=j.useState((s==null?void 0:s.name.en)||""),[h,u]=j.useState((s==null?void 0:s.note)||"");return j.useEffect(()=>{s&&(p(s.name.pt),l(s.name.en),u(s.note||""))},[s==null?void 0:s.id]),N(()=>{s&&m!==s.name.pt&&t(s.id,{...s,name:{...s.name,pt:m}})},1e3,[m]),N(()=>{s&&i!==s.name.en&&t(s.id,{...s,name:{...s.name,en:i}})},1e3,[i]),N(()=>{s&&h!==s.note&&t(s.id,{...s,note:h})},1e3,[h]),s?e.jsx(D,{title:s.name.pt,placement:"right",onClose:()=>o("suspectId"),open:!!s,width:400,children:e.jsxs("div",{className:"suspect__drawer",children:[e.jsxs("div",{className:"grid",style:{gridTemplateColumns:"1fr 1.25fr"},children:[e.jsx(P,{id:F(s.id,d),width:100}),e.jsxs(S,{vertical:!0,gap:4,children:[e.jsx(k,{value:s.name,language:"pt",onChange:r=>{t(s.id,{...s,name:{...s.name,pt:r.target.value}})}}),e.jsx(k,{value:s.name,language:"en",onChange:r=>{t(s.id,{...s,name:{...s.name,en:r.target.value}})}}),e.jsx("div",{children:e.jsx(C,{placeholder:"Select Age",value:s.age,size:"small",onChange:r=>{t(s.id,{...s,age:r})},options:ne,style:{width:80}})}),e.jsx("div",{children:e.jsx(C,{value:s.gender,size:"small",onChange:r=>{t(s.id,{...s,gender:r})},options:oe,style:{width:120}})}),e.jsx("div",{children:e.jsx(C,{value:s.ethnicity,size:"small",onChange:r=>{t(s.id,{...s,ethnicity:r})},options:ce,style:{width:150}})}),e.jsx("div",{children:e.jsx(y,{value:s.note,size:"small",onChange:r=>{t(s.id,{...s,note:r.target.value})}})})]})]}),e.jsxs("div",{className:"grid grid-2",children:[e.jsxs(S,{vertical:!0,children:[e.jsx(b.Text,{strong:!0,children:"Build"}),e.jsx(_.Group,{size:"small",value:s.build,onChange:r=>{t(s.id,{...s,build:r.target.value})},options:me,style:{display:"flex",flexDirection:"column",gap:3}})]}),e.jsxs(S,{vertical:!0,children:[e.jsx(b.Text,{strong:!0,children:"Height"}),e.jsx(_.Group,{size:"small",value:s.height,onChange:r=>{t(s.id,{...s,height:r.target.value})},options:he,style:{display:"flex",flexDirection:"column",gap:3}})]})]}),e.jsx(ue,{suspect:s,addEntryToUpdate:t})]})}):null}function ue({suspect:a,addEntryToUpdate:t}){const o=a.features??[],n=c=>{const d=o.includes(c)?o.filter(s=>s!==c):[...o,c];t(a.id,{...a,features:d})};return e.jsx("div",{className:"grid grid-2",children:G.map(c=>e.jsxs("div",{className:"my-4",children:[e.jsx(b.Text,{strong:!0,children:c.title}),c.features.map(d=>e.jsxs(S,{className:"my-2",gap:4,children:[e.jsx(q,{size:"small",checked:o.includes(d.id),onChange:()=>n(d.id)})," ",d.label]},d.id))]},c.title))})}const me=["thin","average","muscular","large"],he=["short","medium","tall"],G=[{title:"Hair Length",features:[{id:"shortHair",label:"Short Hair"},{id:"longHair",label:"Long Hair"},{id:"mediumHair",label:"Medium Hair"},{id:"bald",label:"Bald"}]},{title:"Hair Color",features:[{id:"blackHair",label:"Black Hair"},{id:"brownHair",label:"Brown Hair"},{id:"blondeHair",label:"Blonde Hair"},{id:"redHair",label:"Red Hair"},{id:"greyHair",label:"Grey Hair"},{id:"coloredHair",label:"Colored Hair"}]},{title:"Face",features:[{id:"beard",label:"Beard"},{id:"mustache",label:"Mustache"},{id:"goatee",label:"Goatee"},{id:"lipstick",label:"Lipstick"}]},{title:"Accessories",features:[{id:"noAccessories",label:"No Accessories"},{id:"glasses",label:"Glasses"},{id:"piercings",label:"Piercings"},{id:"earrings",label:"Earrings"},{id:"necklace",label:"Necklace"},{id:"hat",label:"Hat"},{id:"scarf",label:"Scarf"},{id:"hoodie",label:"Hoodie"},{id:"tie",label:"Tie"},{id:"headscarf",label:"Headscarf/Bandana"}]}];function ge({data:a,addEntryToUpdate:t}){const{addParam:o,queryParams:n}=I(),c=n.get("version")??"gb",d=n.get("sortBy")??"id",s=Number(n.get("cardsPerRow"))||8,[m,p]=W(s),i=j.useMemo(()=>v.orderBy(Object.values(a),l=>d==="id"?Number(l.id.split("-").at(-1)):d==="name.pt"?w(l.name.pt).toLowerCase():d==="name.en"?w(l.name.en).toLowerCase():l[d]??l.id,["asc"]),[a,d]);return e.jsxs(e.Fragment,{children:[e.jsxs(b.Title,{level:2,children:["Deck ",c," (",i.length,")"]}),e.jsx(E.PreviewGroup,{children:e.jsx(Y,{ref:p,wrap:!0,className:"my-2",children:i.map(l=>{var h,u;return e.jsxs("div",{className:"suspect",style:{width:`${m}px`},children:[e.jsx(P,{id:F(l.id,c),width:m,className:"suspect__image"}),e.jsxs("div",{className:"suspect__name",children:[e.jsx("div",{children:e.jsx(J,{children:l.id})}),e.jsxs("div",{children:["ðŸ‡§ðŸ‡· ",l.name.pt]}),e.jsxs("div",{children:["ðŸ‡ºðŸ‡¸ ",l.name.en]}),e.jsxs("div",{className:"suspect__info",style:pe(l),children:[e.jsxs("div",{children:[e.jsxs("div",{children:[l.gender==="male"?e.jsx(Q,{}):e.jsx(V,{})," ",l.age]}),e.jsx("div",{children:e.jsx("em",{children:l.ethnicity})})]}),e.jsxs("div",{className:"uppercase",children:[e.jsx(K,{}),e.jsx("br",{}),l.build.charAt(0)]}),e.jsxs("div",{className:"uppercase",children:[e.jsx(X,{}),e.jsx("br",{}),l.height.charAt(0)]}),e.jsxs("div",{children:[((h=l==null?void 0:l.features)==null?void 0:h.length)??0," features"]})]}),e.jsx(R,{size:"small",block:!0,onClick:()=>o("suspectId",l.id),danger:!(l!=null&&l.features)||((u=l==null?void 0:l.features)==null?void 0:u.length)<2,children:e.jsx(re,{})})]})]},l.id)})},c)}),e.jsx(de,{data:a,addEntryToUpdate:t})]})}const pe=a=>!a.build||!a.height||a.build.length===1||a.height.length===1?{borderColor:"red"}:{};function f(a,t){return v.orderBy(Object.entries(a).map(([o,n])=>({key:o,label:v.capitalize(o),value:n,percentage:Math.round(n/t*100)})),["percentage"],["desc"])}function xe({data:a}){const[t,o]=j.useState(!1);return e.jsxs(e.Fragment,{children:[e.jsx(R,{onClick:()=>o(!0),block:!0,children:"See Stats"}),t&&e.jsx(be,{data:a,open:t,onClose:()=>o(!1)})]})}function be({data:a,open:t,onClose:o}){const{ages:n,ethnicities:c,genders:d,builds:s,heights:m}=j.useMemo(()=>{const i={},l={},h={},u={},r={};Object.values(a).forEach(g=>{i[g.age]=(i[g.age]??0)+1,l[g.ethnicity]=(l[g.ethnicity]??0)+1,h[g.gender]=(h[g.gender]??0)+1,u[g.build||"?"]=(u[g.build||"?"]??0)+1,r[g.height||"?"]=(r[g.height||"?"]??0)+1});const x=Object.keys(a).length;return{ages:f(i,x),ethnicities:f(l,x),genders:f(h,x),builds:f(u,x),heights:f(r,x)}},[a]),p=j.useMemo(()=>{const i={};Object.values(a).forEach(u=>{var r;(r=u.features)==null||r.forEach(x=>{i[x]=(i[x]??0)+1})});const l=Object.keys(a).length,h=G.reduce((u,r)=>{const x=r.features.map(g=>g.id);return u.push(...x),u},[]);return v.orderBy(f(i,l),u=>h.findIndex(r=>r===u.key),["asc"])},[a]);return e.jsxs(D,{title:"Suspects Statistics",placement:"right",onClose:o,open:t,width:400,children:[e.jsx(b.Text,{strong:!0,children:"Ethnicity"}),e.jsx("ul",{className:"statistic__list",children:c.map(i=>e.jsxs("li",{children:[e.jsx("strong",{children:i.label})," - ",i.percentage,"%"]},i.key))}),e.jsx(b.Text,{strong:!0,children:"Gender"}),e.jsx("ul",{className:"statistic__list",children:d.map(i=>e.jsxs("li",{children:[e.jsx("strong",{children:i.label})," - ",i.percentage,"%"]},i.key))}),e.jsx(b.Text,{strong:!0,children:"Age"}),e.jsx("ul",{className:"statistic__list",children:n.map(i=>e.jsxs("li",{children:[e.jsx("strong",{children:i.label})," - ",i.percentage,"%"]},i.key))}),e.jsx(b.Text,{strong:!0,children:"Build"}),e.jsx("ul",{className:"statistic__list",children:s.map(i=>e.jsxs("li",{children:[e.jsx("strong",{children:i.label})," - ",i.percentage,"%"]},i.key))}),e.jsx(b.Text,{strong:!0,children:"Height"}),e.jsx("ul",{className:"statistic__list",children:m.map(i=>e.jsxs("li",{children:[e.jsx("strong",{children:i.label})," - ",i.percentage,"%"]},i.key))}),e.jsx(b.Text,{strong:!0,children:"Features"}),e.jsx("ul",{className:"statistic__list",children:p.map(i=>e.jsxs("li",{children:[e.jsx("strong",{children:i.label})," - ",i.percentage,"% (",i.value,")"]},i.key))})]})}const je=[{value:"ct",label:"Cartoon"},{value:"gb",label:"Ghibli"},{value:"ai",label:"AI"},{value:"md",label:"Models"},{value:"wc",label:"Wacky"}],fe=[{value:"id",label:"Id"},{value:"name.pt",label:"Name (PT)"},{value:"name.en",label:"Name (EN)"},{value:"ethnicity",label:"Ethnicity"},{value:"gender",label:"Gender"},{value:"age",label:"Age"},{value:"height",label:"Height"},{value:"build",label:"Build"}];function ve({data:a,save:t,isDirty:o,isSaving:n,entriesToUpdate:c,hasFirestoreData:d}){const{addParam:s,queryParams:m}=I();return e.jsxs(U,{children:[e.jsxs(S,{vertical:!0,gap:12,children:[e.jsx(ae,{isDirty:o,onSave:t,isSaving:n,dirt:JSON.stringify(c)}),e.jsx(ee,{data:()=>Se(a),fileName:"suspects.json",disabled:o,hasNewData:d,block:!0}),e.jsx(se,{path:"tdr/suspects",className:"text-center"})]}),e.jsx(T,{}),e.jsx(B,{label:"Version",value:m.get("version")??"gb",onChange:p=>s("version",p),options:je}),e.jsx(Z,{label:"Cards Per Row",value:Number(m.get("cardsPerRow")??"8"),onChange:p=>s("cardsPerRow",p),min:2,max:12}),e.jsx(B,{label:"Sort By",value:m.get("sortBy")??"id",onChange:p=>s("sortBy",p),options:fe}),e.jsx(xe,{data:a})]})}function Se(a){const t=v.cloneDeep(a);for(const o in t){const n=t[o];n.name.pt.endsWith(".")&&(n.name.pt=n.name.pt.slice(0,-1).trim()),n.name.en.endsWith(".")&&(n.name.en=n.name.en.slice(0,-1).trim()),Number(n.id.match(/\d+/))>114&&(n.gbExclusive=!0)}return $(t,["gender","ethnicity","age","height","build","features"])}function ds(){const a=ie({tdrResourceName:"suspects",firestoreDataCollectionName:"suspects",serialize:!0});return e.jsx(A,{title:"Suspects",subtitle:"Information",children:e.jsxs(H,{hasSider:!0,children:[e.jsx(M,{children:e.jsx(ve,{...a})}),e.jsx(H.Content,{className:"content",children:e.jsx(z,{isLoading:a.isLoading,error:a.error,hasResponseData:!v.isEmpty(a.data),children:e.jsx(ge,{...a})})})]})})}export{ds as default};
