import{r as j,d as ye,j as s,T as _,F as D,S as q,b as ue,B as Q,e as ne,f as ie,g as Ge,A as E,h as Ye,D as Pe,i as Ue,u as qe,s as fe,k as _e,P as Fe,L as ge}from"./index-DyjSH4OM.js";import{u as be}from"./useQueryParams-Buak0vV0.js";import{R as De}from"./main-DAgWEGSl.js";import{u as $e,C as Ve,a as ve}from"./useArteRuimDrawings-DgdqQIUY.js";import{u as Ae}from"./useMutation-B98nW9qs.js";import{g as Qe,u as Be}from"./useGetFirestoreDoc-Clud0cWJ.js";import{h as Y}from"./moment-B-YVwB4U.js";import{a as re,m as We,r as Ce,b as He}from"./index-CIvxw8l3.js";import{T as Ke,a as se,F as Je}from"./FilterEntries-D3ZPyz_c.js";import{T as W}from"./index-CQYidkL6.js";import{S as ze}from"./index-DQRiDBAE.js";import{F as me}from"./FirestoreConsoleLink-Buc0gGoQ.js";import{C as Se}from"./CopyToClipboardButton-NL5opfSr.js";import{I as X}from"./ImageCard-C5pbT96q.js";import{A as Ze,W as Xe,b as $,c as he}from"./constants-B1K3jPng.js";import{I as V}from"./Item-jt1Ui6d6.js";import{S as et,t as tt,g as Ee,c as st}from"./useTestimoniesResource-CtWg8OLC.js";import{l as h,P as nt}from"./useBaseUrl-CGDFxb01.js";import{g as it,u as P,D as x,a as U,c as H,A as ae,L as we}from"./useParsedHistory-Da35IewS.js";import{R as rt,a as at}from"./Pagination-DhLSDJ7y.js";import{F as Te}from"./Table-DHBMrFtB.js";import{D as ot}from"./DataLoadingWrapper-B0oxzPVc.js";import{u as k}from"./useTDResource-CGE34CFt.js";import{a as B,c as lt,u as ct}from"./warnings-DXIMNqu4.js";import{d as pe,u as dt,a as ut,t as R}from"./daily-espionagem-GjfqVLkp.js";import{u as oe}from"./useLoadWordLibrary-DWLZWDCi.js";import{u as mt}from"./daily-quartetos-CsNUvu70.js";import{u as ht}from"./daily-teoria-de-conjuntos-BOASH31s.js";import{u as Ne}from"./useDailyHistoryQuery-JVKHeXVX.js";import{R as pt}from"./CloudSyncOutlined-BkLFHSn0.js";import{R as ft}from"./SaveOutlined-C-TjSIG9.js";import{S as le}from"./SiderContent--jQ49XzE.js";import{R as gt}from"./ContainerOutlined-C01r9Kdj.js";import{C as G}from"./index-BSyNjB5B.js";import"./index-BxFHkOJs.js";import"./useId-C3rCDJeT.js";import"./index-DpYZgC1U.js";import"./PlusOutlined-DXJb8t4Z.js";import"./index-CUyUdleU.js";import"./useCopyToClipboardFunction-DzFGYu6U.js";import"./VirtualizationWrapper-D_i8yj1t.js";import"./useResourceFirestoreData-Kas4aR5W.js";import"./useUpdateFirestoreDoc-BINkZPPh.js";import"./index-D9N9BiJs.js";import"./Dropdown-CQ0KOtK0.js";import"./index-ClnxuMyA.js";import"./scrollTo-Dcq7vwV7.js";var xt={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M518.3 459a8 8 0 00-12.6 0l-112 141.7a7.98 7.98 0 006.3 12.9h73.9V856c0 4.4 3.6 8 8 8h60c4.4 0 8-3.6 8-8V613.7H624c6.7 0 10.4-7.7 6.3-12.9L518.3 459z"}},{tag:"path",attrs:{d:"M811.4 366.7C765.6 245.9 648.9 160 512.2 160S258.8 245.8 213 366.6C127.3 389.1 64 467.2 64 560c0 110.5 89.5 200 199.9 200H304c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8h-40.1c-33.7 0-65.4-13.4-89-37.7-23.5-24.2-36-56.8-34.9-90.6.9-26.4 9.9-51.2 26.2-72.1 16.7-21.3 40.1-36.8 66.1-43.7l37.9-9.9 13.9-36.6c8.6-22.8 20.6-44.1 35.7-63.4a245.6 245.6 0 0152.4-49.9c41.1-28.9 89.5-44.2 140-44.2s98.9 15.3 140 44.2c19.9 14 37.5 30.8 52.4 49.9 15.1 19.3 27.1 40.7 35.7 63.4l13.8 36.5 37.8 10C846.1 454.5 884 503.8 884 560c0 33.1-12.9 64.3-36.3 87.7a123.07 123.07 0 01-87.6 36.3H720c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h40.1C870.5 760 960 670.5 960 560c0-92.7-63.1-170.7-148.6-193.3z"}}]},name:"cloud-upload",theme:"outlined"};function ce(){return ce=Object.assign?Object.assign.bind():function(e){for(var i=1;i<arguments.length;i++){var r=arguments[i];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},ce.apply(this,arguments)}const jt=(e,i)=>j.createElement(ye,ce({},e,{ref:i,icon:xt})),It=j.forwardRef(jt);var yt={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M396 512a112 112 0 10224 0 112 112 0 10-224 0zm546.2-25.8C847.4 286.5 704.1 186 512 186c-192.2 0-335.4 100.5-430.2 300.3a60.3 60.3 0 000 51.5C176.6 737.5 319.9 838 512 838c192.2 0 335.4-100.5 430.2-300.3 7.7-16.2 7.7-35 0-51.5zM508 688c-97.2 0-176-78.8-176-176s78.8-176 176-176 176 78.8 176 176-78.8 176-176 176z"}}]},name:"eye",theme:"filled"};function de(){return de=Object.assign?Object.assign.bind():function(e){for(var i=1;i<arguments.length;i++){var r=arguments[i];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},de.apply(this,arguments)}const bt=(e,i)=>j.createElement(ye,de({},e,{ref:i,icon:yt})),Dt=j.forwardRef(bt);function vt(){const[e,i]=j.useState(""),[r,a]=j.useState(7),[t,n]=j.useState(!1),[o,c]=j.useState(!1),[l,d]=j.useState(""),{isLoading:m,isError:u,data:f}=At(e,r,o),p=y=>{n(!1),c(!1),i(y.trim())},I=y=>{c(!1),a(y)},b=()=>{const y=Y(e,"YYYY-MM-DD",!0).isValid();n(y),c(y)},C=j.useMemo(()=>{if(!f||Object.keys(f).length===0)return{};if(!l)return f;const y=l;if(!Object.values(f).every(v=>v?.[y]))return f;const w={};return Object.values(f).forEach(v=>{const g=v?.[y],M=g?.number;w[M]&&console.error(`Duplicate entry for game ${y} with number ${M}`),w[M]=re(g,["number","language","text"])}),w},[f,l]);return s.jsxs("div",{children:[s.jsx(_.Title,{level:2,children:"Data Archive"}),s.jsxs(D,{align:"center",className:"mb-6",justify:"space-between",children:[s.jsxs(D,{align:"center",gap:12,children:[s.jsxs(q.Compact,{children:[s.jsx(ue,{onChange:y=>p(y.target.value),placeholder:"YYYY-MM-DD",value:e}),s.jsx(Ke,{max:100,min:1,onChange:y=>I(y??1),value:r}),s.jsx(Q,{disabled:!e||!Y(e,"YYYY-MM-DD",!0).isValid(),onClick:b,type:"primary",children:"Load"})]}),e&&s.jsxs("span",{children:[s.jsx(W,{children:e}),r>1&&s.jsxs(s.Fragment,{children:["to"," ",s.jsx(W,{children:Y(e).add(r-1,"days").format("YYYY-MM-DD")})]})]}),s.jsx("span",{children:s.jsx(W,{color:m?"blue":u?"red":t?"green":"gray",children:m?"Loading...":u?"Error":t?"Valid":"Ready"})})]}),s.jsxs(D,{align:"center",gap:12,children:[s.jsx(Ct,{}),s.jsx(ze,{allowClear:!0,onChange:y=>d(y),options:[{value:"",label:"All games"},{value:"aqui-o",label:"Aqui Ã“"},{value:"arte-ruim",label:"Arte Ruim"},{value:"artista",label:"Artista"},{value:"comunicacao-alienigena",label:"ComunicaÃ§Ã£o AlienÃ­gena"},{value:"controle-de-estoque",label:"Controle de Estoque"},{value:"filmaco",label:"FilmaÃ§o"},{value:"palavreado",label:"Palavreado"},{value:"portais-magicos",label:"Portais MÃ¡gicos"},{value:"quartetos",label:"Quartetos"},{value:"ta-na-cara",label:"TÃ¡ na Cara"},{value:"teoria-de-conjuntos",label:"Teoria de Conjuntos"}],placeholder:"Filter by game",style:{width:200}})]})]}),s.jsx(De,{collapsed:1,src:C,theme:"twilight"})]})}const At=(e,i,r)=>{const a=j.useMemo(()=>{if(!r||!Y(e,"YYYY-MM-DD",!0).isValid())return[];const l=[],d=Y(e);for(let m=0;m<i;m++){const u=d.clone().add(m,"days").format("YYYY-MM-DD");l.push({queryKey:["firebase","diario",u],queryFn:Qe("diario",u),enabled:!0})}return l},[e,i,r]),t=$e({queries:a}),n=t.some(l=>l.isLoading),o=t.some(l=>l.isError),c=j.useMemo(()=>n||o?{}:t.reduce((l,d,m)=>{if(d.data&&Object.keys(d.data).length>0){const u=Y(e).add(m,"days").format("YYYY-MM-DD");l[u]=d.data}return l},{}),[t,e,n,o]);return{isLoading:n,isError:o,data:c,results:t}};function Ct(){const e=Ae({mutationFn:async()=>{const i="2024-01-01",r="2024-04-30";try{const a=Y(i),t=Y(r);for(let n=0;n<=t.diff(a,"days");n++){const o=a.clone().add(n,"days").format("YYYY-MM-DD"),c=ne(ie,"diario",o);await Ge(c)}}catch(a){throw new Error(a)}},onError:i=>{console.error("Error deleting documents:",i)},onSuccess:()=>{console.log(" Documents deleted successfully")}});return s.jsx(Q,{danger:!0,disabled:!0,loading:e.isPending,onClick:()=>e.mutate(),children:"Delete secured documents"})}function T({children:e}){return s.jsx(q,{orientation:"vertical",style:{maxWidth:120},children:e})}function N({children:e}){return s.jsxs(W,{color:"cyan",children:["#",e]})}function A({label:e,children:i}){return s.jsxs(_.Text,{children:[s.jsxs("strong",{children:[e,":"]})," ",i]})}function O({children:e,entry:i}){return s.jsx(Ye,{content:e,title:s.jsxs(D,{justify:"space-between",children:[s.jsx(_.Text,{children:"Sneak Peek"}),s.jsx(Se,{content:JSON.stringify(i)})]}),trigger:"click",children:s.jsx(Q,{icon:s.jsx(Dt,{})})})}const Oe=[{title:"Id",dataIndex:"id",key:"id",fixed:"left",render:e=>s.jsxs(_.Text,{children:[e," ",s.jsx("br",{})," ",Y(e,"YYYY-MM-DD").format("dddd")]})},{title:"Arte Ruim",dataIndex:"arte-ruim",key:"arte-ruim",render:e=>{if(!e)return s.jsx(E,{message:"No entry",type:"error"});const{number:i,cardId:r,text:a,drawings:t}=e;return s.jsxs(T,{children:[s.jsx(N,{children:i}),s.jsx(A,{label:"CardId",children:r}),s.jsx(A,{label:"Drawings",children:t.length}),s.jsx(O,{entry:e,children:s.jsxs(D,{gap:6,vertical:!0,children:[s.jsxs("div",{children:['"',a.split("").map((n,o)=>o<2||n===" "?n:"â¹").join(""),'"']}),s.jsx(q,{wrap:!0,children:t.map(n=>s.jsx(Ve,{className:"canvas",drawing:n,height:75,width:75},n))})]})})]})}},{title:"Aqui O",dataIndex:"aqui-o",key:"aqui-o",render:e=>{if(!e)return s.jsx(E,{message:"No entry",type:"error"});const{number:i,setId:r,title:a,itemsIds:t}=e;return s.jsxs(T,{children:[s.jsx(N,{children:i}),s.jsx(A,{label:"SetId",children:r}),s.jsx(A,{label:"Title",children:a.pt}),s.jsx(A,{label:"Items",children:t.length}),s.jsx(O,{entry:e,children:s.jsx(D,{gap:6,style:{maxWidth:500},wrap:!0,children:t.map(n=>s.jsx(V,{itemId:n,width:48},n))})})]})}},{title:"AlienÃ­gena",dataIndex:"comunicacao-alienigena",key:"comunicacao-alienigena",render:e=>{if(!e)return s.jsx(E,{message:"No entry",type:"error"});const{number:i,itemsIds:r,attributes:a}=e;return s.jsxs(T,{children:[s.jsx(N,{children:i}),s.jsx(A,{label:"Items",children:r.length}),s.jsx(O,{entry:e,children:s.jsxs(D,{gap:6,style:{maxWidth:"300px"},vertical:!0,children:[s.jsx(q,{wrap:!0,children:a.map(t=>s.jsx(Ze,{signId:`sign-${t.spriteId}`,width:48},t.spriteId))}),s.jsx(q,{wrap:!0,children:r.map(t=>s.jsx(V,{itemId:t,width:48},t))})]})})]})}},{title:"Conjuntos",dataIndex:"teoria-de-conjuntos",key:"teoria-de-conjuntos",render:e=>{if(!e)return s.jsx(E,{message:"No entry",type:"error"});const{number:i,rule1:r,intersectingThing:a,rule2:t,title:n,things:o}=e;return s.jsxs(T,{children:[s.jsx(N,{children:i}),s.jsx(A,{label:"Title",children:n}),s.jsx(O,{entry:e,children:s.jsxs(D,{gap:6,vertical:!0,children:[s.jsxs(D,{gap:6,children:[s.jsx(V,{itemId:r.thing.id,width:48}),s.jsx(V,{itemId:a.id,width:48}),s.jsx(V,{itemId:t.thing.id,width:48})]}),s.jsx(D,{gap:6,children:o.map(c=>s.jsx(V,{itemId:c.id,width:35},c.id))})]})})]})}},{title:"Estoque",dataIndex:"controle-de-estoque",key:"controle-de-estoque",render:e=>{if(!e)return s.jsx(E,{message:"No entry",type:"error"});const{number:i,title:r,goods:a}=e;return s.jsxs(T,{children:[s.jsx(N,{children:i}),s.jsx(A,{label:"Title",children:r}),s.jsx(A,{label:"Goods",children:a.length}),s.jsx(O,{entry:e,children:s.jsx(D,{gap:6,style:{maxWidth:245},wrap:!0,children:a.map(t=>s.jsx(Xe,{goodId:t,width:48},t))})})]})}},{title:"Espionagem",dataIndex:"espionagem",key:"espionagem",render:e=>{if(!e)return s.jsx(E,{message:"No entry",type:"error"});const{number:i,statements:r,additionalStatements:a,suspects:t,culpritId:n}=e;return s.jsxs(T,{children:[s.jsx(N,{children:i}),s.jsx(A,{label:"Suspects",children:t.length}),s.jsx(A,{label:"Culprit",children:n}),s.jsx(A,{label:"Statements",children:r.length}),s.jsx(O,{entry:e,children:s.jsxs(D,{gap:6,vertical:!0,children:[s.jsx(q,{style:{maxHeight:200,overflowY:"auto"},wrap:!0,children:t.map(o=>s.jsx(et,{cardId:o.id,cardWidth:48},o.id))}),r.slice(0,3).map(o=>s.jsx(E,{banner:!0,message:o.text,showIcon:!0,type:"info"},o.key)),a.map(o=>s.jsx(E,{banner:!0,message:o.text,showIcon:!0,type:"warning"},o.key))]})})]})}},{title:"FilmaÃ§o",dataIndex:"filmaco",key:"filmaco",render:e=>{if(!e)return s.jsx(E,{message:"No entry",type:"error"});const{number:i,setId:r,title:a,year:t}=e;return s.jsxs(T,{children:[s.jsx(N,{children:i}),s.jsx(A,{label:"SetId",children:r}),s.jsx(O,{entry:e,children:s.jsxs(D,{gap:6,vertical:!0,children:[s.jsxs("span",{children:["Year: ",t]}),s.jsxs("span",{children:["Title:"," ",a.split("").map((n,o)=>o<1||n===" "?n:"â¹").join("")]})]})})]})}},{title:"Organiku",dataIndex:"organiku",key:"organiku",render:e=>{if(!e)return s.jsx(E,{message:"No entry",type:"error"});const{number:i,setId:r,title:a,grid:t,defaultRevealedIndexes:n}=e;return s.jsxs(T,{children:[s.jsx(N,{children:i}),s.jsx(A,{label:"SetId",children:r}),s.jsx(A,{label:"Title",children:a}),s.jsx(O,{entry:e,children:s.jsx("div",{className:"grid",style:{gridTemplateColumns:`repeat(${t?.length%5===0?5:6}, 1fr)`,gap:"8px"},children:(t??[]).map((o,c)=>s.jsx("div",{className:"grid-item",children:s.jsx(V,{className:n.includes(c)?"red-border":"",itemId:n.includes(c)&&o||"0",width:48})},`${o}-${c}`))})})]})}},{title:"Palavreado",dataIndex:"palavreado",key:"palavreado",render:e=>{if(!e)return s.jsx(E,{message:"No entry",type:"error"});const{number:i,letters:r,keyword:a,words:t}=e;return s.jsxs(T,{children:[s.jsx(N,{children:i}),s.jsx(A,{label:"Letters",children:r.length}),s.jsx(A,{label:"Keyword",children:a}),s.jsx(O,{entry:e,children:s.jsx(q,{orientation:"vertical",children:t.map((n,o)=>s.jsx("span",{children:n.split("").map((c,l)=>l===o||c===" "?c:"â¹").join("")},`${i}-${n}`))})})]})}},{title:"Portais",dataIndex:"portais-magicos",key:"portais-magicos",render:e=>{if(!e)return s.jsx(E,{message:"No entry",type:"error"});const{number:i,setId:r,corridors:a}=e;return s.jsxs(T,{children:[s.jsx(N,{children:i}),s.jsx(A,{label:"SetId",children:h.truncate(r,{length:9})}),s.jsx(O,{entry:e,children:s.jsx(D,{gap:6,vertical:!0,children:a.map(t=>s.jsxs(D,{gap:6,vertical:!0,children:[s.jsxs("span",{children:["Passcode: ",t.passcode," (",t.goal,")"]}),s.jsx(D,{children:t.imagesIds.map(n=>s.jsx(X,{cardId:n,cardWidth:48},n))})]},t.passcode))})})]})}},{title:"Quartetos",dataIndex:"quartetos",key:"quartetos",render:e=>{if(!e)return s.jsx(E,{message:"No entry",type:"error"});const{number:i,setId:r,sets:a}=e;return s.jsxs(T,{children:[s.jsx(N,{children:i}),s.jsx(A,{label:"SetId",children:h.truncate(r,{length:9})}),s.jsx(O,{entry:e,children:s.jsx(D,{gap:6,children:a.map(t=>s.jsx(D,{gap:6,vertical:!0,children:t.itemsIds.map(n=>s.jsx(V,{itemId:n,width:48},n))},t.id))})})]})}},{title:"Vitrais",dataIndex:"vitrais",key:"vitrais",render:e=>{if(!e)return s.jsx(E,{message:"No entry",type:"error"});const{number:i,title:r,pieces:a}=e;return s.jsxs(T,{children:[s.jsx(N,{children:i}),s.jsx(A,{label:"Title",children:r}),s.jsx(A,{label:"Pieces",children:a.length}),s.jsx(O,{entry:e,children:s.jsx(D,{gap:6,style:{maxWidth:"300px"},wrap:!0,children:s.jsx(X,{cardId:e.cardId,cardWidth:75})})})]})}},{title:"PicaÃ§o",dataIndex:"artista",key:"artista",render:e=>{if(!e)return s.jsx(E,{message:"No entry",type:"error"});const{number:i,cards:r}=e;return s.jsxs(T,{children:[s.jsx(N,{children:i}),s.jsx(A,{label:"Cards",children:r.length}),s.jsx(O,{entry:e,children:s.jsx(D,{gap:6,style:{maxHeight:500,overflowY:"auto"},vertical:!0,children:r.map((a,t)=>s.jsx("span",{children:a.text},`${a.id}-${t}`))})})]})}},{title:"TÃ¡ Na Cara",dataIndex:"ta-na-cara",key:"ta-na-cara",render:e=>{if(!e)return s.jsx(E,{message:"No entry",type:"error"});const{number:i,suspectsIds:r,testimonies:a}=e;return s.jsxs(T,{children:[s.jsx(N,{children:i}),s.jsx(A,{label:"Suspects",children:r?.length}),s.jsx(A,{label:"Questions",children:a.length}),s.jsx(O,{entry:e,children:s.jsxs(D,{vertical:!0,children:[s.jsx(q,{orientation:"vertical",style:{maxHeight:100,overflowY:"auto"},children:a.map(t=>s.jsxs(D,{vertical:!0,children:[s.jsxs("span",{children:[t.question," (",t.testimonyId,")"]}),s.jsx(D,{children:t.suspectsIds?.map(n=>s.jsx(X,{cardId:n,cardWidth:48},n))})]},t.testimonyId))}),s.jsx(q,{style:{maxHeight:200,maxWidth:"500px",overflowY:"auto"},wrap:!0,children:r?.map(t=>s.jsx(X,{cardId:t,cardWidth:48},t))})]})})]})}}];function St(){const[e,i]=j.useState(""),[r,a]=j.useState(!1),{isLoading:t,data:n,dataUpdatedAt:o}=Be("diario",e,{enabled:!!e&&r}),c=j.useMemo(()=>n?[re(n,["number"])]:[],[n]),l=f=>{a(!1),i(f.trim())},d=()=>{a(Y(e,"YYYY-MM-DD",!0).isValid())},m=()=>{const f=Y(e).subtract(1,"days").format("YYYY-MM-DD");i(f)},u=()=>{const f=Y(e).add(1,"days").format("YYYY-MM-DD");i(f)};return j.useEffect(()=>{!t&&n&&console.log(re(n))},[o]),s.jsxs("div",{children:[s.jsx(_.Title,{level:2,children:"Data Verification"}),s.jsx(D,{align:"center",className:"mb-6",justify:"space-between",children:s.jsxs(D,{align:"center",gap:12,children:[s.jsxs(q.Compact,{children:[s.jsx(ue,{onChange:f=>l(f.target.value),placeholder:"YYYY-MM-DD"}),s.jsx(Q,{onClick:d,type:"primary",children:"Load"})]}),e&&s.jsxs(D,{align:"center",gap:6,children:[s.jsx(Q,{icon:s.jsx(rt,{}),onClick:m}),s.jsx("span",{children:s.jsx(W,{children:e})}),s.jsx(Q,{disabled:e===it(),icon:s.jsx(at,{}),onClick:u})]}),s.jsx("span",{children:s.jsx(W,{color:t?"blue":r?"green":"red",children:t?"Loading...":r?"Valid":"Invalid"})}),s.jsx(me,{disabled:!n,path:`/diario/${e}`})]})}),s.jsx(Te,{columns:Oe,dataSource:c,loading:t,scroll:{x:"max-content"}}),s.jsx(Pe,{}),s.jsxs(D,{align:"center",className:"mb-4",justify:"space-between",wrap:!0,children:[s.jsx(Se,{className:"mb-4",content:JSON.stringify(c[0],null,2),disabled:!n,shape:"default",children:"Copy to Clipboard"}),s.jsx(Et,{data:n})]}),s.jsx(De,{src:c[0]??{},theme:"twilight"})]})}const xe=(e,i)=>{if(!e||!i||i.length<2)return[];const r=[],a=i.toLowerCase(),t=(n,o=[])=>{n&&typeof n=="object"&&Object.entries(n).forEach(([c,l])=>{c.toLowerCase().includes(a)&&r.push([...o,c].join(".")),typeof l=="string"&&l.toLowerCase().includes(a)&&r.push([...o,c].join(".")),typeof l=="object"&&l!==null&&t(l,[...o,c])})};return t(e),r};function Et({data:e}){const[i,r]=j.useState([]),a=o=>{if(n(o),o.trim().length>1){const c=xe(e??{},o.trim());r(c)}else r([])},[t,n]=j.useState("");return j.useEffect(()=>{if(e&&t.trim().length>1){const o=xe(e,t.trim());r(o)}else r([])},[e]),s.jsxs(D,{gap:8,vertical:!0,children:[s.jsx(ue.Search,{allowClear:!0,onChange:o=>a(o.target.value),onSearch:a,placeholder:"Search in data...",style:{width:250}}),i.length>0&&s.jsxs("div",{children:[s.jsxs(_.Text,{children:["Found ",i.length," matches:"]}),s.jsx("ul",{style:{maxHeight:"200px",overflow:"auto",margin:"4px 0"},children:i.map((o,c)=>s.jsx("li",{children:s.jsx(_.Text,{code:!0,copyable:!0,children:o})},c))})]})]})}const wt=(...e)=>{pe.state["aqui-o"]&&console.log(...e)},Tt=e=>{pe.state["aqui-o"]&&console.count(e)},Nt=(...e)=>{pe.state["aqui-o"]&&console.error(...e)},Ot=(e,i,r,a)=>{const[t]=P(x.AQUI_O,a),n=k("items",{enabled:e}),o=k("daily-disc-sets",{enabled:e});return{entries:j.useMemo(()=>!e||!o.isSuccess||!t||!n.isSuccess?{}:Lt(r,t,o.data,n.data),[e,o.dataUpdatedAt,n.dataUpdatedAt,t,r]),isLoading:n.isLoading||o.isLoading}},Lt=(e,i,r,a)=>{Tt("Creating Aqui Ã“...");const t=h.shuffle(Object.values(r).filter(d=>d.itemsIds.filter(Boolean).length>=20)),n=t.filter(d=>!i.used.includes(d.id));n.length<e&&(wt("ðŸ”† Not enough aqui-o sets left, shuffling..."),B("aqui-o","Not enough aqui-o sets left"),n.push(...h.shuffle(t)));const o=Object.values(a).filter(d=>d?.nsfw?!1:h.intersection(d.decks??[],["alien","dream","thing"]).length>0);let c=i.latestDate;const l={};for(let d=0;d<e;d++){let m=n[d];m||Nt("No aqui-o sets left");const u=U(c),f=H(u);c=u,u==="2026-01-01"&&(m=r.white),f?l[u]={id:u,type:"aqui-o",number:i.latestNumber+d+1,setId:"special",title:{pt:"Especial Fim de Semana",en:"Weekend Special"},itemsIds:["0",...h.sampleSize(o,35).map(p=>p.id)]}:l[u]={id:u,type:"aqui-o",number:i.latestNumber+d+1,setId:m.id,title:m.title,itemsIds:["0",...h.sampleSize(m.itemsIds,20)]}}return l},kt=(e,i,r,a)=>{const[t]=P(x.ARTE_RUIM,a),n=ve(e,i);return{entries:j.useMemo(()=>!e||n.isLoading||!t?[]:Mt(r,t,n,i),[e,n.dataUpdatedAt,i,t,r]),isLoading:n.isLoading}},Mt=(e,i,r,a)=>{console.count("Creating Arte Ruim...");const t=Object.values(r.drawings).filter(l=>!(i.used.includes(l.id)||l.drawings.length<3)).map(l=>({id:l.id,type:"arte-ruim",language:a??"pt",cardId:l.id,text:l.text,drawings:l.drawings.map(d=>d.drawing),number:0,dataIds:l.drawings.map(d=>d.id)})),n=h.sampleSize(h.shuffle(t),e);let o=i.latestDate;return n.map((l,d)=>{const m=U(o);return o=m,{...l,id:m,number:i.latestNumber+d+1}})},Rt=(e,i,r,a,t)=>{const[n]=P(x.ARTISTA,a),[o]=P(x.ARTE_RUIM,a),c=k(`arte-ruim-cards-${i}`,{enabled:e}),l=ve(e,i);return{entries:j.useMemo(()=>{if(!e||!c.isSuccess||!l.hasResponseData||!n)return{};const m=t.map(u=>u.cardId);return Gt(r,n,o,c.data,m,l.drawings)},[e,c.dataUpdatedAt,o,n,r,t,l.dataUpdatedAt,l.hasResponseData]),isLoading:c.isLoading||l.isLoading}},Gt=(e,i,r,a,t,n)=>{console.count("Creating Artista...");let o=i.latestDate;const c={};for(let l=0;l<e;l++){const d=U(o),m=Object.keys(a??{}).filter(f=>!r.used.includes(f)&&!t.includes(f)&&n?.[f]?.drawings?.length<3),u=h.sampleSize(m,20).map(f=>a[f]);o=d,c[d]={id:d,type:"artista",number:i.latestNumber+l+1,cards:u}}return c},Yt=(e,i,r,a)=>{const[t]=P(x.COMUNICACAO_ALIENIGENA,a),n=k("items",{enabled:e}),o=k("items-attributes",{enabled:e}),c=k("items-attribute-values",{enabled:e});return{entries:j.useMemo(()=>!e||!t||!o.isSuccess||!c.isSuccess||!n.isSuccess?{}:Pt(r,t,o.data,c.data,n.data),[e,r,t,t,o.dataUpdatedAt,c.dataUpdatedAt,n.dataUpdatedAt]),isLoading:n.isLoading||o.isLoading||c.isLoading}},Pt=(e,i,r,a,t)=>{console.count("Creating Comunicacao Alienigena...");let n=i.latestDate;const o=h.values(r),c=h.values(a).filter(u=>u.complete&&t?.[u.id]?.nsfw!==!0),l={};let d=0;for(;h.keys(l).length<e+5&&d<ae;){const u=Ut(o,c);if(u.valid&&!l[u.setId]&&!i.used.includes(u.setId)&&(l[u.setId]=u),h.keys(l).length>=e)break;d+=1}console.log(`ðŸ”† Generating this batch took ${d} tries`),d>=100&&B("comunicacao-alienigena","Not enough valid comunicacao alienigena games (over 100 attempts)");const m={};return Object.values(l).forEach((u,f)=>{const p=U(n);n=p;let I=h.shuffle(u.itemsIds);H(p)?I=h.shuffle([...I,...h.sampleSize(u.additionalItems,2)].filter(Boolean)):I=h.shuffle(I),m[p]={id:p,number:i.latestNumber+f+1,type:"comunicacao-alienigena",setId:u.setId,attributes:u.attributes,requests:u.requests,solution:u.solution,itemsIds:I}}),m},Ut=(e,i)=>{const r=h.shuffle(i),a=h.shuffle(We(50,0)),t=h.sampleSize(e,3).map(g=>({...g,spriteId:`${a.pop()}`})),n=[],o=[],c=[],l=[],d=[],m=[],u=[],f=[];r.forEach(g=>{const M=[$.DETERMINISTIC,$.RELATED],S=g.attributes[t[0].id]===$.DETERMINISTIC,F=M.includes(g.attributes[t[0].id]),J=g.attributes[t[0].id]===$.UNRELATED,Me=g.attributes[t[1].id]===$.DETERMINISTIC,ee=M.includes(g.attributes[t[1].id]),z=g.attributes[t[1].id]===$.UNRELATED,Re=g.attributes[t[2].id]===$.DETERMINISTIC,te=M.includes(g.attributes[t[2].id]),Z=g.attributes[t[2].id]===$.UNRELATED;if(J&&z&&Z){f.push(g.id);return}S&&z&&Z&&n.push(g.id),J&&Me&&Z&&o.push(g.id),J&&z&&Re&&c.push(g.id),F&&ee&&Z&&l.push(g.id),F&&z&&te&&d.push(g.id),J&&ee&&te&&m.push(g.id),F&&ee&&te&&u.push(g.id)});const p=t.map(g=>({id:g.id,name:g.name.pt,description:g.description.pt,spriteId:g.spriteId,itemsIds:[]}));p[0].itemsIds=h.sampleSize(n,n.length>3?3:Math.max(n.length-1,1)),p[1].itemsIds=h.sampleSize(o,o.length>3?3:Math.max(n.length-1,1)),p[2].itemsIds=h.sampleSize(c,c.length>3?3:Math.max(n.length-1,1));const I=[];p.forEach(g=>{I.push(...g.itemsIds)});const b=[];l.length>0&&b.push({spritesIds:[t[0].spriteId,t[1].spriteId],itemId:h.sample(l)??""}),d.length>0&&b.push({spritesIds:[t[0].spriteId,t[2].spriteId],itemId:h.sample(d)??""}),m.length>0&&b.push({spritesIds:[t[1].spriteId,t[2].spriteId],itemId:h.sample(m)??""}),u.length>0&&b.push({spritesIds:t.map(g=>g.spriteId),itemId:h.sample(u)??""});const C=[];n.length>0&&C.push({spritesIds:[t[0].spriteId],itemId:n.filter(g=>!I.includes(g))[0]}),o.length>0&&C.push({spritesIds:[t[1].spriteId],itemId:o.filter(g=>!I.includes(g))[0]}),c.length>0&&C.push({spritesIds:[t[2].spriteId],itemId:c.filter(g=>!I.includes(g))[0]});let y=h.sampleSize(b,4);y.length<3&&y.push(...h.sampleSize(C,4-y.length)),y.length<4&&console.log("ðŸ”† Not enough requests for an alien communication, marking it as invalid"),y=h.shuffle(y);const w=y.map(g=>g.itemId),v={setId:p.map(g=>g.id).sort().join("-"),attributes:p,requests:y,solution:w.join("-"),itemsIds:w,additionalItems:f.filter(Boolean),valid:!1};return v.valid=[v.attributes.length===3,v.requests.length===4,v.itemsIds.length===4,v.attributes.every(g=>g.itemsIds.length>0),v.requests.every(g=>g.itemId)].every(Boolean),v},qt=(e,i,r,a)=>{const[t]=P(x.CONTROLE_DE_ESTOQUE,a);return{entries:j.useMemo(()=>!e||!t?{}:_t(r,t),[e,r,t]),isLoading:!1}},_t=(e,i)=>{console.count("Creating Controle de Estoque...");let r=i.latestDate;const a={};for(let t=0;t<e;t++){const n=U(r);r=n,a[n]=Bt(n,i.latestNumber+t+1)}return a},Ft=256,$t=16,Vt=4,Qt=1,Bt=(e,i)=>{const[r,a,t]=e.split("-").map(Number),o=new Date(r,a-1,t).getDay(),c=["Domingo","Segunda-feira","TerÃ§a-feira","Quarta-feira","Quinta-feira","Sexta-feira","SÃ¡bado"][o],l={id:e,number:i,type:"controle-de-estoque",language:"pt",title:c,goods:[],orders:[]},d=h.sampleSize(Array(Ft).fill("").map((u,f)=>`good-${f+1}`),$t+Qt),m=d.pop();if(l.goods=d,l.orders=h.sampleSize(l.goods,Vt),!m)throw new Error("No out of stock good");return l.orders.push(m),l.orders=h.shuffle(l.orders),l},Wt=(e,i,r,a)=>{const[t]=P(x.FILMACO,a),n=k("daily-movie-sets",{enabled:e});return{entries:j.useMemo(()=>!e||!n.isSuccess||!t?{}:(Object.values(n.data).filter(l=>l.itemsIds.length>0&&!t.used.includes(l.id)).length<=r&&B("filmaco","Not enough unused films"),Ht(r,t,n.data)),[e,n.dataUpdatedAt,t,r]),isLoading:n.isLoading}},Ht=(e,i,r)=>{console.count("Creating FilmaÃ§o...");const a=h.shuffle(Object.values(r).filter(l=>l.itemsIds.filter(Boolean).length>0)),t=h.shuffle(a.filter(l=>!i.used.includes(l.id)));t.length<e&&t.push(...h.shuffle(a));const n=h.shuffle(Object.values(r).filter(l=>l.itemsIds.length>0&&i.used.includes(l.id)));let o=i.latestDate;const c={};for(let l=0;l<e;l++){const d=U(o),m=H(d),u=m?Kt(n):t[l];if(!u){B("filmaco","No filmaÃ§o sets left");break}o=d,c[d]={id:d,type:"filmaco",number:i.latestNumber+l+1,setId:u.id,title:u.title,itemsIds:u.itemsIds,year:u.year},m&&(c[d].isDoubleFeature=!0)}return c},Kt=e=>{let i=[];for(;i.length<2&&e.length>0;){const a=e.pop();a&&h.intersection(a.itemsIds,i?.[0]?.itemsIds||[]).length===0&&i.push(a)}return i=h.orderBy(i,a=>a.year,"asc"),{id:`df-${i.map(a=>a.id).join("-")}`,title:`${i.map(a=>a.title).join(" Ã— ")}`,itemsIds:h.shuffle(Ce(i.flatMap(a=>a.itemsIds))),year:i.map(a=>a.year).join(" Ã— ")}},Jt=(e,i,r,a)=>{const[t]=P(x.ORGANIKU,a),n=k("items-groups",{enabled:e});return{entries:j.useMemo(()=>!e||!n.isSuccess||!t?{}:zt(r,t,i,n.data),[e,i,t,r,n.dataUpdatedAt]),isLoading:n.isLoading}},zt=(e,i,r,a)=>{console.count("Creating Organiku...");const t=h.shuffle(Object.values(a).filter(c=>c.itemsIds.length>6&&i.used.includes(c.id)===!1));t.length<e&&B("organiku","Not enough organiku groups left");let n=i.latestDate;const o={};for(let c=0;c<e;c++){const l=U(n);n=l;const d=H(l);if(l==="2026-01-01"){const m=a["2a97f"],u=h.sampleSize(m.itemsIds,d?6:5),f=Ie(u),p=je(f,u,1);o[l]={id:l,number:i.latestNumber+c+1,setId:m.id,type:"organiku",title:h.capitalize(m.name[r]),grid:f,defaultRevealedIndexes:p,itemsIds:u}}else{const m=t[c],u=h.sampleSize(m.itemsIds,d?6:5),f=Ie(u),p=je(f,u,1);o[l]={id:l,number:i.latestNumber+c+1,setId:m.id,type:"organiku",title:h.capitalize(m.name[r]),grid:f,defaultRevealedIndexes:p,itemsIds:u}}}return o};function je(e,i,r){const a=new Set,t={};e.forEach((n,o)=>{t[n]||(t[n]=[]),t[n].push(o)});for(const n of i){const o=t[n]??[],l=o.length%2===0?2:1,d=h.shuffle(o);for(let m=0;m<l&&m<d.length;m++)a.add(d[m])}for(let n=0;n<r;n++){const o=i[n%i.length],c=(t[o]??[]).filter(d=>!a.has(d)),l=h.shuffle(c);for(let d=0;d<2&&d<l.length;d++)a.add(l[d])}return Array.from(a)}function Ie(e){const i=e.length,r=[];r.push(h.shuffle(e));function a(n,o){for(let c=0;c<i;c++)for(let l=0;l<o;l++)if(r[l][c]===n[c])return!1;return!0}function t(n){if(n===i)return!0;const o=Le(e);for(;o.length>0;){const c=o.splice(Math.floor(Math.random()*o.length),1)[0];if(a(c,n)){if(r.push(c),t(n+1))return!0;r.pop()}}return!1}return t(1),r.flat()}function Le(e){if(e.length<=1)return[e.slice()];const i=[];for(let r=0;r<e.length;r++){const a=[...e.slice(0,r),...e.slice(r+1)];for(const t of Le(a))i.push([e[r],...t])}return i}const Zt=(e,i,r,a)=>{const[t]=P(x.PALAVREADO,a),n=oe(4,i,e),o=oe(5,i,e);return{entries:j.useMemo(()=>!e||!n.data||!n.data.length||!o.data||!o.data.length||!t?{}:Xt(r,t,n.data,o.data),[e,n.dataUpdatedAt,o.dataUpdatedAt,t,r]),isLoading:n.isLoading||o.isLoading}},Xt=(e,i,r,a)=>{console.count("Creating Palavreado...");let t=i.latestDate;const n=[],o={};for(let c=0;c<e;c++){const l=U(t),d=H(l),m=d?5:4;t=l;let u;l==="2026-01-01"&&(u="novo"),o[l]={id:l,type:"palavreado",number:i.latestNumber+c+1,...es(d?a:r,[...Object.values(o).map(f=>f.keyword),...i.used],n,m,u)}}return o},es=(e,i,r,a=4,t)=>{let n=h.shuffle(h.difference(e,r,i));const o=t||(n.pop()??"");t&&(n=h.difference(n,[t]));const c=[];for(let l=0;l<a;l++){const d=ts(e,o,c,l);c.push(d)}return r.push(o,...c),{keyword:o,words:c,letters:ss(c,o.length)}},ts=(e,i,r,a)=>{const t=h.uniq([...h.flatMap(r.map(c=>c.split(""))),...i.split("")]),n=h.shuffle(e.filter(c=>c[a]===i[a]&&!r.includes(c)));return h.sortBy(n,c=>h.intersection(c.split(""),t).length)[0]},ss=(e,i)=>{const r=h.flatMap(e.map(o=>o.split(""))),a=i===4?[0,5,10,15]:[0,6,12,18,24],t=h.shuffle(r.filter((o,c)=>!a.includes(c))),n=[];for(let o=0;o<r.length;o++)a.includes(o)?n.push(r[o]):n.push(t.shift()??"");return n},ns=(e,i,r,a)=>{const[t]=P(x.PORTAIS_MAGICOS,a),n=k("daily-passcode-sets",{enabled:e}),o=oe(3,i,e);return{entries:j.useMemo(()=>{if(!e||!n.isSuccess||!o.isSuccess||!t)return{};const l=o.data.reduce((d,m)=>(m.split("").forEach(u=>{d[u]||(d[u]=[]),d[u].push(m)}),d),{" ":["  "],"-":[" - "]});return is(r,t,n.data,l)},[e,r,n.dataUpdatedAt,o.isSuccess,o.dataUpdatedAt,t]),isLoading:n.isLoading||o.isLoading}},is=(e,i,r,a)=>{console.count("Creating Portais MÃ¡gicos...");let t=i.latestDate;const n=i.used,o={};let c=h.shuffle(Object.values(r).filter(d=>d.imageCardsIds.length>0));const l={};for(let d=0;d<e;d++){const m=U(t),u=[];let f=[...c];const p=[];for(;p.length<3;){const I=f.pop();if(!I){B("portais-magicos",`Not enough passcode sets to build Portais MÃ¡gicos for ${m}`),console.error("Not enough sets available to build more corridors");break}const b=h.sample(I.passcode.filter(v=>v.length<=12&&!n.includes(v)))||"";if(!b)continue;const C=p.length+1;u.push(I.id),o[I.id]=!0;const y=b.split("").map(v=>h.sample(a[v])||` ${v} `),w=h.sampleSize(I.imageCardsIds,C);p.push({passcode:b,imagesIds:w,words:y,goal:rs(b,y)}),f=f.filter(v=>!o[v.id]&&v.imageCardsIds.length>C)}t=m,l[m]={id:m,type:"portais-magicos",setId:u.join(he),number:i.latestNumber+d+1,corridors:p.reverse(),goal:p.reduce((I,b)=>I+b.goal,0)},c=c.filter(I=>!o[I.id])}return l};function rs(e,i){if(e.length!==i.length)throw new Error("Secret word length must match the number of 3-letter words");let r=0;for(let a=0;a<e.length;a++){const t=e[a].toUpperCase(),n=i[a].toUpperCase();let o=-1;for(let l=0;l<3;l++)if(n[l]===t){o=l;break}if(o===-1)throw new Error(`Target letter '${t}' not found in word '${n}' at position ${a}`);let c=0;o===0?c=2:o===1?c=0:o===2&&(c=1),r+=c}return r}const as=(e,i,r,a)=>{const[t]=P(x.TA_NA_CARA,a),n=k("suspects",{enabled:e}),o=k(`testimony-questions-${i}`,{enabled:e}),c=k("testimony-answers",{select:tt,enabled:e});return{entries:j.useMemo(()=>{if(!e||!n.isSuccess||!o.isSuccess||!t||!c.isSuccess)return{};const d=ms(o.data,c.data,n.data),m=n.data??{},u=Object.keys(n.data).map(f=>Ee(f,"gb"));return ls(r,t,u,o.data,d,m)},[e,n.dataUpdatedAt,o.dataUpdatedAt,c.dataUpdatedAt,t,r]),isLoading:n.isLoading||o.isLoading}},os=15,ke=7,ls=(e,i,r,a,t,n)=>{console.count("Creating TÃ¡ Na Cara...");let o=0,c=i.latestDate;const l={};for(let d=0;d<e;d++){const m=U(c);c=m;const u={},f=[];for(let b=0;b<os;b++){o>=t.length&&(o=0);const C=t[o];f.push(cs(C,a[C.testimonyId])),o+=1}const p=He(f.flatMap(b=>b.suspectsIds||[]),!0);Object.keys(p).forEach(b=>{u[b]=n[K(b)].name.pt});const I=[];for(const b of h.shuffle(r)){if(I.length>=ke)break;if(p[b])continue;let C=!1;for(const y of f){const w=y.testimonyId,v=K(b),g=t.find(M=>M.testimonyId===w);if(g){const M=g.counts,S=["5+","32+"];for(const F of S)if(M[F]?.includes(v)){C=!0;break}}if(C)break}C||(I.push(b),u[b]=n[K(b)].name.pt)}l[m]={id:m,type:"ta-na-cara",number:i.latestNumber+d+1,suspectsIds:I,testimonies:f,names:u}}return l},cs=(e,i)=>{const r=[...h.shuffle(e.counts[0]),...h.shuffle([...e.counts[3],...e.counts[2]]),...h.shuffle([...e.counts[1],...e.counts[4]]),...e.counts[5],...e.counts["5+"]].filter(Boolean).slice(0,ke).map(a=>Ee(a,"gb"));return{testimonyId:i.id,question:i.question,nsfw:!!i.nsfw,suspectsIds:r}},ds=e=>e.reduce((i,r)=>{const a=r.split(he),t=a[0],n=Number(a[1]);if(t.startsWith("us")){const o=K(t);return o.includes("undefined")||(i[o]=n||0),i}return i[t]=n||0,i},{}),us=(e,i)=>{const r=ds(e);return i.forEach(a=>{a.testimonies.forEach(t=>{r[t.testimonyId]===void 0&&(r[t.testimonyId]=0),r[t.testimonyId]+=1}),a.suspectsIds?.forEach(t=>{const n=K(t);r[n]===void 0&&(r[n]=0),r[n]+=1})}),Object.entries(r).map(([a,t])=>`${a}${he}${t}`)},ms=(e,i,r)=>{const a={};Object.keys(e).forEach(n=>{a[n]===void 0&&(a[n]={0:[],1:[],2:[],3:[],4:[],5:[],"5+":[],"32+":[]});const o=i[n]||{};Object.keys(r).forEach(c=>{const l=o[c]||[],d=st(l);if(d>=32)a[n]["32+"].push(c);else if(d>5&&d<32)a[n]["5+"].push(c);else try{a[n][d].push(c)}catch(m){console.error("Error updating globalCounts:",m)}})});const t=h.orderBy(Object.keys(a).map(n=>({testimonyId:n,counts:a[n]})),[n=>n.counts[0].length,n=>n.counts[1].length,n=>n.counts[2].length,n=>n.counts[3].length,n=>n.counts[4].length],["desc"]);for(let n=0;n<t.length;n+=13){const o=t.slice(n,n+13),c=h.shuffle(o);t.splice(n,13,...c)}return t},K=e=>{const i=e.split("-");return i.length<3?e:`${i[0]}-${i[2]}`},hs=(e,i,r)=>{const[a]=P(x.VITRAIS,r),t=k("daily-puzzle-set",{enabled:e});return{entries:j.useMemo(()=>!e||t.isLoading||!a?{}:ps(i,a,t.data),[e,a,i,t.dataUpdatedAt]),isLoading:t.isLoading}},ps=(e,i,r)=>{console.count("Creating Vitrais...");const a=h.shuffle(Object.values(r).filter(o=>!i.used.includes(o.id)));let t=i.latestDate;const n={};return Array.from({length:e}).forEach((o,c)=>{const l=U(t),d=H(l);t=l;const m=a[c];if(!m){B("vitrais",`Not enough eligible Daily Vitrais sets to create a new puzzle for date ${l}. Please add more sets or clear used history.`);return}let u;try{u=fs(d)}catch(f){B("vitrais",`Error generating Daily Vitrais puzzle for date ${l} with set ${m.title}: ${f}`);return}n[l]={id:l,number:i.latestNumber+c+1,type:"vitrais",title:m.title,cardId:m.id,pieces:u}}),n};function fs(e){const i=e?h.sample([18,21,24]):h.sample([12,15]),r=Array.from({length:i},(o,c)=>c);let a=0,t=!1,n=[...r];for(;a<ae&&!t;){n=h.shuffle([...r]);for(let o=0;o<n.length;o++)if(n[o]===o){const c=(o+1)%n.length;[n[o],n[c]]=[n[c],n[o]]}t=n.every((o,c)=>o!==c),a++}if(!t)throw new Error(`Failed to generate valid derangement for ${i} pieces after ${ae} attempts`);if(r.length!==i)throw new Error(`Generated pieces count mismatch: expected ${i}, got ${r.length}`);return n}function gs(e,i,r){const a=we.DAILY[i??"pt"],t=Ne(a,{enabled:e});j.useEffect(()=>{},[r]);const n=e&&t.isSuccess,o=k("items",{enabled:n}),c=Ot(n,i,r,t.data??{}),l=kt(n,i,r,t.data??{}),d=Yt(n,i,r,t.data??{}),m=qt(n,i,r,t.data??{}),u=Wt(n,i,r,t.data??{}),f=Zt(n,i,r,t.data??{}),p=mt(n,i,r,t.data??{}),I=ht(n,i,r,t.data??{}),b=ns(n,i,r,t.data??{}),C=Jt(n,i,r,t.data??{}),y=dt(n,i,r,t.data??{}),w=hs(n,r,t.data??{}),v=Rt(n,i,r,t.data??{},l.entries),g=as(n,i,r,t.data??{}),M=j.useMemo(()=>l.entries.length===0?[]:(console.count("Bundling entries..."),l.entries.map(S=>{const F={id:S.id,"arte-ruim":S,"aqui-o":c.entries[S.id],"comunicacao-alienigena":d.entries[S.id],"controle-de-estoque":m.entries[S.id],espionagem:y.entries[S.id],filmaco:u.entries[S.id],organiku:C.entries[S.id],palavreado:f.entries[S.id],"portais-magicos":b.entries[S.id],quartetos:p.entries[S.id],"teoria-de-conjuntos":I.entries[S.id],vitrais:w.entries[S.id],artista:v.entries[S.id],"ta-na-cara":g.entries[S.id],dictionary:{}};return F.dictionary=xs(F,o.data),F})),[l.entries,c.entries,d.entries,m.entries,u.entries,C.entries,f.entries,b.entries,p.entries,I.entries,v.entries,g.entries,y.entries,w.entries,o.data]);return{isLoading:t.isLoading||c.isLoading||l.isLoading||d.isLoading||m.isLoading||u.isLoading||f.isLoading||b.isLoading||p.isLoading||I.isLoading||v.isLoading||g.isLoading||y.isLoading||C.isLoading||w.isLoading||o.isLoading,entries:M}}const xs=(e,i)=>{const r={};return e["aqui-o"].itemsIds.forEach(a=>{const t=i[a];t&&(r[a]=t.name.pt)}),e["comunicacao-alienigena"].itemsIds.forEach(a=>{const t=i[a];t&&(r[a]=t.name.pt)}),e["comunicacao-alienigena"].attributes.forEach(a=>{a.itemsIds.forEach(t=>{const n=i[t];n&&(r[t]=n.name.pt)})}),e.filmaco.itemsIds.forEach(a=>{const t=i[a];t&&(r[a]=t.name.pt)}),e.quartetos.grid.forEach(a=>{const t=i[a];t&&(r[a]=t.name.pt)}),e.organiku.itemsIds.forEach(a=>{const t=i[a];t&&(r[a]=t.name.pt)}),r};function js(e){const{notification:i}=Ue.useApp(),r=qe(),a=we.DAILY[e??"pt"],[t,n]=j.useState(!1),o=Ne(a,{enabled:!!a}),c=Ae({mutationFn:async l=>{const d=l.map(p=>{const I=ne(ie,`${a}/${p.id}`);return fe(I,p)}),m=ne(ie,`${a}/history`),u=o.data;if(!u)throw new Error("No previous history");const f={...u,[x.AQUI_O]:L(x.AQUI_O,u,l,p=>p.setId),[x.ARTE_RUIM]:L(x.ARTE_RUIM,u,l,p=>p.cardId),[x.ARTISTA]:L(x.ARTISTA,u,l,null),[x.COMUNICACAO_ALIENIGENA]:L(x.COMUNICACAO_ALIENIGENA,u,l,p=>p.setId),[x.CONTROLE_DE_ESTOQUE]:L(x.CONTROLE_DE_ESTOQUE,u,l,null),[x.FILMACO]:L(x.FILMACO,u,l,p=>p.setId),[x.PALAVREADO]:L(x.PALAVREADO,u,l,p=>p.keyword),[x.PORTAIS_MAGICOS]:L(x.PORTAIS_MAGICOS,u,l,p=>p.corridors.map(I=>I.passcode)),[x.TA_NA_CARA]:L(x.TA_NA_CARA,u,l,null,us),[x.QUARTETOS]:L(x.QUARTETOS,u,l,p=>p.sets.map(I=>I.id)),[x.TEORIA_DE_CONJUNTOS]:L(x.TEORIA_DE_CONJUNTOS,u,l,p=>[p.intersectingThing.id,p.setId]),[x.ORGANIKU]:L(x.ORGANIKU,u,l,p=>p.setId),[x.ESPIONAGEM]:L(x.ESPIONAGEM,u,l,p=>p.culpritId),[x.VITRAIS]:L(x.VITRAIS,u,l,p=>p.cardId)};return fe(m,f),Promise.all(d)},onSuccess:()=>{i.info({title:"Data saved",placement:"bottomLeft"}),r.invalidateQueries({queryKey:[a,"history"]}),n(!1)},onError:()=>{i.error({title:"Error saving data",placement:"bottomLeft"})}});return{isDirty:t,setIsDirty:n,save:c.mutateAsync,isPending:c.isPending}}const L=(e,i,r,a,t)=>{const n=JSON.parse(i[e]?.used??"[]");return t?{latestDate:r[r.length-1].id,latestNumber:r[r.length-1][e].number,used:JSON.stringify(t(n,r.map(o=>o[e])))}:a===null?{latestDate:r[r.length-1].id,latestNumber:r[r.length-1][e].number,used:"[]"}:{latestDate:r[r.length-1].id,latestNumber:r[r.length-1][e].number,used:JSON.stringify(Ce([...n,...r.map(o=>o[e]).map(a)]).flat())}},Is="pt";function ys(){const[e,i]=j.useState(""),[r,a]=j.useState(3),[t,n]=j.useState(7),[o,c]=j.useState(Date.now());return s.jsxs("div",{children:[s.jsx(_.Title,{level:2,children:"Data Population"}),s.jsxs(D,{gap:12,children:[s.jsx(se,{label:"Language",onChange:i,options:[Is],placeholder:"Select a language",value:e}),s.jsx(se,{label:"Minimum Drawings",onChange:a,options:[2,3,4],placeholder:"Select a number",value:r}),s.jsx(se,{label:"Batch Size",onChange:n,options:[1,3,7,14,21,28],placeholder:"Select a number",value:t}),s.jsx(Q,{icon:s.jsx(pt,{}),onClick:()=>{lt(),c(Date.now())}}),s.jsx(me,{className:"ml-2",path:"diario/history"})]}),s.jsx(bs,{batchSize:t,language:e},o)]})}function bs({language:e,batchSize:i}){const r=e,a=gs(!!r,r,i),t=ct(),n=j.useMemo(()=>Object.values(t),[t]);j.useEffect(()=>{h.isEmpty(t)||console.log(t)},[t]);const{save:o,isPending:c}=js(r??"pt");return s.jsxs(ot,{error:null,hasResponseData:!a.isLoading,isLoading:a.isLoading,children:[s.jsxs(D,{align:"center",justify:"space-between",children:[s.jsxs(_.Title,{level:4,children:["Total: ",a.entries.length]}),s.jsx(Q,{disabled:(a.entries??[]).length===0||n.length>0,icon:s.jsx(ft,{}),loading:c,onClick:()=>o(a.entries),size:"large",type:"primary",children:"Save"})]}),n.map(l=>s.jsx(E,{banner:!0,message:l,showIcon:!0,type:"warning"},l)),s.jsx(Te,{columns:Oe,dataSource:a.entries??[],scroll:{x:"max-content"}})]})}function Ds(){const{queryParams:e}=be();return e.get("display")==="archive"?s.jsx(vt,{}):e.get("display")==="check"?s.jsx(St,{}):s.jsx(ys,{})}function vs(){const{queryParams:e,addParams:i}=be();return s.jsxs(s.Fragment,{children:[s.jsx(le,{children:s.jsx(Je,{label:"Display",onChange:r=>i({display:r}),options:[{title:"Population",icon:s.jsx(It,{}),value:"population"},{title:"Check",icon:s.jsx(_e,{}),value:"check"},{title:"Archive",icon:s.jsx(gt,{}),value:"archive"}],value:e.get("display")??"population"})}),s.jsx(le,{children:s.jsx(me,{label:"History",path:"/diario/history"})}),s.jsx(As,{})]})}function As(){const e=ut();return s.jsxs(le,{children:[s.jsx(_.Title,{level:5,children:"Debuggers"}),s.jsx("div",{children:s.jsx(G,{checked:e["aqui-o"],disabled:!0,onChange:()=>R("aqui-o"),children:"Aqui o"})}),s.jsx("div",{children:s.jsx(G,{checked:e["arte-ruim"],disabled:!0,onChange:()=>R("arte-ruim"),children:"Arte Ruim"})}),s.jsx("div",{children:s.jsx(G,{checked:e.artista,disabled:!0,onChange:()=>R("artista"),children:"Artista"})}),s.jsx("div",{children:s.jsx(G,{checked:e["comunicacao-alienigena"],disabled:!0,onChange:()=>R("comunicacao-alienigena"),children:"Com. AlienÃ­gena"})}),s.jsx("div",{children:s.jsx(G,{checked:e["controle-de-estoque"],disabled:!0,onChange:()=>R("controle-de-estoque"),children:"Controle de Estoque"})}),s.jsx("div",{children:s.jsx(G,{checked:e.espionagem,disabled:!0,onChange:()=>R("espionagem"),children:"Espionagem"})}),s.jsx("div",{children:s.jsx(G,{checked:e.filmaco,disabled:!0,onChange:()=>R("filmaco"),children:"Filmaco"})}),s.jsx("div",{children:s.jsx(G,{checked:e.organiku,disabled:!0,onChange:()=>R("organiku"),children:"Organiku"})}),s.jsx("div",{children:s.jsx(G,{checked:e.palavreado,disabled:!0,onChange:()=>R("palavreado"),children:"Palavreado"})}),s.jsx("div",{children:s.jsx(G,{checked:e["portais-magicos"],disabled:!0,onChange:()=>R("portais-magicos"),children:"Portais MÃ¡gicos"})}),s.jsx("div",{children:s.jsx(G,{checked:e.quartetos,disabled:!0,onChange:()=>R("quartetos"),children:"Quartetos"})}),s.jsx("div",{children:s.jsx(G,{checked:e["ta-na-cara"],disabled:!0,onChange:()=>R("ta-na-cara"),children:"TÃ¡ na Cara"})}),s.jsx("div",{children:s.jsx(G,{checked:e["teoria-de-conjuntos"],disabled:!0,onChange:()=>R("teoria-de-conjuntos"),children:"Teoria de Conjuntos"})})]})}function In(){return s.jsx(Fe,{title:"Daily Setup",children:s.jsxs(ge,{hasSider:!0,children:[s.jsx(nt,{children:s.jsx(vs,{})}),s.jsx(ge.Content,{className:"content",children:s.jsx(Ds,{})})]})})}export{In as default};
