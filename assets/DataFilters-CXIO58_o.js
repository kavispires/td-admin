import{r as m,j as c,c as v}from"./index-BaGtrpxe.js";import{u as f}from"./useQueryParams-oAS7WoYB.js";import{l as p}from"./useBaseUrl-DZ0WramL.js";import{a as b}from"./FilterEntries-DSTJ81PW.js";function d(t,a=[]){const l=Object.keys(Object.values(t).reduce((e,r)=>(Object.keys(r).forEach(s=>{!e[s]&&!a.includes(s)&&(e[s]=!0)}),e),{})),o=[],n=[];return l.forEach(e=>{const r=Object.values(t).map(i=>i[e]),s=Array.from(new Set(r)),u=s.length/r.length;u>=.05&&o.push(e),u<=.9&&n.push({label:e,options:[{label:"All",value:""},...s.sort().map(i=>({label:String(i),value:i}))]})}),{filters:n,sortableKeys:o}}function D({data:t,ignoreKeys:a=[]}){const{queryParams:l,addParam:o}=f(),n=m.useMemo(()=>d(t,a),[t,a]);return c.jsxs(v,{layout:"vertical",children:[n.filters.map(e=>c.jsx(b,{label:p.capitalize(e.label),onChange:r=>o(e.label.toLowerCase(),r),options:e.options,value:l.get(e.label.toLowerCase())??""},e.label)),c.jsx(b,{label:"Sort by",onChange:e=>o("sort",e),options:n.sortableKeys.map(e=>({label:p.capitalize(e),value:e})),value:l.get("sort")??""}),c.jsx(b,{label:"Order",onChange:e=>o("order",e),options:[{label:"Ascending",value:"asc"},{label:"Descending",value:"desc"}],value:l.get("order")??"asc"})]})}function O(t){const{queryParams:a}=f(),l=m.useMemo(()=>d(t),[t]),o=m.useMemo(()=>Array.from(a.entries()).filter(([r])=>l.filters.some(s=>s.label.toLowerCase()===r)).reduce((r,[s,u])=>(r[s]=u,r),{}),[a,l]),n=a.get("sort")??"id",e=a.get("order")==="desc"?"desc":"asc";return m.useMemo(()=>{const s=Object.values(t).filter(u=>Object.entries(o).every(([i,g])=>String(u[i])===g));return p.orderBy(s,n,e)},[t,o,n,e])}export{D,O as u};
