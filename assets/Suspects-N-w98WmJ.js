import{r as f,a as F,_ as G,j as e,T as p,I as O,B as k,D as T,P as E,L as w}from"./index-BmKmifuD.js";import{D as L}from"./DataLoadingWrapper-DfqjV0Gf.js";import{l as v,P as M}from"./useBaseUrl-CV65xL7T.js";import{I as B}from"./ImageCard-C8XC0jEm.js";import{u as z}from"./useCardWidth-CZsLuRob.js";import{u as H}from"./useQueryParams-Xp2SkAjz.js";import{D as C}from"./EditableFields-9QkOV5W4.js";import{g as R}from"./utils-Bq5u3CDr.js";import{D as P}from"./index-D4kLRM1_.js";import{F as S}from"./index-DZkJ9OT8.js";import{S as N}from"./index-C93JcBPZ.js";import{R as I}from"./index-B3nqieae.js";import{S as A}from"./index-DmgRV1Ct.js";import{S as y}from"./index-CXjb0pZw.js";import{T as $}from"./index-3FN9VFKp.js";import{R as W,a as q}from"./WomanOutlined-BzekyAK6.js";import{R as Y,a as J}from"./ColumnWidthOutlined-7-XHpCa2.js";import{a as _,b as Q}from"./FilterEntries-CRanhvKv.js";import{S as V}from"./SiderContent-CQJYQry7.js";import{D as K}from"./DownloadButton-tz6fwmNw.js";import{S as X}from"./SaveButton-E-BI8ZxD.js";import{a as Z}from"./index-DmSVtCoz.js";import{u as U}from"./useResourceFirestoreData-IMf-Ll2Z.js";import"./useCopyToClipboardFunction-v2jZg77r.js";import"./LanguageFlag-2FhCtA3U.js";import"./index-dopZDYz9.js";import"./Input-CEcyoz_o.js";import"./FireFilled-17_jJgK3.js";import"./IdcardOutlined-CyQOn2HX.js";import"./gapSize-U1swVQyS.js";import"./index-Dl0nHeYG.js";import"./index-CsRa4iyH.js";import"./moment-C5S46NFB.js";import"./SaveOutlined-Gppapl37.js";import"./constants-B4YYuuBb.js";import"./Item-BDgAGbk3.js";import"./useGetFirestoreDoc--hH88T1t.js";import"./useTDResource-C3kg2Dqy.js";import"./useUpdateFirestoreDoc-C2ni2j9Y.js";import"./useMutation-Dczd92Es.js";var ee={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M880 836H144c-17.7 0-32 14.3-32 32v36c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-36c0-17.7-14.3-32-32-32zm-622.3-84c2 0 4-.2 6-.5L431.9 722c2-.4 3.9-1.3 5.3-2.8l423.9-423.9a9.96 9.96 0 000-14.1L694.9 114.9c-1.9-1.9-4.4-2.9-7.1-2.9s-5.2 1-7.1 2.9L256.8 538.8c-1.5 1.5-2.4 3.3-2.8 5.3l-29.5 168.2a33.5 33.5 0 009.4 29.8c6.6 6.4 14.9 9.9 23.8 9.9z"}}]},name:"edit",theme:"filled"},se=function(r,n){return f.createElement(F,G({},r,{ref:n,icon:ee}))},ie=f.forwardRef(se);const ae=["18-21","21-30","30-40","40-50","50-60","50-70"].map(s=>({label:s,value:s})),le=[{label:"Male",value:"male"},{label:"Female",value:"female"},{label:"Non-binary",value:"non-binary"},{label:"Other",value:"other"}],te=[{label:"Caucasian",value:"caucasian"},{label:"Black",value:"black"},{label:"Asian",value:"asian"},{label:"Latino",value:"latino"},{label:"Indigenous",value:"indigenous"},{label:"Indian",value:"indian"},{label:"Middle Eastern",value:"middle-eastern"},{label:"Mixed",value:"mixed"},{label:"Other",value:"other"}];function re({data:s,addEntryToUpdate:r}){const{removeParam:n,queryParams:l}=H(),c=l.get("suspectId"),d=l.get("version")??"gb",i=s[c??""];return i?e.jsx(P,{title:i.name.pt,placement:"right",onClose:()=>n("suspectId"),open:!!i,width:400,children:e.jsxs("div",{className:"suspect__drawer",children:[e.jsxs("div",{className:"grid grid-2",children:[e.jsx(B,{id:R(i.id,d),width:100}),e.jsxs(S,{vertical:!0,gap:4,children:[e.jsx(C,{value:i.name,language:"pt",onChange:o=>{r(i.id,{...i,name:{...i.name,pt:o.target.value}})}}),e.jsx(C,{value:i.name,language:"en",onChange:o=>{r(i.id,{...i,name:{...i.name,en:o.target.value}})}}),e.jsx("div",{children:e.jsx(N,{value:i.age,size:"small",onChange:o=>{r(i.id,{...i,age:o})},options:ae,style:{width:80}})}),e.jsx("div",{children:e.jsx(N,{value:i.gender,size:"small",onChange:o=>{r(i.id,{...i,gender:o})},options:le,style:{width:120}})}),e.jsx("div",{children:e.jsx(N,{value:i.ethnicity,size:"small",onChange:o=>{r(i.id,{...i,ethnicity:o})},options:te,style:{width:150}})})]})]}),e.jsxs("div",{className:"grid grid-2",children:[e.jsxs(S,{vertical:!0,children:[e.jsx(p.Text,{strong:!0,children:"Build"}),e.jsx(I.Group,{size:"small",value:i.build,onChange:o=>{r(i.id,{...i,build:o.target.value})},options:oe,style:{display:"flex",flexDirection:"column",gap:3}})]}),e.jsxs(S,{vertical:!0,children:[e.jsx(p.Text,{strong:!0,children:"Height"}),e.jsx(I.Group,{size:"small",value:i.height,onChange:o=>{r(i.id,{...i,height:o.target.value})},options:ce,style:{display:"flex",flexDirection:"column",gap:3}})]})]}),e.jsx(ne,{suspect:i,addEntryToUpdate:r})]})}):null}function ne({suspect:s,addEntryToUpdate:r}){const n=s.features??[],l=c=>{const d=n.includes(c)?n.filter(i=>i!==c):[...n,c];r(s.id,{...s,features:d})};return e.jsx("div",{className:"grid grid-2",children:D.map(c=>e.jsxs("div",{className:"my-4",children:[e.jsx(p.Text,{strong:!0,children:c.title}),c.features.map(d=>e.jsxs(S,{className:"my-2",gap:4,children:[e.jsx(A,{size:"small",checked:n.includes(d.id),onChange:()=>l(d.id)})," ",d.label]},d.id))]},c.title))})}const oe=["thin","average","muscular","large"],ce=["short","medium","tall"],D=[{title:"Hair Length",features:[{id:"shortHair",label:"Short Hair"},{id:"longHair",label:"Long Hair"},{id:"mediumHair",label:"Medium Hair"},{id:"bald",label:"Bald"}]},{title:"Hair Color",features:[{id:"blackHair",label:"Black Hair"},{id:"brownHair",label:"Brown Hair"},{id:"blondeHair",label:"Blonde Hair"},{id:"redHair",label:"Red Hair"},{id:"greyHair",label:"Grey Hair"},{id:"coloredHair",label:"Colored Hair"}]},{title:"Face",features:[{id:"beard",label:"Beard"},{id:"mustache",label:"Mustache"},{id:"goatee",label:"Goatee"},{id:"lipstick",label:"Lipstick"}]},{title:"Accessories",features:[{id:"glasses",label:"Glasses"},{id:"piercings",label:"Piercings"},{id:"earrings",label:"Earrings"},{id:"necklace",label:"Necklace"},{id:"hat",label:"Hat"},{id:"scarf",label:"Scarf"},{id:"hoodie",label:"Hoodie"},{id:"tie",label:"Tie"},{id:"headscarf",label:"Headscarf/Bandana"}]}];function de({data:s,addEntryToUpdate:r}){const{addParam:n,queryParams:l}=H(),c=l.get("version")??"gb",d=l.get("sortBy")??"id",i=Number(l.get("cardsPerRow"))||8,[o,x]=z(i),a=f.useMemo(()=>v.orderBy(Object.values(s),t=>d==="id"?Number(t.id.split("-").at(-1)):t[d]??t.id,["asc"]),[s,d]);return e.jsxs(e.Fragment,{children:[e.jsxs(p.Title,{level:2,children:["Deck ",c," (",a.length,")"]}),e.jsx(O.PreviewGroup,{children:e.jsx(y,{ref:x,wrap:!0,className:"my-2",children:a.map(t=>{var b,u;return e.jsxs("div",{className:"suspect",style:{width:`${o}px`},children:[e.jsx(B,{id:R(t.id,c),width:o,className:"suspect__image"}),e.jsxs("div",{className:"suspect__name",children:[e.jsx("div",{children:e.jsx($,{children:t.id})}),e.jsxs("div",{children:["ðŸ‡§ðŸ‡· ",t.name.pt]}),e.jsxs("div",{children:["ðŸ‡ºðŸ‡¸ ",t.name.en]}),e.jsxs("div",{className:"suspect__info",style:ue(t),children:[e.jsxs("div",{children:[e.jsxs("div",{children:[t.gender==="male"?e.jsx(W,{}):e.jsx(q,{})," ",t.age]}),e.jsx("div",{children:e.jsx("em",{children:t.ethnicity})})]}),e.jsxs("div",{className:"uppercase",children:[e.jsx(Y,{}),e.jsx("br",{}),t.build.charAt(0)]}),e.jsxs("div",{className:"uppercase",children:[e.jsx(J,{}),e.jsx("br",{}),t.height.charAt(0)]}),e.jsxs("div",{children:[((b=t==null?void 0:t.features)==null?void 0:b.length)??0," features"]})]}),e.jsx(k,{size:"small",block:!0,onClick:()=>n("suspectId",t.id),danger:!(t!=null&&t.features)||((u=t==null?void 0:t.features)==null?void 0:u.length)<2,children:e.jsx(ie,{})})]})]},t.id)})},c)}),e.jsx(re,{data:s,addEntryToUpdate:r})]})}const ue=s=>!s.build||!s.height||s.build.length===1||s.height.length===1?{borderColor:"red"}:{};function j(s,r){return v.orderBy(Object.entries(s).map(([n,l])=>({key:n,label:v.capitalize(n),value:l,percentage:Math.round(l/r*100)})),["percentage"],["desc"])}function he({data:s}){const[r,n]=f.useState(!1);return e.jsxs(e.Fragment,{children:[e.jsx(k,{onClick:()=>n(!0),block:!0,children:"See Stats"}),r&&e.jsx(me,{data:s,open:r,onClose:()=>n(!1)})]})}function me({data:s,open:r,onClose:n}){const{ages:l,ethnicities:c,genders:d,builds:i,heights:o}=f.useMemo(()=>{const a={},t={},b={},u={},m={};Object.values(s).forEach(h=>{a[h.age]=(a[h.age]??0)+1,t[h.ethnicity]=(t[h.ethnicity]??0)+1,b[h.gender]=(b[h.gender]??0)+1,u[h.build||"?"]=(u[h.build||"?"]??0)+1,m[h.height||"?"]=(m[h.height||"?"]??0)+1});const g=Object.keys(s).length;return{ages:j(a,g),ethnicities:j(t,g),genders:j(b,g),builds:j(u,g),heights:j(m,g)}},[s]),x=f.useMemo(()=>{const a={};Object.values(s).forEach(u=>{var m;(m=u.features)==null||m.forEach(g=>{a[g]=(a[g]??0)+1})});const t=Object.keys(s).length,b=D.reduce((u,m)=>{const g=m.features.map(h=>h.id);return u.push(...g),u},[]);return v.orderBy(j(a,t),u=>b.findIndex(m=>m===u.key),["asc"])},[s]);return e.jsxs(P,{title:"Suspects Statistics",placement:"right",onClose:n,open:r,width:400,children:[e.jsx(p.Text,{strong:!0,children:"Ethnicity"}),e.jsx("ul",{className:"statistic__list",children:c.map(a=>e.jsxs("li",{children:[e.jsx("strong",{children:a.label})," - ",a.percentage,"%"]},a.key))}),e.jsx(p.Text,{strong:!0,children:"Gender"}),e.jsx("ul",{className:"statistic__list",children:d.map(a=>e.jsxs("li",{children:[e.jsx("strong",{children:a.label})," - ",a.percentage,"%"]},a.key))}),e.jsx(p.Text,{strong:!0,children:"Age"}),e.jsx("ul",{className:"statistic__list",children:l.map(a=>e.jsxs("li",{children:[e.jsx("strong",{children:a.label})," - ",a.percentage,"%"]},a.key))}),e.jsx(p.Text,{strong:!0,children:"Build"}),e.jsx("ul",{className:"statistic__list",children:i.map(a=>e.jsxs("li",{children:[e.jsx("strong",{children:a.label})," - ",a.percentage,"%"]},a.key))}),e.jsx(p.Text,{strong:!0,children:"Height"}),e.jsx("ul",{className:"statistic__list",children:o.map(a=>e.jsxs("li",{children:[e.jsx("strong",{children:a.label})," - ",a.percentage,"%"]},a.key))}),e.jsx(p.Text,{strong:!0,children:"Features"}),e.jsx("ul",{className:"statistic__list",children:x.map(a=>e.jsxs("li",{children:[e.jsx("strong",{children:a.label})," - ",a.percentage,"% (",a.value,")"]},a.key))})]})}const ge=[{value:"ct",label:"Cartoon"},{value:"gb",label:"Ghibli"},{value:"ai",label:"AI"},{value:"md",label:"Models"},{value:"wc",label:"Wacky"}],pe=[{value:"id",label:"Id"},{value:"name.pt",label:"Name (PT)"},{value:"name.en",label:"Name (EN)"},{value:"ethnicity",label:"Ethnicity"},{value:"gender",label:"Gender"},{value:"age",label:"Age"},{value:"height",label:"Height"},{value:"build",label:"Build"}];function xe({data:s,save:r,isDirty:n,isSaving:l,entriesToUpdate:c,hasFirestoreData:d}){const{addParam:i,queryParams:o}=H();return e.jsxs(V,{children:[e.jsxs(S,{vertical:!0,gap:12,children:[e.jsx(X,{isDirty:n,onSave:r,isSaving:l,dirt:JSON.stringify(c)}),e.jsx(K,{data:()=>be(s),fileName:"suspects.json",disabled:n,hasNewData:d,block:!0})]}),e.jsx(T,{}),e.jsx(_,{label:"Version",value:o.get("version")??"gb",onChange:x=>i("version",x),options:ge}),e.jsx(Q,{label:"Cards Per Row",value:Number(o.get("cardsPerRow")??"8"),onChange:x=>i("cardsPerRow",x),min:2,max:12}),e.jsx(_,{label:"Sort By",value:o.get("sortBy")??"id",onChange:x=>i("sortBy",x),options:pe}),e.jsx(he,{data:s})]})}function be(s){const r=v.cloneDeep(s);for(const n in r){const l=r[n];(l.height.length===1||l.build.length===1)&&(l.height==="S"&&(l.height="short"),l.height==="M"&&(l.height="medium"),l.height==="L"&&(l.height="tall"),l.build==="S"&&(l.build="thin"),l.build==="M"&&(l.build="average")),l.build==="fat"&&(l.build="large"),l.build==="heavy"&&(l.build="large")}return Z(r,["gender","ethnicity","age","height","build","features"])}function ls(){const s=U({tdrResourceName:"suspects",firestoreDataCollectionName:"suspects",serialize:!0});return e.jsx(E,{title:"Suspects",subtitle:"Information",children:e.jsxs(w,{hasSider:!0,children:[e.jsx(M,{children:e.jsx(xe,{...s})}),e.jsx(w.Content,{className:"content",children:e.jsx(L,{isLoading:s.isLoading,error:s.error,hasResponseData:!v.isEmpty(s.data),children:e.jsx(de,{...s})})})]})})}export{ls as default};
