import{j as e,ab as E,a9 as w,T as n,r as F,D as b,P as S,L as y}from"./index-BcpMPOAg.js";import{u as L,D as N}from"./DataFilters-xaHx6zXV.js";import{u as P,P as T}from"./useGridPagination-1aLL9hCJ.js";import{L as p,D as g,N as k}from"./EditableFields-C9MnEPSH.js";import{L as h}from"./LanguageFlag-C1u0qMtj.js";import{I as R}from"./ImageCard-D6JXHKUb.js";import{l as x}from"./lodash-B_GpjCgW.js";import{r as I,a as O,d as B}from"./index-C0rILB8_.js";import{P as C}from"./constants-CDABhm8f.js";import{C as j}from"./index-DitlW1w1.js";import{F as o}from"./index-CvollKDQ.js";import{S as W}from"./index-CievdN-s.js";import{R as A}from"./index-BUdJ8DRP.js";import{D as G}from"./DataLoadingWrapper-Cb888-Fx.js";import{D as M}from"./DownloadButton-CuwcBA80.js";import{S as z}from"./SaveButton-DgrAWeEW.js";import{S as f}from"./SiderContent-JvxUDyEO.js";import{P as H}from"./useBaseUrl-VNOUWM6_.js";import{u as _}from"./useResourceFirebaseData-C0-K6THW.js";import"./useQueryParams-Dy4QSqde.js";import"./FilterEntries-CknB04Jo.js";import"./index-CS0G3aBP.js";import"./index-152sXHsr.js";import"./index-BMo2W_I8.js";import"./Pagination-Br-dN2Q5.js";import"./index-Dgz3u-ss.js";import"./gapSize-U1swVQyS.js";import"./useCopyToClipboardFunction-BM64UHih.js";import"./index-D26Mw3Et.js";import"./Input-DTnEziXo.js";import"./FireFilled-C8cwD51i.js";import"./IdcardOutlined-BvpdvmLt.js";import"./Item-DkDVx9Fs.js";import"./PlusOutlined-SX4cjdA7.js";import"./moment-C5S46NFB.js";import"./SaveOutlined-C8xYw-EB.js";import"./useGetFirebaseDoc-CRdbVXDQ.js";import"./useTDResource-D9INFiCY.js";import"./useUpdateFirebaseDoc-Byynv72i.js";import"./useMutation-VLxkg5Mr.js";const d=[{value:"base",label:"Base"},{value:"anime",label:"Anime"},{value:"art",label:"Art"},{value:"cartoon",label:"Cartoon"},{value:"characters",label:"Characters"},{value:"comics",label:"Comics"},{value:"games",label:"Games"},{value:"history",label:"History"},{value:"internet",label:"Internet"},{value:"literature",label:"Literature"},{value:"movies",label:"Movies"},{value:"music",label:"Music"},{value:"mythology",label:"Mythology"},{value:"pop-culture",label:"Pop Culture"},{value:"random",label:"Random"},{value:"sports",label:"Sports"},{value:"television",label:"Television"},{value:"special-td",label:"Special TD"},{value:"special-td-bg",label:"Special TD BG"}],J=(s,t)=>{if(!s||s.length===0)return"warning";if(s.filter(l=>!d.some(r=>r.value===l)).length>0||t&&s.includes("base"))return"error"};function K({contender:s,addEntryToUpdate:t}){const a=(i,m,u)=>{t(s.id,x.merge({[m]:{en:"",pt:""}},s,{[m]:{[u]:i}}))},l=i=>{t(s.id,x.merge(s,{nsfw:i}))},r=i=>{t(s.id,{...s,decks:I(i).sort()})};return e.jsxs(j,{hoverable:!0,"style-":{width:240,maxWidth:240},cover:e.jsx(R,{id:s.id,width:240}),children:[e.jsx(j.Meta,{title:s.id,description:e.jsxs(o,{vertical:!0,children:[e.jsx(p,{children:"Name"}),e.jsx(g,{value:s.name,language:"en",onChange:i=>a(i.target.value,"name","en")}),e.jsx(g,{value:s.name,language:"pt",onChange:i=>a(i.target.value,"name","pt")}),e.jsx(p,{children:"Description"}),e.jsx(g,{value:s.description??C,language:"en",onChange:i=>a(i.target.value,"description","en")}),e.jsx(g,{value:s.description??C,language:"pt",onChange:i=>a(i.target.value,"description","pt")}),e.jsx(p,{children:"Decks"}),e.jsx(W,{mode:"multiple",defaultValue:s.decks??[],size:"small",options:d,onChange:i=>r(i),style:{maxWidth:"calc(100vw / 9)"},status:J(s.decks,s.exclusivity)}),e.jsxs(o,{align:"center",children:[e.jsx(p,{children:"NSFW"})," ",e.jsx(k,{value:s.nsfw,size:"small",onChange:i=>l(i)})]}),e.jsxs(o,{align:"center",gap:8,children:[e.jsx(p,{children:"Exclusivity"})," ",e.jsx(U,{contender:s,addEntryToUpdate:t})]})]})}),e.jsx(j.Meta,{})]})}function U({contender:s,addEntryToUpdate:t}){const a=i=>{t(s.id,x.merge(s,{exclusivity:i}))},l=[{value:"en",label:e.jsx(h,{language:"en",style:{width:24}})},{value:"pt",label:e.jsx(h,{language:"pt",style:{width:24}})},{value:"none",label:"None"}],r=e.jsx(o,{gap:8,children:e.jsx(A.Group,{options:l,onChange:i=>a(i.target.value),value:s==null?void 0:s.exclusivity})});return e.jsxs(o,{gap:8,children:[(s==null?void 0:s.exclusivity)==="en"&&e.jsx(h,{language:"en",style:{width:24}}),(s==null?void 0:s.exclusivity)==="pt"&&e.jsx(h,{language:"pt",style:{width:24}}),!(s!=null&&s.exclusivity)&&"None",e.jsx(E,{title:"Change exclusivity?",content:r,trigger:"click",children:e.jsx(w,{})})]})}function Y({data:s,addEntryToUpdate:t}){const a=L(s),{page:l,pagination:r}=P({data:a,resetter:"",defaultPageSize:32});return e.jsx(e.Fragment,{children:e.jsxs(e.Fragment,{children:[e.jsxs(n.Title,{level:2,children:["Listing - Contenders (",a.length," | ",Object.values(s??{}).length,")"]}),e.jsx(T,{pagination:r,className:"full-width",children:e.jsx(o,{gap:16,wrap:"wrap",children:l.map(i=>e.jsx(K,{contender:i,addEntryToUpdate:t},i.id))})})]})})}function Q({data:s,isDirty:t,save:a,isSaving:l,entriesToUpdate:r}){return e.jsxs(e.Fragment,{children:[e.jsx(f,{children:e.jsxs(o,{vertical:!0,gap:12,children:[e.jsx(z,{isDirty:t,onSave:a,isSaving:l,dirt:JSON.stringify(r)}),e.jsx(M,{data:()=>V(s),fileName:"contenders.json",disabled:t,block:!0})]})}),e.jsx(f,{children:e.jsx(N,{data:s,ignoreKeys:["description"]})}),e.jsx(f,{children:e.jsx(q,{data:s})})]})}function V(s){console.log("Preparing file for download...");const t=x.cloneDeep(s);return Object.values(t).forEach(a=>{const l=a.exclusivity;(a.exclusivity===void 0||l==="none")&&(a.exclusivity=void 0)}),O(B(t))}function q({data:s}){const t=F.useMemo(()=>{let a=0,l=0,r=0;const i=Object.values(s).reduce((u,c)=>((c.decks??[]).forEach((v,X,D)=>{(v==="base"||!D.includes("base"))&&(u[v]=u[v]?u[v]+1:1)}),c.exclusivity==="en"&&a++,c.exclusivity==="pt"&&l++,c.exclusivity||r++,u),{}),m=Object.keys(i).filter(u=>!d.some(c=>c.value===u));return{deckCounts:i,invalidDecks:m,englishExclusivity:a,portugueseExclusivity:l,bothExclusivity:r}},[s]);return e.jsxs(o,{vertical:!0,gap:8,children:[e.jsx(n.Text,{strong:!0,children:"Deck Counts"}),e.jsx(o,{vertical:!0,gap:8,style:{maxHeight:"300px",overflowY:"auto"},children:d.map(a=>e.jsxs(n.Text,{children:[a.label,": ",t.deckCounts[a.value]??0]},a.value))}),e.jsx(b,{className:"my-2"}),e.jsx(n.Text,{strong:!0,children:"Invalid Decks"}),e.jsx(o,{vertical:!0,gap:8,style:{maxHeight:"300px",overflowY:"auto"},children:t.invalidDecks.map(a=>e.jsx(n.Text,{children:a},a))}),e.jsx(b,{className:"my-2"}),e.jsx(n.Text,{strong:!0,children:"Exclusivity"}),e.jsxs(o,{vertical:!0,gap:8,children:[e.jsxs(n.Text,{children:["English: ",t.englishExclusivity]}),e.jsxs(n.Text,{children:["Portuguese: ",t.portugueseExclusivity]}),e.jsxs(n.Text,{children:["Both: ",t.bothExclusivity]})]})]})}function Ae(){const s=_({tdrResourceName:"contenders",firebaseDataCollectionName:"contenders",serialize:!0});return e.jsx(S,{title:"Contenders",subtitle:"Characters, Celebrities, Personalities",children:e.jsxs(y,{hasSider:!0,children:[e.jsx(H,{children:e.jsx(Q,{...s})}),e.jsx(y.Content,{className:"content",children:e.jsx(G,{isLoading:s.isLoading,error:s.error,hasResponseData:!x.isEmpty(s.data),children:e.jsx(Y,{...s})})})]})})}export{Ae as Contenders,Ae as default};
