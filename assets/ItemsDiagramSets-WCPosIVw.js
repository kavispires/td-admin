import{r as y,a1 as X,R as A,a6 as Y,a7 as B,a3 as Oe,a4 as K,a5 as Re,ak as qe,a2 as He,a9 as Je,C as Qe,c as de,g as Xe,m as Ye,d as F,al as Ze,e as et,am as tt,an as nt,f as at,h as rt,ao as st,b as ve,ap as ot,aq as lt,w as be,j as n,D as W,B as U,T as P,J as he,X as it,x as dt,P as ct,L as je}from"./index-BHrRQ1uq.js";import{D as De}from"./DataLoadingWrapper-DKkg9HZe.js";import{F as ut}from"./FilterEntries-BiZjj4NT.js";import{S as mt}from"./SiderContent-Dj_cqrIg.js";import{D as ft}from"./DownloadButton-DRTPYwYl.js";import{S as pt}from"./SaveButton-DzoI0xQq.js";import{u as ge}from"./useQueryParams-Cr8fZCN0.js";import{u as ce}from"./useTDResource-wK2jd69j.js";import{l as Z}from"./lodash-f0m46xYx.js";import{a as ht,w as ue}from"./index-Rk2ZCQ0l.js";import{v as G,s as Fe,a as Ce,b as Se,S as _e,c as Ie}from"./daily-teoria-de-conjuntos-Cij07fYg.js";import{F as ee}from"./index-CjtWJUFP.js";import{R as gt}from"./ClusterOutlined-zQvQ3RvO.js";import{R as xt}from"./TableOutlined-nZjEACr8.js";import{c as oe,P as yt}from"./useBaseUrl--32bgvsR.js";import{I as Ve}from"./Item-DXicAdtS.js";import{F as M}from"./index-BHuPI7uO.js";import{M as vt}from"./index-Cl1PfxMn.js";import{I as te}from"./index-DuBa27hb.js";import{R as H}from"./index-Cm-andhV.js";import{A as bt}from"./index-Bhh1-3KX.js";import{S as me}from"./index-7mXcI-6s.js";import{T as J}from"./TransparentButton-DpdrHZZr.js";import{S as R}from"./index-Co7aD7RO.js";import{R as Le}from"./index-WNUpoTeg.js";import{u as ze}from"./useTablePagination-T_HopZaN.js";import{T as L}from"./index-Db_5R2-z.js";import{F as Be}from"./Table-CGPLlxUi.js";import{u as jt}from"./useResourceFirebaseData-DpbqY9uc.js";import"./index-DL-QmAap.js";import"./index-CkYVgnOz.js";import"./moment-C5S46NFB.js";import"./SaveOutlined-DugEzKbM.js";import"./constants-B_q3c2xJ.js";import"./constants-ddEaHlnY.js";import"./gapSize-U1swVQyS.js";import"./Input-cdsOURLH.js";import"./throttleByAnimationFrame-BDh47Y1L.js";import"./index-BESd2kFy.js";import"./scrollTo-CnYqteaX.js";import"./Pagination-DPx5Huu7.js";import"./extendsObject-keMuGWqj.js";import"./useGetFirebaseDoc-xE0GJyOY.js";import"./useUpdateFirebaseDoc-B5eSaqtP.js";import"./useMutation-Cs1gCno8.js";function $e(e){var t=y.useRef();t.current=e;var r=y.useCallback(function(){for(var a,o=arguments.length,u=new Array(o),m=0;m<o;m++)u[m]=arguments[m];return(a=t.current)===null||a===void 0?void 0:a.call.apply(a,[t].concat(u))},[]);return r}function Ct(){return!!(typeof window<"u"&&window.document&&window.document.createElement)}var we=Ct()?y.useLayoutEffect:y.useEffect,St=function(t,r){var a=y.useRef(!0);we(function(){return t(a.current)},r),we(function(){return a.current=!1,function(){a.current=!0}},[])},Te=function(t,r){St(function(a){if(!a)return t()},r)};function Pe(e){var t=y.useRef(!1),r=y.useState(e),a=X(r,2),o=a[0],u=a[1];y.useEffect(function(){return t.current=!1,function(){t.current=!0}},[]);function m(d,f){f&&t.current||u(d)}return[o,m]}function le(e){return e!==void 0}function It(e,t){var r=t||{},a=r.defaultValue,o=r.value,u=r.onChange,m=r.postState,d=Pe(function(){return le(o)?o:le(a)?typeof a=="function"?a():a:typeof e=="function"?e():e}),f=X(d,2),p=f[0],j=f[1],s=o!==void 0?o:p,g=m?m(s):s,i=$e(u),l=Pe([s]),x=X(l,2),b=x[0],$=x[1];Te(function(){var v=b[0];p!==v&&i(p,v)},[b]),Te(function(){le(o)||j(o)},[o]);var C=$e(function(v,I){j(v,I),$([s],I)});return[g,C]}var fe={},$t=function(t){};function wt(e,t){}function Tt(e,t){}function Pt(){fe={}}function Ke(e,t,r){!t&&!fe[r]&&(e(!1,r),fe[r]=!0)}function ae(e,t){Ke(wt,e,t)}function Nt(e,t){Ke(Tt,e,t)}ae.preMessage=$t;ae.resetWarned=Pt;ae.noteOnce=Nt;var ie={exports:{}},w={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ne;function At(){if(Ne)return w;Ne=1;var e=typeof Symbol=="function"&&Symbol.for,t=e?Symbol.for("react.element"):60103,r=e?Symbol.for("react.portal"):60106,a=e?Symbol.for("react.fragment"):60107,o=e?Symbol.for("react.strict_mode"):60108,u=e?Symbol.for("react.profiler"):60114,m=e?Symbol.for("react.provider"):60109,d=e?Symbol.for("react.context"):60110,f=e?Symbol.for("react.async_mode"):60111,p=e?Symbol.for("react.concurrent_mode"):60111,j=e?Symbol.for("react.forward_ref"):60112,s=e?Symbol.for("react.suspense"):60113,g=e?Symbol.for("react.suspense_list"):60120,i=e?Symbol.for("react.memo"):60115,l=e?Symbol.for("react.lazy"):60116,x=e?Symbol.for("react.block"):60121,b=e?Symbol.for("react.fundamental"):60117,$=e?Symbol.for("react.responder"):60118,C=e?Symbol.for("react.scope"):60119;function v(c){if(typeof c=="object"&&c!==null){var T=c.$$typeof;switch(T){case t:switch(c=c.type,c){case f:case p:case a:case u:case o:case s:return c;default:switch(c=c&&c.$$typeof,c){case d:case j:case l:case i:case m:return c;default:return T}}case r:return T}}}function I(c){return v(c)===p}return w.AsyncMode=f,w.ConcurrentMode=p,w.ContextConsumer=d,w.ContextProvider=m,w.Element=t,w.ForwardRef=j,w.Fragment=a,w.Lazy=l,w.Memo=i,w.Portal=r,w.Profiler=u,w.StrictMode=o,w.Suspense=s,w.isAsyncMode=function(c){return I(c)||v(c)===f},w.isConcurrentMode=I,w.isContextConsumer=function(c){return v(c)===d},w.isContextProvider=function(c){return v(c)===m},w.isElement=function(c){return typeof c=="object"&&c!==null&&c.$$typeof===t},w.isForwardRef=function(c){return v(c)===j},w.isFragment=function(c){return v(c)===a},w.isLazy=function(c){return v(c)===l},w.isMemo=function(c){return v(c)===i},w.isPortal=function(c){return v(c)===r},w.isProfiler=function(c){return v(c)===u},w.isStrictMode=function(c){return v(c)===o},w.isSuspense=function(c){return v(c)===s},w.isValidElementType=function(c){return typeof c=="string"||typeof c=="function"||c===a||c===p||c===u||c===o||c===s||c===g||typeof c=="object"&&c!==null&&(c.$$typeof===l||c.$$typeof===i||c.$$typeof===m||c.$$typeof===d||c.$$typeof===j||c.$$typeof===b||c.$$typeof===$||c.$$typeof===C||c.$$typeof===x)},w.typeOf=v,w}var Ae;function kt(){return Ae||(Ae=1,ie.exports=At()),ie.exports}var Et=kt();function pe(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=[];return A.Children.forEach(e,function(a){a==null&&!t.keepEmpty||(Array.isArray(a)?r=r.concat(pe(a)):Et.isFragment(a)&&a.props?r=r.concat(pe(a.props.children,t)):r.push(a))}),r}var ke={ENTER:13},We=A.forwardRef(function(e,t){var r=e.prefixCls,a=e.forceRender,o=e.className,u=e.style,m=e.children,d=e.isActive,f=e.role,p=e.classNames,j=e.styles,s=A.useState(d||a),g=X(s,2),i=g[0],l=g[1];return A.useEffect(function(){(a||d)&&l(!0)},[a,d]),i?A.createElement("div",{ref:t,className:Y("".concat(r,"-content"),B(B({},"".concat(r,"-content-active"),d),"".concat(r,"-content-inactive"),!d),o),style:u,role:f},A.createElement("div",{className:Y("".concat(r,"-content-box"),p==null?void 0:p.body),style:j==null?void 0:j.body},m)):null});We.displayName="PanelContent";var Mt=["showArrow","headerClass","isActive","onItemClick","forceRender","className","classNames","styles","prefixCls","collapsible","accordion","panelKey","extra","header","expandIcon","openMotion","destroyInactivePanel","children"],Ge=A.forwardRef(function(e,t){var r=e.showArrow,a=r===void 0?!0:r,o=e.headerClass,u=e.isActive,m=e.onItemClick,d=e.forceRender,f=e.className,p=e.classNames,j=p===void 0?{}:p,s=e.styles,g=s===void 0?{}:s,i=e.prefixCls,l=e.collapsible,x=e.accordion,b=e.panelKey,$=e.extra,C=e.header,v=e.expandIcon,I=e.openMotion,c=e.destroyInactivePanel,T=e.children,E=Oe(e,Mt),N=l==="disabled",h=$!=null&&typeof $!="boolean",S=B(B(B({onClick:function(){m==null||m(b)},onKeyDown:function(_){(_.key==="Enter"||_.keyCode===ke.ENTER||_.which===ke.ENTER)&&(m==null||m(b))},role:x?"tab":"button"},"aria-expanded",u),"aria-disabled",N),"tabIndex",N?-1:0),k=typeof v=="function"?v(e):A.createElement("i",{className:"arrow"}),q=k&&A.createElement("div",K({className:"".concat(i,"-expand-icon")},["header","icon"].includes(l)?S:{}),k),O=Y("".concat(i,"-item"),B(B({},"".concat(i,"-item-active"),u),"".concat(i,"-item-disabled"),N),f),D=Y(o,"".concat(i,"-header"),B({},"".concat(i,"-collapsible-").concat(l),!!l),j.header),V=Re({className:D,style:g.header},["header","icon"].includes(l)?{}:S);return A.createElement("div",K({},E,{ref:t,className:O}),A.createElement("div",V,a&&q,A.createElement("span",K({className:"".concat(i,"-header-text")},l==="header"?S:{}),C),h&&A.createElement("div",{className:"".concat(i,"-extra")},$)),A.createElement(qe,K({visible:u,leavedClassName:"".concat(i,"-content-hidden")},I,{forceRender:d,removeOnLeave:c}),function(z,_){var re=z.className,se=z.style;return A.createElement(We,{ref:_,prefixCls:i,className:re,classNames:j,style:se,styles:g,isActive:u,forceRender:d,role:x?"tabpanel":void 0},T)}))}),Ot=["children","label","key","collapsible","onItemClick","destroyInactivePanel"],Rt=function(t,r){var a=r.prefixCls,o=r.accordion,u=r.collapsible,m=r.destroyInactivePanel,d=r.onItemClick,f=r.activeKey,p=r.openMotion,j=r.expandIcon;return t.map(function(s,g){var i=s.children,l=s.label,x=s.key,b=s.collapsible,$=s.onItemClick,C=s.destroyInactivePanel,v=Oe(s,Ot),I=String(x??g),c=b??u,T=C??m,E=function(S){c!=="disabled"&&(d(S),$==null||$(S))},N=!1;return o?N=f[0]===I:N=f.indexOf(I)>-1,A.createElement(Ge,K({},v,{prefixCls:a,key:I,panelKey:I,isActive:N,accordion:o,openMotion:p,expandIcon:j,header:l,collapsible:c,onItemClick:E,destroyInactivePanel:T}),i)})},Dt=function(t,r,a){if(!t)return null;var o=a.prefixCls,u=a.accordion,m=a.collapsible,d=a.destroyInactivePanel,f=a.onItemClick,p=a.activeKey,j=a.openMotion,s=a.expandIcon,g=t.key||String(r),i=t.props,l=i.header,x=i.headerClass,b=i.destroyInactivePanel,$=i.collapsible,C=i.onItemClick,v=!1;u?v=p[0]===g:v=p.indexOf(g)>-1;var I=$??m,c=function(N){I!=="disabled"&&(f(N),C==null||C(N))},T={key:g,panelKey:g,header:l,headerClass:x,isActive:v,prefixCls:o,destroyInactivePanel:b??d,openMotion:j,accordion:u,children:t.props.children,onItemClick:c,expandIcon:s,collapsible:I};return typeof t.type=="string"?t:(Object.keys(T).forEach(function(E){typeof T[E]>"u"&&delete T[E]}),A.cloneElement(t,T))};function Ft(e,t,r){return Array.isArray(e)?Rt(e,r):pe(t).map(function(a,o){return Dt(a,o,r)})}var _t=`accept acceptCharset accessKey action allowFullScreen allowTransparency
    alt async autoComplete autoFocus autoPlay capture cellPadding cellSpacing challenge
    charSet checked classID className colSpan cols content contentEditable contextMenu
    controls coords crossOrigin data dateTime default defer dir disabled download draggable
    encType form formAction formEncType formMethod formNoValidate formTarget frameBorder
    headers height hidden high href hrefLang htmlFor httpEquiv icon id inputMode integrity
    is keyParams keyType kind label lang list loop low manifest marginHeight marginWidth max maxLength media
    mediaGroup method min minLength multiple muted name noValidate nonce open
    optimum pattern placeholder poster preload radioGroup readOnly rel required
    reversed role rowSpan rows sandbox scope scoped scrolling seamless selected
    shape size sizes span spellCheck src srcDoc srcLang srcSet start step style
    summary tabIndex target title type useMap value width wmode wrap`,Vt=`onCopy onCut onPaste onCompositionEnd onCompositionStart onCompositionUpdate onKeyDown
    onKeyPress onKeyUp onFocus onBlur onChange onInput onSubmit onClick onContextMenu onDoubleClick
    onDrag onDragEnd onDragEnter onDragExit onDragLeave onDragOver onDragStart onDrop onMouseDown
    onMouseEnter onMouseLeave onMouseMove onMouseOut onMouseOver onMouseUp onSelect onTouchCancel
    onTouchEnd onTouchMove onTouchStart onScroll onWheel onAbort onCanPlay onCanPlayThrough
    onDurationChange onEmptied onEncrypted onEnded onError onLoadedData onLoadedMetadata
    onLoadStart onPause onPlay onPlaying onProgress onRateChange onSeeked onSeeking onStalled onSuspend onTimeUpdate onVolumeChange onWaiting onLoad onError`,Lt="".concat(_t," ").concat(Vt).split(/[\s\n]+/),zt="aria-",Bt="data-";function Ee(e,t){return e.indexOf(t)===0}function Kt(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r;t===!1?r={aria:!0,data:!0,attr:!0}:t===!0?r={aria:!0}:r=Re({},t);var a={};return Object.keys(e).forEach(function(o){(r.aria&&(o==="role"||Ee(o,zt))||r.data&&Ee(o,Bt)||r.attr&&Lt.includes(o))&&(a[o]=e[o])}),a}function Wt(e){var t=e;if(!Array.isArray(t)){var r=He(t);t=r==="number"||r==="string"?[t]:[]}return t.map(function(a){return String(a)})}var Gt=A.forwardRef(function(e,t){var r=e.prefixCls,a=r===void 0?"rc-collapse":r,o=e.destroyInactivePanel,u=o===void 0?!1:o,m=e.style,d=e.accordion,f=e.className,p=e.children,j=e.collapsible,s=e.openMotion,g=e.expandIcon,i=e.activeKey,l=e.defaultActiveKey,x=e.onChange,b=e.items,$=Y(a,f),C=It([],{value:i,onChange:function(h){return x==null?void 0:x(h)},defaultValue:l,postState:Wt}),v=X(C,2),I=v[0],c=v[1],T=function(h){return c(function(){if(d)return I[0]===h?[]:[h];var S=I.indexOf(h),k=S>-1;return k?I.filter(function(q){return q!==h}):[].concat(Je(I),[h])})};ae(!p,"[rc-collapse] `children` will be removed in next major version. Please use `items` instead.");var E=Ft(b,p,{prefixCls:a,accordion:d,openMotion:s,expandIcon:g,collapsible:j,destroyInactivePanel:u,onItemClick:T,activeKey:I});return A.createElement("div",K({ref:t,className:$,style:m,role:d?"tablist":void 0},Kt(e,{aria:!0,data:!0})),E)});const xe=Object.assign(Gt,{Panel:Ge});xe.Panel;const Ut=y.forwardRef((e,t)=>{const{getPrefixCls:r}=y.useContext(Qe),{prefixCls:a,className:o,showArrow:u=!0}=e,m=r("collapse",a),d=de({[`${m}-no-arrow`]:!u},o);return y.createElement(xe.Panel,Object.assign({ref:t},e,{prefixCls:m,className:d}))}),qt=e=>{const{componentCls:t,contentBg:r,padding:a,headerBg:o,headerPadding:u,collapseHeaderPaddingSM:m,collapseHeaderPaddingLG:d,collapsePanelBorderRadius:f,lineWidth:p,lineType:j,colorBorder:s,colorText:g,colorTextHeading:i,colorTextDisabled:l,fontSizeLG:x,lineHeight:b,lineHeightLG:$,marginSM:C,paddingSM:v,paddingLG:I,paddingXS:c,motionDurationSlow:T,fontSizeIcon:E,contentPadding:N,fontHeight:h,fontHeightLG:S}=e,k=`${F(p)} ${j} ${s}`;return{[t]:Object.assign(Object.assign({},et(e)),{backgroundColor:o,border:k,borderRadius:f,"&-rtl":{direction:"rtl"},[`& > ${t}-item`]:{borderBottom:k,"&:first-child":{[`
            &,
            & > ${t}-header`]:{borderRadius:`${F(f)} ${F(f)} 0 0`}},"&:last-child":{[`
            &,
            & > ${t}-header`]:{borderRadius:`0 0 ${F(f)} ${F(f)}`}},[`> ${t}-header`]:Object.assign(Object.assign({position:"relative",display:"flex",flexWrap:"nowrap",alignItems:"flex-start",padding:u,color:i,lineHeight:b,cursor:"pointer",transition:`all ${T}, visibility 0s`},tt(e)),{[`> ${t}-header-text`]:{flex:"auto"},[`${t}-expand-icon`]:{height:h,display:"flex",alignItems:"center",paddingInlineEnd:C},[`${t}-arrow`]:Object.assign(Object.assign({},nt()),{fontSize:E,transition:`transform ${T}`,svg:{transition:`transform ${T}`}}),[`${t}-header-text`]:{marginInlineEnd:"auto"}}),[`${t}-collapsible-header`]:{cursor:"default",[`${t}-header-text`]:{flex:"none",cursor:"pointer"}},[`${t}-collapsible-icon`]:{cursor:"unset",[`${t}-expand-icon`]:{cursor:"pointer"}}},[`${t}-content`]:{color:g,backgroundColor:r,borderTop:k,[`& > ${t}-content-box`]:{padding:N},"&-hidden":{display:"none"}},"&-small":{[`> ${t}-item`]:{[`> ${t}-header`]:{padding:m,paddingInlineStart:c,[`> ${t}-expand-icon`]:{marginInlineStart:e.calc(v).sub(c).equal()}},[`> ${t}-content > ${t}-content-box`]:{padding:v}}},"&-large":{[`> ${t}-item`]:{fontSize:x,lineHeight:$,[`> ${t}-header`]:{padding:d,paddingInlineStart:a,[`> ${t}-expand-icon`]:{height:S,marginInlineStart:e.calc(I).sub(a).equal()}},[`> ${t}-content > ${t}-content-box`]:{padding:I}}},[`${t}-item:last-child`]:{borderBottom:0,[`> ${t}-content`]:{borderRadius:`0 0 ${F(f)} ${F(f)}`}},[`& ${t}-item-disabled > ${t}-header`]:{"\n          &,\n          & > .arrow\n        ":{color:l,cursor:"not-allowed"}},[`&${t}-icon-position-end`]:{[`& > ${t}-item`]:{[`> ${t}-header`]:{[`${t}-expand-icon`]:{order:1,paddingInlineEnd:0,paddingInlineStart:C}}}}})}},Ht=e=>{const{componentCls:t}=e,r=`> ${t}-item > ${t}-header ${t}-arrow`;return{[`${t}-rtl`]:{[r]:{transform:"rotate(180deg)"}}}},Jt=e=>{const{componentCls:t,headerBg:r,paddingXXS:a,colorBorder:o}=e;return{[`${t}-borderless`]:{backgroundColor:r,border:0,[`> ${t}-item`]:{borderBottom:`1px solid ${o}`},[`
        > ${t}-item:last-child,
        > ${t}-item:last-child ${t}-header
      `]:{borderRadius:0},[`> ${t}-item:last-child`]:{borderBottom:0},[`> ${t}-item > ${t}-content`]:{backgroundColor:"transparent",borderTop:0},[`> ${t}-item > ${t}-content > ${t}-content-box`]:{paddingTop:a}}}},Qt=e=>{const{componentCls:t,paddingSM:r}=e;return{[`${t}-ghost`]:{backgroundColor:"transparent",border:0,[`> ${t}-item`]:{borderBottom:0,[`> ${t}-content`]:{backgroundColor:"transparent",border:0,[`> ${t}-content-box`]:{paddingBlock:r}}}}}},Xt=e=>({headerPadding:`${e.paddingSM}px ${e.padding}px`,headerBg:e.colorFillAlter,contentPadding:`${e.padding}px 16px`,contentBg:e.colorBgContainer}),Yt=Xe("Collapse",e=>{const t=Ye(e,{collapseHeaderPaddingSM:`${F(e.paddingXS)} ${F(e.paddingSM)}`,collapseHeaderPaddingLG:`${F(e.padding)} ${F(e.paddingLG)}`,collapsePanelBorderRadius:e.borderRadiusLG});return[qt(t),Jt(t),Qt(t),Ht(t),Ze(t)]},Xt),Zt=y.forwardRef((e,t)=>{const{getPrefixCls:r,direction:a,expandIcon:o,className:u,style:m}=at("collapse"),{prefixCls:d,className:f,rootClassName:p,style:j,bordered:s=!0,ghost:g,size:i,expandIconPosition:l="start",children:x,expandIcon:b}=e,$=rt(O=>{var D;return(D=i??O)!==null&&D!==void 0?D:"middle"}),C=r("collapse",d),v=r(),[I,c,T]=Yt(C),E=y.useMemo(()=>l==="left"?"start":l==="right"?"end":l,[l]),N=b??o,h=y.useCallback(function(){let O=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const D=typeof N=="function"?N(O):y.createElement(st,{rotate:O.isActive?a==="rtl"?-90:90:void 0,"aria-label":O.isActive?"expanded":"collapsed"});return ve(D,()=>{var V;return{className:de((V=D==null?void 0:D.props)===null||V===void 0?void 0:V.className,`${C}-arrow`)}})},[N,C]),S=de(`${C}-icon-position-${E}`,{[`${C}-borderless`]:!s,[`${C}-rtl`]:a==="rtl",[`${C}-ghost`]:!!g,[`${C}-${$}`]:$!=="middle"},u,f,p,c,T),k=Object.assign(Object.assign({},ot(v)),{motionAppear:!1,leavedClassName:`${C}-content-hidden`}),q=y.useMemo(()=>x?lt(x).map((O,D)=>{var V,z;const _=O.props;if(_!=null&&_.disabled){const re=(V=O.key)!==null&&V!==void 0?V:String(D),se=Object.assign(Object.assign({},be(O.props,["disabled"])),{key:re,collapsible:(z=_.collapsible)!==null&&z!==void 0?z:"disabled"});return ve(O,se)}return O}):null,[x]);return I(y.createElement(xe,Object.assign({ref:t,openMotion:k},be(e,["rootClassName"]),{expandIcon:h,prefixCls:C,className:S,style:Object.assign(Object.assign({},m),j)}),q))}),en=Object.assign(Zt,{Panel:Ut});function tn({data:e,save:t,isDirty:r,isSaving:a,entriesToUpdate:o,hasFirestoreData:u}){const{addParams:m,queryParams:d}=ge(),f=ce("daily-diagram-rules");return n.jsxs(mt,{children:[n.jsxs(ee,{vertical:!0,gap:12,children:[n.jsx(pt,{isDirty:r,onSave:t,isSaving:a,dirt:JSON.stringify(o)}),n.jsx(ft,{data:()=>nn(e,f.data??{}),fileName:"daily-diagram-items.json",disabled:r,hasNewData:u,block:!0})]}),n.jsx(W,{}),n.jsx(ut,{label:"Display",value:d.get("display")??"rule",onChange:p=>m({display:p,page:1},{page:1}),options:[{title:"By Rule",icon:n.jsx(gt,{}),value:"rule"},{title:"By Thing",icon:n.jsx(xt,{}),value:"thing"}]}),n.jsx(W,{}),n.jsx(U,{size:"small",block:!0,onClick:()=>m({display:"simulator"}),children:"Simulator"}),n.jsx(P.Paragraph,{type:"secondary",className:"my-6",children:"v2.0.1"})]})}function nn(e,t){console.log("Preparing file for download...");const r=Z.cloneDeep(e);return Object.values(r).forEach(a=>{const o=Object.values(t).filter(d=>d.updatedAt>a.updatedAt),u=o.filter(d=>d.method==="auto");u.length>0&&(console.log(`Performing ${u.length} auto updates for ${a.name}`),a.rules=a.rules.filter(d=>!u.map(f=>f.id).includes(d)),u.forEach(d=>{G[d.id](a.name)&&a.rules.push(d.id)})),a.rules=a.rules.sort(),o.some(d=>d.method!=="auto")||(console.log("Auto updating"),a.updatedAt=Date.now())}),ht(r)}function ye({isModalOpen:e,onSaveThing:t,onCancel:r,thing:a,rules:o,width:u,itemAliases:m,subtitle:d,okButtonText:f,onGiveAnotherThing:p}){const j=y.useMemo(()=>Z.orderBy(Object.values(o),[h=>{const S=["manual","dependency","auto"].indexOf(h.method);return S===-1?Number.POSITIVE_INFINITY:S},h=>{const S=["grammar","comparison","order","count","contains","ends"].indexOf(h.type);return S===-1?Number.POSITIVE_INFINITY:S},h=>h.title.slice(0,7),h=>Number(h.id.split("-")[1])]),[o]),[s]=M.useForm(),g=M.useWatch([],s),i=!g||Object.values(g??{}).some(h=>h===void 0),l=M.useWatch("name",s);y.useEffect(()=>{if(!l||a.name&&a.syllables&&l===a.name)return;const h={syllables:Fe(l),stressedSyllable:a.stressedSyllable??l.includes(" ")?-1:0};Object.keys(o).forEach(S=>{G[S]?h[S]=G[S](l):h[S]=a.rules.length>0?a.rules.includes(S):void 0}),s.setFieldsValue(h)},[l]);const x=M.useWatch("syllables",s),b=s.getFieldValue("ddr-51-pt");y.useEffect(()=>{b&&(s.setFieldsValue({stressedSyllable:void 0}),s.setFieldsValue({"ddr-43-pt":!1}),s.setFieldsValue({"ddr-44-pt":!1}),s.setFieldsValue({"ddr-45-pt":!1}),s.setFieldsValue({"ddr-46-pt":!1})),b===void 0&&s.setFieldsValue({"ddr-51-pt":!1})},[b]),y.useEffect(()=>{if(x){const h=Object.keys(o).reduce((S,k)=>(Ce[k]&&(S[k]=Ce[k](l,x,b)),S),{});s.setFieldsValue({...h,stressedSyllable:x===a.syllables?a.stressedSyllable:a.stressedSyllable??l.includes(" ")?-1:void 0})}},[l,x,b]);const $=M.useWatch("stressedSyllable",s);y.useEffect(()=>{if(!b&&$!==void 0){const h=Object.keys(o).reduce((S,k)=>(Se[k]&&(S[k]=Se[k](l,x,$)),S),{});s.setFieldsValue({...h})}},[$]);const C=s.getFieldValue("ddr-1-pt"),v=s.getFieldValue("ddr-2-pt"),I=s.getFieldValue("ddr-50-pt");y.useEffect(()=>{C===!0&&(s.setFieldsValue({"ddr-2-pt":!1}),s.setFieldsValue({"ddr-50-pt":!1}))},[C]),y.useEffect(()=>{v===!0&&(s.setFieldsValue({"ddr-1-pt":!1}),s.setFieldsValue({"ddr-50-pt":!1}))},[v]),y.useEffect(()=>{I===!0&&(s.setFieldsValue({"ddr-1-pt":!1}),s.setFieldsValue({"ddr-2-pt":!1}))},[I]);const c=s.getFieldValue("ddr-3-pt");y.useEffect(()=>{c===!0&&s.setFieldsValue({"ddr-4-pt":!1})},[c]);const T=s.getFieldValue("ddr-4-pt");y.useEffect(()=>{T===!0&&s.setFieldsValue({"ddr-3-pt":!1})},[T]),y.useEffect(()=>{(l==null?void 0:l.includes("-"))&&s.setFieldsValue({"ddr-5-pt":!0})},[l]);const E=h=>{const S=rn(h);t(S)},N=y.useMemo(()=>(x??"").split(_e),[x]);return n.jsx(vt,{width:u,title:n.jsxs(n.Fragment,{children:["Edit ",a.name," ",d&&n.jsx("small",{children:d})]}),open:e,onOk:s.submit,onCancel:r,maskClosable:!1,okButtonProps:{disabled:i,htmlType:"submit",size:"large"},okText:f??"Add Item",children:n.jsxs(M,{form:s,name:`new-item-${a.itemId}`,onFinish:E,autoComplete:"off",initialValues:an(a,o),layout:"vertical",size:"small",labelWrap:!0,children:[n.jsxs("div",{className:"diagram-container",children:[n.jsx("div",{children:n.jsx(Ve,{id:a.itemId,width:50})}),n.jsx(M.Item,{name:"name",label:"Name",children:n.jsx(te,{})}),n.jsx(M.Item,{name:"itemId",label:"Item",children:n.jsx(te,{readOnly:!0})}),n.jsx(M.Item,{name:"syllables",label:"Syllables",children:n.jsx(te,{})}),n.jsx(M.Item,{name:"stressedSyllable",label:"Stressed Syllable",children:n.jsx(H.Group,{optionType:"button",buttonStyle:"solid",children:N.map((h,S)=>n.jsx(H,{value:N.length-S-1,children:h},S))})}),n.jsx(M.Item,{name:"updatedAt",label:"Updated At",children:n.jsx(te,{value:new Date(a.updatedAt).toLocaleString(),readOnly:!0})}),(m||p)&&n.jsxs("div",{children:[m&&n.jsxs("span",{children:["Options: ",m==null?void 0:m.join(", ")]}),p&&n.jsx(U,{size:"small",onClick:p,type:"dashed",className:"mt-2",children:"Give me another thing"})]}),n.jsx("div",{children:n.jsx(bt,{offsetTop:50,children:n.jsx(ee,{justify:"center",align:"center",children:n.jsx(U,{type:"primary",htmlType:"submit",size:"large",disabled:i,children:f??"Add Item"})})})})]}),n.jsx("div",{className:"diagram-container",children:j.map(h=>h.method==="auto"&&G[h.id]?n.jsx(M.Item,{name:h.id,label:h.title,valuePropName:"checked",className:oe(a.updatedAt<h.updatedAt&&"diagram-container__outdated-rule"),children:n.jsx(me,{checkedChildren:"✅",unCheckedChildren:"❌",disabled:!0})},h.id):h.method==="dependency"?n.jsx(M.Item,{name:h.id,label:h.title,valuePropName:"checked",className:oe(a.updatedAt<h.updatedAt&&"diagram-container__outdated-rule"),children:n.jsx(me,{checkedChildren:"✅",unCheckedChildren:"❌",disabled:!0})},h.id):n.jsx(M.Item,{name:h.id,label:h.title,className:oe(a.updatedAt<h.updatedAt&&"diagram-container__outdated-rule"),children:n.jsxs(H.Group,{optionType:"button",buttonStyle:"solid",children:[n.jsx(H,{value:!0,children:"✅"}),n.jsx(H,{value:!1,children:"❌"})]})},h.id))})]})})}const an=(e,t)=>{let r=!1;return{name:e.name,itemId:e.itemId,syllables:e.syllables??Fe(e.name),stressedSyllable:e.stressedSyllable??0,...Object.keys(t).reduce((a,o)=>{if(e.updatedAt<t[o].updatedAt)if(G[o]){const u=G[o](e.name);u&&e.rules.includes(o)&&(r=!0),a[o]=u}else a[o]=void 0;else a[o]=e.rules.includes(o);return a},{}),updatedAt:r?Date.now():e.updatedAt}},rn=e=>{const{itemId:t,name:r,updatedAt:a,syllables:o,stressedSyllable:u,...m}=e;return{itemId:t,name:r,updatedAt:Date.now(),syllables:o,stressedSyllable:u,rules:Object.keys(m).filter(d=>m[d]===!0)}};function Q({itemId:e,name:t,width:r=50}){return n.jsxs(ee,{vertical:!0,align:"center",children:[n.jsx(Ve,{id:e,width:r}),n.jsx(P.Text,{code:!0,children:t},e)]})}function ne({thing:e,width:t=50,onActivateThing:r}){return n.jsx(J,{onClick:()=>r(e),children:n.jsx(Q,{itemId:e.itemId,name:e.name,width:t})})}function sn({game:e}){const[t]=y.useState([{id:e.rule1.thing.id,name:e.rule1.thing.name,rule:1}]),[r]=y.useState([{id:e.rule2.thing.id,name:e.rule2.thing.name,rule:2}]),[a]=y.useState([{id:e.intersectingThing.id,name:e.intersectingThing.name,rule:0}]),[o]=y.useState(e.things.slice(0,4)),[u,m]=y.useState(e.things[0]);return n.jsxs(R,{direction:"vertical",align:"center",children:[n.jsx(P.Title,{level:4,children:"Game Sample"}),n.jsxs(P.Title,{level:5,children:['"',e.title,'"']}),n.jsx(Le,{value:e.level,count:e.level,disabled:!0}),n.jsx(P.Paragraph,{style:{maxWidth:"500px"},children:"O círculo amarelo tem uma regra gramatical secreta e o circulo vermelho tem outra regra gramatical secreta. O quadrado do meio representa a interseção entre a regra amarela e a regra vermelha."}),n.jsx(R,{children:n.jsx(on,{width:600,leftCircleChildren:n.jsx(J,{style:{width:"100%",height:"100%"},children:t.map((d,f,p)=>n.jsx(Q,{itemId:d.id,name:d.name,width:f===p.length-1?80:60},d.id))}),rightCircleChildren:n.jsx(J,{style:{width:"100%",height:"100%"},children:r.map((d,f,p)=>n.jsx(Q,{itemId:d.id,name:d.name,width:f===p.length-1?80:60},d.id))}),intersectionChildren:n.jsx(J,{style:{width:"100%",height:"100%"},children:a.map((d,f,p)=>n.jsx(Q,{itemId:d.id,name:d.name,width:f===p.length-1?80:60},d.id))})})}),n.jsx(P.Text,{children:"Coloque os objetos nos círculos corretos:"}),n.jsx(R,{className:"space--center",children:o.map(d=>n.jsx(J,{style:d.id===(u==null?void 0:u.id)?{outline:"3px solid hotPink"}:{},onClick:()=>m(d),children:n.jsx(Q,{itemId:d.id,name:d.name},d.id)},d.id))}),n.jsx(en,{items:[{key:"1",label:"Resposta",children:n.jsxs(R,{direction:"vertical",children:[n.jsx(P.Text,{strong:!0,children:"Regra Amarela"}),n.jsx("ul",{children:n.jsx("li",{children:n.jsx(P.Text,{children:e.rule1.text})})}),n.jsx(P.Text,{strong:!0,children:"Regra Vermelha"}),n.jsx("ul",{children:n.jsx("li",{children:n.jsx(P.Text,{children:e.rule2.text})})})]})}]}),n.jsx("div",{style:{height:"200px"}})]})}function on({leftCircleChildren:e,rightCircleChildren:t,intersectionChildren:r,...a}){return n.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 760 500",...a,children:[n.jsx("path",{fill:"#fbb03b",stroke:"#000",strokeMiterlimit:"10",strokeWidth:"5",d:"M252.78 3.5c-136.42 0-247 110.59-247 247s110.59 247 247 247 247-110.59 247-247-110.59-247-247-247zm.99 483.07C123.39 486.57 17.7 380.88 17.7 250.5S123.39 14.43 253.77 14.43 489.84 120.12 489.84 250.5 384.15 486.57 253.77 486.57z"}),n.jsx("path",{fill:"#f15a24",stroke:"#000",strokeMiterlimit:"10",strokeWidth:"5",d:"M508.22 3.5c-136.41 0-247 110.59-247 247s110.59 247 247 247 247-110.59 247-247-110.58-247-247-247zm.99 483.07c-130.38 0-236.07-105.69-236.07-236.07S378.84 14.43 509.22 14.43 745.29 120.12 745.29 250.5 639.6 486.57 509.22 486.57z"}),n.jsx("path",{fill:"#535353",d:"M487.34 250.5c0-62.39-24.29-121.04-68.41-165.16a235.9 235.9 0 00-37.43-30.47 235.35 235.35 0 00-37.43 30.47c-44.12 44.11-68.41 102.77-68.41 165.16s24.29 121.04 68.41 165.16a235.9 235.9 0 0037.43 30.47 235.35 235.35 0 0037.43-30.47c44.12-44.11 68.41-102.77 68.41-165.16z"}),n.jsx("path",{fill:"#535353",d:"M258.72 250.5c0-66.64 25.95-129.3 73.08-176.42a253.125 253.125 0 0134.1-28.57c-33.98-18.65-72.29-28.57-112.13-28.57-62.39 0-121.04 24.29-165.16 68.41C44.5 129.46 20.2 188.11 20.2 250.5s24.29 121.04 68.41 165.16c44.11 44.12 102.77 68.41 165.16 68.41 39.84 0 78.15-9.92 112.13-28.57a252.507 252.507 0 01-34.1-28.57c-47.12-47.12-73.08-109.78-73.08-176.42zM674.37 85.34C630.25 41.22 571.6 16.93 509.21 16.93c-40.27 0-78.98 10.14-113.24 29.18 11.74 8.26 22.86 17.6 33.22 27.96 47.12 47.12 73.08 109.78 73.08 176.42s-25.95 129.3-73.08 176.42a252.312 252.312 0 01-33.22 27.96c34.25 19.04 72.96 29.18 113.24 29.18 62.39 0 121.04-24.29 165.16-68.41 44.12-44.11 68.41-102.77 68.41-165.16s-24.29-121.04-68.41-165.16z"}),n.jsx("foreignObject",{x:"30",y:"25",width:"250",height:"450",children:n.jsx("div",{className:"venn-diagram__circle-content-left",children:e})}),n.jsx("foreignObject",{x:"480",y:"25",width:"250",height:"450",children:n.jsx("div",{className:"venn-diagram__circle-content-right",children:t})}),n.jsx("foreignObject",{x:"290",y:"65",width:"182",height:"370",children:n.jsx("div",{className:"venn-diagram__circle-content-intersection",children:r})})]})}function ln({things:e,rules:t}){const[r]=he(),[a,o]=y.useState(null),u=()=>{o(Object.values(Ie(1,{latestDate:"2023/01/01",latestNumber:0,used:[]},t,e))[0])},m=()=>{let d=null;try{d=Ie(25,{latestDate:"2023/01/01",latestNumber:0,used:[]},t,e),console.log(d)}catch(f){console.error(f)}};return n.jsxs(R,{direction:"vertical",ref:r,children:[n.jsx(P.Title,{level:5,children:"Game Simulator"}),n.jsx(U,{size:"large",onClick:u,children:"Simulate"}),n.jsx(U,{size:"large",onClick:m,children:"Generate Demos (log)"}),a&&n.jsx(sn,{game:a},JSON.stringify(a))]})}function dn({children:e,things:t,rules:r,addEntryToUpdate:a}){const o=y.useMemo(()=>Object.values(t).filter(f=>{if(f.syllables&&f.syllables.split(_e).join("")!==f.name.replace(/\s/g,""))return console.log("❗️ Name and syllables do not match",f.name,f.syllables),!0;const p=Object.values(r).filter(s=>s.updatedAt>f.updatedAt);return p.filter(s=>s.method==="auto").length>0&&console.log("❗️ Thing has auto updates that will be performed automatically upon downloading the JSON"),p.some(s=>s.method!=="auto")}),[t,r]),[u,m]=y.useState(null);y.useEffect(()=>{const f=async p=>{console.log("Found things that need to update..."),m(null),await ue(250),o.length>0&&m(o[0])};console.count("Checking for things that need to update..."),o.length>0&&f(o[0])},[o]);const d=f=>{a(f.itemId,f)};return n.jsxs(n.Fragment,{children:[u&&n.jsx(ye,{subtitle:`(${o.length} left to update)`,isModalOpen:u!==null,onSaveThing:d,onCancel:()=>m(null),thing:u,rules:r,okButtonText:"Update",width:"90vw"}),e]})}function Ue({addEntryToUpdate:e,availableThings:t,rules:r,width:a}){const{notification:o}=it.useApp(),[u,m]=y.useState(null),[d,f]=y.useState({}),p=()=>{const i=Z.sample(t.filter(l=>!d[l.id]));i?(f(l=>({...l,[i.id]:!0})),m({itemId:i.id,name:cn(i),updatedAt:Date.now(),syllables:"",stressedSyllable:0,rules:[]})):m(null)},j=y.useMemo(()=>{if(!u)return[];const i=t.find(l=>l.id===u.itemId);return[i==null?void 0:i.name.pt,...(i==null?void 0:i.aliasesPt)??[]].filter(Boolean)},[u,t]),s=async i=>{u&&((!i.name||!i.itemId)&&o.error({message:"Name and Item ID are required"}),e(i.itemId,i),console.log("COMPLETED SAVE"),m(null),await ue(250),p())},g=async()=>{m(null),await ue(100),p()};return n.jsxs(n.Fragment,{children:[n.jsx(U,{size:"large",onClick:p,children:"Classify New Item"}),!!u&&n.jsx(ye,{isModalOpen:u!==null,onSaveThing:s,onCancel:()=>m(null),thing:u,rules:r,width:a*.9,itemAliases:j,onGiveAnotherThing:g})]})}const cn=e=>e.name.pt.split(" ").length===1?e.name.pt:e.aliasesPt?e.aliasesPt.find(t=>t.split(" ").length===1)??e.name.pt:e.name.pt;function un({things:e,addEntryToUpdate:t,availableThings:r,rules:a,setActiveThing:o}){const[u,{width:m}]=he(),d=y.useMemo(()=>Object.values(e),[e]),f=ze({total:d.length,showQuickJumper:!0}),p=[{title:"ItemId",dataIndex:"itemId",key:"itemId",sorter:(s,g)=>Number(s.itemId)-Number(g.itemId),render:s=>n.jsx(L,{children:s})},{title:"Name",dataIndex:"name",key:"name",sorter:(s,g)=>s.name.localeCompare(g.name),render:s=>n.jsx(P.Text,{children:s})},{title:"Sprite",dataIndex:"itemId",key:"sprite",render:s=>n.jsx(ne,{thing:e[s],onActivateThing:o},`i-${s}`)},{title:"Rules",dataIndex:"rules",key:"rules",render:(s,g)=>n.jsx(R,{wrap:!0,children:s.map(i=>n.jsx(dt,{title:a[i].title,children:n.jsx(L,{color:a[i].updatedAt>g.updatedAt?"red":void 0,children:i})},i))})},{title:"Count",dataIndex:"rules",key:"count",sorter:(s,g)=>s.rules.length-g.rules.length,render:s=>s.length}],j=y.useMemo(()=>{const s={};return Object.values(e).forEach(g=>{s[g.name]||(s[g.name]=[]),s[g.name].push(g.itemId)}),Object.values(s).filter(g=>g.length>1)},[e]);return n.jsxs(R,{direction:"vertical",ref:u,children:[n.jsxs(P.Title,{level:5,children:["Rules By Items ",n.jsx(W,{type:"vertical"})," Added: ",n.jsx(L,{children:Object.keys(e).length})," Available to add ",n.jsx(L,{children:r.length})]}),n.jsx(Ue,{addEntryToUpdate:t,availableThings:r,rules:a,width:m}),n.jsx(W,{}),n.jsx(Be,{dataSource:d,columns:p,rowKey:"itemId",pagination:f}),n.jsx(W,{}),n.jsx(P.Title,{level:5,children:"Duplicated Things"}),n.jsxs(R,{wrap:!0,children:[j.length===0&&n.jsx(P.Text,{children:"No duplicated things"}),j.map(s=>n.jsxs(ee,{align:"center",children:[n.jsx(L,{color:"red",children:s.length}),s.map(g=>n.jsx(ne,{thing:e[g],onActivateThing:o},`i-${g}`))]},s[0]))]})]})}function mn({things:e,addEntryToUpdate:t,availableThings:r,rules:a,thingsByRules:o,setActiveThing:u,containerWidth:m}){const{is:d,addParam:f}=ge(),p=y.useMemo(()=>Object.values(a).map(i=>({...i,thingsCount:o[i.id].length})),[a,o]),j=ze({total:p.length,showQuickJumper:!0}),s=y.useMemo(()=>{const i=Object.values(o).map(l=>l.length);return{maxThings:Math.max(...i),minThings:Math.min(...i),averageThings:Math.round(Object.values(o).reduce((l,x)=>l+x.length,0)/Object.keys(o).length)}},[o]),g=[{title:"Id",dataIndex:"id",key:"id",sorter:(i,l)=>Number(i.id.split("-")[1])-Number(l.id.split("-")[1]),render:i=>n.jsx(P.Text,{children:i})},{title:"Rule",dataIndex:"title",key:"title",sorter:(i,l)=>i.title.localeCompare(l.title),render:i=>n.jsx(P.Text,{children:i})},{title:"Type",dataIndex:"type",key:"type",sorter:(i,l)=>i.type.localeCompare(l.type)},{title:"Method",dataIndex:"method",key:"method",sorter:(i,l)=>i.method.localeCompare(l.method)},{title:"Things",dataIndex:"thingsCount",key:"thingsCount",render:(i,l)=>n.jsxs(R,{size:"small",children:[n.jsx(L,{children:i}),d("showThings")?n.jsxs(R,{size:"small",wrap:!0,children:[o[l.id].slice(0,20).map(x=>n.jsx(ne,{thing:e[x],onActivateThing:u},`${l.id}-${x}`)),o[l.id].length>20&&n.jsxs(P.Text,{children:["+",i-20," more"]})]}):n.jsxs(R,{size:"small",wrap:!0,children:[o[l.id].slice(0,5).map(x=>n.jsx(ne,{thing:e[x],onActivateThing:u},`${l.id}-${x}`)),o[l.id].length>5&&n.jsxs(P.Text,{children:["+",i-5," more"]})]})]}),sorter:(i,l)=>i.thingsCount-l.thingsCount},{title:"Level",dataIndex:"level",key:"level",sorter:(i,l)=>i.level-l.level,render:i=>n.jsx(Le,{value:i,count:3,disabled:!0})}];return n.jsxs(R,{direction:"vertical",children:[n.jsxs(P.Title,{level:4,children:["Things By Rule (Added: ",Object.keys(e).length," | ",r.length,")"," "]}),n.jsxs(R,{split:n.jsx(W,{type:"vertical"}),wrap:!0,children:[n.jsx(Ue,{addEntryToUpdate:t,availableThings:r,rules:a,width:m}),n.jsxs(P.Text,{strong:!0,children:["Average Things: ",n.jsx(L,{children:s.averageThings})]}),n.jsxs(P.Text,{strong:!0,children:["Max Things: ",n.jsx(L,{children:s.maxThings})]}),n.jsxs(P.Text,{strong:!0,children:["Min Things: ",n.jsx(L,{children:s.minThings})]}),n.jsx(me,{checked:d("showThings"),onChange:i=>f("showThings",i),checkedChildren:"Hide things",unCheckedChildren:"Show things"})]}),n.jsx(Be,{dataSource:p,columns:g,pagination:j})]})}const Me=e=>{const t=e.filter(r=>r.split(" ").length===1);return t.length>0?t[0]:""};function fn({data:e,addEntryToUpdate:t}){const[r,{width:a}]=he(),o=ce("items"),u=ce("daily-diagram-rules"),m=y.useMemo(()=>Object.values(o.data??{}).filter(l=>{var b,$,C,v,I,c;if(e&&e[l.id]!==void 0||l.nsfw)return!1;const x=l.name.pt.split(" ").length===1;return!!((b=l.decks)!=null&&b.includes("thing")||($=l.decks)!=null&&$.includes("alien")&&x||(C=l.decks)!=null&&C.includes("manufactured")&&x||(v=l.decks)!=null&&v.includes("alien")&&l.aliasesPt&&Me(l.aliasesPt)||(I=l.decks)!=null&&I.includes("manufactured")&&l.aliasesPt&&Me(l.aliasesPt)||(c=l.decks)!=null&&c.includes("meta")&&x)}),[e,o.data]),d=y.useMemo(()=>u.data??{},[u.data]),f=y.useMemo(()=>{const l=Object.values(d).reduce((x,b)=>(x[b.id]=[],x),{});return Z.orderBy(Object.values(e),["updatedAt"],["desc"]).forEach(x=>{x.rules.forEach(b=>{l[b].push(x.itemId)})}),l},[e,d]),{is:p,queryParams:j}=ge(),[s,g]=y.useState(null);if(o.isLoading||u.isLoading)return n.jsx(P.Text,{children:"Loading..."});const i=l=>{t(l.itemId,l)};return n.jsx(De,{isLoading:o.isLoading||u.isLoading,hasResponseData:o.hasResponseData||u.hasResponseData,children:n.jsx("div",{ref:r,children:n.jsxs(dn,{things:e,rules:d,addEntryToUpdate:t,children:[s&&n.jsx(ye,{isModalOpen:s!==null,onSaveThing:l=>{i(l),g(null)},onCancel:()=>g(null),thing:s,rules:d,okButtonText:"Update",width:a}),(p("display","rule")||!j.has("display"))&&n.jsx(mn,{things:e,addEntryToUpdate:t,availableThings:m,rules:d,thingsByRules:f,setActiveThing:g,containerWidth:a}),p("display","thing")&&n.jsx(un,{things:e,addEntryToUpdate:t,availableThings:m,rules:d,thingsByRules:f,setActiveThing:g}),p("display","simulator")&&n.jsx(ln,{things:e,addEntryToUpdate:t,availableThings:m,rules:d})]})})})}function sa(){const e=jt({tdrResourceName:"daily-diagram-items",firebaseDataCollectionName:"diagramItems",serialize:!0});return n.jsx(ct,{title:"Items",subtitle:"Diagram Sets",children:n.jsxs(je,{hasSider:!0,children:[n.jsx(yt,{children:n.jsx(tn,{...e})}),n.jsx(je.Content,{className:"content",children:n.jsx(De,{isLoading:e.isLoading||e.isSaving,error:e.error,hasResponseData:!Z.isEmpty(e.data),children:n.jsx(ee,{vertical:!0,gap:24,children:n.jsx(fn,{...e})})})})]})})}export{sa as ItemsDiagramSets,sa as default};
